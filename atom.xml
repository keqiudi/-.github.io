<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>WalnutğŸ­</title>
  
  
  <link href="https://keqiudi.github.io/atom.xml" rel="self"/>
  
  <link href="https://keqiudi.github.io/"/>
  <updated>2023-07-19T17:00:17.053Z</updated>
  <id>https://keqiudi.github.io/</id>
  
  <author>
    <name>WalnutğŸ­</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>çº¿ç¨‹æ± C++ç‰ˆ</title>
    <link href="https://keqiudi.github.io/posts/aa76cb12.html"/>
    <id>https://keqiudi.github.io/posts/aa76cb12.html</id>
    <published>2023-07-18T14:50:42.000Z</published>
    <updated>2023-07-19T17:00:17.053Z</updated>
    
    <content type="html"><![CDATA[<h1>1.ä»»åŠ¡é˜Ÿåˆ—</h1><h2 id="ç±»å£°æ˜-Task-TaskQueue">ç±»å£°æ˜(Task,TaskQueue)</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> C___PRACTICE_TASKQUEUE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> C___PRACTICE_TASKQUEUE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> function = <span class="built_in">void</span>(*)(<span class="type">void</span>* arg);<span class="comment">//ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹å–åˆ«å</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Task</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Task</span>()&#123;</span><br><span class="line">        working = <span class="literal">nullptr</span>;</span><br><span class="line">        arg = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*æ— å‚æ„é€ */</span></span><br><span class="line">    <span class="built_in">Task</span>(function working, <span class="type">void</span>* arg)&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;working = working;</span><br><span class="line">        <span class="keyword">this</span>-&gt;arg = arg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*æœ‰å‚æ„é€ */</span></span><br><span class="line">    function working;</span><br><span class="line">    <span class="type">void</span>* arg;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TaskQueue</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::queue&lt;Task&gt; taskQueue;<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—,ç”¨å®¹å™¨å®ç°</span></span><br><span class="line">    <span class="type">pthread_mutex_t</span>  QueueLock;<span class="comment">//äº’æ–¥é”</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TaskQueue</span>();</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">TaskQueue</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addTask</span><span class="params">(Task&amp; task)</span></span>;</span><br><span class="line">    <span class="comment">/*æ·»åŠ ä»»åŠ¡*/</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addTask</span><span class="params">(function working, <span class="type">void</span>* arg)</span></span>;</span><br><span class="line">    <span class="comment">/*addTaské‡è½½å‡½æ•°*/</span></span><br><span class="line">    <span class="function">Task <span class="title">takeTask</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">/*å–å‡ºä»»åŠ¡*/</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">size_t</span> <span class="title">getTaskSize</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> taskQueue.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è·å–ä»»åŠ¡é˜Ÿåˆ—å¤§å°*/</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//C___PRACTICE_TASKQUEUE_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­<span class='p red'>Task</span> æ˜¯ä»»åŠ¡ç±»ï¼Œé‡Œè¾¹æœ‰ä¸¤ä¸ªæˆå‘˜ï¼Œåˆ†åˆ«æ˜¯ä¸¤ä¸ªæŒ‡é’ˆ <span class='p red'>void(*)(void*)</span>å’Œ <span class='p red'>void*</span></p><p>å¦å¤–ä¸€ä¸ªç±»<span class='p red'>TaskQueue</span>æ˜¯ä»»åŠ¡é˜Ÿåˆ—ï¼Œæä¾›äº†æ·»åŠ ä»»åŠ¡ã€å–å‡ºä»»åŠ¡ã€å­˜å‚¨ä»»åŠ¡ã€è·å–ä»»åŠ¡ä¸ªæ•°ã€çº¿ç¨‹åŒæ­¥çš„åŠŸèƒ½ã€‚</p><h2 id="ç±»å®šä¹‰">ç±»å®šä¹‰</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TaskQueue.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">TaskQueue::<span class="built_in">TaskQueue</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_init</span>(&amp;QueueLock, <span class="literal">nullptr</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">TaskQueue::~<span class="built_in">TaskQueue</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_destroy</span>(&amp;QueueLock);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TaskQueue::addTask</span><span class="params">(Task&amp; task)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;QueueLock);<span class="comment">//æ­¤å¤„å¦‚æœèµ„æºå·²ç»è¢«é‡Šæ”¾ï¼Œå°±ä¼šå‘ç”Ÿæ®µé”™è¯¯</span></span><br><span class="line">    taskQueue.<span class="built_in">push</span>(task);</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;QueueLock);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TaskQueue::addTask</span><span class="params">(function working, <span class="type">void</span> *arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;QueueLock);</span><br><span class="line">    taskQueue.<span class="built_in">push</span>(<span class="built_in">Task</span>(working, arg));</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;QueueLock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">Task <span class="title">TaskQueue::takeTask</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;QueueLock);</span><br><span class="line">    Task t;</span><br><span class="line">    <span class="keyword">if</span>(!taskQueue.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        t = taskQueue.<span class="built_in">front</span>();<span class="comment">//å–å‡ºé˜Ÿåˆ—å¤´éƒ¨å…ƒç´ </span></span><br><span class="line">        taskQueue.<span class="built_in">pop</span>();<span class="comment">//åˆ é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;QueueLock);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>2.çº¿ç¨‹æ± </h1><h2 id="ç±»å£°æ˜-ThreadPool">ç±»å£°æ˜(ThreadPool)</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> C___PRACTICE_THREADPOOL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> C___PRACTICE_THREADPOOL_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TaskQueue.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadPool</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    TaskQueue* taskQueue = <span class="literal">nullptr</span>;<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—</span></span><br><span class="line">    <span class="type">pthread_t</span> managerID;<span class="comment">//ç®¡ç†è€…çº¿ç¨‹id</span></span><br><span class="line">    <span class="type">pthread_t</span>* threadIDs;</span><br><span class="line">    <span class="type">int</span> minNum;<span class="comment">//æœ€å°çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> maxNum;<span class="comment">//æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> busyNum;<span class="comment">//å¿™çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> liveNum;<span class="comment">//æ´»ç€çš„çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> exitNum;<span class="comment">//è¦é”€æ¯çš„çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">pthread_mutex_t</span> threadLock;<span class="comment">//é”ä½æ•´ä¸ªçº¿ç¨‹æ± </span></span><br><span class="line">    <span class="type">pthread_mutex_t</span> busyLock;<span class="comment">//å•ç‹¬é”ä½busyNumï¼Œæé«˜æ•ˆç‡</span></span><br><span class="line">    <span class="type">pthread_cond_t</span> notEmpty;<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºæ—¶é˜»å¡ï¼Œä¸ä¸ºç©ºæ—¶å”¤é†’</span></span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> shutdown;<span class="comment">//æ˜¯å¦è¦é”€æ¯çº¿ç¨‹æ± </span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span>* <span class="title">worker</span><span class="params">(<span class="type">void</span>* arg)</span></span>;</span><br><span class="line">    <span class="comment">//å·¥ä½œçº¿ç¨‹å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span>* <span class="title">manager</span><span class="params">(<span class="type">void</span>* arg)</span></span>;</span><br><span class="line">    <span class="comment">//ç®¡ç†è€…çº¿ç¨‹å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">threadExit</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ThreadPool</span>(<span class="type">int</span> min,<span class="type">int</span> max);</span><br><span class="line">    <span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line">    ~<span class="built_in">ThreadPool</span>();</span><br><span class="line">    <span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addTask</span><span class="params">(Task task)</span></span>;</span><br><span class="line">    <span class="comment">//æ·»åŠ ä»»åŠ¡</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getBusyNumber</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//è·å–å¿™çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getAliveNumber</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//è·å–æ´»ç€çš„çº¿ç¨‹æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//C___PRACTICE_THREADPOOL_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç±»å®šä¹‰-2">ç±»å®šä¹‰</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ThreadPool.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CHECK_TIME 5<span class="comment">//é»˜è®¤ç®¡ç†è€…çº¿ç¨‹æ£€æµ‹æ—¶é—´</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ADD_NUM 2<span class="comment">//ä¸€æ¬¡æ·»åŠ 3ä¸ªçº¿ç¨‹</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EXIT_NUM 2<span class="comment">//ä¸€æ¬¡é”€æ¯3ä¸ªçº¿ç¨‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">safe_delete_void_ptr</span><span class="params">(<span class="type">void</span>* &amp;target)</span></span>;</span><br><span class="line"></span><br><span class="line">ThreadPool::<span class="built_in">ThreadPool</span>(<span class="type">int</span> min, <span class="type">int</span> max)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">       </span><br><span class="line">        taskQueue = <span class="built_in">new</span> (std::nothrow)TaskQueue;</span><br><span class="line">          <span class="comment">/*æ²¡æœ‰std::nothrowåˆ™ifæ¡ä»¶å§‹ç»ˆä¸ºfalse*/</span></span><br><span class="line">        <span class="keyword">if</span>(taskQueue == <span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           cout &lt;&lt; <span class="string">&quot;new taskQueue error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        threadIDs = <span class="built_in">new</span> (std::nothrow)<span class="type">pthread_t</span>[max];<span class="comment">//åˆ†é…åŠ¨æ€æ•°ç»„</span></span><br><span class="line"><span class="comment">/*æ²¡æœ‰std::nothrowåˆ™ifæ¡ä»¶å§‹ç»ˆä¸ºfalse*/</span></span><br><span class="line">        <span class="keyword">if</span>(threadIDs == <span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;new threadIDs error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">memset</span>(threadIDs, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">pthread_t</span>) * max);</span><br><span class="line">        minNum = min;</span><br><span class="line">        maxNum = max;</span><br><span class="line">        busyNum = <span class="number">0</span>;</span><br><span class="line">        liveNum = min;</span><br><span class="line">        exitNum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">pthread_mutex_init</span>(&amp;threadLock, <span class="literal">nullptr</span>) != <span class="number">0</span> ||</span><br><span class="line">           <span class="built_in">pthread_mutex_init</span>(&amp;busyLock, <span class="literal">nullptr</span>) != <span class="number">0</span> ||</span><br><span class="line">           <span class="built_in">pthread_cond_init</span>(&amp;notEmpty, <span class="literal">nullptr</span>) != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;init the lock or cond error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        shutdown = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç±»çš„æˆå‘˜å‡½æ•°ä¼ é€’åœ°å€æ—¶å¤±è´¥æŠ¥é”™:Reference to non-static member function must be called</span></span><br><span class="line"><span class="comment">         * åŸå› :ç±»çš„æˆå‘˜å‡½æ•°ä¸æ˜¯é™æ€æ—¶ï¼Œå‡½æ•°æ²¡æœ‰åœ°å€ï¼Œåªæœ‰å®ä¾‹åŒ–ä¹‹åæ‰ä¼šæœ‰åœ°å€ï¼Œæ‰€ä»¥ä¸èƒ½ä¼ é€’åœ°å€</span></span><br><span class="line"><span class="comment">         * ä¸¤ç§è§£å†³æ–¹æ¡ˆ:</span></span><br><span class="line"><span class="comment">         * 1.å°†æˆå‘˜å‡½æ•°æ”¹ä¸ºé™æ€å‡½æ•°</span></span><br><span class="line"><span class="comment">         * 2.å°†æˆå‘˜å‡½æ•°æ”¹ä¸ºå…¨å±€å‡½æ•°ï¼Œç‹¬ç«‹äºç±»ä¹‹å¤–ï¼ˆæƒ³è¦è®¿é—®æˆå‘˜å˜é‡å°±å¿…é¡»åŠ ä¸Šå‹å…ƒå‡½æ•°ï¼‰</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="built_in">pthread_create</span>(&amp;managerID, <span class="literal">nullptr</span>, manager, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; min; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_create</span>(&amp;threadIDs[i], <span class="literal">nullptr</span>, worker, <span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;<span class="comment">//æ­¤å¤„ä¸è¿”å›å°†ä¼šå¯¼è‡´ä¹‹åçš„é‡Šæ”¾èµ„æº</span></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">while</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(threadIDs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] threadIDs;</span><br><span class="line">        threadIDs = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;<span class="comment">//å¦‚æœthreadIDsä¸ä¸ºç©ºï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="keyword">if</span>(taskQueue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> taskQueue;</span><br><span class="line">        taskQueue = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;<span class="comment">//å¦‚æœtaskQueueä¸ä¸ºç©ºï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>* <span class="title">ThreadPool::worker</span><span class="params">(<span class="type">void</span>* arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> pool = <span class="built_in">static_cast</span>&lt;ThreadPool*&gt;(arg);<span class="comment">//ä¼ é€’çš„æ˜¯(void*)this,æ‰€ä»¥è¦å¼ºåˆ¶ç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="comment">/*æ­¤å¤„ä¸ºC++çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¹Ÿå¯ç”¨Cä¸­çš„(ThreadPool*)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * é™æ€å‡½æ•°ä¸èƒ½è®¿é—®æˆå‘˜å˜é‡ï¼Œæ‰€ä»¥å¿…é¡»ä¼ å…¥è¯¥ç±»çš„å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">        <span class="keyword">while</span>(pool-&gt;taskQueue-&gt;<span class="built_in">getTaskSize</span>()==<span class="number">0</span> &amp;&amp; !pool-&gt;shutdown)</span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;thread &quot;</span>&lt;&lt;<span class="built_in">pthread_self</span>()&lt;&lt;<span class="string">&quot; is waiting&quot;</span>&lt;&lt;endl;</span><br><span class="line">            <span class="built_in">pthread_cond_wait</span>(&amp;pool-&gt;notEmpty, &amp;pool-&gt;threadLock);</span><br><span class="line">            <span class="comment">//å¦‚æœä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œä¸”çº¿ç¨‹æ± æ²¡æœ‰å…³é—­ï¼Œåˆ™ç­‰å¾…</span></span><br><span class="line">            <span class="comment">//ç­‰å¾…æ¡ä»¶å˜é‡ï¼Œä¼šå…ˆè§£é”ï¼Œç­‰å¾…è¢«å”¤é†’ï¼Œå†æ¬¡æ‹¿åˆ°äº†è¿™æŠŠé”</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/*ç®¡ç†è€…é”€æ¯çº¿ç¨‹é€»è¾‘</span></span><br><span class="line"><span class="comment">             *</span></span><br><span class="line"><span class="comment">             * å”¤é†’ååˆ¤æ–­æ˜¯å¦è¦é”€æ¯çº¿ç¨‹</span></span><br><span class="line"><span class="comment">             * */</span></span><br><span class="line">            <span class="keyword">if</span> (pool-&gt;exitNum &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                pool-&gt;exitNum--;<span class="comment">//ä¸èƒ½æ”¾åœ¨ifé‡Œé¢ï¼Œå¦åˆ™å¯èƒ½åœ¨äº§ç”Ÿæ–°çº¿ç¨‹æ—¶ï¼ŒNum&gt;0,ç›´æ¥å°±è¢«é”€æ¯äº†ï¼Œä¸ç¬¦åˆæœŸæœ›ï¼Œæ•…ä¿è¯æ¯æ¬¡å¾ªç¯éƒ½å‡ä¸€</span></span><br><span class="line">                <span class="comment">/*é™å®šå½“å­˜æ´»çš„çº¿ç¨‹ä¸ªæ•°å¤§äºæœ€å°ä¸ªæ•°æ—¶æ‰é”€æ¯*/</span></span><br><span class="line">                <span class="keyword">if</span> (pool-&gt;liveNum &gt; pool-&gt;minNum) &#123;</span><br><span class="line">                    pool-&gt;liveNum--;</span><br><span class="line">                    <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);<span class="comment">//è§£é”</span></span><br><span class="line">                    pool-&gt;<span class="built_in">threadExit</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(pool-&gt;shutdown)<span class="comment">//å¦‚æœçº¿ç¨‹æ± å…³é—­ï¼Œåˆ™çº¿ç¨‹å…¨éƒ¨é€€å‡º</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);<span class="comment">//é¿å…æ­»é”</span></span><br><span class="line">            pool-&gt;<span class="built_in">threadExit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å–å‡ºä»»åŠ¡å·¥ä½œ</span></span><br><span class="line">        Task task = pool-&gt;taskQueue-&gt;<span class="built_in">takeTask</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ­¤å¤„ç”Ÿäº§è€…ä¸éœ€è¦è¢«å”¤é†’äº†ï¼Œä»»åŠ¡é˜Ÿåˆ—å¯ä»¥æ— é™å¤§,å³å¯ä»¥æ— é™é‡çš„ä»»åŠ¡</span></span><br><span class="line">        <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);<span class="comment">//è§£é”</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">        pool-&gt;busyNum++;</span><br><span class="line">        <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;thread &quot;</span> &lt;&lt; <span class="built_in">pthread_self</span>() &lt;&lt; <span class="string">&quot; start working&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        task.<span class="built_in">working</span>(task.arg);<span class="comment">//æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">        <span class="built_in">safe_delete_void_ptr</span>&lt;<span class="type">int</span>&gt;(task.arg);<span class="comment">//ç›´æ¥delete task.arg æœ‰å±é™©</span></span><br><span class="line">        task.arg = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;thread &quot;</span> &lt;&lt; <span class="built_in">pthread_self</span>() &lt;&lt; <span class="string">&quot; end working&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">        pool-&gt;busyNum--;</span><br><span class="line">        <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>* <span class="title">ThreadPool::manager</span><span class="params">(<span class="type">void</span> *arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> pool = <span class="built_in">static_cast</span>&lt;ThreadPool*&gt;(arg);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!pool-&gt;shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sleep</span>(CHECK_TIME);<span class="comment">//æ¯éš”3ç§’æ£€æµ‹ä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">        <span class="type">size_t</span> queueSize = pool-&gt;taskQueue-&gt;<span class="built_in">getTaskSize</span>();<span class="comment">//å–å‡ºä»»åŠ¡ä¸ªæ•°</span></span><br><span class="line">        <span class="type">int</span> liveNum = pool-&gt;liveNum;<span class="comment">//å–å‡ºå­˜æ´»çº¿ç¨‹ä¸ªæ•°</span></span><br><span class="line">        <span class="type">int</span> busyNum = pool-&gt;busyNum;</span><br><span class="line">        <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ·»åŠ çº¿ç¨‹è§„åˆ™</span></span><br><span class="line">        <span class="comment">//1.ä»»åŠ¡ä¸ªæ•°&gt;å­˜æ´»çº¿ç¨‹ä¸ªæ•°&amp;&amp;å­˜æ´»çº¿ç¨‹ä¸ªæ•°&lt;æœ€å¤§çº¿ç¨‹ä¸ªæ•°æ—¶ï¼Œåˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">if</span>(queueSize&gt;liveNum&amp;&amp;liveNum&lt;pool-&gt;maxNum)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">/*forå¾ªç¯ä¸‰ä¸ªæ¡ä»¶</span></span><br><span class="line"><span class="comment">             * 1.éå†çº¿ç¨‹id</span></span><br><span class="line"><span class="comment">             * 2.counter&lt;ADD_NUM</span></span><br><span class="line"><span class="comment">             * 3.åœ¨å­˜æ´»çº¿ç¨‹ä¸ªæ•°å°äºæœ€å¤§çº¿ç¨‹ä¸ªæ•°æ—¶æ‰æ·»åŠ */</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pool-&gt;maxNum&amp;&amp;counter&lt;ADD_NUM&amp;&amp;pool-&gt;liveNum&lt;pool-&gt;maxNum;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//æ‰¾åˆ°ç©ºé—²çš„çº¿ç¨‹idï¼Œåˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">                <span class="keyword">if</span>(pool-&gt;threadIDs[i]==<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">pthread_create</span>(&amp;pool-&gt;threadIDs[i],<span class="literal">nullptr</span>,worker,pool);</span><br><span class="line">                    counter++;</span><br><span class="line">                    pool-&gt;liveNum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é”€æ¯çº¿ç¨‹è§„åˆ™</span></span><br><span class="line">        <span class="comment">//1.å¿™çº¿ç¨‹*2&lt;å­˜æ´»çº¿ç¨‹&amp;&amp;å­˜æ´»çº¿ç¨‹&gt;æœ€å°çº¿ç¨‹ä¸ªæ•°æ—¶ï¼Œé”€æ¯çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">if</span>(busyNum*<span class="number">2</span>&lt;liveNum&amp;&amp;liveNum&gt;pool-&gt;minNum)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">            pool-&gt;exitNum = EXIT_NUM;</span><br><span class="line">            <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">            <span class="comment">//å”¤é†’çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„çº¿ç¨‹ï¼Œè®©ä»–ä»¬è‡ªå·±æ‰§è¡Œï¼Œåˆ¤æ–­æ˜¯å¦é€€å‡º</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;EXIT_NUM;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">pthread_cond_signal</span>(&amp;pool-&gt;notEmpty);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ThreadPool::threadExit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*ä½¿çº¿ç¨‹é€€å‡ºæ—¶çº¿ç¨‹idå½’0*/</span></span><br><span class="line">    <span class="type">pthread_t</span> tid = <span class="built_in">pthread_self</span>();<span class="comment">//è·å–å½“å‰çº¿ç¨‹çš„id</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(threadIDs[i] == tid)</span><br><span class="line">        &#123;</span><br><span class="line">            threadIDs[i] = <span class="number">0</span>;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;threadExit() called, threadID: &quot;</span> &lt;&lt; tid &lt;&lt; <span class="string">&quot; exiting...&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pthread_exit</span>(<span class="literal">NULL</span>);<span class="comment">//Cçš„å‡½æ•°ï¼Œæ­¤å¤„ä¸ç”¨nullptrï¼Œè€Œæ˜¯ç”¨NULL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ThreadPool::addTask</span><span class="params">(Task task)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­¤å¤„ä¸ç”¨åˆ¤æ–­ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æ»¡ï¼Œå› ä¸ºä»»åŠ¡é˜Ÿåˆ—å¯ä»¥æ— é™å¤§</span></span><br><span class="line">    <span class="keyword">if</span>(shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="comment">//å¦‚æœçº¿ç¨‹æ± å…³é—­ï¼Œåˆ™ä¸æ·»åŠ ä»»åŠ¡</span></span><br><span class="line"></span><br><span class="line">    taskQueue-&gt;<span class="built_in">addTask</span>(task);<span class="comment">//æ·»åŠ ä»»åŠ¡,æ­¤æ—¶ä¸ç”¨ä¸Šé”åŸå› ï¼Œå› ä¸ºaddTaskä¸­å·²ç»ä¸Šé”äº†</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_cond_signal</span>(&amp;notEmpty);<span class="comment">//å”¤é†’çº¿ç¨‹æ± ä¸­çš„æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ThreadPool::getBusyNumber</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//ç”¨busyNumè‡ªå·±çš„é”ï¼Œæé«˜æ•ˆç‡</span></span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;busyLock);</span><br><span class="line">    <span class="type">int</span> busyNum = <span class="keyword">this</span>-&gt;busyNum;</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;busyLock);</span><br><span class="line">    <span class="keyword">return</span> busyNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ThreadPool::getAliveNumber</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//ç”¨çº¿ç¨‹æ± çš„é”</span></span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;threadLock);</span><br><span class="line">    <span class="type">int</span> liveNum = <span class="keyword">this</span>-&gt;liveNum;</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;threadLock);</span><br><span class="line">    <span class="keyword">return</span> liveNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ThreadPool::~<span class="built_in">ThreadPool</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;shutdown = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_join</span>(<span class="keyword">this</span>-&gt;managerID, <span class="literal">nullptr</span>);<span class="comment">//ç­‰å¾…ç®¡ç†è€…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>-&gt;liveNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">pthread_cond_signal</span>(&amp;notEmpty);<span class="comment">//å”¤é†’æ‰€æœ‰çº¿ç¨‹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_mutex_destroy</span>(&amp;threadLock);</span><br><span class="line">    <span class="built_in">pthread_mutex_destroy</span>(&amp;busyLock);</span><br><span class="line">    <span class="built_in">pthread_cond_destroy</span>(&amp;notEmpty);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(taskQueue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> taskQueue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(threadIDs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> [] threadIDs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">safe_delete_void_ptr</span><span class="params">(<span class="type">void</span>* &amp;target)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(target)</span><br><span class="line">    &#123;</span><br><span class="line">        T* temp = <span class="built_in">static_cast</span>&lt;T*&gt;(target);</span><br><span class="line">        <span class="keyword">delete</span> temp;</span><br><span class="line">        temp = <span class="literal">nullptr</span>;</span><br><span class="line">        target = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//</span></span><br></pre></td></tr></table></figure><h3 id="é‡åˆ°çš„é—®é¢˜">é‡åˆ°çš„é—®é¢˜</h3><div class="tip warning faa-horizontal animated"><p>æ³¨æ„25è¡Œç”¨newåˆ†é…å†…å­˜C++ä¸­ï¼Œnewæ“ä½œç¬¦é»˜è®¤ä¸ä¼šè¿”å›NULLï¼Œè€Œæ˜¯ä¼šåœ¨åˆ†é…å†…å­˜å¤±è´¥æ—¶æŠ›å‡ºä¸€ä¸ªstd::bad_allocå¼‚å¸¸ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä½ ä¸éœ€è¦åœ¨æ¯æ¬¡ä½¿ç”¨newæ“ä½œç¬¦åæ£€æŸ¥è¿”å›å€¼æ˜¯å¦ä¸ºNULLï¼Œè€Œæ˜¯å¯ä»¥ç”¨try/catchè¯­å¥ç»Ÿä¸€å¤„ç†å¼‚å¸¸ã€‚å¦‚æœä½ æƒ³è®©newæ“ä½œç¬¦åœ¨åˆ†é…å†…å­˜å¤±è´¥æ—¶è¿”å›NULLï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œä½ å¯ä»¥ä½¿ç”¨std::nothrowå‚æ•°</p></div><p>è§£å†³æ–¹æ¡ˆ:</p><ul><li>try/catchè¯­å¥ç»Ÿä¸€å¤„ç†å¼‚å¸¸</li><li>std::nothrowå‚æ•°</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.ç¬¬ä¸€ç§</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">            taskQueue = <span class="keyword">new</span> TaskQueue;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">catch</span> (std::bad_alloc &amp;e) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;new taskQueue error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            threadIDs = <span class="keyword">new</span> <span class="type">pthread_t</span>[max];<span class="comment">//åˆ†é…åŠ¨æ€æ•°ç»„</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">catch</span> (std::bad_alloc &amp;e) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;new threadIDs error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">/////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§ï¼Œè§ä¸Šæ–¹ä»£ç ä¸­ä½¿ç”¨æ–¹æ³•,25è¡Œ</span></span><br></pre></td></tr></table></figure><div class="tip warning faa-horizontal animated"><p>æ³¨æ„è¿™é‡Œ133è¡Œä»£ç ï¼ŒC++ä¸­ä¸èƒ½ç”¨deleteç›´æ¥åˆ é™¤ä¸€ä¸ªvoid*æŒ‡é’ˆï¼Œå› ä¸ºdeleteéœ€è¦è°ƒç”¨è¢«åˆ é™¤å¯¹è±¡çš„ææ„å‡½æ•°ï¼Œè€ŒvoidæŒ‡é’ˆæ²¡æœ‰ç±»å‹ä¿¡æ¯ï¼Œæ‰€ä»¥æ— æ³•ç¡®å®šè°ƒç”¨å“ªä¸ªææ„å‡½æ•°ã€‚è¿™æ ·åšä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼Œå¯èƒ½ä¼šå‡ºç°å´©æºƒæˆ–å†…å­˜æ³„æ¼ã€‚ä½ å¿…é¡»åœ¨deleteä¹‹å‰æŠŠvoidæŒ‡é’ˆè½¬æ¢å›å®ƒåŸæ¥çš„ç±»å‹ï¼Œæ‰èƒ½æ­£ç¡®åœ°é‡Šæ”¾å†…å­˜ã€‚</p></div><ul><li>è§£å†³æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨æ¨¡æ¿å®šä¹‰å†…è”å‡½æ•°</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">safe_delete_void_ptr</span><span class="params">(<span class="type">void</span>* &amp;target)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">safe_delete_void_ptr</span><span class="params">(<span class="type">void</span>* &amp;target)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(target)</span><br><span class="line">    &#123;</span><br><span class="line">        T* temp = <span class="built_in">static_cast</span>&lt;T*&gt;(target);</span><br><span class="line">        <span class="keyword">delete</span> temp;</span><br><span class="line">        temp = <span class="literal">nullptr</span>;</span><br><span class="line">        target = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//</span></span><br></pre></td></tr></table></figure><p>[ C++æŒ‡é’ˆç¼–ç¨‹ä½ è¦å°å¿ƒçš„é™·é˜±â€”â€”å¦‚ä½•ä¼˜é›…çš„é‡Šæ”¾æŒ‡é’ˆvoid*_c++é‡Šæ”¾void<em>æŒ‡é’ˆ_äºŒæµå°å®çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/SweetTool/article/details/77688337?ops_request_misc=%7B%22request%5Fid%22%3A%22168977949416800222881353%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168977949416800222881353&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-77688337-null-null.142%5Ev90%5Einsert_down28v1,239%5Ev2%5Einsert_chatgpt&amp;utm_term=c%2B%2B">https://blog.csdn.net/SweetTool/article/details/77688337?ops_request_misc={&quot;request_id&quot;%3A&quot;168977949416800222881353&quot;%2C&quot;scm&quot;%3A&quot;20140713.130102334..&quot;}&amp;request_id=168977949416800222881353&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-77688337-null-null.142^v90^insert_down28v1,239^v2^insert_chatgpt&amp;utm_term=c%2B%2B</a> delete void</em> æŒ‡é’ˆ&amp;spm=1018.2226.3001.4187)</p><ul><li>è§£å†³æ–¹æ¡ˆäºŒï¼šç”¨æ¨¡æ¿ç±»</li></ul><h1>3.ä¿®æ”¹ä¸ºæ¨¡æ¿ç±»å¤„ç†æŒ‡é’ˆé‡Šæ”¾é—®é¢˜</h1><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">TaskQueue.h</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">TaskQueue.cpp</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ThreadPool.h</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">ThreadPool.cpp</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -5">test.cpp</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> C___PRACTICE_TASKQUEUE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> C___PRACTICE_TASKQUEUE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> function = <span class="built_in">void</span>(*)(<span class="type">void</span>* arg);<span class="comment">//ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹å–åˆ«å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;<span class="comment">//å«æœ‰æ¨¡æ¿ç±»çš„å‡½æ•°æˆ–ç±»éƒ½è¦åŠ è¿™ä¸ª</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Task</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Task</span>&lt;T&gt;()&#123;</span><br><span class="line">        working = <span class="literal">nullptr</span>;</span><br><span class="line">        arg = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*æ— å‚æ„é€ */</span></span><br><span class="line">    <span class="built_in">Task</span>&lt;T&gt;(function working, <span class="type">void</span>* arg)&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;working = working;</span><br><span class="line">        <span class="keyword">this</span>-&gt;arg = (T*)arg;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*æœ‰å‚æ„é€ */</span></span><br><span class="line">    function working;</span><br><span class="line">    T* arg;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TaskQueue</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">    std::queue&lt;Task&lt;T&gt;&gt; taskQueue;<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—,ç”¨å®¹å™¨å®ç°</span></span><br><span class="line">    <span class="type">pthread_mutex_t</span>  QueueLock;<span class="comment">//äº’æ–¥é”</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">TaskQueue</span>();</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">TaskQueue</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addTask</span><span class="params">(Task&lt;T&gt; task)</span></span>;</span><br><span class="line">    <span class="comment">/*æ·»åŠ ä»»åŠ¡*/</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addTask</span><span class="params">(function working, <span class="type">void</span>* arg)</span></span>;</span><br><span class="line">    <span class="comment">/*addtaské‡è½½å‡½æ•°*/</span></span><br><span class="line">    <span class="function">Task&lt;T&gt; <span class="title">takeTask</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">/*å–å‡ºä»»åŠ¡*/</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">size_t</span> <span class="title">getTaskSize</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> taskQueue.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*è·å–ä»»åŠ¡é˜Ÿåˆ—å¤§å°*/</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//C___PRACTICE_TASKQUEUE_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TaskQueue.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">TaskQueue&lt;T&gt;::<span class="built_in">TaskQueue</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_init</span>(&amp;QueueLock, <span class="literal">nullptr</span>);</span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;<span class="comment">//æ¨¡æ¿ç±»å‰é¢éƒ½è¦åŠ è¿™ä¸ª</span></span><br><span class="line">TaskQueue&lt;T&gt;::~<span class="built_in">TaskQueue</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_destroy</span>(&amp;QueueLock);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> TaskQueue&lt;T&gt;::<span class="built_in">addTask</span>(Task&lt;T&gt; task)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;QueueLock);<span class="comment">//æ­¤å¤„å¦‚æœèµ„æºå·²ç»è¢«é‡Šæ”¾ï¼Œå°±ä¼šå‘ç”Ÿæ®µé”™è¯¯</span></span><br><span class="line">    taskQueue.<span class="built_in">push</span>(task);</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;QueueLock);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> TaskQueue&lt;T&gt;::<span class="built_in">addTask</span>(function working, <span class="type">void</span> *arg)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;QueueLock);</span><br><span class="line">    taskQueue.<span class="built_in">push</span>(<span class="built_in">Task</span>&lt;T&gt;(working, arg));</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;QueueLock);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">Task&lt;T&gt; TaskQueue&lt;T&gt;::<span class="built_in">takeTask</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;QueueLock);</span><br><span class="line">    Task&lt;T&gt; t;</span><br><span class="line">    <span class="keyword">if</span>(!taskQueue.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      t = taskQueue.<span class="built_in">front</span>();<span class="comment">//å–å‡ºé˜Ÿåˆ—å¤´éƒ¨å…ƒç´ </span></span><br><span class="line">      taskQueue.<span class="built_in">pop</span>();<span class="comment">//åˆ é™¤é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;QueueLock);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> C___PRACTICE_THREADPOOL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> C___PRACTICE_THREADPOOL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TaskQueue.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;TaskQueue.cpp&quot;</span></span></span><br><span class="line"><span class="comment">/*ç‰¹æ®Š:</span></span><br><span class="line"><span class="comment"> * å½“æœ‰ç±»æ¨¡æ¿æ—¶,ç±»æ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰åˆ†å¼€å†™æ—¶ï¼Œéœ€è¦åŒ…å«å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadPool</span> &#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">    TaskQueue&lt;T&gt;* taskQueue;<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—</span></span><br><span class="line">    <span class="type">pthread_t</span> managerID;<span class="comment">//ç®¡ç†è€…çº¿ç¨‹id</span></span><br><span class="line">    <span class="type">pthread_t</span>* threadIDs;</span><br><span class="line">    <span class="type">int</span> minNum;<span class="comment">//æœ€å°çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> maxNum;<span class="comment">//æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> busyNum;<span class="comment">//å¿™çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> liveNum;<span class="comment">//æ´»ç€çš„çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">int</span> exitNum;<span class="comment">//è¦é”€æ¯çš„çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="type">pthread_mutex_t</span> threadLock;<span class="comment">//é”ä½æ•´ä¸ªçº¿ç¨‹æ± </span></span><br><span class="line">    <span class="type">pthread_mutex_t</span> busyLock;<span class="comment">//å•ç‹¬é”ä½busyNumï¼Œæé«˜æ•ˆç‡</span></span><br><span class="line">    <span class="type">pthread_cond_t</span> notEmpty;<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºæ—¶é˜»å¡ï¼Œä¸ä¸ºç©ºæ—¶å”¤é†’</span></span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> shutdown;<span class="comment">//æ˜¯å¦è¦é”€æ¯çº¿ç¨‹æ± </span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span>* <span class="title">worker</span><span class="params">(<span class="type">void</span>* arg)</span></span>;</span><br><span class="line">    <span class="comment">//å·¥ä½œçº¿ç¨‹å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span>* <span class="title">manager</span><span class="params">(<span class="type">void</span>* arg)</span></span>;</span><br><span class="line">    <span class="comment">//ç®¡ç†è€…çº¿ç¨‹å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">threadExit</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ThreadPool</span>(<span class="type">int</span> min,<span class="type">int</span> max);</span><br><span class="line">    <span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line">    ~<span class="built_in">ThreadPool</span>();</span><br><span class="line">    <span class="comment">//ææ„å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">addTask</span><span class="params">(Task&lt;T&gt; task)</span></span>;</span><br><span class="line">    <span class="comment">//æ·»åŠ ä»»åŠ¡</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getBusyNumber</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//è·å–å¿™çº¿ç¨‹æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">getAliveNumber</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//è·å–æ´»ç€çš„çº¿ç¨‹æ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//C___PRACTICE_THREADPOOL_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiu on 2023/7/18.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ThreadPool.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> std::cout;</span><br><span class="line"><span class="keyword">using</span> std::endl;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CHECK_TIME 5<span class="comment">//é»˜è®¤ç®¡ç†è€…çº¿ç¨‹æ£€æµ‹æ—¶é—´</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ADD_NUM 2<span class="comment">//ä¸€æ¬¡æ·»åŠ 3ä¸ªçº¿ç¨‹</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EXIT_NUM 2<span class="comment">//ä¸€æ¬¡é”€æ¯3ä¸ªçº¿ç¨‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">ThreadPool&lt;T&gt;::<span class="built_in">ThreadPool</span>(<span class="type">int</span> min, <span class="type">int</span> max)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        taskQueue = <span class="keyword">new</span> TaskQueue&lt;T&gt;;</span><br><span class="line">        <span class="keyword">if</span>(taskQueue == <span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;new taskQueue error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        threadIDs = <span class="keyword">new</span> <span class="type">pthread_t</span>[max];<span class="comment">//åˆ†é…åŠ¨æ€æ•°ç»„</span></span><br><span class="line">        <span class="keyword">if</span>(threadIDs == <span class="literal">nullptr</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;new threadIDs error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">memset</span>(threadIDs, <span class="number">0</span>, <span class="built_in">sizeof</span>(<span class="type">pthread_t</span>) * max);</span><br><span class="line">        minNum = min;</span><br><span class="line">        maxNum = max;</span><br><span class="line">        busyNum = <span class="number">0</span>;</span><br><span class="line">        liveNum = min;</span><br><span class="line">        exitNum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">pthread_mutex_init</span>(&amp;threadLock, <span class="literal">nullptr</span>) != <span class="number">0</span> ||</span><br><span class="line">           <span class="built_in">pthread_mutex_init</span>(&amp;busyLock, <span class="literal">nullptr</span>) != <span class="number">0</span> ||</span><br><span class="line">           <span class="built_in">pthread_cond_init</span>(&amp;notEmpty, <span class="literal">nullptr</span>) != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;init the lock or cond error&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        shutdown = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * ç±»çš„æˆå‘˜å‡½æ•°ä¼ é€’åœ°å€æ—¶å¤±è´¥æŠ¥é”™:Reference to non-static member function must be called</span></span><br><span class="line"><span class="comment">         * åŸå› :ç±»çš„æˆå‘˜å‡½æ•°ä¸æ˜¯é™æ€æ—¶ï¼Œå‡½æ•°æ²¡æœ‰åœ°å€ï¼Œåªæœ‰å®ä¾‹åŒ–ä¹‹åæ‰ä¼šæœ‰åœ°å€ï¼Œæ‰€ä»¥ä¸èƒ½ä¼ é€’åœ°å€</span></span><br><span class="line"><span class="comment">         * ä¸¤ç§è§£å†³æ–¹æ¡ˆ:</span></span><br><span class="line"><span class="comment">         * 1.å°†æˆå‘˜å‡½æ•°æ”¹ä¸ºé™æ€å‡½æ•°</span></span><br><span class="line"><span class="comment">         * 2.å°†æˆå‘˜å‡½æ•°æ”¹ä¸ºå…¨å±€å‡½æ•°ï¼Œç‹¬ç«‹äºç±»ä¹‹å¤–ï¼ˆæƒ³è¦è®¿é—®æˆå‘˜å˜é‡å°±å¿…é¡»åŠ ä¸Šå‹å…ƒå‡½æ•°ï¼‰</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">         <span class="built_in">pthread_create</span>(&amp;managerID, <span class="literal">nullptr</span>, manager, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; min; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_create</span>(&amp;threadIDs[i], <span class="literal">nullptr</span>, worker, <span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>;<span class="comment">//æ­¤å¤„ä¸è¿”å›å°†ä¼šå¯¼è‡´ä¹‹åçš„é‡Šæ”¾èµ„æº</span></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">while</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(threadIDs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span>[] threadIDs;</span><br><span class="line">        threadIDs = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;<span class="comment">//å¦‚æœthreadIDsä¸ä¸ºç©ºï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="keyword">if</span>(taskQueue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> taskQueue;</span><br><span class="line">        taskQueue = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;<span class="comment">//å¦‚æœtaskQueueä¸ä¸ºç©ºï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span>* ThreadPool&lt;T&gt;::<span class="built_in">worker</span>(<span class="type">void</span>* arg)</span><br><span class="line">&#123;</span><br><span class="line">     <span class="keyword">auto</span> pool = <span class="built_in">static_cast</span>&lt;ThreadPool*&gt;(arg);<span class="comment">//ä¼ é€’çš„æ˜¯(void*)this,æ‰€ä»¥è¦å¼ºåˆ¶ç±»å‹è½¬æ¢</span></span><br><span class="line">     <span class="comment">/*æ­¤å¤„ä¸ºC++çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¹Ÿå¯ç”¨Cä¸­çš„(ThreadPool*)</span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment">      * é™æ€å‡½æ•°ä¸èƒ½è®¿é—®æˆå‘˜å˜é‡ï¼Œæ‰€ä»¥å¿…é¡»ä¼ å…¥è¯¥ç±»çš„å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment">      * */</span></span><br><span class="line">     <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">     &#123;</span><br><span class="line"></span><br><span class="line">         <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">         <span class="keyword">while</span>(pool-&gt;taskQueue-&gt;<span class="built_in">getTaskSize</span>()==<span class="number">0</span> &amp;&amp; !pool-&gt;shutdown)</span><br><span class="line">         &#123;</span><br><span class="line">             cout&lt;&lt;<span class="string">&quot;thread &quot;</span>&lt;&lt;<span class="built_in">pthread_self</span>()&lt;&lt;<span class="string">&quot; is waiting&quot;</span>&lt;&lt;endl;</span><br><span class="line">             <span class="built_in">pthread_cond_wait</span>(&amp;pool-&gt;notEmpty, &amp;pool-&gt;threadLock);</span><br><span class="line">             <span class="comment">//å¦‚æœä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œä¸”çº¿ç¨‹æ± æ²¡æœ‰å…³é—­ï¼Œåˆ™ç­‰å¾…</span></span><br><span class="line">             <span class="comment">//ç­‰å¾…æ¡ä»¶å˜é‡ï¼Œä¼šå…ˆè§£é”ï¼Œç­‰å¾…è¢«å”¤é†’ï¼Œå†æ¬¡æ‹¿åˆ°äº†è¿™æŠŠé”</span></span><br><span class="line"></span><br><span class="line">             <span class="comment">/*ç®¡ç†è€…é”€æ¯çº¿ç¨‹é€»è¾‘</span></span><br><span class="line"><span class="comment">              *</span></span><br><span class="line"><span class="comment">              * å”¤é†’ååˆ¤æ–­æ˜¯å¦è¦é”€æ¯çº¿ç¨‹</span></span><br><span class="line"><span class="comment">              * */</span></span><br><span class="line">             <span class="keyword">if</span> (pool-&gt;exitNum &gt; <span class="number">0</span>)</span><br><span class="line">             &#123;</span><br><span class="line">                 pool-&gt;exitNum--;<span class="comment">//ä¸èƒ½æ”¾åœ¨ifé‡Œé¢ï¼Œå¦åˆ™å¯èƒ½åœ¨äº§ç”Ÿæ–°çº¿ç¨‹æ—¶ï¼ŒNum&gt;0,ç›´æ¥å°±è¢«é”€æ¯äº†ï¼Œä¸ç¬¦åˆæœŸæœ›ï¼Œæ•…ä¿è¯æ¯æ¬¡å¾ªç¯éƒ½å‡ä¸€</span></span><br><span class="line">                 <span class="comment">/*é™å®šå½“å­˜æ´»çš„çº¿ç¨‹ä¸ªæ•°å¤§äºæœ€å°ä¸ªæ•°æ—¶æ‰é”€æ¯*/</span></span><br><span class="line">                 <span class="keyword">if</span> (pool-&gt;liveNum &gt; pool-&gt;minNum) &#123;</span><br><span class="line">                     pool-&gt;liveNum--;</span><br><span class="line">                     <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);<span class="comment">//è§£é”</span></span><br><span class="line">                     pool-&gt;<span class="built_in">threadExit</span>();</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">if</span>(pool-&gt;shutdown)<span class="comment">//å¦‚æœçº¿ç¨‹æ± å…³é—­ï¼Œåˆ™çº¿ç¨‹å…¨éƒ¨é€€å‡º</span></span><br><span class="line">             &#123;</span><br><span class="line">                 <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);<span class="comment">//é¿å…æ­»é”</span></span><br><span class="line">                 pool-&gt;<span class="built_in">threadExit</span>();</span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">             <span class="comment">//å–å‡ºä»»åŠ¡å·¥ä½œ</span></span><br><span class="line">             Task task = pool-&gt;taskQueue-&gt;<span class="built_in">takeTask</span>();</span><br><span class="line"></span><br><span class="line">             <span class="comment">//æ­¤å¤„ç”Ÿäº§è€…ä¸éœ€è¦è¢«å”¤é†’äº†ï¼Œä»»åŠ¡é˜Ÿåˆ—å¯ä»¥æ— é™å¤§,å³å¯ä»¥æ— é™é‡çš„ä»»åŠ¡</span></span><br><span class="line">             <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);<span class="comment">//è§£é”</span></span><br><span class="line"></span><br><span class="line">             <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">             pool-&gt;busyNum++;</span><br><span class="line">             <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">             cout &lt;&lt; <span class="string">&quot;thread &quot;</span> &lt;&lt; <span class="built_in">pthread_self</span>() &lt;&lt; <span class="string">&quot; start working&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">             task.<span class="built_in">working</span>(task.arg);<span class="comment">//æ‰§è¡Œä»»åŠ¡</span></span><br><span class="line">             <span class="keyword">delete</span> task.arg;<span class="comment">//é‡Šæ”¾å‚æ•°èµ„æº</span></span><br><span class="line">             task.arg = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">             cout &lt;&lt; <span class="string">&quot;thread &quot;</span> &lt;&lt; <span class="built_in">pthread_self</span>() &lt;&lt; <span class="string">&quot; end working&quot;</span> &lt;&lt; endl;</span><br><span class="line">             <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">             pool-&gt;busyNum--;</span><br><span class="line">             <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;busyLock);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span>* ThreadPool&lt;T&gt;::<span class="built_in">manager</span>(<span class="type">void</span> *arg)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> pool = <span class="built_in">static_cast</span>&lt;ThreadPool*&gt;(arg);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!pool-&gt;shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sleep</span>(CHECK_TIME);<span class="comment">//æ¯éš”3ç§’æ£€æµ‹ä¸€æ¬¡</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">        <span class="type">size_t</span> queueSize = pool-&gt;taskQueue-&gt;<span class="built_in">getTaskSize</span>();<span class="comment">//å–å‡ºä»»åŠ¡ä¸ªæ•°</span></span><br><span class="line">        <span class="type">int</span> liveNum = pool-&gt;liveNum;<span class="comment">//å–å‡ºå­˜æ´»çº¿ç¨‹ä¸ªæ•°</span></span><br><span class="line">        <span class="type">int</span> busyNum = pool-&gt;busyNum;</span><br><span class="line">        <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ·»åŠ çº¿ç¨‹è§„åˆ™</span></span><br><span class="line">        <span class="comment">//1.ä»»åŠ¡ä¸ªæ•°&gt;å­˜æ´»çº¿ç¨‹ä¸ªæ•°&amp;&amp;å­˜æ´»çº¿ç¨‹ä¸ªæ•°&lt;æœ€å¤§çº¿ç¨‹ä¸ªæ•°æ—¶ï¼Œåˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">if</span>(queueSize&gt;liveNum&amp;&amp;liveNum&lt;pool-&gt;maxNum)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">/*forå¾ªç¯ä¸‰ä¸ªæ¡ä»¶</span></span><br><span class="line"><span class="comment">             * 1.éå†çº¿ç¨‹id</span></span><br><span class="line"><span class="comment">             * 2.counter&lt;ADD_NUM</span></span><br><span class="line"><span class="comment">             * 3.åœ¨å­˜æ´»çº¿ç¨‹ä¸ªæ•°å°äºæœ€å¤§çº¿ç¨‹ä¸ªæ•°æ—¶æ‰æ·»åŠ */</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pool-&gt;maxNum&amp;&amp;counter&lt;ADD_NUM&amp;&amp;pool-&gt;liveNum&lt;pool-&gt;maxNum;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//æ‰¾åˆ°ç©ºé—²çš„çº¿ç¨‹idï¼Œåˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">                <span class="keyword">if</span>(pool-&gt;threadIDs[i]==<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">pthread_create</span>(&amp;pool-&gt;threadIDs[i],<span class="literal">nullptr</span>,worker,pool);</span><br><span class="line">                    counter++;</span><br><span class="line">                    pool-&gt;liveNum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é”€æ¯çº¿ç¨‹è§„åˆ™</span></span><br><span class="line">        <span class="comment">//1.å¿™çº¿ç¨‹*2&lt;å­˜æ´»çº¿ç¨‹&amp;&amp;å­˜æ´»çº¿ç¨‹&gt;æœ€å°çº¿ç¨‹ä¸ªæ•°æ—¶ï¼Œé”€æ¯çº¿ç¨‹</span></span><br><span class="line">        <span class="keyword">if</span>(busyNum*<span class="number">2</span>&lt;liveNum&amp;&amp;liveNum&gt;pool-&gt;minNum)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">pthread_mutex_lock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">            pool-&gt;exitNum = EXIT_NUM;</span><br><span class="line">            <span class="built_in">pthread_mutex_unlock</span>(&amp;pool-&gt;threadLock);</span><br><span class="line">            <span class="comment">//å”¤é†’çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„çº¿ç¨‹ï¼Œè®©ä»–ä»¬è‡ªå·±æ‰§è¡Œï¼Œåˆ¤æ–­æ˜¯å¦é€€å‡º</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;EXIT_NUM;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">pthread_cond_signal</span>(&amp;pool-&gt;notEmpty);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> ThreadPool&lt;T&gt;::<span class="built_in">threadExit</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*ä½¿çº¿ç¨‹é€€å‡ºæ—¶çº¿ç¨‹idå½’0*/</span></span><br><span class="line">    <span class="type">pthread_t</span> tid = <span class="built_in">pthread_self</span>();<span class="comment">//è·å–å½“å‰çº¿ç¨‹çš„id</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(threadIDs[i] == tid)</span><br><span class="line">        &#123;</span><br><span class="line">            threadIDs[i] = <span class="number">0</span>;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;threadExit() called, threadID: &quot;</span> &lt;&lt; tid &lt;&lt; <span class="string">&quot; exiting...&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pthread_exit</span>(<span class="literal">NULL</span>);<span class="comment">//Cçš„å‡½æ•°ï¼Œæ­¤å¤„ä¸ç”¨nullptrï¼Œè€Œæ˜¯ç”¨NULL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">void</span> ThreadPool&lt;T&gt;::<span class="built_in">addTask</span>(Task&lt;T&gt; task)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­¤å¤„ä¸ç”¨åˆ¤æ–­ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æ»¡ï¼Œå› ä¸ºä»»åŠ¡é˜Ÿåˆ—å¯ä»¥æ— é™å¤§</span></span><br><span class="line">    <span class="keyword">if</span>(shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="comment">//å¦‚æœçº¿ç¨‹æ± å…³é—­ï¼Œåˆ™ä¸æ·»åŠ ä»»åŠ¡</span></span><br><span class="line"></span><br><span class="line">    taskQueue-&gt;<span class="built_in">addTask</span>(task);<span class="comment">//æ·»åŠ ä»»åŠ¡,æ­¤æ—¶ä¸ç”¨ä¸Šé”åŸå› ï¼Œå› ä¸ºaddTaskä¸­å·²ç»ä¸Šé”äº†</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_cond_signal</span>(&amp;notEmpty);<span class="comment">//å”¤é†’çº¿ç¨‹æ± ä¸­çš„æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">int</span> ThreadPool&lt;T&gt;::<span class="built_in">getBusyNumber</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ç”¨busyNumè‡ªå·±çš„é”ï¼Œæé«˜æ•ˆç‡</span></span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;busyLock);</span><br><span class="line">    <span class="type">int</span> busyNum = <span class="keyword">this</span>-&gt;busyNum;</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;busyLock);</span><br><span class="line">    <span class="keyword">return</span> busyNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="type">int</span> ThreadPool&lt;T&gt;::<span class="built_in">getAliveNumber</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ç”¨çº¿ç¨‹æ± çš„é”</span></span><br><span class="line">    <span class="built_in">pthread_mutex_lock</span>(&amp;threadLock);</span><br><span class="line">    <span class="type">int</span> liveNum = <span class="keyword">this</span>-&gt;liveNum;</span><br><span class="line">    <span class="built_in">pthread_mutex_unlock</span>(&amp;threadLock);</span><br><span class="line">    <span class="keyword">return</span> liveNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">ThreadPool&lt;T&gt;::~<span class="built_in">ThreadPool</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;shutdown = <span class="literal">true</span>;<span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_join</span>(<span class="keyword">this</span>-&gt;managerID, <span class="literal">nullptr</span>);<span class="comment">//ç­‰å¾…ç®¡ç†è€…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>-&gt;liveNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">pthread_cond_signal</span>(&amp;notEmpty);<span class="comment">//å”¤é†’æ‰€æœ‰çº¿ç¨‹</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">pthread_mutex_destroy</span>(&amp;threadLock);</span><br><span class="line">    <span class="built_in">pthread_mutex_destroy</span>(&amp;busyLock);</span><br><span class="line">    <span class="built_in">pthread_cond_destroy</span>(&amp;notEmpty);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(taskQueue)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> taskQueue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(threadIDs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> [] threadIDs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -5"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ThreadPool.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ThreadPool.cpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">working</span><span class="params">(<span class="type">void</span>* arg)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> num = *(<span class="type">int</span>*)arg;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;thread &quot;</span> &lt;&lt; <span class="built_in">pthread_self</span>() &lt;&lt; <span class="string">&quot; is working, number = &quot;</span> &lt;&lt; num &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">ThreadPool&lt;<span class="type">int</span>&gt; <span class="title">pool</span><span class="params">(<span class="number">3</span>, <span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>*num = <span class="keyword">new</span> <span class="type">int</span>;<span class="comment">//åˆ†é…ç©ºé—´</span></span><br><span class="line">        *num = i+<span class="number">100</span>;</span><br><span class="line">        pool.<span class="built_in">addTask</span>(<span class="built_in">Task</span>&lt;<span class="type">int</span>&gt;(working, num));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sleep</span>(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="tip warning faa-horizontal animated"><p>ç‰¹æ®Š:å½“æœ‰ç±»æ¨¡æ¿æ—¶,ç±»æ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰åˆ†å¼€å†™æ—¶ï¼Œéœ€è¦åŒ…å«å¤´æ–‡ä»¶å’Œæºæ–‡ä»¶ï¼Œå¦åˆ™ä¼šæŠ¥æ‰¾ä¸åˆ°å®šä¹‰çš„é”™è¯¯</p></div><div class="tag link"><a class="link-card" title="çº¿ç¨‹æ± C++ç‰ˆ" href="https://keqiudi.github.io/posts/de7c53fe.html"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">çº¿ç¨‹æ± C++ç‰ˆ</p><p class="url">https://keqiudi.github.io/posts/de7c53fe.html</p></div></a></div>]]></content>
    
    
    <summary type="html">çº¿ç¨‹æ± C++ç‰ˆ</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://keqiudi.github.io/posts/4a17b156.html"/>
    <id>https://keqiudi.github.io/posts/4a17b156.html</id>
    <published>2023-07-17T05:14:05.532Z</published>
    <updated>2023-07-17T11:17:07.783Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    <summary type="html">ä½ å¥½ä¸–ç•Œ</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>çº¿ç¨‹æ± Cè¯­è¨€ç‰ˆ</title>
    <link href="https://keqiudi.github.io/posts/de7c53fe.html"/>
    <id>https://keqiudi.github.io/posts/de7c53fe.html</id>
    <published>2023-07-16T11:14:40.000Z</published>
    <updated>2023-07-18T15:37:45.046Z</updated>
    
    <content type="html"><![CDATA[<h1>1.çº¿ç¨‹æ± åŸç†</h1><p>æˆ‘ä»¬ä½¿ç”¨çº¿ç¨‹çš„æ—¶å€™å°±å»åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™æ ·å®ç°èµ·æ¥éå¸¸ç®€ä¾¿ï¼Œä½†æ˜¯å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœå¹¶å‘çš„çº¿ç¨‹æ•°é‡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯æ‰§è¡Œä¸€ä¸ªæ—¶é—´å¾ˆçŸ­çš„ä»»åŠ¡å°±ç»“æŸäº†ï¼Œè¿™æ ·é¢‘ç¹åˆ›å»ºçº¿ç¨‹å°±ä¼šå¤§å¤§é™ä½ç³»ç»Ÿçš„æ•ˆç‡ï¼Œå› ä¸ºé¢‘ç¹åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹éœ€è¦æ—¶é—´ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§åŠæ³•ä½¿å¾—çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œå°±æ˜¯æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸è¢«é”€æ¯ï¼Œè€Œæ˜¯å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–çš„ä»»åŠ¡å‘¢ï¼Ÿ</p><p><strong>çº¿ç¨‹æ± </strong>æ˜¯ä¸€ç§å¤šçº¿ç¨‹å¤„ç†å½¢å¼ï¼Œå¤„ç†è¿‡ç¨‹ä¸­å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œç„¶ååœ¨åˆ›å»ºçº¿ç¨‹åè‡ªåŠ¨å¯åŠ¨è¿™äº›ä»»åŠ¡ã€‚çº¿ç¨‹æ± çº¿ç¨‹éƒ½æ˜¯åå°çº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ä½¿ç”¨é»˜è®¤çš„å †æ ˆå¤§å°ï¼Œä»¥é»˜è®¤çš„ä¼˜å…ˆçº§è¿è¡Œï¼Œå¹¶å¤„äºå¤šçº¿ç¨‹å•å…ƒä¸­ã€‚å¦‚æœæŸä¸ªçº¿ç¨‹åœ¨æ‰˜ç®¡ä»£ç ä¸­ç©ºé—²ï¼ˆå¦‚æ­£åœ¨ç­‰å¾…æŸä¸ªäº‹ä»¶ï¼‰, åˆ™çº¿ç¨‹æ± å°†æ’å…¥å¦ä¸€ä¸ªè¾…åŠ©çº¿ç¨‹æ¥ä½¿æ‰€æœ‰å¤„ç†å™¨ä¿æŒç¹å¿™ã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹æ± çº¿ç¨‹éƒ½å§‹ç»ˆä¿æŒç¹å¿™ï¼Œä½†é˜Ÿåˆ—ä¸­åŒ…å«æŒ‚èµ·çš„å·¥ä½œï¼Œåˆ™çº¿ç¨‹æ± å°†åœ¨ä¸€æ®µæ—¶é—´ååˆ›å»ºå¦ä¸€ä¸ªè¾…åŠ©çº¿ç¨‹ä½†çº¿ç¨‹çš„æ•°ç›®æ°¸è¿œä¸ä¼šè¶…è¿‡æœ€å¤§å€¼ã€‚è¶…è¿‡æœ€å¤§å€¼çš„çº¿ç¨‹å¯ä»¥æ’é˜Ÿï¼Œä½†ä»–ä»¬è¦ç­‰åˆ°å…¶ä»–çº¿ç¨‹å®Œæˆåæ‰å¯åŠ¨ã€‚</p><p>åœ¨å„ä¸ªç¼–ç¨‹è¯­è¨€çš„è¯­ç§ä¸­éƒ½æœ‰<strong>çº¿ç¨‹æ± </strong>çš„æ¦‚å¿µï¼Œå¹¶ä¸”å¾ˆå¤šè¯­è¨€ä¸­ç›´æ¥æä¾›äº†çº¿ç¨‹æ± ï¼Œä½œä¸ºç¨‹åºçŒ¿ç›´æ¥ä½¿ç”¨å°±å¯ä»¥äº†ï¼Œä¸‹é¢ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹<strong>çº¿ç¨‹æ± </strong>çš„å®ç°åŸç†ï¼š</p><p><strong>çº¿ç¨‹æ± çš„ç»„æˆä¸»è¦åˆ†ä¸º 3 ä¸ªéƒ¨åˆ†ï¼Œè¿™ä¸‰éƒ¨åˆ†é…åˆå·¥ä½œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„çº¿ç¨‹æ± ï¼š</strong></p><ol><li><p><strong>ä»»åŠ¡é˜Ÿåˆ—ï¼Œå­˜å‚¨éœ€è¦å¤„ç†çš„ä»»åŠ¡ï¼Œç”±å·¥ä½œçš„çº¿ç¨‹æ¥å¤„ç†è¿™äº›ä»»åŠ¡</strong></p><ul><li>é€šè¿‡çº¿ç¨‹æ± æä¾›çš„ API å‡½æ•°ï¼Œå°†ä¸€ä¸ªå¾…å¤„ç†çš„ä»»åŠ¡æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œæˆ–è€…ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­åˆ é™¤</li><li>å·²å¤„ç†çš„ä»»åŠ¡ä¼šè¢«ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­åˆ é™¤</li><li>çº¿ç¨‹æ± çš„ä½¿ç”¨è€…ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨çº¿ç¨‹æ± å‡½æ•°å¾€ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä»»åŠ¡çš„çº¿ç¨‹å°±æ˜¯ç”Ÿäº§è€…çº¿ç¨‹</li></ul></li><li><p><strong>å·¥ä½œçš„çº¿ç¨‹ï¼ˆä»»åŠ¡é˜Ÿåˆ—ä»»åŠ¡çš„æ¶ˆè´¹è€…ï¼‰ ï¼ŒNä¸ª</strong></p><ul><li>çº¿ç¨‹æ± ä¸­ç»´æŠ¤äº†ä¸€å®šæ•°é‡çš„å·¥ä½œçº¿ç¨‹ï¼Œä»–ä»¬çš„ä½œç”¨æ˜¯æ˜¯ä¸åœçš„è¯»ä»»åŠ¡é˜Ÿåˆ—ï¼Œä»é‡Œè¾¹å–å‡ºä»»åŠ¡å¹¶å¤„ç†</li><li>å·¥ä½œçš„çº¿ç¨‹ç›¸å½“äºæ˜¯ä»»åŠ¡é˜Ÿåˆ—çš„æ¶ˆè´¹è€…è§’è‰²ï¼Œ</li><li>å¦‚æœä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œå·¥ä½œçš„çº¿ç¨‹å°†ä¼šè¢«é˜»å¡ (ä½¿ç”¨æ¡ä»¶å˜é‡ / ä¿¡å·é‡é˜»å¡)</li><li>å¦‚æœé˜»å¡ä¹‹åæœ‰äº†æ–°çš„ä»»åŠ¡ï¼Œç”±ç”Ÿäº§è€…å°†é˜»å¡è§£é™¤ï¼Œå·¥ä½œçº¿ç¨‹å¼€å§‹å·¥ä½œ</li></ul></li><li><p><strong>ç®¡ç†è€…çº¿ç¨‹ï¼ˆä¸å¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼‰ï¼Œ1ä¸ª</strong></p></li></ol><ul><li><ul><li>å®ƒçš„ä»»åŠ¡æ˜¯å‘¨æœŸæ€§çš„å¯¹ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ•°é‡ä»¥åŠå¤„äºå¿™çŠ¶æ€çš„å·¥ä½œçº¿ç¨‹ä¸ªæ•°è¿›è¡Œæ£€æµ‹</li><li>å½“ä»»åŠ¡è¿‡å¤šçš„æ—¶å€™ï¼Œå¯ä»¥é€‚å½“çš„åˆ›å»ºä¸€äº›æ–°çš„å·¥ä½œçº¿ç¨‹</li><li>å½“ä»»åŠ¡è¿‡å°‘çš„æ—¶å€™ï¼Œå¯ä»¥é€‚å½“çš„é”€æ¯ä¸€äº›å·¥ä½œçš„çº¿ç¨‹</li></ul></li></ul><h1>2.ä»»åŠ¡é˜Ÿåˆ—(Task)</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»»åŠ¡ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Task</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">void</span> (*function)(<span class="type">void</span>* arg);</span><br><span class="line">    <span class="type">void</span>* arg;</span><br><span class="line">&#125;Task;</span><br></pre></td></tr></table></figure><h1>3.çº¿ç¨‹æ± å®šä¹‰(ThreadPool)</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çº¿ç¨‹æ± ç»“æ„ä½“</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ThreadPool</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—</span></span><br><span class="line">    Task* taskQ;</span><br><span class="line">    <span class="type">int</span> queueCapacity;  <span class="comment">// å®¹é‡</span></span><br><span class="line">    <span class="type">int</span> queueSize;      <span class="comment">// å½“å‰ä»»åŠ¡ä¸ªæ•°</span></span><br><span class="line">    <span class="type">int</span> queueFront;     <span class="comment">// é˜Ÿå¤´ -&gt; å–æ•°æ®</span></span><br><span class="line">    <span class="type">int</span> queueRear;      <span class="comment">// é˜Ÿå°¾ -&gt; æ”¾æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="type">pthread_t</span> managerID;    <span class="comment">// ç®¡ç†è€…çº¿ç¨‹ID</span></span><br><span class="line">    <span class="type">pthread_t</span> *threadIDs;   <span class="comment">// å·¥ä½œçš„çº¿ç¨‹ID</span></span><br><span class="line">    <span class="type">int</span> minNum;             <span class="comment">// æœ€å°çº¿ç¨‹æ•°é‡</span></span><br><span class="line">    <span class="type">int</span> maxNum;             <span class="comment">// æœ€å¤§çº¿ç¨‹æ•°é‡</span></span><br><span class="line">    <span class="type">int</span> busyNum;            <span class="comment">// å¿™çš„çº¿ç¨‹çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="type">int</span> liveNum;            <span class="comment">// å­˜æ´»çš„çº¿ç¨‹çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="type">int</span> exitNum;            <span class="comment">// è¦é”€æ¯çš„çº¿ç¨‹ä¸ªæ•°</span></span><br><span class="line">    <span class="type">pthread_mutex_t</span> mutexPool;  <span class="comment">// é”æ•´ä¸ªçš„çº¿ç¨‹æ± </span></span><br><span class="line">    <span class="type">pthread_mutex_t</span> mutexBusy;  <span class="comment">// é”busyNumå˜é‡</span></span><br><span class="line">    <span class="type">pthread_cond_t</span> notFull;     <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—æ˜¯ä¸æ˜¯æ»¡äº†</span></span><br><span class="line">    <span class="type">pthread_cond_t</span> notEmpty;    <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—æ˜¯ä¸æ˜¯ç©ºäº†</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> shutdown;           <span class="comment">// æ˜¯ä¸æ˜¯è¦é”€æ¯çº¿ç¨‹æ± , é”€æ¯ä¸º1, ä¸é”€æ¯ä¸º0</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1>4.å¤´æ–‡ä»¶å£°æ˜(ThreadPool.h)</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _THREADPOOL_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _THREADPOOL_H</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ThreadPool</span> <span class="title">ThreadPool</span>;</span></span><br><span class="line"><span class="comment">// åˆ›å»ºçº¿ç¨‹æ± å¹¶åˆå§‹åŒ–</span></span><br><span class="line">ThreadPool *<span class="title function_">threadPoolCreate</span><span class="params">(<span class="type">int</span> min, <span class="type">int</span> max, <span class="type">int</span> queueSize)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”€æ¯çº¿ç¨‹æ± </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">threadPoolDestroy</span><span class="params">(ThreadPool* pool)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™çº¿ç¨‹æ± æ·»åŠ ä»»åŠ¡</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">threadPoolAdd</span><span class="params">(ThreadPool* pool, <span class="type">void</span>(*func)(<span class="type">void</span>*), <span class="type">void</span>* arg)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–çº¿ç¨‹æ± ä¸­å·¥ä½œçš„çº¿ç¨‹çš„ä¸ªæ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">threadPoolBusyNum</span><span class="params">(ThreadPool* pool)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–çº¿ç¨‹æ± ä¸­æ´»ç€çš„çº¿ç¨‹çš„ä¸ªæ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">threadPoolAliveNum</span><span class="params">(ThreadPool* pool)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//////////////////////</span></span><br><span class="line"><span class="comment">// å·¥ä½œçš„çº¿ç¨‹(æ¶ˆè´¹è€…çº¿ç¨‹)ä»»åŠ¡å‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">worker</span><span class="params">(<span class="type">void</span>* arg)</span>;</span><br><span class="line"><span class="comment">// ç®¡ç†è€…çº¿ç¨‹ä»»åŠ¡å‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">manager</span><span class="params">(<span class="type">void</span>* arg)</span>;</span><br><span class="line"><span class="comment">// å•ä¸ªçº¿ç¨‹é€€å‡º</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">threadExit</span><span class="params">(ThreadPool* pool)</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span>  <span class="comment">// _THREADPOOL_H</span></span></span><br></pre></td></tr></table></figure><h1>5.æºæ–‡ä»¶å®šä¹‰(ThreadPool.c)</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">ThreadPool* <span class="title function_">threadPoolCreate</span><span class="params">(<span class="type">int</span> min, <span class="type">int</span> max, <span class="type">int</span> queueSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    ThreadPool* pool = (ThreadPool*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(ThreadPool));</span><br><span class="line">    <span class="keyword">do</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (pool == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;malloc threadpool fail...\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        pool-&gt;threadIDs = (<span class="type">pthread_t</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">pthread_t</span>) * max);</span><br><span class="line">        <span class="keyword">if</span> (pool-&gt;threadIDs == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;malloc threadIDs fail...\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(pool-&gt;threadIDs, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="type">pthread_t</span>) * max);</span><br><span class="line">        pool-&gt;minNum = min;</span><br><span class="line">        pool-&gt;maxNum = max;</span><br><span class="line">        pool-&gt;busyNum = <span class="number">0</span>;</span><br><span class="line">        pool-&gt;liveNum = min;    <span class="comment">// å’Œæœ€å°ä¸ªæ•°ç›¸ç­‰</span></span><br><span class="line">        pool-&gt;exitNum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pthread_mutex_init(&amp;pool-&gt;mutexPool, <span class="literal">NULL</span>) != <span class="number">0</span> ||</span><br><span class="line">            pthread_mutex_init(&amp;pool-&gt;mutexBusy, <span class="literal">NULL</span>) != <span class="number">0</span> ||</span><br><span class="line">            pthread_cond_init(&amp;pool-&gt;notEmpty, <span class="literal">NULL</span>) != <span class="number">0</span> ||</span><br><span class="line">            pthread_cond_init(&amp;pool-&gt;notFull, <span class="literal">NULL</span>) != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;mutex or condition init fail...\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—</span></span><br><span class="line">        pool-&gt;taskQ = (Task*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Task) * queueSize);</span><br><span class="line">        pool-&gt;queueCapacity = queueSize;</span><br><span class="line">        pool-&gt;queueSize = <span class="number">0</span>;</span><br><span class="line">        pool-&gt;queueFront = <span class="number">0</span>;</span><br><span class="line">        pool-&gt;queueRear = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        pool-&gt;shutdown = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºçº¿ç¨‹</span></span><br><span class="line">        pthread_create(&amp;pool-&gt;managerID, <span class="literal">NULL</span>, manager, pool);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; min; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            pthread_create(&amp;pool-&gt;threadIDs[i], <span class="literal">NULL</span>, worker, pool);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pool;</span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">if</span> (pool &amp;&amp; pool-&gt;threadIDs) <span class="built_in">free</span>(pool-&gt;threadIDs);</span><br><span class="line">    <span class="keyword">if</span> (pool &amp;&amp; pool-&gt;taskQ) <span class="built_in">free</span>(pool-&gt;taskQ);</span><br><span class="line">    <span class="keyword">if</span> (pool) <span class="built_in">free</span>(pool);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">threadPoolDestroy</span><span class="params">(ThreadPool* pool)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (pool == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…³é—­çº¿ç¨‹æ± </span></span><br><span class="line">    pool-&gt;shutdown = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// é˜»å¡å›æ”¶ç®¡ç†è€…çº¿ç¨‹</span></span><br><span class="line">    pthread_join(pool-&gt;managerID, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">// å”¤é†’é˜»å¡çš„æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; pool-&gt;liveNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_cond_signal(&amp;pool-&gt;notEmpty);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é‡Šæ”¾å †å†…å­˜</span></span><br><span class="line">    <span class="keyword">if</span> (pool-&gt;taskQ)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(pool-&gt;taskQ);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pool-&gt;threadIDs)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">free</span>(pool-&gt;threadIDs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pthread_mutex_destroy(&amp;pool-&gt;mutexPool);</span><br><span class="line">    pthread_mutex_destroy(&amp;pool-&gt;mutexBusy);</span><br><span class="line">    pthread_cond_destroy(&amp;pool-&gt;notEmpty);</span><br><span class="line">    pthread_cond_destroy(&amp;pool-&gt;notFull);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(pool);</span><br><span class="line">    pool = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">threadPoolAdd</span><span class="params">(ThreadPool* pool, <span class="type">void</span>(*func)(<span class="type">void</span>*), <span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;pool-&gt;mutexPool);</span><br><span class="line">    <span class="keyword">while</span> (pool-&gt;queueSize == pool-&gt;queueCapacity &amp;&amp; !pool-&gt;shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é˜»å¡ç”Ÿäº§è€…çº¿ç¨‹</span></span><br><span class="line">        pthread_cond_wait(&amp;pool-&gt;notFull, &amp;pool-&gt;mutexPool);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pool-&gt;shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ·»åŠ ä»»åŠ¡</span></span><br><span class="line">    pool-&gt;taskQ[pool-&gt;queueRear].function = func;</span><br><span class="line">    pool-&gt;taskQ[pool-&gt;queueRear].arg = arg;</span><br><span class="line">    pool-&gt;queueRear = (pool-&gt;queueRear + <span class="number">1</span>) % pool-&gt;queueCapacity;</span><br><span class="line">    pool-&gt;queueSize++;</span><br><span class="line"></span><br><span class="line">    pthread_cond_signal(&amp;pool-&gt;notEmpty);</span><br><span class="line">    pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">threadPoolBusyNum</span><span class="params">(ThreadPool* pool)</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">    <span class="type">int</span> busyNum = pool-&gt;busyNum;</span><br><span class="line">    pthread_mutex_unlock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">    <span class="keyword">return</span> busyNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">threadPoolAliveNum</span><span class="params">(ThreadPool* pool)</span></span><br><span class="line">&#123;</span><br><span class="line">    pthread_mutex_lock(&amp;pool-&gt;mutexPool);</span><br><span class="line">    <span class="type">int</span> aliveNum = pool-&gt;liveNum;</span><br><span class="line">    pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">    <span class="keyword">return</span> aliveNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>* <span class="title function_">worker</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    ThreadPool* pool = (ThreadPool*)arg;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;pool-&gt;mutexPool);</span><br><span class="line">        <span class="comment">// å½“å‰ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">while</span> (pool-&gt;queueSize == <span class="number">0</span> &amp;&amp; !pool-&gt;shutdown)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// é˜»å¡å·¥ä½œçº¿ç¨‹</span></span><br><span class="line">            pthread_cond_wait(&amp;pool-&gt;notEmpty, &amp;pool-&gt;mutexPool);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯ä¸æ˜¯è¦é”€æ¯çº¿ç¨‹</span></span><br><span class="line">            <span class="keyword">if</span> (pool-&gt;exitNum &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                pool-&gt;exitNum--;</span><br><span class="line">                <span class="keyword">if</span> (pool-&gt;liveNum &gt; pool-&gt;minNum)</span><br><span class="line">                &#123;</span><br><span class="line">                    pool-&gt;liveNum--;</span><br><span class="line">                    pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">                    threadExit(pool);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦è¢«å…³é—­äº†</span></span><br><span class="line">        <span class="keyword">if</span> (pool-&gt;shutdown)</span><br><span class="line">        &#123;</span><br><span class="line">            pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">            threadExit(pool);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªä»»åŠ¡</span></span><br><span class="line">        Task task;</span><br><span class="line">        task.function = pool-&gt;taskQ[pool-&gt;queueFront].function;</span><br><span class="line">        task.arg = pool-&gt;taskQ[pool-&gt;queueFront].arg;</span><br><span class="line">        <span class="comment">// ç§»åŠ¨å¤´ç»“ç‚¹</span></span><br><span class="line">        pool-&gt;queueFront = (pool-&gt;queueFront + <span class="number">1</span>) % pool-&gt;queueCapacity;</span><br><span class="line">        pool-&gt;queueSize--;</span><br><span class="line">        <span class="comment">// è§£é”</span></span><br><span class="line">        pthread_cond_signal(&amp;pool-&gt;notFull);</span><br><span class="line">        pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;thread %ld start working...\n&quot;</span>, pthread_self());</span><br><span class="line">        pthread_mutex_lock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">        pool-&gt;busyNum++;</span><br><span class="line">        pthread_mutex_unlock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">        task.function(task.arg);</span><br><span class="line">        <span class="built_in">free</span>(task.arg);</span><br><span class="line">        task.arg = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;thread %ld end working...\n&quot;</span>, pthread_self());</span><br><span class="line">        pthread_mutex_lock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">        pool-&gt;busyNum--;</span><br><span class="line">        pthread_mutex_unlock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>* <span class="title function_">manager</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    ThreadPool* pool = (ThreadPool*)arg;</span><br><span class="line">    <span class="keyword">while</span> (!pool-&gt;shutdown)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ¯éš”3sæ£€æµ‹ä¸€æ¬¡</span></span><br><span class="line">        sleep(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å–å‡ºçº¿ç¨‹æ± ä¸­ä»»åŠ¡çš„æ•°é‡å’Œå½“å‰çº¿ç¨‹çš„æ•°é‡</span></span><br><span class="line">        pthread_mutex_lock(&amp;pool-&gt;mutexPool);</span><br><span class="line">        <span class="type">int</span> queueSize = pool-&gt;queueSize;</span><br><span class="line">        <span class="type">int</span> liveNum = pool-&gt;liveNum;</span><br><span class="line">        pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å–å‡ºå¿™çš„çº¿ç¨‹çš„æ•°é‡</span></span><br><span class="line">        pthread_mutex_lock(&amp;pool-&gt;mutexBusy);</span><br><span class="line">        <span class="type">int</span> busyNum = pool-&gt;busyNum;</span><br><span class="line">        pthread_mutex_unlock(&amp;pool-&gt;mutexBusy);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ·»åŠ çº¿ç¨‹</span></span><br><span class="line">        <span class="comment">// ä»»åŠ¡çš„ä¸ªæ•°&gt;å­˜æ´»çš„çº¿ç¨‹ä¸ªæ•° &amp;&amp; å­˜æ´»çš„çº¿ç¨‹æ•°&lt;æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (queueSize &gt; liveNum &amp;&amp; liveNum &lt; pool-&gt;maxNum)</span><br><span class="line">        &#123;</span><br><span class="line">            pthread_mutex_lock(&amp;pool-&gt;mutexPool);</span><br><span class="line">            <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; pool-&gt;maxNum &amp;&amp; counter &lt; NUMBER</span><br><span class="line">                &amp;&amp; pool-&gt;liveNum &lt; pool-&gt;maxNum; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (pool-&gt;threadIDs[i] == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    pthread_create(&amp;pool-&gt;threadIDs[i], <span class="literal">NULL</span>, worker, pool);</span><br><span class="line">                    counter++;</span><br><span class="line">                    pool-&gt;liveNum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é”€æ¯çº¿ç¨‹</span></span><br><span class="line">        <span class="comment">// å¿™çš„çº¿ç¨‹*2 &lt; å­˜æ´»çš„çº¿ç¨‹æ•° &amp;&amp; å­˜æ´»çš„çº¿ç¨‹&gt;æœ€å°çº¿ç¨‹æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (busyNum * <span class="number">2</span> &lt; liveNum &amp;&amp; liveNum &gt; pool-&gt;minNum)</span><br><span class="line">        &#123;</span><br><span class="line">            pthread_mutex_lock(&amp;pool-&gt;mutexPool);</span><br><span class="line">            pool-&gt;exitNum = NUMBER;</span><br><span class="line">            pthread_mutex_unlock(&amp;pool-&gt;mutexPool);</span><br><span class="line">            <span class="comment">// è®©å·¥ä½œçš„çº¿ç¨‹è‡ªæ€</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; NUMBER; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                pthread_cond_signal(&amp;pool-&gt;notEmpty);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">threadExit</span><span class="params">(ThreadPool* pool)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">pthread_t</span> tid = pthread_self();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; pool-&gt;maxNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (pool-&gt;threadIDs[i] == tid)</span><br><span class="line">        &#123;</span><br><span class="line">            pool-&gt;threadIDs[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;threadExit() called, %ld exiting...\n&quot;</span>, tid);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>6.æµ‹è¯•ä»£ç </h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">taskFunc</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> num = *(<span class="type">int</span>*)arg;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;thread %ld is working, number = %d\n&quot;</span>,</span><br><span class="line">        pthread_self(), num);</span><br><span class="line">    sleep(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºçº¿ç¨‹æ± </span></span><br><span class="line">    ThreadPool* pool = threadPoolCreate(<span class="number">3</span>, <span class="number">10</span>, <span class="number">100</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>* num = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">        *num = i + <span class="number">100</span>;</span><br><span class="line">        threadPoolAdd(pool, taskFunc, num);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">    threadPoolDestroy(pool);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tag link"><a class="link-card" title="çº¿ç¨‹æ± C++ç‰ˆ" href="https://keqiudi.github.io/posts/aa76cb12.html"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">çº¿ç¨‹æ± C++ç‰ˆ</p><p class="url">https://keqiudi.github.io/posts/aa76cb12.html</p></div></a></div>]]></content>
    
    
    <summary type="html">çº¿ç¨‹æ± Cè¯­è¨€ç‰ˆ</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>çº¿ç¨‹åŒæ­¥</title>
    <link href="https://keqiudi.github.io/posts/895e9db.html"/>
    <id>https://keqiudi.github.io/posts/895e9db.html</id>
    <published>2023-07-15T09:04:29.000Z</published>
    <updated>2023-07-18T15:19:38.935Z</updated>
    
    <content type="html"><![CDATA[<h1>1.çº¿ç¨‹åŒæ­¥æ¦‚å¿µ</h1><p>çº¿ç¨‹åŒæ­¥çš„çœŸå®æ„æ€ï¼Œå…¶å®æ˜¯â€œ<strong>æ’é˜Ÿ</strong>â€ï¼šå‡ ä¸ªçº¿ç¨‹ä¹‹é—´è¦æ’é˜Ÿï¼Œä¸€ä¸ªä¸€ä¸ªå¯¹å…±äº«èµ„æºè¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯åŒæ—¶è¿›è¡Œæ“ä½œã€‚ è€Œæœ€è®©äººæ— è¯­çš„æ˜¯ï¼Œçº¿ç¨‹åŒæ­¥çš„ç›®çš„å°±æ˜¯è®©å„ä¸ªçº¿ç¨‹å»æ’é˜Ÿä½¿ç”¨èµ„æºï¼Œè€Œä¸æ˜¯è®©çº¿ç¨‹åŒæ—¶å»ä½¿ç”¨èµ„æºã€‚</p><p>å‡è®¾æœ‰ 4 ä¸ªçº¿ç¨‹ Aã€Bã€Cã€Dï¼Œå½“å‰ä¸€ä¸ªçº¿ç¨‹ A å¯¹å†…å­˜ä¸­çš„å…±äº«èµ„æºè¿›è¡Œè®¿é—®çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹ B, C, D éƒ½ä¸å¯ä»¥å¯¹è¿™å—å†…å­˜è¿›è¡Œæ“ä½œï¼Œç›´åˆ°çº¿ç¨‹ A å¯¹è¿™å—å†…å­˜è®¿é—®å®Œæ¯•ä¸ºæ­¢ï¼ŒBï¼ŒCï¼ŒD ä¸­çš„ä¸€ä¸ªæ‰èƒ½è®¿é—®è¿™å—å†…å­˜ï¼Œå‰©ä½™çš„ä¸¤ä¸ªéœ€è¦ç»§ç»­é˜»å¡ç­‰å¾…ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯¹è¿™å—å†…å­˜æ“ä½œå®Œæ¯•ã€‚ çº¿ç¨‹å¯¹å†…å­˜çš„è¿™ç§è®¿é—®æ–¹å¼å°±ç§°ä¹‹ä¸ºçº¿ç¨‹åŒæ­¥ï¼Œé€šè¿‡å¯¹æ¦‚å¿µçš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°æ‰€è°“çš„åŒæ­¥å¹¶ä¸æ˜¯å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹å†…å­˜è¿›è¡Œè®¿é—®ï¼Œè€Œæ˜¯æŒ‰ç…§å…ˆåé¡ºåºä¾æ¬¡è¿›è¡Œçš„ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè¦çº¿ç¨‹åŒæ­¥">ä¸ºä»€ä¹ˆè¦çº¿ç¨‹åŒæ­¥</h2><p><strong>åœ¨ç ”ç©¶çº¿ç¨‹åŒæ­¥ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªä¸¤ä¸ªçº¿ç¨‹äº¤æ›¿è®¡æ•°ï¼ˆæ¯ä¸ªçº¿ç¨‹æ•° 50 ä¸ªæ•°ï¼Œäº¤æ›¿æ•°åˆ° 100ï¼‰çš„ä¾‹å­ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX 50</span></span><br><span class="line"><span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"><span class="type">int</span> number;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">funcA_num</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;MAX; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = number;</span><br><span class="line">        cur++;</span><br><span class="line">        usleep(<span class="number">10</span>);</span><br><span class="line">        number = cur;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Thread A, id = %lu, number = %d\n&quot;</span>, pthread_self(), number);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>* <span class="title function_">funcB_num</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;MAX; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cur = number;</span><br><span class="line">        cur++;</span><br><span class="line">        number = cur;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Thread B, id = %lu, number = %d\n&quot;</span>, pthread_self(), number);</span><br><span class="line">        usleep(<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">pthread_t</span> p1, p2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸¤ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    pthread_create(&amp;p1, <span class="literal">NULL</span>, funcA_num, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_create(&amp;p2, <span class="literal">NULL</span>, funcB_num, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜»å¡ï¼Œèµ„æºå›æ”¶</span></span><br><span class="line">    pthread_join(p1, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(p2, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å¹¶æ‰§è¡Œä¸Šé¢çš„æµ‹è¯•ç¨‹åºï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">$ ./a.out </span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">1</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">2</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">2</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">3</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">4</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">5</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">6</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">7</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">8</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">7</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">8</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">9</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">8</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">9</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">9</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">10</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">11</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">10</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">11</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">11</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">12</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">13</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">14</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">15</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">16</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">17</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">18</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">19</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">17</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">18</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">19</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">19</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">20</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">20</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">21</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">21</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">22</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">22</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">23</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">23</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">24</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">24</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">25</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">25</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">26</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">26</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">27</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">27</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">28</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">28</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">29</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">29</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">30</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">30</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">31</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">31</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">32</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">32</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">33</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">33</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">34</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">34</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">35</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">35</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">36</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">36</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">37</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">37</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">38</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">38</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">39</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">39</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">40</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">41</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">42</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">42</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">43</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">44</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">45</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">45</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">46</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">46</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">47</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">47</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">48</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">48</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">49</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">50</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">51</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">51</span></span><br><span class="line">Thread B, id = <span class="number">140504473724672</span>, number = <span class="number">52</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">53</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">54</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">55</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">56</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">57</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">58</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">59</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">60</span></span><br><span class="line">Thread A, id = <span class="number">140504482117376</span>, number = <span class="number">61</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡å¯¹ä¸Šé¢ä¾‹å­çš„æµ‹è¯•ï¼Œå¯ä»¥çœ‹å‡ºè™½ç„¶æ¯ä¸ªçº¿ç¨‹å†…éƒ¨å¾ªç¯äº† 50 æ¬¡æ¯æ¬¡æ•°ä¸€ä¸ªæ•°ï¼Œä½†æ˜¯æœ€ç»ˆæ²¡æœ‰æ•°åˆ° 100ï¼Œé€šè¿‡è¾“å‡ºçš„ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œæœ‰äº›æ•°å­—è¢«é‡å¤æ•°äº†å¤šæ¬¡ï¼Œå…¶åŸå› å°±æ˜¯æ²¡æœ‰å¯¹çº¿ç¨‹è¿›è¡ŒåŒæ­¥å¤„ç†ï¼Œé€ æˆäº†<strong>æ•°æ®çš„æ··ä¹±ã€‚</strong></p><p>ä¸¤ä¸ªçº¿ç¨‹åœ¨æ•°æ•°çš„æ—¶å€™éœ€è¦åˆ†æ—¶å¤ç”¨ CPU æ—¶é—´ç‰‡ï¼Œå¹¶ä¸”æµ‹è¯•ç¨‹åºä¸­è°ƒç”¨äº† sleep() å¯¼è‡´çº¿ç¨‹çš„ CPU æ—¶é—´ç‰‡æ²¡ç”¨å®Œå°±è¢«è¿«æŒ‚èµ·äº†ï¼Œè¿™æ ·å°±èƒ½è®© CPU çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆä¿å­˜å½“å‰çŠ¶æ€ï¼Œä¸‹ä¸€æ¬¡ç»§ç»­è¿è¡Œçš„æ—¶å€™éœ€è¦åŠ è½½ä¿å­˜çš„çŠ¶æ€ï¼‰æ›´åŠ é¢‘ç¹ï¼Œæ›´å®¹æ˜“å†ç°æ•°æ®æ··ä¹±çš„è¿™ä¸ªç°è±¡ã€‚</p><p>åœ¨æµ‹è¯•ç¨‹åºä¸­ä¸¤ä¸ªçº¿ç¨‹å…±ç”¨å…¨å±€å˜é‡ <strong>number</strong> å½“çº¿ç¨‹å˜æˆè¿è¡Œæ€ä¹‹åå¼€å§‹æ•°æ•°ï¼Œä»ç‰©ç†å†…å­˜åŠ è½½æ•°æ®ï¼Œè®©åå°†æ•°æ®æ”¾åˆ° CPU è¿›è¡Œè¿ç®—ï¼Œæœ€åå°†ç»“æœæ›´æ–°åˆ°ç‰©ç†å†…å­˜ä¸­ã€‚å¦‚æœæ•°æ•°çš„ä¸¤ä¸ªçº¿ç¨‹éƒ½å¯ä»¥é¡ºåˆ©å®Œæˆè¿™ä¸ªæµç¨‹ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœè‚¯å®šæ˜¯æ­£ç¡®çš„ã€‚</p><p>å¦‚æœçº¿ç¨‹ A æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹æœŸé—´å°±å¤±å»äº† CPU æ—¶é—´ç‰‡ï¼Œçº¿ç¨‹ A è¢«æŒ‚èµ·äº†æœ€æ–°çš„æ•°æ®æ²¡èƒ½æ›´æ–°åˆ°ç‰©ç†å†…å­˜ã€‚çº¿ç¨‹ B å˜æˆè¿è¡Œæ€ä¹‹åä»ç‰©ç†å†…å­˜è¯»æ•°æ®ï¼Œå¾ˆæ˜¾ç„¶å®ƒæ²¡æœ‰æ‹¿åˆ°æœ€æ–°æ•°æ®ï¼Œåªèƒ½åŸºäºæ—§çš„æ•°æ®å¾€åæ•°ï¼Œç„¶åå¤±å» CPU æ—¶é—´ç‰‡æŒ‚èµ·ã€‚çº¿ç¨‹ A å¾—åˆ° CPU æ—¶é—´ç‰‡å˜æˆè¿è¡Œæ€ï¼Œç¬¬ä¸€ä»¶äº‹å„¿å°±æ˜¯å°†ä¸Šæ¬¡æ²¡æ›´æ–°åˆ°å†…å­˜çš„æ•°æ®æ›´æ–°åˆ°å†…å­˜ï¼Œä½†æ˜¯è¿™æ ·ä¼šå¯¼è‡´çº¿ç¨‹ B å·²ç»æ›´æ–°åˆ°å†…å­˜çš„æ•°æ®è¢«è¦†ç›–ï¼Œæ´»å„¿ç™½å¹²äº†ï¼Œæœ€ç»ˆå¯¼è‡´æœ‰äº›æ•°æ®ä¼šè¢«é‡å¤æ•°å¾ˆå¤šæ¬¡ã€‚</p><h2 id="åŒæ­¥æ–¹å¼">åŒæ­¥æ–¹å¼</h2><p>å¯¹äºå¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºå‡ºç°æ•°æ®æ··ä¹±çš„é—®é¢˜ï¼Œéœ€è¦è¿›è¡Œçº¿ç¨‹åŒæ­¥ã€‚å¸¸ç”¨çš„çº¿ç¨‹åŒæ­¥æ–¹å¼æœ‰å››ç§ï¼š<strong>äº’æ–¥é”ã€è¯»å†™é”ã€æ¡ä»¶å˜é‡ã€ä¿¡å·é‡</strong>ã€‚æ‰€è°“çš„å…±äº«èµ„æºå°±æ˜¯å¤šä¸ªçº¿ç¨‹å…±åŒè®¿é—®çš„å˜é‡ï¼Œè¿™äº›å˜é‡é€šå¸¸ä¸ºå…¨å±€æ•°æ®åŒºå˜é‡æˆ–è€…å †åŒºå˜é‡ï¼Œè¿™äº›å˜é‡å¯¹åº”çš„å…±äº«èµ„æºä¹Ÿè¢«ç§°ä¹‹ä¸º<strong>ä¸´ç•Œèµ„æº</strong>ã€‚</p><p><img src="https://subingwen.cn/linux/thread-sync/image-20200106092600543.png" alt="image-20200106092600543"></p><p>æ‰¾åˆ°ä¸´ç•Œèµ„æºä¹‹åï¼Œå†æ‰¾å’Œä¸´ç•Œèµ„æºç›¸å…³çš„ä¸Šä¸‹æ–‡ä»£ç ï¼Œè¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªä»£ç å—ï¼Œè¿™ä¸ªä»£ç å—å¯ä»¥ç§°ä¹‹ä¸ºä¸´ç•ŒåŒºã€‚ç¡®å®šå¥½ä¸´ç•ŒåŒºï¼ˆä¸´ç•ŒåŒºè¶Šå°è¶Šå¥½ï¼‰ä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œçº¿ç¨‹åŒæ­¥äº†ï¼Œçº¿ç¨‹åŒæ­¥çš„å¤§è‡´å¤„ç†æ€è·¯æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>åœ¨ä¸´ç•ŒåŒºä»£ç çš„ä¸Šè¾¹ï¼Œæ·»åŠ åŠ é”å‡½æ•°ï¼Œå¯¹ä¸´ç•ŒåŒºåŠ é”ã€‚<ul><li>å“ªä¸ªçº¿ç¨‹è°ƒç”¨è¿™å¥ä»£ç ï¼Œå°±ä¼šæŠŠè¿™æŠŠé”é”ä¸Šï¼Œå…¶ä»–çº¿ç¨‹å°±åªèƒ½é˜»å¡åœ¨é”ä¸Šäº†ã€‚</li></ul></li><li>åœ¨ä¸´ç•ŒåŒºä»£ç çš„ä¸‹è¾¹ï¼Œæ·»åŠ è§£é”å‡½æ•°ï¼Œå¯¹ä¸´ç•ŒåŒºè§£é”ã€‚<ul><li>å‡ºä¸´ç•ŒåŒºçš„çº¿ç¨‹ä¼šå°†é”å®šçš„é‚£æŠŠé”æ‰“å¼€ï¼Œå…¶ä»–æŠ¢åˆ°é”çš„çº¿ç¨‹å°±å¯ä»¥è¿›å…¥åˆ°ä¸´ç•ŒåŒºäº†ã€‚</li></ul></li><li>é€šè¿‡é”æœºåˆ¶èƒ½ä¿è¯ä¸´ç•ŒåŒºä»£ç æœ€å¤šåªèƒ½åŒæ—¶æœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œè¿™æ ·å¹¶è¡Œè®¿é—®å°±å˜ä¸ºä¸²è¡Œè®¿é—®äº†ã€‚</li></ul><h1>2.äº’æ–¥é”</h1><h2 id="äº’æ–¥é”å‡½æ•°">äº’æ–¥é”å‡½æ•°</h2><p>äº’æ–¥é”æ˜¯çº¿ç¨‹åŒæ­¥æœ€å¸¸ç”¨çš„ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡äº’æ–¥é”å¯ä»¥é”å®šä¸€ä¸ªä»£ç å—ï¼Œè¢«é”å®šçš„è¿™ä¸ªä»£ç å—ï¼Œæ‰€æœ‰çš„çº¿ç¨‹åªèƒ½é¡ºåºæ‰§è¡Œ (ä¸èƒ½å¹¶è¡Œå¤„ç†)ï¼Œè¿™æ ·å¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ•°æ®æ··ä¹±çš„é—®é¢˜å°±å¯ä»¥è¢«è§£å†³äº†ï¼Œéœ€è¦ä»˜å‡ºçš„ä»£ä»·å°±æ˜¯æ‰§è¡Œæ•ˆç‡çš„é™ä½ï¼Œå› ä¸ºé»˜è®¤ä¸´ç•ŒåŒºå¤šä¸ªçº¿ç¨‹æ˜¯å¯ä»¥å¹¶è¡Œå¤„ç†çš„ï¼Œç°åœ¨åªèƒ½ä¸²è¡Œå¤„ç†ã€‚</p><p>åœ¨ Linux ä¸­äº’æ–¥é”çš„ç±»å‹ä¸º <strong>pthread_mutex_t</strong>ï¼Œåˆ›å»ºä¸€ä¸ªè¿™ç§ç±»å‹çš„å˜é‡å°±å¾—åˆ°äº†ä¸€æŠŠäº’æ–¥é”ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">pthread_mutex_t</span>  mutex;</span><br></pre></td></tr></table></figure><p>åœ¨åˆ›å»ºçš„é”å¯¹è±¡ä¸­ä¿å­˜äº†å½“å‰è¿™æŠŠé”çš„çŠ¶æ€ä¿¡æ¯ï¼šé”å®šè¿˜æ˜¯æ‰“å¼€ï¼Œå¦‚æœæ˜¯é”å®šçŠ¶æ€è¿˜è®°å½•äº†ç»™è¿™æŠŠé”åŠ é”çš„çº¿ç¨‹ä¿¡æ¯ï¼ˆçº¿ç¨‹ IDï¼‰ã€‚ä¸€ä¸ªäº’æ–¥é”å˜é‡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”å®šï¼Œè¢«é”å®šä¹‹åå…¶ä»–çº¿ç¨‹å†å¯¹äº’æ–¥é”å˜é‡åŠ é”å°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°è¿™æŠŠäº’æ–¥é”è¢«è§£é”ï¼Œè¢«é˜»å¡çš„çº¿ç¨‹æ‰èƒ½è¢«è§£é™¤é˜»å¡ã€‚<strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªå…±äº«èµ„æºå¯¹åº”ä¸€ä¸ªæŠŠäº’æ–¥é”(å…¨å±€å…±äº«çš„é”)ï¼Œé”çš„ä¸ªæ•°å’Œçº¿ç¨‹çš„ä¸ªæ•°æ— å…³ã€‚</strong></p><p><strong>Linux æä¾›çš„äº’æ–¥é”æ“ä½œå‡½æ•°å¦‚ä¸‹ï¼Œå¦‚æœå‡½æ•°è°ƒç”¨æˆåŠŸä¼šè¿”å› 0ï¼Œè°ƒç”¨å¤±è´¥ä¼šè¿”å›ç›¸åº”çš„é”™è¯¯å·ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–äº’æ–¥é”</span></span><br><span class="line"><span class="comment">// restrict: æ˜¯ä¸€ä¸ªå…³é”®å­—, ç”¨æ¥ä¿®é¥°æŒ‡é’ˆ, åªæœ‰è¿™ä¸ªå…³é”®å­—ä¿®é¥°çš„æŒ‡é’ˆå¯ä»¥è®¿é—®æŒ‡å‘çš„å†…å­˜åœ°å€, å…¶ä»–æŒ‡é’ˆæ˜¯ä¸è¡Œçš„</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_init</span><span class="params">(<span class="type">pthread_mutex_t</span> *<span class="keyword">restrict</span> mutex,</span></span><br><span class="line"><span class="params">           <span class="type">const</span> <span class="type">pthread_mutexattr_t</span> *<span class="keyword">restrict</span> attr)</span>;</span><br><span class="line"><span class="comment">// é‡Šæ”¾äº’æ–¥é”èµ„æº            </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_destroy</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°</p><ul><li><p>mutex: äº’æ–¥é”å˜é‡çš„åœ°å€</p></li><li><p>attr: äº’æ–¥é”çš„å±æ€§ï¼Œä¸€èˆ¬ä½¿ç”¨é»˜è®¤å±æ€§å³å¯ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šä¸º NULL</p></li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¿®æ”¹äº’æ–¥é”çš„çŠ¶æ€, å°†å…¶è®¾å®šä¸ºé”å®šçŠ¶æ€, è¿™ä¸ªçŠ¶æ€è¢«å†™å…¥åˆ°å‚æ•° mutex ä¸­</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_lock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œé¦–å…ˆä¼šåˆ¤æ–­å‚æ•° mutex äº’æ–¥é”ä¸­çš„çŠ¶æ€æ˜¯ä¸æ˜¯é”å®šçŠ¶æ€:</p><ul><li><p>æ²¡æœ‰è¢«é”å®šï¼Œæ˜¯æ‰“å¼€çš„ï¼Œè¿™ä¸ªçº¿ç¨‹å¯ä»¥åŠ é”æˆåŠŸï¼Œè¿™ä¸ªè¿™ä¸ªé”ä¸­ä¼šè®°å½•æ˜¯å“ªä¸ªçº¿ç¨‹åŠ é”æˆåŠŸäº†</p></li><li><p>å¦‚æœè¢«é”å®šäº†ï¼Œå…¶ä»–çº¿ç¨‹åŠ é”å°±å¤±è´¥äº†ï¼Œè¿™äº›çº¿ç¨‹éƒ½ä¼šé˜»å¡åœ¨è¿™æŠŠé”ä¸Š</p></li><li><p>å½“è¿™æŠŠé”è¢«è§£å¼€ä¹‹åï¼Œè¿™äº›é˜»å¡åœ¨é”ä¸Šçš„çº¿ç¨‹å°±è§£é™¤é˜»å¡äº†ï¼Œå¹¶ä¸”è¿™äº›çº¿ç¨‹æ˜¯é€šè¿‡ç«äº‰çš„æ–¹å¼å¯¹è¿™æŠŠé”åŠ é”ï¼Œæ²¡æŠ¢åˆ°é”çš„çº¿ç¨‹ç»§ç»­é˜»å¡</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°è¯•åŠ é”</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_trylock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨è¿™ä¸ªå‡½æ•°å¯¹äº’æ–¥é”å˜é‡åŠ é”è¿˜æ˜¯æœ‰ä¸¤ç§æƒ…å†µ:</p><ul><li>å¦‚æœè¿™æŠŠé”æ²¡æœ‰è¢«é”å®šæ˜¯æ‰“å¼€çš„ï¼Œçº¿ç¨‹åŠ é”æˆåŠŸ</li><li>å¦‚æœé”å˜é‡è¢«é”ä½äº†ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°åŠ é”çš„çº¿ç¨‹ï¼Œä¸ä¼šè¢«é˜»å¡ï¼ŒåŠ é”å¤±è´¥ç›´æ¥è¿”å›é”™è¯¯å·</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹äº’æ–¥é”è§£é”</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_mutex_unlock</span><span class="params">(<span class="type">pthread_mutex_t</span> *mutex)</span>;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> ä¸æ˜¯æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯ä»¥å¯¹äº’æ–¥é”è§£é”ï¼Œå“ªä¸ªçº¿ç¨‹åŠ çš„é”ï¼Œå“ªä¸ªçº¿ç¨‹æ‰èƒ½è§£é”æˆåŠŸã€‚</p><h2 id="äº’æ–¥é”çš„ä½¿ç”¨">äº’æ–¥é”çš„ä½¿ç”¨</h2><p>æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢å¤šçº¿ç¨‹äº¤æ›¿æ•°æ•°çš„ä¾‹å­ä¿®æ”¹ä¸€ä¸‹ï¼Œä½¿ç”¨äº’æ–¥é”è¿›è¡Œçº¿ç¨‹åŒæ­¥ã€‚ä¸¤ä¸ªçº¿ç¨‹ä¸€å…±æ“ä½œäº†åŒä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸€äº’æ–¥é”ï¼Œæ¥æ§åˆ¶è¿™ä¸¤ä¸ªçº¿ç¨‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX 100</span></span><br><span class="line"><span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"><span class="type">int</span> number;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€æŠŠäº’æ–¥é”</span></span><br><span class="line"><span class="comment">// å…¨å±€å˜é‡, å¤šä¸ªçº¿ç¨‹å…±äº«</span></span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çº¿ç¨‹å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">funcA_num</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;MAX; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¿ç¨‹AåŠ é”æˆåŠŸ, ä¸é˜»å¡</span></span><br><span class="line">        <span class="comment">// å¦‚æœBåŠ é”æˆåŠŸ, çº¿ç¨‹Aé˜»å¡</span></span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="type">int</span> cur = number;</span><br><span class="line">        cur++;</span><br><span class="line">        usleep(<span class="number">10</span>);</span><br><span class="line">        number = cur;</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Thread A, id = %lu, number = %d\n&quot;</span>, pthread_self(), number);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span>* <span class="title function_">funcB_num</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;MAX; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// aåŠ é”æˆåŠŸ, bçº¿ç¨‹è®¿é—®è¿™æŠŠé”çš„æ—¶å€™æ˜¯é”å®šçš„</span></span><br><span class="line">        <span class="comment">// çº¿ç¨‹Bå…ˆé˜»å¡, açº¿ç¨‹è§£é”ä¹‹åé˜»å¡è§£é™¤</span></span><br><span class="line">        <span class="comment">// çº¿ç¨‹BåŠ é”æˆåŠŸäº†</span></span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="type">int</span> cur = number;</span><br><span class="line">        cur++;</span><br><span class="line">        number = cur;</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Thread B, id = %lu, number = %d\n&quot;</span>, pthread_self(), number);</span><br><span class="line">        usleep(<span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span>* argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">pthread_t</span> p1, p2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–äº’æ–¥é”</span></span><br><span class="line">    pthread_mutex_init(&amp;mutex, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸¤ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    pthread_create(&amp;p1, <span class="literal">NULL</span>, funcA_num, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_create(&amp;p2, <span class="literal">NULL</span>, funcB_num, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜»å¡ï¼Œèµ„æºå›æ”¶</span></span><br><span class="line">    pthread_join(p1, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_join(p2, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”€æ¯äº’æ–¥é”</span></span><br><span class="line">    <span class="comment">// çº¿ç¨‹é”€æ¯ä¹‹å, å†å»é‡Šæ”¾äº’æ–¥é”</span></span><br><span class="line">    pthread_mutex_destroy(&amp;mutex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>3.æ­»é”</h1><p>å½“å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºï¼Œéœ€è¦åŠ é”ï¼Œå¦‚æœé”ä½¿ç”¨ä¸å½“ï¼Œå°±ä¼šé€ æˆæ­»é”è¿™ç§ç°è±¡ã€‚å¦‚æœçº¿ç¨‹æ­»é”é€ æˆçš„åæœæ˜¯ï¼šæ‰€æœ‰çš„çº¿ç¨‹éƒ½è¢«é˜»å¡ï¼Œå¹¶ä¸”çº¿ç¨‹çš„é˜»å¡æ˜¯æ— æ³•è§£å¼€çš„ï¼ˆå› ä¸ºå¯ä»¥è§£é”çš„çº¿ç¨‹ä¹Ÿè¢«é˜»å¡äº†ï¼‰ã€‚</p><p>é€ æˆæ­»é”çš„åœºæ™¯æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li><p>1.åŠ é”åå¿˜è®°è§£é”</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœºæ™¯1</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">6</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“å‰çº¿ç¨‹AåŠ é”æˆåŠŸ, å½“å‰å¾ªç¯å®Œæ¯•æ²¡æœ‰è§£é”, åœ¨ä¸‹ä¸€è½®å¾ªç¯çš„æ—¶å€™è‡ªå·±è¢«é˜»å¡äº†</span></span><br><span class="line">        <span class="comment">// å…¶ä½™çš„çº¿ç¨‹ä¹Ÿè¢«é˜»å¡</span></span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    ....</span><br><span class="line">    .....</span><br><span class="line">        <span class="comment">// å¿˜è®°è§£é”</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœºæ™¯2</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">6</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“å‰çº¿ç¨‹AåŠ é”æˆåŠŸ</span></span><br><span class="line">        <span class="comment">// å…¶ä½™çš„çº¿ç¨‹è¢«é˜»å¡</span></span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    ....</span><br><span class="line">    .....</span><br><span class="line">        <span class="keyword">if</span>(xxx)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å‡½æ•°é€€å‡º, æ²¡æœ‰è§£é”ï¼ˆè§£é”å‡½æ•°æ— æ³•è¢«æ‰§è¡Œäº†ï¼‰</span></span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>2.é‡å¤åŠ é”ï¼Œå½¢æˆæ­»é”</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">6</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“å‰çº¿ç¨‹AåŠ é”æˆåŠŸ</span></span><br><span class="line">        <span class="comment">// å…¶ä½™çš„çº¿ç¨‹é˜»å¡</span></span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="comment">// é”è¢«é”ä½äº†, Açº¿ç¨‹é˜»å¡</span></span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    ....</span><br><span class="line">    .....</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éšè—çš„æ¯”è¾ƒæ·±çš„æƒ…å†µ</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">funcA</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">6</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“å‰çº¿ç¨‹AåŠ é”æˆåŠŸ</span></span><br><span class="line">        <span class="comment">// å…¶ä½™çš„çº¿ç¨‹é˜»å¡</span></span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">    ....</span><br><span class="line">    .....</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">funcB</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">6</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“å‰çº¿ç¨‹AåŠ é”æˆåŠŸ</span></span><br><span class="line">        <span class="comment">// å…¶ä½™çš„çº¿ç¨‹é˜»å¡</span></span><br><span class="line">    pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        funcA();<span class="comment">// é‡å¤åŠ é”</span></span><br><span class="line">    ....</span><br><span class="line">    .....</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>3.åœ¨ç¨‹åºä¸­æœ‰å¤šä¸ªå…±äº«èµ„æºï¼Œå› æ­¤æœ‰å¾ˆå¤šæŠŠé”ï¼Œéšæ„åŠ é”ï¼Œå¯¼è‡´ç›¸äº’è¢«é˜»å¡</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">åœºæ™¯æè¿°:</span><br><span class="line">  1. æœ‰ä¸¤ä¸ªå…±äº«èµ„æº:X, Yï¼ŒXå¯¹åº”é”A, Yå¯¹åº”é”B</span><br><span class="line">     - çº¿ç¨‹Aè®¿é—®èµ„æºX, åŠ é”A</span><br><span class="line">     - çº¿ç¨‹Bè®¿é—®èµ„æºY, åŠ é”B</span><br><span class="line">  2. çº¿ç¨‹Aè¦è®¿é—®èµ„æºY, çº¿ç¨‹Bè¦è®¿é—®èµ„æºXï¼Œå› ä¸ºèµ„æºXå’ŒYå·²ç»è¢«å¯¹åº”çš„é”é”ä½äº†ï¼Œå› æ­¤è¿™ä¸ªä¸¤ä¸ªçº¿ç¨‹è¢«é˜»å¡</span><br><span class="line">     - çº¿ç¨‹Aè¢«é”Bé˜»å¡äº†, æ— æ³•æ‰“å¼€Aé”</span><br><span class="line">     - çº¿ç¨‹Bè¢«é”Aé˜»å¡äº†, æ— æ³•æ‰“å¼€Bé”</span><br></pre></td></tr></table></figure></li></ul><p><strong>åœ¨ä½¿ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹çš„æ—¶å€™ï¼Œå¦‚ä½•é¿å…æ­»é”å‘¢ï¼Ÿ</strong></p><ul><li><p>é¿å…å¤šæ¬¡é”å®šï¼Œå¤šæ£€æŸ¥</p></li><li><p>å¯¹å…±äº«èµ„æºè®¿é—®å®Œæ¯•ä¹‹åï¼Œä¸€å®šè¦è§£é”ï¼Œæˆ–è€…åœ¨åŠ é”çš„ä½¿ç”¨ trylock</p></li><li><p>å¦‚æœç¨‹åºä¸­æœ‰å¤šæŠŠé”ï¼Œå¯ä»¥æ§åˆ¶å¯¹é”çš„è®¿é—®é¡ºåº (é¡ºåºè®¿é—®å…±äº«èµ„æºï¼Œä½†åœ¨æœ‰äº›æƒ…å†µä¸‹æ˜¯åšä¸åˆ°çš„)ï¼Œå¦å¤–ä¹Ÿå¯ä»¥åœ¨å¯¹å…¶ä»–äº’æ–¥é”åšåŠ é”æ“ä½œä¹‹å‰ï¼Œå…ˆé‡Šæ”¾å½“å‰çº¿ç¨‹æ‹¥æœ‰çš„äº’æ–¥é”ã€‚</p></li><li><p>é¡¹ç›®ç¨‹åºä¸­å¯ä»¥å¼•å…¥ä¸€äº›ä¸“é—¨ç”¨äºæ­»é”æ£€æµ‹çš„æ¨¡å—</p></li></ul><h1>4.è¯»å†™é”</h1><p>è¯»å†™é”æ˜¯äº’æ–¥é”çš„å‡çº§ç‰ˆï¼Œåœ¨åšè¯»æ“ä½œçš„æ—¶å€™å¯ä»¥æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ï¼Œå¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯åšè¯»æ“ä½œ, é‚£ä¹ˆè¯»æ˜¯å¹¶è¡Œçš„ï¼Œä½†æ˜¯ä½¿ç”¨äº’æ–¥é”ï¼Œè¯»æ“ä½œä¹Ÿæ˜¯ä¸²è¡Œçš„ã€‚</p><p>è¯»å†™é”æ˜¯ä¸€æŠŠé”ï¼Œé”çš„ç±»å‹ä¸º <strong>pthread_rwlock_t</strong>ï¼Œæœ‰äº†ç±»å‹ä¹‹åå°±å¯ä»¥åˆ›å»ºä¸€æŠŠäº’æ–¥é”äº†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">pthread_rwlock_t</span> rwlock;</span><br></pre></td></tr></table></figure><p>ä¹‹æ‰€ä»¥ç§°å…¶ä¸ºè¯»å†™é”ï¼Œæ˜¯å› ä¸ºè¿™æŠŠé”æ—¢å¯ä»¥é”å®šè¯»æ“ä½œï¼Œä¹Ÿå¯ä»¥é”å®šå†™æ“ä½œã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå¯ä»¥å¤§è‡´è®¤ä¸ºåœ¨è¿™æŠŠé”ä¸­è®°å½•äº†è¿™äº›ä¿¡æ¯ï¼š</p><ul><li>é”çš„çŠ¶æ€ï¼šé”å®š / æ‰“å¼€</li><li>é”å®šçš„æ˜¯ä»€ä¹ˆæ“ä½œï¼šè¯»æ“ä½œ / å†™æ“ä½œï¼Œä½¿ç”¨è¯»å†™é”é”å®šäº†è¯»æ“ä½œï¼Œéœ€è¦å…ˆè§£é”æ‰èƒ½å»é”å®šå†™æ“ä½œï¼Œåä¹‹äº¦ç„¶ã€‚</li><li>å“ªä¸ªçº¿ç¨‹å°†è¿™æŠŠé”é”ä¸Šäº†</li></ul><p>è¯»å†™é”çš„ä½¿ç”¨æ–¹å¼ä¹Ÿäº’æ–¥é”çš„ä½¿ç”¨æ–¹å¼æ˜¯å®Œå…¨ç›¸åŒçš„ï¼šæ‰¾å…±äº«èµ„æºï¼Œç¡®å®šä¸´ç•ŒåŒºï¼Œåœ¨ä¸´ç•ŒåŒºçš„å¼€å§‹ä½ç½®åŠ é”ï¼ˆè¯»é” / å†™é”ï¼‰ï¼Œä¸´ç•ŒåŒºçš„ç»“æŸä½ç½®è§£é”ã€‚</p><p>å› ä¸ºé€šè¿‡ä¸€æŠŠè¯»å†™é”å¯ä»¥é”å®šè¯»æˆ–è€…å†™æ“ä½œï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹å…³äºè¯»å†™é”çš„ç‰¹ç‚¹ï¼š</p><ol><li>ä½¿ç”¨è¯»å†™é”çš„è¯»é”é”å®šäº†ä¸´ç•ŒåŒºï¼Œçº¿ç¨‹å¯¹ä¸´ç•ŒåŒºçš„è®¿é—®æ˜¯å¹¶è¡Œçš„ï¼Œè¯»é”æ˜¯å…±äº«çš„ã€‚</li><li>ä½¿ç”¨è¯»å†™é”çš„å†™é”é”å®šäº†ä¸´ç•ŒåŒºï¼Œçº¿ç¨‹å¯¹ä¸´ç•ŒåŒºçš„è®¿é—®æ˜¯ä¸²è¡Œçš„ï¼Œå†™é”æ˜¯ç‹¬å çš„ã€‚</li><li>ä½¿ç”¨è¯»å†™é”åˆ†åˆ«å¯¹ä¸¤ä¸ªä¸´ç•ŒåŒºåŠ äº†è¯»é”å’Œå†™é”ï¼Œä¸¤ä¸ªçº¿ç¨‹è¦åŒæ—¶è®¿é—®è€…ä¸¤ä¸ªä¸´ç•ŒåŒºï¼Œè®¿é—®å†™é”ä¸´ç•ŒåŒºçš„çº¿ç¨‹ç»§ç»­è¿è¡Œï¼Œè®¿é—®è¯»é”ä¸´ç•ŒåŒºçš„çº¿ç¨‹é˜»å¡ï¼Œå› ä¸º<strong>å†™é”æ¯”è¯»é”çš„ä¼˜å…ˆçº§é«˜ã€‚</strong></li></ol><p>å¦‚æœè¯´ç¨‹åºä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯¹å…±äº«èµ„æºåšå†™æ“ä½œï¼Œä½¿ç”¨è¯»å†™é”æ²¡æœ‰ä¼˜åŠ¿ï¼Œå’Œäº’æ–¥é”æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœè¯´ç¨‹åºä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯¹å…±äº«èµ„æºæœ‰å†™ä¹Ÿæœ‰è¯»æ“ä½œï¼Œå¹¶ä¸”å¯¹å…±äº«èµ„æºè¯»çš„æ“ä½œè¶Šå¤šï¼Œè¯»å†™é”æ›´æœ‰ä¼˜åŠ¿ã€‚</p><p><strong>Linux æä¾›çš„è¯»å†™é”æ“ä½œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼Œå¦‚æœå‡½æ•°è°ƒç”¨æˆåŠŸè¿”å› 0ï¼Œå¤±è´¥è¿”å›å¯¹åº”çš„é”™è¯¯å·ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">pthread_rwlock_t</span> rwlock;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–è¯»å†™é”</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_init</span><span class="params">(<span class="type">pthread_rwlock_t</span> *<span class="keyword">restrict</span> rwlock,</span></span><br><span class="line"><span class="params">           <span class="type">const</span> <span class="type">pthread_rwlockattr_t</span> *<span class="keyword">restrict</span> attr)</span>;</span><br><span class="line"><span class="comment">// é‡Šæ”¾è¯»å†™é”å ç”¨çš„ç³»ç»Ÿèµ„æº</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_destroy</span><span class="params">(<span class="type">pthread_rwlock_t</span> *rwlock)</span>;</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°:<ul><li>rwlock: è¯»å†™é”çš„åœ°å€ï¼Œä¼ å‡ºå‚æ•°</li><li>attr: è¯»å†™é”å±æ€§ï¼Œä¸€èˆ¬ä½¿ç”¨é»˜è®¤å±æ€§ï¼ŒæŒ‡å®šä¸º NULL</li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ç¨‹åºä¸­å¯¹è¯»å†™é”åŠ è¯»é”, é”å®šçš„æ˜¯è¯»æ“ä½œ</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_rdlock</span><span class="params">(<span class="type">pthread_rwlock_t</span> *rwlock)</span>;</span><br></pre></td></tr></table></figure><ul><li>è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯»å†™é”æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆåŠ é”æˆåŠŸï¼›å¦‚æœè¯»å†™é”å·²ç»é”å®šäº†è¯»æ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¾ç„¶å¯ä»¥åŠ é”æˆåŠŸï¼Œå› ä¸ºè¯»é”æ˜¯å…±äº«çš„ï¼›å¦‚æœè¯»å†™é”å·²ç»é”å®šäº†å†™æ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°å¯ä»¥æœ‰æ•ˆçš„é¿å…æ­»é”</span></span><br><span class="line"><span class="comment">// å¦‚æœåŠ è¯»é”å¤±è´¥, ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹, ç›´æ¥è¿”å›é”™è¯¯å·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_tryrdlock</span><span class="params">(<span class="type">pthread_rwlock_t</span> *rwlock)</span>;</span><br></pre></td></tr></table></figure><ul><li>è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯»å†™é”æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆåŠ é”æˆåŠŸï¼›å¦‚æœè¯»å†™é”å·²ç»é”å®šäº†è¯»æ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¾ç„¶å¯ä»¥åŠ é”æˆåŠŸï¼Œå› ä¸ºè¯»é”æ˜¯å…±äº«çš„ï¼›å¦‚æœè¯»å†™é”å·²ç»é”å®šäº†å†™æ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°åŠ é”å¤±è´¥ï¼Œå¯¹åº”çš„çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­å¯¹å‡½æ•°è¿”å›å€¼è¿›è¡Œåˆ¤æ–­ï¼Œæ·»åŠ åŠ é”å¤±è´¥ä¹‹åçš„å¤„ç†åŠ¨ä½œã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ç¨‹åºä¸­å¯¹è¯»å†™é”åŠ å†™é”, é”å®šçš„æ˜¯å†™æ“ä½œ</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_wrlock</span><span class="params">(<span class="type">pthread_rwlock_t</span> *rwlock)</span>;</span><br></pre></td></tr></table></figure><ul><li>è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯»å†™é”æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆåŠ é”æˆåŠŸï¼›å¦‚æœè¯»å†™é”å·²ç»é”å®šäº†è¯»æ“ä½œæˆ–è€…é”å®šäº†å†™æ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°å¯ä»¥æœ‰æ•ˆçš„é¿å…æ­»é”</span></span><br><span class="line"><span class="comment">// å¦‚æœåŠ å†™é”å¤±è´¥, ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹, ç›´æ¥è¿”å›é”™è¯¯å·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_trywrlock</span><span class="params">(<span class="type">pthread_rwlock_t</span> *rwlock)</span>;</span><br></pre></td></tr></table></figure><ul><li>ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯»å†™é”æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆåŠ é”æˆåŠŸï¼›å¦‚æœè¯»å†™é”å·²ç»é”å®šäº†è¯»æ“ä½œæˆ–è€…é”å®šäº†å†™æ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°åŠ é”å¤±è´¥ï¼Œä½†æ˜¯çº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­å¯¹å‡½æ•°è¿”å›å€¼è¿›è¡Œåˆ¤æ–­ï¼Œæ·»åŠ åŠ é”å¤±è´¥ä¹‹åçš„å¤„ç†åŠ¨ä½œã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§£é”, ä¸ç®¡é”å®šäº†è¯»è¿˜æ˜¯å†™éƒ½å¯ç”¨è§£é”</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_rwlock_unlock</span><span class="params">(<span class="type">pthread_rwlock_t</span> *rwlock)</span>;</span><br></pre></td></tr></table></figure><h2 id="è¯»å†™é”çš„ä½¿ç”¨">è¯»å†™é”çš„ä½¿ç”¨</h2><p>é¢˜ç›®è¦æ±‚ï¼š8 ä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªå…¨å±€å˜é‡ï¼Œ3 ä¸ªçº¿ç¨‹ä¸å®šæ—¶å†™åŒä¸€å…¨å±€èµ„æºï¼Œ5 ä¸ªçº¿ç¨‹ä¸å®šæ—¶è¯»åŒä¸€å…¨å±€èµ„æºã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"><span class="type">int</span> number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰è¯»å†™é”</span></span><br><span class="line"><span class="type">pthread_rwlock_t</span> rwlock;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™çš„çº¿ç¨‹çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">writeNum</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_rwlock_wrlock(&amp;rwlock);</span><br><span class="line">        <span class="type">int</span> cur = number;</span><br><span class="line">        cur ++;</span><br><span class="line">        number = cur;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;++å†™æ“ä½œå®Œæ¯•, number : %d, tid = %ld\n&quot;</span>, number, pthread_self());</span><br><span class="line">        pthread_rwlock_unlock(&amp;rwlock);</span><br><span class="line">        <span class="comment">// æ·»åŠ sleepç›®çš„æ˜¯è¦çœ‹åˆ°å¤šä¸ªçº¿ç¨‹äº¤æ›¿å·¥ä½œ</span></span><br><span class="line">        usleep(rand() % <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»çº¿ç¨‹çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="comment">// å¤šä¸ªçº¿ç¨‹å¯ä»¥å¦‚æœå¤„ç†åŠ¨ä½œç›¸åŒ, å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="comment">// æ¯ä¸ªçº¿ç¨‹ä¸­çš„æ ˆèµ„æºæ˜¯ç‹¬äº«</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">readNum</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_rwlock_rdlock(&amp;rwlock);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;--å…¨å±€å˜é‡number = %d, tid = %ld\n&quot;</span>, number, pthread_self());</span><br><span class="line">        pthread_rwlock_unlock(&amp;rwlock);</span><br><span class="line">        usleep(rand() % <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–è¯»å†™é”</span></span><br><span class="line">    pthread_rwlock_init(&amp;rwlock, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3ä¸ªå†™çº¿ç¨‹, 5ä¸ªè¯»çš„çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> wtid[<span class="number">3</span>];</span><br><span class="line">    <span class="type">pthread_t</span> rtid[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;wtid[i], <span class="literal">NULL</span>, writeNum, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;rtid[i], <span class="literal">NULL</span>, readNum, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(wtid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(rtid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”€æ¯è¯»å†™é”</span></span><br><span class="line">    pthread_rwlock_destroy(&amp;rwlock);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>5.æ¡ä»¶å˜é‡</h1><h2 id="æ¡ä»¶å˜é‡å‡½æ•°">æ¡ä»¶å˜é‡å‡½æ•°</h2><p>ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œæ¡ä»¶å˜é‡çš„ä¸»è¦ä½œç”¨ä¸æ˜¯å¤„ç†çº¿ç¨‹åŒæ­¥ï¼Œ<strong>è€Œæ˜¯è¿›è¡Œçº¿ç¨‹çš„é˜»å¡</strong>ã€‚å¦‚æœåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­åªä½¿ç”¨æ¡ä»¶å˜é‡æ— æ³•å®ç°çº¿ç¨‹çš„åŒæ­¥ï¼Œå¿…é¡»è¦é…åˆäº’æ–¥é”æ¥ä½¿ç”¨ã€‚è™½ç„¶æ¡ä»¶å˜é‡å’Œäº’æ–¥é”éƒ½èƒ½é˜»å¡çº¿ç¨‹ï¼Œä½†æ˜¯äºŒè€…çš„æ•ˆæœæ˜¯ä¸ä¸€æ ·çš„ï¼ŒäºŒè€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>è®¾æœ‰ A-Z 26 ä¸ªçº¿ç¨‹ï¼Œè¿™ 26 ä¸ªçº¿ç¨‹å…±åŒè®¿é—®åŒä¸€æŠŠäº’æ–¥é”ï¼Œå¦‚æœçº¿ç¨‹ A åŠ é”æˆåŠŸï¼Œé‚£ä¹ˆå…¶ä½™ B-Z çº¿ç¨‹è®¿é—®äº’æ–¥é”éƒ½é˜»å¡ï¼Œæ‰€æœ‰çš„çº¿ç¨‹åªèƒ½é¡ºåºè®¿é—®ä¸´ç•ŒåŒº</li><li>æ¡ä»¶å˜é‡åªæœ‰åœ¨æ»¡è¶³æŒ‡å®šæ¡ä»¶ä¸‹æ‰ä¼šé˜»å¡çº¿ç¨‹ï¼Œå¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒºï¼ŒåŒæ—¶è¯»å†™ä¸´ç•Œèµ„æºï¼Œè¿™ç§æƒ…å†µä¸‹è¿˜æ˜¯ä¼šå‡ºç°å…±äº«èµ„æºä¸­æ•°æ®çš„æ··ä¹±ã€‚</li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹æ¡ä»¶å˜é‡ç”¨äºå¤„ç†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ï¼Œå¹¶ä¸”å’Œäº’æ–¥é”é…åˆä½¿ç”¨ã€‚æ¡ä»¶å˜é‡ç±»å‹å¯¹åº”çš„ç±»å‹ä¸º <strong>pthread_cond_t</strong>ï¼Œè¿™æ ·å°±å¯ä»¥å®šä¹‰ä¸€ä¸ªæ¡ä»¶å˜é‡ç±»å‹çš„å˜é‡äº†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">pthread_cond_t</span> cond;<span class="comment">//cond(condition)</span></span><br></pre></td></tr></table></figure><ul><li>è¢«æ¡ä»¶å˜é‡é˜»å¡çš„çº¿ç¨‹çš„çº¿ç¨‹ä¿¡æ¯ä¼šè¢«è®°å½•åˆ°è¿™ä¸ªå˜é‡ä¸­ï¼Œä»¥ä¾¿åœ¨è§£é™¤é˜»å¡çš„æ—¶å€™ä½¿ç”¨ã€‚</li></ul><p><strong>æ¡ä»¶å˜é‡æ“ä½œå‡½æ•°å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">pthread_cond_t</span> cond;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_init</span><span class="params">(<span class="type">pthread_cond_t</span> *<span class="keyword">restrict</span> cond,</span></span><br><span class="line"><span class="params">      <span class="type">const</span> <span class="type">pthread_condattr_t</span> *<span class="keyword">restrict</span> attr)</span>;</span><br><span class="line"><span class="comment">// é”€æ¯é‡Šæ”¾èµ„æº        </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_destroy</span><span class="params">(<span class="type">pthread_cond_t</span> *cond)</span>;</span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°:</p><ul><li>cond: æ¡ä»¶å˜é‡çš„åœ°å€</li><li>attr: æ¡ä»¶å˜é‡å±æ€§ï¼Œä¸€èˆ¬ä½¿ç”¨é»˜è®¤å±æ€§ï¼ŒæŒ‡å®šä¸º NULL</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çº¿ç¨‹é˜»å¡å‡½æ•°, å“ªä¸ªçº¿ç¨‹è°ƒç”¨è¿™ä¸ªå‡½æ•°, å“ªä¸ªçº¿ç¨‹å°±ä¼šè¢«é˜»å¡</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_wait</span><span class="params">(<span class="type">pthread_cond_t</span> *<span class="keyword">restrict</span> cond, <span class="type">pthread_mutex_t</span> *<span class="keyword">restrict</span> mutex)</span>;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‡½æ•°åŸå‹å¯ä»¥çœ‹å‡ºï¼Œè¯¥å‡½æ•°åœ¨é˜»å¡çº¿ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦ä¸€ä¸ªäº’æ–¥é”å‚æ•°ï¼Œè¿™ä¸ªäº’æ–¥é”ä¸»è¦åŠŸèƒ½æ˜¯è¿›è¡Œçº¿ç¨‹åŒæ­¥ï¼Œè®©çº¿ç¨‹é¡ºåºè¿›å…¥ä¸´ç•ŒåŒºï¼Œé¿å…å‡ºç°æ•°å…±äº«èµ„æºçš„æ•°æ®æ··ä¹±ã€‚è¯¥å‡½æ•°ä¼šå¯¹è¿™ä¸ªäº’æ–¥é”åšä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š</p><ol><li>åœ¨é˜»å¡çº¿ç¨‹æ—¶å€™ï¼Œå¦‚æœçº¿ç¨‹å·²ç»å¯¹äº’æ–¥é” mutex ä¸Šé”ï¼Œé‚£ä¹ˆä¼šå°†è¿™æŠŠé”æ‰“å¼€ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†é¿å…æ­»é”</li><li>å½“çº¿ç¨‹è§£é™¤é˜»å¡çš„æ—¶å€™ï¼Œå‡½æ•°å†…éƒ¨ä¼šå¸®åŠ©è¿™ä¸ªçº¿ç¨‹å†æ¬¡å°†è¿™ä¸ª mutex äº’æ–¥é”é”ä¸Šï¼Œç»§ç»­å‘ä¸‹è®¿é—®ä¸´ç•ŒåŒº</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¡¨ç¤ºçš„æ—¶é—´æ˜¯ä»1971.1.1åˆ°æŸä¸ªæ—¶é—´ç‚¹çš„æ—¶é—´, æ€»é•¿åº¦ä½¿ç”¨ç§’/çº³ç§’è¡¨ç¤º</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> &#123;</span></span><br><span class="line"><span class="type">time_t</span> tv_sec;      <span class="comment">/* Seconds */</span></span><br><span class="line"><span class="type">long</span>   tv_nsec;     <span class="comment">/* Nanoseconds [0 .. 999999999] */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// å°†çº¿ç¨‹é˜»å¡ä¸€å®šçš„æ—¶é—´é•¿åº¦, æ—¶é—´åˆ°è¾¾ä¹‹å, çº¿ç¨‹å°±è§£é™¤é˜»å¡äº†</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_timedwait</span><span class="params">(<span class="type">pthread_cond_t</span> *<span class="keyword">restrict</span> cond,<span class="type">pthread_mutex_t</span> *<span class="keyword">restrict</span> mutex, <span class="type">const</span> <span class="keyword">struct</span> timespec *<span class="keyword">restrict</span> abstime)</span>;</span><br></pre></td></tr></table></figure></li></ul><p>è¿™ä¸ªå‡½æ•°çš„å‰ä¸¤ä¸ªå‚æ•°å’Œ <strong>pthread_cond_wait</strong> å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºçº¿ç¨‹é˜»å¡çš„æ—¶é•¿ï¼Œä½†æ˜¯éœ€è¦é¢å¤–æ³¨æ„ä¸€ç‚¹ï¼š<strong>struct timespec</strong> è¿™ä¸ªç»“æ„ä½“ä¸­è®°å½•çš„æ—¶é—´æ˜¯ä»1971.1.1åˆ°æŸä¸ªæ—¶é—´ç‚¹çš„æ—¶é—´ï¼Œæ€»é•¿åº¦ä½¿ç”¨ç§’/çº³ç§’è¡¨ç¤ºã€‚å› æ­¤èµ‹å€¼æ–¹å¼ç›¸å¯¹è¦éº»çƒ¦ä¸€ç‚¹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">time_t</span> mytim = time(<span class="literal">NULL</span>);<span class="comment">// 1970.1.1 0:0:0 åˆ°å½“å‰çš„æ€»ç§’æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> <span class="title">tmsp</span>;</span></span><br><span class="line">tmsp.tv_nsec = <span class="number">0</span>;</span><br><span class="line">tmsp.tv_sec = time(<span class="literal">NULL</span>) + <span class="number">100</span>;<span class="comment">// çº¿ç¨‹é˜»å¡100s</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å”¤é†’é˜»å¡åœ¨æ¡ä»¶å˜é‡ä¸Šçš„çº¿ç¨‹, è‡³å°‘æœ‰ä¸€ä¸ªè¢«è§£é™¤é˜»å¡</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_signal</span><span class="params">(<span class="type">pthread_cond_t</span> *cond)</span>;</span><br><span class="line"><span class="comment">// å”¤é†’é˜»å¡åœ¨æ¡ä»¶å˜é‡ä¸Šçš„çº¿ç¨‹, è¢«é˜»å¡çš„çº¿ç¨‹å…¨éƒ¨è§£é™¤é˜»å¡</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cond_broadcast</span><span class="params">(<span class="type">pthread_cond_t</span> *cond)</span>;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œéƒ½å¯ä»¥å”¤é†’è¢« pthread_cond_wait æˆ–è€… pthread_cond_timedwait é˜»å¡çš„çº¿ç¨‹ï¼ŒåŒºåˆ«å°±åœ¨äº pthread_cond_signal æ˜¯å”¤é†’è‡³å°‘ä¸€ä¸ªè¢«é˜»å¡çš„çº¿ç¨‹ï¼ˆæ€»ä¸ªæ•°ä¸å®šï¼‰ï¼Œpthread_cond_broadcast æ˜¯å”¤é†’æ‰€æœ‰è¢«é˜»å¡çš„çº¿ç¨‹ã€‚</p><h2 id="ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…">ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…</h2><p><strong>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ç»„æˆï¼š</strong></p><ol><li>ç”Ÿäº§è€…çº¿ç¨‹ -&gt; è‹¥å¹²ä¸ª<ul><li>ç”Ÿäº§å•†å“æˆ–è€…ä»»åŠ¡æ”¾å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­</li><li>ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†å°±é˜»å¡ï¼Œä¸æ»¡çš„æ—¶å€™å°±å·¥ä½œ</li><li>é€šè¿‡ä¸€ä¸ªç”Ÿäº§è€…çš„æ¡ä»¶å˜é‡æ§åˆ¶ç”Ÿäº§è€…çº¿ç¨‹é˜»å¡å’Œéé˜»å¡</li></ul></li><li>æ¶ˆè´¹è€…çº¿ç¨‹ -&gt; è‹¥å¹²ä¸ª<ul><li>è¯»ä»»åŠ¡é˜Ÿåˆ—ï¼Œå°†ä»»åŠ¡æˆ–è€…æ•°æ®å–å‡º</li><li>ä»»åŠ¡é˜Ÿåˆ—ä¸­æœ‰æ•°æ®å°±æ¶ˆè´¹ï¼Œæ²¡æœ‰æ•°æ®å°±é˜»å¡</li><li>é€šè¿‡ä¸€ä¸ªæ¶ˆè´¹è€…çš„æ¡ä»¶å˜é‡æ§åˆ¶æ¶ˆè´¹è€…çº¿ç¨‹é˜»å¡å’Œéé˜»å¡</li></ul></li><li>é˜Ÿåˆ— -&gt; å­˜å‚¨ä»»åŠ¡ / æ•°æ®ï¼Œå¯¹åº”ä¸€å—å†…å­˜ï¼Œä¸ºäº†è¯»å†™è®¿é—®å¯ä»¥é€šè¿‡ä¸€ä¸ªæ•°æ®ç»“æ„ç»´æŠ¤è¿™å—å†…å­˜<ul><li>å¯ä»¥æ˜¯æ•°ç»„ã€é“¾è¡¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ stl å®¹å™¨ï¼šqueue /stack/list/vector</li></ul></li></ol><p><strong>åœºæ™¯æè¿°ï¼šä½¿ç”¨æ¡ä»¶å˜é‡å®ç°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ï¼Œç”Ÿäº§è€…æœ‰ 5 ä¸ªï¼Œå¾€é“¾è¡¨å¤´éƒ¨æ·»åŠ èŠ‚ç‚¹ï¼Œæ¶ˆè´¹è€…ä¹Ÿæœ‰ 5 ä¸ªï¼Œåˆ é™¤é“¾è¡¨å¤´éƒ¨çš„èŠ‚ç‚¹ã€‚</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é“¾è¡¨çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ¡ä»¶å˜é‡, æ§åˆ¶æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line"><span class="type">pthread_cond_t</span> cond;</span><br><span class="line"><span class="comment">// äº’æ–¥é”å˜é‡</span></span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"><span class="comment">// æŒ‡å‘å¤´ç»“ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> * <span class="title">head</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä¸€ç›´ç”Ÿäº§</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªé“¾è¡¨çš„æ–°èŠ‚ç‚¹</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnew</span> =</span> (<span class="keyword">struct</span> Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</span><br><span class="line">        <span class="comment">// èŠ‚ç‚¹åˆå§‹åŒ–</span></span><br><span class="line">        pnew-&gt;number = rand() % <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">// èŠ‚ç‚¹çš„è¿æ¥, æ·»åŠ åˆ°é“¾è¡¨çš„å¤´éƒ¨, æ–°èŠ‚ç‚¹å°±æ–°çš„å¤´ç»“ç‚¹</span></span><br><span class="line">        pnew-&gt;next = head;</span><br><span class="line">        <span class="comment">// headæŒ‡é’ˆå‰ç§»</span></span><br><span class="line">        head = pnew;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;+++producer, number = %d, tid = %ld\n&quot;</span>, pnew-&gt;number, pthread_self());</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿäº§äº†ä»»åŠ¡, é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line">        pthread_cond_broadcast(&amp;cond);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿäº§æ…¢ä¸€ç‚¹</span></span><br><span class="line">        sleep(rand() % <span class="number">3</span><span class="comment">//rand()äº§ç”Ÿ0-32767ä¹‹é—´çš„éšæœºæ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* consumer(<span class="type">void</span>* arg)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="comment">// ä¸€ç›´æ¶ˆè´¹, åˆ é™¤é“¾è¡¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">//        if(head == NULL)   // è¿™æ ·å†™æœ‰bug</span></span><br><span class="line">        <span class="keyword">while</span>(head == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä»»åŠ¡é˜Ÿåˆ—, ä¹Ÿå°±æ˜¯é“¾è¡¨ä¸­å·²ç»æ²¡æœ‰èŠ‚ç‚¹å¯ä»¥æ¶ˆè´¹äº†</span></span><br><span class="line">            <span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹éœ€è¦é˜»å¡</span></span><br><span class="line">            <span class="comment">// çº¿ç¨‹åŠ äº’æ–¥é”æˆåŠŸ, ä½†æ˜¯çº¿ç¨‹é˜»å¡åœ¨è¿™è¡Œä»£ç ä¸Š, é”è¿˜æ²¡è§£å¼€</span></span><br><span class="line">            <span class="comment">// å…¶ä»–çº¿ç¨‹åœ¨è®¿é—®è¿™æŠŠé”çš„æ—¶å€™ä¹Ÿä¼šé˜»å¡, ç”Ÿäº§è€…ä¹Ÿä¼šé˜»å¡ ==&gt; æ­»é”</span></span><br><span class="line">            <span class="comment">// è¿™å‡½æ•°ä¼šè‡ªåŠ¨å°†çº¿ç¨‹æ‹¥æœ‰çš„é”è§£å¼€</span></span><br><span class="line">            pthread_cond_wait(&amp;cond, &amp;mutex);</span><br><span class="line">            <span class="comment">// å½“æ¶ˆè´¹è€…çº¿ç¨‹è§£é™¤é˜»å¡ä¹‹å, ä¼šè‡ªåŠ¨å°†è¿™æŠŠé”é”ä¸Š</span></span><br><span class="line">            <span class="comment">// è¿™æ—¶å€™å½“å‰è¿™ä¸ªçº¿ç¨‹åˆé‡æ–°æ‹¥æœ‰äº†è¿™æŠŠäº’æ–¥é”</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å–å‡ºé“¾è¡¨çš„å¤´ç»“ç‚¹, å°†å…¶åˆ é™¤</span></span><br><span class="line">        <span class="keyword">struct</span> Node* pnode = head;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;--consumer: number: %d, tid = %ld\n&quot;</span>, pnode-&gt;number, pthread_self());</span><br><span class="line">        head  = pnode-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(pnode);</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);        </span><br><span class="line"></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ¡ä»¶å˜é‡</span></span><br><span class="line">    pthread_cond_init(&amp;cond, <span class="literal">NULL</span>);</span><br><span class="line">    pthread_mutex_init(&amp;mutex, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º5ä¸ªç”Ÿäº§è€…, 5ä¸ªæ¶ˆè´¹è€…</span></span><br><span class="line">    <span class="type">pthread_t</span> ptid[<span class="number">5</span>];</span><br><span class="line">    <span class="type">pthread_t</span> ctid[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;ptid[i], <span class="literal">NULL</span>, producer, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;ctid[i], <span class="literal">NULL</span>, consumer, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é˜»å¡ç­‰å¾…å­çº¿ç¨‹é€€å‡º</span></span><br><span class="line">        pthread_join(ptid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(ctid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”€æ¯æ¡ä»¶å˜é‡</span></span><br><span class="line">    pthread_cond_destroy(&amp;cond);</span><br><span class="line">    pthread_mutex_destroy(&amp;mutex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="comment">// ä¸€ç›´æ¶ˆè´¹, åˆ é™¤é“¾è¡¨ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>)   <span class="comment">// è¿™æ ·å†™æœ‰bug</span></span><br><span class="line">        &#123;</span><br><span class="line">            pthread_cond_wait(&amp;cond, &amp;mutex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å–å‡ºé“¾è¡¨çš„å¤´ç»“ç‚¹, å°†å…¶åˆ é™¤</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnode</span> =</span> head;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;--consumer: number: %d, tid = %ld\n&quot;</span>, pnode-&gt;number, pthread_self());</span><br><span class="line">        head  = pnode-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(pnode);</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);        </span><br><span class="line"></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä¸ºä»€ä¹ˆåœ¨ç¬¬7è¡Œä½¿ç”¨if æœ‰bug:</span></span><br><span class="line"><span class="comment">    å½“ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©º, æ‰€æœ‰çš„æ¶ˆè´¹è€…çº¿ç¨‹éƒ½ä¼šè¢«è¿™ä¸ªå‡½æ•°é˜»å¡ pthread_cond_wait(&amp;cond, &amp;mutex);</span></span><br><span class="line"><span class="comment">    ä¹Ÿå°±æ˜¯é˜»å¡åœ¨ä»£ç çš„ç¬¬9è¡Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    å½“ç”Ÿäº§è€…ç”Ÿäº§äº†1ä¸ªèŠ‚ç‚¹, è°ƒç”¨ pthread_cond_broadcast(&amp;cond); å”¤é†’äº†æ‰€æœ‰é˜»å¡çš„çº¿ç¨‹</span></span><br><span class="line"><span class="comment">      - æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹é€šè¿‡ pthread_cond_wait()åŠ é”æˆåŠŸ, å…¶ä½™æ²¡æœ‰åŠ é”æˆåŠŸçš„çº¿ç¨‹ç»§ç»­é˜»å¡</span></span><br><span class="line"><span class="comment">      - åŠ é”æˆåŠŸçš„çº¿ç¨‹å‘ä¸‹è¿è¡Œ, å¹¶æˆåŠŸåˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹, ç„¶åè§£é”</span></span><br><span class="line"><span class="comment">      - æ²¡æœ‰åŠ é”æˆåŠŸçš„çº¿ç¨‹è§£é™¤é˜»å¡ç»§ç»­æŠ¢è¿™æŠŠé”, å¦å¤–ä¸€ä¸ªå­çº¿ç¨‹åŠ é”æˆåŠŸ</span></span><br><span class="line"><span class="comment">      - ä½†æ˜¯è¿™ä¸ªçº¿ç¨‹åˆ é™¤é“¾è¡¨èŠ‚ç‚¹çš„æ—¶å€™é“¾è¡¨å·²ç»ä¸ºç©ºäº†, åè¾¹è®¿é—®è¿™ä¸ªç©ºèŠ‚ç‚¹çš„æ—¶å€™å°±ä¼šå‡ºç°æ®µé”™è¯¯</span></span><br><span class="line"><span class="comment">    è§£å†³æ–¹æ¡ˆ:</span></span><br><span class="line"><span class="comment">      - éœ€è¦å¾ªç¯çš„å¯¹é“¾è¡¨æ˜¯å¦ä¸ºç©ºè¿›è¡Œåˆ¤æ–­, éœ€è¦å°†if è¯¥æˆ while</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h1>6.ä¿¡å·é‡</h1><h2 id="ä¿¡å·é‡å‡½æ•°">ä¿¡å·é‡å‡½æ•°</h2><p>ä¿¡å·é‡ç”¨åœ¨å¤šçº¿ç¨‹å¤šä»»åŠ¡åŒæ­¥çš„ï¼Œä¸€ä¸ªçº¿ç¨‹å®Œæˆäº†æŸä¸€ä¸ªåŠ¨ä½œå°±é€šè¿‡ä¿¡å·é‡å‘Šè¯‰åˆ«çš„çº¿ç¨‹ï¼Œåˆ«çš„çº¿ç¨‹å†è¿›è¡ŒæŸäº›åŠ¨ä½œã€‚ä¿¡å·é‡ä¸ä¸€å®šæ˜¯é”å®šæŸä¸€ä¸ªèµ„æºï¼Œè€Œæ˜¯æµç¨‹ä¸Šçš„æ¦‚å¿µï¼Œæ¯”å¦‚ï¼šæœ‰ Aï¼ŒB ä¸¤ä¸ªçº¿ç¨‹ï¼ŒB çº¿ç¨‹è¦ç­‰ A çº¿ç¨‹å®ŒæˆæŸä¸€ä»»åŠ¡ä»¥åå†è¿›è¡Œè‡ªå·±ä¸‹é¢çš„æ­¥éª¤ï¼Œè¿™ä¸ªä»»åŠ¡å¹¶ä¸ä¸€å®šæ˜¯é”å®šæŸä¸€èµ„æºï¼Œè¿˜å¯ä»¥æ˜¯è¿›è¡Œä¸€äº›è®¡ç®—æˆ–è€…æ•°æ®å¤„ç†ä¹‹ç±»ã€‚</p><p>**ä¿¡å·é‡ï¼ˆä¿¡å·ç¯ï¼‰**ä¸äº’æ–¥é”å’Œæ¡ä»¶å˜é‡çš„ä¸»è¦ä¸åŒåœ¨äºâ€ ç¯â€ çš„æ¦‚å¿µï¼Œç¯äº®åˆ™æ„å‘³ç€èµ„æºå¯ç”¨ï¼Œç¯ç­åˆ™æ„å‘³ç€ä¸å¯ç”¨ã€‚ä¿¡å·é‡ä¸»è¦é˜»å¡çº¿ç¨‹ï¼Œä¸èƒ½å®Œå…¨ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¦‚æœè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œéœ€è¦ä¿¡å·é‡å’Œäº’æ–¥é”ä¸€èµ·ä½¿ç”¨ã€‚</p><p>**ä¿¡å·é‡å’Œæ¡ä»¶å˜é‡ä¸€æ ·ç”¨äºå¤„ç†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ï¼Œç”¨äºé˜»å¡ç”Ÿäº§è€…çº¿ç¨‹æˆ–è€…æ¶ˆè´¹è€…çº¿ç¨‹çš„è¿è¡Œã€‚**ä¿¡å·çš„ç±»å‹ä¸º sem_t å¯¹åº”çš„å¤´æ–‡ä»¶ä¸º <strong>&lt;semaphore.h&gt;ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="type">sem_t</span> sem;</span><br></pre></td></tr></table></figure><ul><li>Linux æä¾›çš„ä¿¡å·é‡æ“ä½œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–ä¿¡å·é‡/ä¿¡å·ç¯</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_init</span><span class="params">(<span class="type">sem_t</span> *sem, <span class="type">int</span> pshared, <span class="type">unsigned</span> <span class="type">int</span> value)</span>;</span><br><span class="line">          </span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_destroy</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br><span class="line"><span class="comment">// èµ„æºé‡Šæ”¾, çº¿ç¨‹é”€æ¯ä¹‹åè°ƒç”¨è¿™ä¸ªå‡½æ•°å³å¯</span></span><br><span class="line"><span class="comment">// å‚æ•° sem å°±æ˜¯ sem_init() çš„ç¬¬ä¸€ä¸ªå‚æ•°  </span></span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°:</p><ul><li><p>sem: ä¿¡å·é‡å˜é‡åœ°å€</p></li><li><p>psharedï¼š</p><ul><li><p>0ï¼šçº¿ç¨‹åŒæ­¥</p></li><li><p>é 0ï¼šè¿›ç¨‹åŒæ­¥</p></li></ul></li><li><p>valueï¼šåˆå§‹åŒ–å½“å‰ä¿¡å·é‡æ‹¥æœ‰çš„èµ„æºæ•°ï¼ˆ&gt;=0ï¼‰ï¼Œå¦‚æœèµ„æºæ•°ä¸º 0ï¼Œçº¿ç¨‹å°±ä¼šè¢«é˜»å¡äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‚æ•° sem å°±æ˜¯ sem_init() çš„ç¬¬ä¸€ä¸ªå‚æ•°  </span></span><br><span class="line"><span class="comment">// å‡½æ•°è¢«è°ƒç”¨semä¸­çš„èµ„æºå°±ä¼šè¢«æ¶ˆè€—1ä¸ª, èµ„æºæ•°-1</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_wait</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>å½“çº¿ç¨‹è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸” sem ä¸­çš„èµ„æºæ•° &gt;0ï¼Œçº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œçº¿ç¨‹ä¼šå ç”¨ sem ä¸­çš„ä¸€ä¸ªèµ„æºï¼Œå› æ­¤èµ„æºæ•° - 1ï¼Œç›´åˆ° sem ä¸­çš„èµ„æºæ•°å‡ä¸º 0 æ—¶ï¼Œèµ„æºè¢«è€—å°½ï¼Œå› æ­¤çº¿ç¨‹ä¹Ÿå°±è¢«é˜»å¡äº†ã€‚</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‚æ•° sem å°±æ˜¯ sem_init() çš„ç¬¬ä¸€ä¸ªå‚æ•°  </span></span><br><span class="line"><span class="comment">// å‡½æ•°è¢«è°ƒç”¨semä¸­çš„èµ„æºå°±ä¼šè¢«æ¶ˆè€—1ä¸ª, èµ„æºæ•°-1</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_trywait</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br></pre></td></tr></table></figure><ul><li>å½“çº¿ç¨‹è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸” sem ä¸­çš„èµ„æºæ•° &gt;0ï¼Œçº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œçº¿ç¨‹ä¼šå ç”¨ sem ä¸­çš„ä¸€ä¸ªèµ„æºï¼Œå› æ­¤èµ„æºæ•° - 1ï¼Œç›´åˆ° sem ä¸­çš„èµ„æºæ•°å‡ä¸º 0 æ—¶ï¼Œèµ„æºè¢«è€—å°½ï¼Œä½†æ˜¯çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ï¼Œç›´æ¥è¿”å›é”™è¯¯å·ï¼Œå› æ­¤å¯ä»¥åœ¨ç¨‹åºä¸­æ·»åŠ åˆ¤æ–­åˆ†æ”¯ï¼Œç”¨äºå¤„ç†è·å–èµ„æºå¤±è´¥ä¹‹åçš„æƒ…å†µã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¡¨ç¤ºçš„æ—¶é—´æ˜¯ä»1971.1.1åˆ°æŸä¸ªæ—¶é—´ç‚¹çš„æ—¶é—´, æ€»é•¿åº¦ä½¿ç”¨ç§’/çº³ç§’è¡¨ç¤º</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> &#123;</span></span><br><span class="line"><span class="type">time_t</span> tv_sec;      <span class="comment">/* Seconds */</span></span><br><span class="line"><span class="type">long</span>   tv_nsec;     <span class="comment">/* Nanoseconds [0 .. 999999999] */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// è°ƒç”¨è¯¥å‡½æ•°çº¿ç¨‹è·å–semä¸­çš„ä¸€ä¸ªèµ„æºï¼Œå½“èµ„æºæ•°ä¸º0æ—¶ï¼Œçº¿ç¨‹é˜»å¡ï¼Œåœ¨é˜»å¡abs_timeoutå¯¹åº”çš„æ—¶é•¿ä¹‹åï¼Œè§£é™¤é˜»å¡ã€‚</span></span><br><span class="line"><span class="comment">// abs_timeout: é˜»å¡çš„æ—¶é—´é•¿åº¦, å•ä½æ˜¯s, æ˜¯ä»1970.1.1å¼€å§‹è®¡ç®—çš„</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_timedwait</span><span class="params">(<span class="type">sem_t</span> *sem, <span class="type">const</span> <span class="keyword">struct</span> timespec *abs_timeout)</span>;</span><br></pre></td></tr></table></figure><ul><li>è¯¥å‡½æ•°çš„å‚æ•° abs_timeout å’Œ pthread_cond_timedwait çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨æ–¹æ³•ä¸å†è¿‡å¤šèµ˜è¿°ã€‚å½“çº¿ç¨‹è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸” sem ä¸­çš„èµ„æºæ•° &gt;0ï¼Œçº¿ç¨‹ä¸ä¼šé˜»å¡ï¼Œçº¿ç¨‹ä¼šå ç”¨ sem ä¸­çš„ä¸€ä¸ªèµ„æºï¼Œå› æ­¤èµ„æºæ•° - 1ï¼Œç›´åˆ° sem ä¸­çš„èµ„æºæ•°å‡ä¸º 0 æ—¶ï¼Œèµ„æºè¢«è€—å°½ï¼Œçº¿ç¨‹è¢«é˜»å¡ï¼Œå½“é˜»å¡æŒ‡å®šçš„æ—¶é•¿ä¹‹åï¼Œçº¿ç¨‹è§£é™¤é˜»å¡ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è°ƒç”¨è¯¥å‡½æ•°ç»™semä¸­çš„èµ„æºæ•°+1</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_post</span><span class="params">(<span class="type">sem_t</span> *sem)</span>;</span><br></pre></td></tr></table></figure><ul><li>è°ƒç”¨è¯¥å‡½æ•°ä¼šå°† sem ä¸­çš„èµ„æºæ•° +1ï¼Œå¦‚æœæœ‰çº¿ç¨‹åœ¨è°ƒç”¨ sem_waitã€sem_trywaitã€sem_timedwait æ—¶å› ä¸º sem ä¸­çš„èµ„æºæ•°ä¸º 0 è¢«é˜»å¡äº†ï¼Œè¿™æ—¶è¿™äº›çº¿ç¨‹ä¼šè§£é™¤é˜»å¡ï¼Œè·å–åˆ°èµ„æºä¹‹åç»§ç»­å‘ä¸‹è¿è¡Œã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥çœ‹ä¿¡å·é‡ sem ä¸­çš„æ•´å½¢æ•°çš„å½“å‰å€¼, è¿™ä¸ªå€¼ä¼šè¢«å†™å…¥åˆ°svalæŒ‡é’ˆå¯¹åº”çš„å†…å­˜ä¸­</span></span><br><span class="line"><span class="comment">// svalæ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sem_getvalue</span><span class="params">(<span class="type">sem_t</span> *sem, <span class="type">int</span> *sval)</span>;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡è¿™ä¸ªå‡½æ•°å¯ä»¥æŸ¥çœ‹ sem ä¸­ç°åœ¨æ‹¥æœ‰çš„èµ„æºä¸ªæ•°ï¼Œé€šè¿‡ç¬¬äºŒä¸ªå‚æ•° sval å°†æ•°æ®ä¼ å‡ºï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬äºŒä¸ªå‚æ•°çš„ä½œç”¨å’Œè¿”å›å€¼æ˜¯ä¸€æ ·çš„ã€‚</li></ul><h2 id="ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…-2">ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…</h2><p>ç”±äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ˜¯ä¸¤ç±»çº¿ç¨‹ï¼Œå¹¶ä¸”åœ¨è¿˜æ²¡æœ‰ç”Ÿæˆä¹‹å‰æ˜¯ä¸èƒ½è¿›è¡Œæ¶ˆè´¹çš„ï¼Œåœ¨ä½¿ç”¨ä¿¡å·é‡å¤„ç†è¿™ç±»é—®é¢˜çš„æ—¶å€™å¯ä»¥å®šä¹‰ä¸¤ä¸ªä¿¡å·é‡ï¼Œåˆ†åˆ«ç”¨äºè®°å½•ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹æ‹¥æœ‰çš„æ€»èµ„æºæ•°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”Ÿäº§è€…çº¿ç¨‹ </span></span><br><span class="line"><span class="type">sem_t</span> psem;</span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line"><span class="type">sem_t</span> csem;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿¡å·é‡åˆå§‹åŒ–</span></span><br><span class="line">sem_init(&amp;psem, <span class="number">0</span>, <span class="number">5</span>);    <span class="comment">// 5ä¸ªç”Ÿäº§è€…å¯ä»¥åŒæ—¶ç”Ÿäº§</span></span><br><span class="line">sem_init(&amp;csem, <span class="number">0</span>, <span class="number">0</span>);    <span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹æ²¡æœ‰èµ„æº, å› æ­¤ä¸èƒ½æ¶ˆè´¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…çº¿ç¨‹</span></span><br><span class="line"><span class="comment">// åœ¨ç”Ÿäº§ä¹‹å‰, ä»ä¿¡å·é‡ä¸­å–å‡ºä¸€ä¸ªèµ„æº</span></span><br><span class="line">sem_wait(&amp;psem);</span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…å•†å“ä»£ç , æœ‰å•†å“äº†, æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—</span></span><br><span class="line">...... </span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"><span class="comment">// é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç»™æ¶ˆè´¹è€…ä¿¡å·é‡æ·»åŠ èµ„æºï¼Œè®©æ¶ˆè´¹è€…è§£é™¤é˜»å¡</span></span><br><span class="line">sem_post(&amp;csem);<span class="comment">//æ¶ˆè´¹è€…èµ„æº+1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹</span></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…éœ€è¦ç­‰å¾…ç”Ÿäº§, é»˜è®¤å¯åŠ¨ä¹‹ååº”è¯¥é˜»å¡</span></span><br><span class="line">sem_wait(&amp;csem);<span class="comment">//ç”Ÿäº§è€…èµ„æº-1</span></span><br><span class="line"><span class="comment">// å¼€å§‹æ¶ˆè´¹</span></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"><span class="comment">// æ¶ˆè´¹å®Œæˆ, é€šè¿‡ç”Ÿäº§è€…ç”Ÿäº§ï¼Œç»™ç”Ÿäº§è€…ä¿¡å·é‡æ·»åŠ èµ„æº</span></span><br><span class="line">sem_post(&amp;psem);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„ä»£ç å¯ä»¥çŸ¥é“ï¼Œåˆå§‹åŒ–ä¿¡å·é‡çš„æ—¶å€™æ²¡æœ‰æ¶ˆè´¹è€…åˆ†é…èµ„æºï¼Œæ¶ˆè´¹è€…çº¿ç¨‹å¯åŠ¨ä¹‹åç”±äºæ²¡æœ‰èµ„æºè‡ªç„¶å°±è¢«é˜»å¡äº†ï¼Œç­‰ç”Ÿäº§è€…ç”Ÿäº§å‡ºäº§å“ä¹‹åï¼Œå†ç»™æ¶ˆè´¹è€…åˆ†é…èµ„æºï¼Œè¿™æ ·äºŒè€…å°±å¯ä»¥é…åˆç€å®Œæˆç”Ÿäº§å’Œæ¶ˆè´¹æµç¨‹äº†ã€‚</p><h2 id="ä¿¡å·é‡çš„ä½¿ç”¨">ä¿¡å·é‡çš„ä½¿ç”¨</h2><p><strong>åœºæ™¯æè¿°ï¼šä½¿ç”¨ä¿¡å·é‡å®ç°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ï¼Œç”Ÿäº§è€…æœ‰ 5 ä¸ªï¼Œå¾€é“¾è¡¨å¤´éƒ¨æ·»åŠ èŠ‚ç‚¹ï¼Œæ¶ˆè´¹è€…ä¹Ÿæœ‰ 5 ä¸ªï¼Œåˆ é™¤é“¾è¡¨å¤´éƒ¨çš„èŠ‚ç‚¹ã€‚</strong></p><h3 id="æ€»èµ„æºæ•°ä¸º1">æ€»èµ„æºæ•°ä¸º1</h3><p>å¦‚æœç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä½¿ç”¨çš„ä¿¡å·é‡å¯¹åº”çš„æ€»èµ„æºæ•°ä¸º 1ï¼Œé‚£ä¹ˆä¸ç®¡çº¿ç¨‹æœ‰å¤šå°‘ä¸ªï¼Œå¯ä»¥å·¥ä½œçš„çº¿ç¨‹åªæœ‰ä¸€ä¸ªï¼Œå…¶ä½™çº¿ç¨‹ç”±äºæ‹¿ä¸åˆ°èµ„æºï¼Œéƒ½è¢«è¿«é˜»å¡äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é“¾è¡¨çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…çº¿ç¨‹ä¿¡å·é‡</span></span><br><span class="line"><span class="type">sem_t</span> psem;</span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹ä¿¡å·é‡</span></span><br><span class="line"><span class="type">sem_t</span> csem;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº’æ–¥é”å˜é‡</span></span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"><span class="comment">// æŒ‡å‘å¤´ç»“ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> * <span class="title">head</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä¸€ç›´ç”Ÿäº§</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”Ÿäº§è€…æ‹¿ä¸€ä¸ªä¿¡å·ç¯</span></span><br><span class="line">        sem_wait(&amp;psem);</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªé“¾è¡¨çš„æ–°èŠ‚ç‚¹</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnew</span> =</span> (<span class="keyword">struct</span> Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</span><br><span class="line">        <span class="comment">// èŠ‚ç‚¹åˆå§‹åŒ–</span></span><br><span class="line">        pnew-&gt;number = rand() % <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">// èŠ‚ç‚¹çš„è¿æ¥, æ·»åŠ åˆ°é“¾è¡¨çš„å¤´éƒ¨, æ–°èŠ‚ç‚¹å°±æ–°çš„å¤´ç»“ç‚¹</span></span><br><span class="line">        pnew-&gt;next = head;</span><br><span class="line">        <span class="comment">// headæŒ‡é’ˆå‰ç§»</span></span><br><span class="line">        head = pnew;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;+++producer, number = %d, tid = %ld\n&quot;</span>, pnew-&gt;number, pthread_self());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹, ç»™æ¶ˆè´¹è€…åŠ ä¿¡å·ç¯</span></span><br><span class="line">        sem_post(&amp;csem);</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç”Ÿäº§æ…¢ä¸€ç‚¹</span></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sem_wait(&amp;csem);</span><br><span class="line">        <span class="comment">// å–å‡ºé“¾è¡¨çš„å¤´ç»“ç‚¹, å°†å…¶åˆ é™¤</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnode</span> =</span> head;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;--consumer: number: %d, tid = %ld\n&quot;</span>, pnode-&gt;number, pthread_self());</span><br><span class="line">        head  = pnode-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(pnode);</span><br><span class="line">        <span class="comment">// é€šçŸ¥ç”Ÿäº§è€…ç”Ÿæˆ, ç»™ç”Ÿäº§è€…åŠ ä¿¡å·ç¯</span></span><br><span class="line">        sem_post(&amp;psem);</span><br><span class="line"></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¿¡å·é‡</span></span><br><span class="line">    <span class="comment">// ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ‹¥æœ‰çš„ä¿¡å·ç¯çš„æ€»å’Œä¸º1</span></span><br><span class="line">    sem_init(&amp;psem, <span class="number">0</span>, <span class="number">1</span>);  <span class="comment">// ç”Ÿæˆè€…çº¿ç¨‹ä¸€å…±æœ‰1ä¸ªä¿¡å·ç¯</span></span><br><span class="line">    sem_init(&amp;csem, <span class="number">0</span>, <span class="number">0</span>);  <span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹ä¸€å…±æœ‰0ä¸ªä¿¡å·ç¯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º5ä¸ªç”Ÿäº§è€…, 5ä¸ªæ¶ˆè´¹è€…</span></span><br><span class="line">    <span class="type">pthread_t</span> ptid[<span class="number">5</span>];</span><br><span class="line">    <span class="type">pthread_t</span> ctid[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;ptid[i], <span class="literal">NULL</span>, producer, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;ctid[i], <span class="literal">NULL</span>, consumer, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(ptid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(ctid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sem_destroy(&amp;psem);</span><br><span class="line">    sem_destroy(&amp;csem);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é€šè¿‡æµ‹è¯•ä»£ç å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“è®ºï¼šå¦‚æœç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä½¿ç”¨çš„ä¿¡å·é‡æ€»èµ„æºæ•°ä¸º 1ï¼Œé‚£ä¹ˆä¸ä¼šå‡ºç°ç”Ÿäº§è€…çº¿ç¨‹å’Œæ¶ˆè´¹è€…çº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºçš„æƒ…å†µï¼Œä¸ç®¡ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹æœ‰å¤šå°‘ä¸ªï¼Œå®ƒä»¬éƒ½æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚</strong></p><h3 id="æ€»èµ„æºæ•°å¤§äº1">æ€»èµ„æºæ•°å¤§äº1</h3><p>å¦‚æœç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä½¿ç”¨çš„ä¿¡å·é‡å¯¹åº”çš„æ€»èµ„æºæ•°ä¸ºå¤§äº 1ï¼Œè¿™ç§åœºæ™¯ä¸‹å‡ºç°çš„æƒ…å†µå°±æ¯”è¾ƒå¤šäº†ï¼š</p><ul><li>å¤šä¸ªç”Ÿäº§è€…çº¿ç¨‹åŒæ—¶ç”Ÿäº§</li><li>å¤šä¸ªæ¶ˆè´¹è€…åŒæ—¶æ¶ˆè´¹</li><li>ç”Ÿäº§è€…çº¿ç¨‹å’Œæ¶ˆè´¹è€…çº¿ç¨‹åŒæ—¶ç”Ÿäº§å’Œæ¶ˆè´¹</li></ul><p>ä»¥ä¸Šä¸ç®¡å“ªä¸€ç§æƒ…å†µéƒ½å¯èƒ½ä¼šå‡ºç°å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„æƒ…å†µï¼Œå¦‚æœæƒ³é˜²æ­¢å…±äº«èµ„æºå‡ºç°æ•°æ®æ··ä¹±ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨äº’æ–¥é”è¿›è¡Œçº¿ç¨‹åŒæ­¥ï¼Œå¤„ç†ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é“¾è¡¨çš„èŠ‚ç‚¹</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…çº¿ç¨‹ä¿¡å·é‡</span></span><br><span class="line"><span class="type">sem_t</span> psem;</span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹ä¿¡å·é‡</span></span><br><span class="line"><span class="type">sem_t</span> csem;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº’æ–¥é”å˜é‡</span></span><br><span class="line"><span class="type">pthread_mutex_t</span> mutex;</span><br><span class="line"><span class="comment">// æŒ‡å‘å¤´ç»“ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> * <span class="title">head</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä¸€ç›´ç”Ÿäº§</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”Ÿäº§è€…æ‹¿ä¸€ä¸ªä¿¡å·ç¯</span></span><br><span class="line">        sem_wait(&amp;psem);</span><br><span class="line">        <span class="comment">// åŠ é”, è¿™å¥ä»£ç æ”¾åˆ° sem_wait()ä¸Šè¾¹, æœ‰å¯èƒ½ä¼šé€ æˆæ­»é”</span></span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªé“¾è¡¨çš„æ–°èŠ‚ç‚¹</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnew</span> =</span> (<span class="keyword">struct</span> Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</span><br><span class="line">        <span class="comment">// èŠ‚ç‚¹åˆå§‹åŒ–</span></span><br><span class="line">        pnew-&gt;number = rand() % <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">// èŠ‚ç‚¹çš„è¿æ¥, æ·»åŠ åˆ°é“¾è¡¨çš„å¤´éƒ¨, æ–°èŠ‚ç‚¹å°±æ–°çš„å¤´ç»“ç‚¹</span></span><br><span class="line">        pnew-&gt;next = head;</span><br><span class="line">        <span class="comment">// headæŒ‡é’ˆå‰ç§»</span></span><br><span class="line">        head = pnew;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;+++producer, number = %d, tid = %ld\n&quot;</span>, pnew-&gt;number, pthread_self());</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line">        sem_post(&amp;csem);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç”Ÿäº§æ…¢ä¸€ç‚¹</span></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sem_wait(&amp;csem);</span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>* <span class="title">pnode</span> =</span> head;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;--consumer: number: %d, tid = %ld\n&quot;</span>, pnode-&gt;number, pthread_self());</span><br><span class="line">        head  = pnode-&gt;next;</span><br><span class="line">        <span class="comment">// å–å‡ºé“¾è¡¨çš„å¤´ç»“ç‚¹, å°†å…¶åˆ é™¤</span></span><br><span class="line">        <span class="built_in">free</span>(pnode);</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">        <span class="comment">// é€šçŸ¥ç”Ÿäº§è€…ç”Ÿæˆ, ç»™ç”Ÿäº§è€…åŠ ä¿¡å·ç¯</span></span><br><span class="line">        sem_post(&amp;psem);</span><br><span class="line"></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¿¡å·é‡</span></span><br><span class="line">    sem_init(&amp;psem, <span class="number">0</span>, <span class="number">5</span>);  <span class="comment">// ç”Ÿæˆè€…çº¿ç¨‹ä¸€å…±æœ‰5ä¸ªä¿¡å·ç¯</span></span><br><span class="line">    sem_init(&amp;csem, <span class="number">0</span>, <span class="number">0</span>);  <span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹ä¸€å…±æœ‰0ä¸ªä¿¡å·ç¯</span></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–äº’æ–¥é”</span></span><br><span class="line">    pthread_mutex_init(&amp;mutex, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º5ä¸ªç”Ÿäº§è€…, 5ä¸ªæ¶ˆè´¹è€…</span></span><br><span class="line">    <span class="type">pthread_t</span> ptid[<span class="number">5</span>];</span><br><span class="line">    <span class="type">pthread_t</span> ctid[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;ptid[i], <span class="literal">NULL</span>, producer, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_create(&amp;ctid[i], <span class="literal">NULL</span>, consumer, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(ptid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_join(ctid[i], <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sem_destroy(&amp;psem);</span><br><span class="line">    sem_destroy(&amp;csem);</span><br><span class="line">    pthread_mutex_destroy(&amp;mutex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç¼–å†™ä¸Šè¿°ä»£ç çš„æ—¶å€™è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„æ˜¯äº‹é¡¹ï¼Œä¸ç®¡æ˜¯æ¶ˆè´¹è€…çº¿ç¨‹çš„å¤„ç†å‡½æ•°è¿˜æ˜¯ç”Ÿäº§è€…çº¿ç¨‹çš„å¤„ç†å‡½æ•°å†…éƒ¨æœ‰è¿™ä¹ˆä¸¤è¡Œä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¶ˆè´¹è€…</span></span><br><span class="line">sem_wait(&amp;csem);</span><br><span class="line">pthread_mutex_lock(&amp;mutex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿäº§è€…</span></span><br><span class="line">sem_wait(&amp;csem);</span><br><span class="line">pthread_mutex_lock(&amp;mutex);</span><br></pre></td></tr></table></figure><p><strong>è¿™ä¸¤è¡Œä»£ç çš„è°ƒç”¨é¡ºåºæ˜¯ä¸èƒ½é¢ å€’çš„ï¼Œå¦‚æœé¢ å€’è¿‡æ¥å°±æœ‰å¯èƒ½ä¼šé€ æˆæ­»é”ï¼Œä¸‹é¢æ¥åˆ†æä¸€ç§æ­»é”çš„åœºæ™¯ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span>* <span class="title function_">producer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä¸€ç›´ç”Ÿäº§</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        <span class="comment">// ç”Ÿäº§è€…æ‹¿ä¸€ä¸ªä¿¡å·ç¯</span></span><br><span class="line">        sem_wait(&amp;psem);</span><br><span class="line">......</span><br><span class="line">        ......</span><br><span class="line">        <span class="comment">// é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹</span></span><br><span class="line">        sem_post(&amp;csem);</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç”Ÿäº§æ…¢ä¸€ç‚¹</span></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¶ˆè´¹è€…çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">consumer</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        pthread_mutex_lock(&amp;mutex);</span><br><span class="line">        sem_wait(&amp;csem);</span><br><span class="line">......</span><br><span class="line">        ......</span><br><span class="line">        <span class="comment">// é€šçŸ¥ç”Ÿäº§è€…ç”Ÿæˆ, ç»™ç”Ÿäº§è€…åŠ ä¿¡å·ç¯</span></span><br><span class="line">        sem_post(&amp;psem);</span><br><span class="line">        pthread_mutex_unlock(&amp;mutex);</span><br><span class="line"></span><br><span class="line">        sleep(rand() % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä¿¡å·é‡</span></span><br><span class="line">    sem_init(&amp;psem, <span class="number">0</span>, <span class="number">5</span>);  <span class="comment">// ç”Ÿæˆè€…çº¿ç¨‹ä¸€å…±æœ‰5ä¸ªä¿¡å·ç¯</span></span><br><span class="line">    sem_init(&amp;csem, <span class="number">0</span>, <span class="number">0</span>);  <span class="comment">// æ¶ˆè´¹è€…çº¿ç¨‹ä¸€å…±æœ‰0ä¸ªä¿¡å·ç¯</span></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆå§‹åŒ–çŠ¶æ€ä¸‹æ¶ˆè´¹è€…çº¿ç¨‹æ²¡æœ‰ä»»åŠ¡ä¿¡å·é‡èµ„æºï¼Œå‡è®¾æŸä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹å…ˆè¿è¡Œï¼Œè°ƒç”¨ <strong>pthread_mutex_lock(&amp;mutex)</strong>; å¯¹äº’æ–¥é”åŠ é”æˆåŠŸï¼Œç„¶åè°ƒç”¨ <strong>sem_wait(&amp;csem)</strong>; ç”±äºæ²¡æœ‰èµ„æºï¼Œå› æ­¤è¢«é˜»å¡äº†ã€‚å…¶ä½™çš„æ¶ˆè´¹è€…çº¿ç¨‹ç”±äºæ²¡æœ‰æŠ¢åˆ°äº’æ–¥é”ï¼Œå› æ­¤è¢«é˜»å¡åœ¨äº’æ–¥é”ä¸Šã€‚å¯¹åº”ç”Ÿäº§è€…çº¿ç¨‹ç¬¬ä¸€æ­¥æ“ä½œä¹Ÿæ˜¯è°ƒç”¨ <strong>pthread_mutex_lock(&amp;mutex)</strong>;ï¼Œä½†æ˜¯è¿™æ—¶å€™äº’æ–¥é”å·²ç»è¢«æ¶ˆè´¹è€…çº¿ç¨‹é”ä¸Šäº†ï¼Œæ‰€æœ‰ç”Ÿäº§è€…éƒ½è¢«é˜»å¡ï¼Œåˆ°æ­¤ä¸ºæ­¢ï¼Œå¤šä½™çš„çº¿ç¨‹éƒ½è¢«é˜»å¡äº†ï¼Œç¨‹åºäº§ç”Ÿäº†æ­»é”ã€‚</p><p><strong>è¯·è®°ä½: å…ˆæ‹¿ä¿¡å·ç¯ï¼Œå†åŠ é”!!!</strong></p>]]></content>
    
    
    <summary type="html">çº¿ç¨‹åŒæ­¥</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>è™šæ‹Ÿåœ°å€ç©ºé—´</title>
    <link href="https://keqiudi.github.io/posts/fb84f8a3.html"/>
    <id>https://keqiudi.github.io/posts/fb84f8a3.html</id>
    <published>2023-07-14T10:22:13.000Z</published>
    <updated>2023-07-18T15:19:10.666Z</updated>
    
    <content type="html"><![CDATA[<h1>1.è™šæ‹Ÿåœ°å€ç©ºé—´</h1><p>è™šæ‹Ÿåœ°å€ç©ºé—´æ˜¯ä¸€ä¸ªéå¸¸æŠ½è±¡çš„æ¦‚å¿µï¼Œå…ˆæ ¹æ®å­—é¢æ„æ€è¿›è¡Œè§£é‡Šï¼š</p><ul><li>å®ƒå¯ä»¥ç”¨æ¥åŠ è½½ç¨‹åºæ•°æ®ï¼ˆæ•°æ®å¯èƒ½è¢«åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸Šï¼Œç©ºé—´ä¸å¤Ÿå°±åŠ è½½åˆ°è™šæ‹Ÿå†…å­˜ä¸­ï¼‰</li><li>å®ƒå¯¹åº”ç€ä¸€æ®µè¿ç»­çš„å†…å­˜åœ°å€ï¼Œèµ·å§‹ä½ç½®ä¸º 0ã€‚</li><li>ä¹‹æ‰€ä»¥è¯´è™šæ‹Ÿæ˜¯å› ä¸ºè¿™ä¸ªèµ·å§‹çš„ 0 åœ°å€æ˜¯è¢«è™šæ‹Ÿå‡ºæ¥çš„ï¼Œ ä¸æ˜¯ç‰©ç†å†…å­˜çš„ 0 åœ°å€</li></ul><p>è™šæ‹Ÿåœ°å€ç©ºé—´çš„å¤§å°ä¹Ÿç”±æ“ä½œç³»ç»Ÿå†³å®šï¼Œ32ä½çš„æ“ä½œç³»ç»Ÿè™šæ‹Ÿåœ°å€ç©ºé—´çš„å¤§å°ä¸º 232 å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯ 4Gï¼Œ64 ä½çš„æ“ä½œç³»ç»Ÿè™šæ‹Ÿåœ°å€ç©ºé—´å¤§å°ä¸º 264 å­—èŠ‚ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„æ•°ï¼Œæ„Ÿå…´è¶£å¯ä»¥è‡ªå·±è®¡ç®—ä¸€ä¸‹ã€‚å½“æˆ‘ä»¬è¿è¡Œç£ç›˜ä¸Šä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº, å°±ä¼šå¾—åˆ°ä¸€ä¸ªè¿›ç¨‹ï¼Œå†…æ ¸ä¼šç»™æ¯ä¸€ä¸ªè¿è¡Œçš„è¿›ç¨‹åˆ›å»ºä¸€å—å±äºè‡ªå·±çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå¹¶å°†åº”ç”¨ç¨‹åºæ•°æ®è£…è½½åˆ°è™šæ‹Ÿåœ°å€ç©ºé—´å¯¹åº”çš„åœ°å€ä¸Šã€‚</p><p>è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œç¨‹åºå†…éƒ¨æ‰€æœ‰çš„æŒ‡ä»¤éƒ½æ˜¯é€šè¿‡ CPU å¤„ç†å®Œæˆçš„ï¼ŒCPU åªè¿›è¡Œæ•°æ®è¿ç®—å¹¶ä¸å…·å¤‡æ•°æ®å­˜å‚¨çš„èƒ½åŠ›ï¼Œå…¶å¤„ç†çš„æ•°æ®éƒ½åŠ è½½è‡ªç‰©ç†å†…å­˜ï¼Œé‚£ä¹ˆè¿›ç¨‹ä¸­çš„æ•°æ®æ˜¯å¦‚ä½•è¿›å‡ºå…¥åˆ°ç‰©ç†å†…å­˜ä¸­çš„å‘¢ï¼Ÿå…¶å®æ˜¯é€šè¿‡ CPU ä¸­çš„å†…å­˜ç®¡ç†å•å…ƒ MMUï¼ˆMemory Management Unitï¼‰ä»è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æ˜ å°„è¿‡å»çš„ã€‚</p><h2 id="æ„ä¹‰">æ„ä¹‰</h2><p>é€šè¿‡ä¸Šè¾¹çš„ä»‹ç»å¤§å®¶ä¼šæ„Ÿè§‰åˆ°ä¸€å¤´é›¾æ°´ï¼Œ ä¸ºä»€ä¹ˆæ“ä½œç³»ç»Ÿä¸ç›´æ¥å°†æ•°æ®åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸­è€Œæ˜¯å°†æ•°æ®åŠ è½½åˆ°è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼Œåœ¨é€šè¿‡ CPU çš„ MMU æ˜ å°„åˆ°ç‰©ç†å†…å­˜ä¸­å‘¢ï¼Ÿ</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹å¦‚æœç›´æ¥å°†æ•°æ®åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼š</p><p><strong>å‡è®¾è®¡ç®—æœºçš„ç‰©ç†å†…å­˜å¤§å°ä¸º 1G, è¿›ç¨‹ A éœ€è¦ 100M å†…å­˜å› æ­¤ç›´æ¥åœ¨ç‰©ç†å†…å­˜ä¸Šä» 0 åœ°å€å¼€å§‹åˆ†é… 100M, è¿›ç¨‹ B å¯åŠ¨éœ€è¦ 250M å†…å­˜ï¼Œå› æ­¤ç»§ç»­åœ¨ç‰©ç†å†…å­˜ä¸Šä¸ºå…¶åˆ†é… 250M å†…å­˜ï¼Œå¹¶ä¸”è¿›ç¨‹ A å’Œè¿›ç¨‹ B å ç”¨çš„å†…å­˜æ˜¯è¿ç»­çš„ã€‚ä¹‹åå†å¯åŠ¨å…¶ä»–è¿›ç¨‹ç»§ç»­æŒ‰ç…§è¿™ç§æ–¹æ³•è¿›è¡Œç‰©ç†å†…å­˜çš„åˆ†é…ã€‚</strong></p><p>ä½¿ç”¨è¿™ç§æ–¹å¼åˆ†é…å†…å­˜ä¼šæœ‰å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><p>1.æ¯ä¸ªè¿›ç¨‹çš„åœ°å€ä¸éš”ç¦»ï¼Œæœ‰å®‰å…¨é£é™©ã€‚</p><p>ç”±äºç¨‹åºéƒ½æ˜¯ç›´æ¥è®¿é—®ç‰©ç†å†…å­˜ï¼Œæ‰€ä»¥æ¶æ„ç¨‹åºå¯ä»¥é€šè¿‡å†…å­˜å¯»å€éšæ„ä¿®æ”¹åˆ«çš„è¿›ç¨‹å¯¹åº”çš„å†…å­˜æ•°æ®ï¼Œä»¥è¾¾åˆ°ç ´åçš„ç›®çš„ã€‚è™½ç„¶æœ‰äº›æ—¶å€™æ˜¯éæ¶æ„çš„ï¼Œä½†æ˜¯æœ‰äº›å­˜åœ¨ bug çš„ç¨‹åºå¯èƒ½ä¸å°å¿ƒä¿®æ”¹äº†å…¶å®ƒç¨‹åºçš„å†…å­˜æ•°æ®ï¼Œå°±ä¼šå¯¼è‡´å…¶å®ƒç¨‹åºçš„è¿è¡Œå‡ºç°å¼‚å¸¸ã€‚</p><p>2.å†…å­˜æ•ˆç‡ä½ã€‚</p><p>å¦‚æœç›´æ¥ä½¿ç”¨ç‰©ç†å†…å­˜çš„è¯ï¼Œä¸€ä¸ªè¿›ç¨‹å¯¹åº”çš„å†…å­˜å—å°±æ˜¯ä½œä¸ºä¸€ä¸ªæ•´ä½“æ“ä½œçš„ï¼Œå¦‚æœå‡ºç°ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬çš„åŠæ³•æ˜¯å°†ä¸å¸¸ç”¨çš„è¿›ç¨‹æ‹·è´åˆ°ç£ç›˜çš„äº¤æ¢åˆ†åŒºï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰ä¸­ï¼Œä»¥ä¾¿è…¾å‡ºå†…å­˜ï¼Œå› æ­¤å°±éœ€è¦å°†æ•´ä¸ªè¿›ç¨‹ä¸€èµ·æ‹·èµ°ï¼Œå¦‚æœæ•°æ®é‡å¤§ï¼Œåœ¨å†…å­˜å’Œç£ç›˜ä¹‹é—´æ‹·è´æ—¶é—´å°±ä¼šå¾ˆé•¿ï¼Œæ•ˆç‡ä½ä¸‹ã€‚</p><p>3.è¿›ç¨‹ä¸­æ•°æ®çš„åœ°å€ä¸ç¡®å®šï¼Œæ¯æ¬¡éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p>ç”±äºç‰©ç†å†…å­˜çš„ä½¿ç”¨æƒ…å†µä¸€ç›´åœ¨åŠ¨æ€çš„å˜åŒ–ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šå†…å­˜ç°åœ¨ä½¿ç”¨åˆ°å“ªé‡Œäº†ï¼Œå¦‚æœç›´æ¥å°†ç¨‹åºæ•°æ®åŠ è½½åˆ°ç‰©ç†å†…å­˜ï¼Œå†…å­˜ä¸­æ¯æ¬¡å­˜å‚¨æ•°æ®çš„èµ·å§‹åœ°å€éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™æ ·æ•°æ®çš„åŠ è½½éƒ½éœ€è¦ä½¿ç”¨ç›¸å¯¹åœ°å€ï¼ŒåŠ è½½æ•ˆç‡ä½ï¼ˆé™æ€åº“æ˜¯ä½¿ç”¨ç»å¯¹åœ°å€åŠ è½½çš„ï¼‰ã€‚</p><p>æ€»ç»“ï¼šæœ‰äº†è™šæ‹Ÿåœ°å€ç©ºé—´ä¹‹åå°±å¯ä»¥å®Œç¾çš„è§£å†³ä¸Šè¾¹æåˆ°çš„æ‰€æœ‰é—®é¢˜äº†ï¼Œ**è™šæ‹Ÿåœ°å€ç©ºé—´å°±æ˜¯ä¸€ä¸ªä¸­é—´å±‚ï¼Œç›¸å½“äºåœ¨ç¨‹åºå’Œç‰©ç†å†…å­˜ä¹‹é—´è®¾ç½®äº†ä¸€ä¸ªå±éšœï¼Œå°†äºŒè€…éš”ç¦»å¼€æ¥ã€‚ç¨‹åºä¸­è®¿é—®çš„å†…å­˜åœ°å€ä¸å†æ˜¯å®é™…çš„ç‰©ç†å†…å­˜åœ°å€ï¼Œè€Œæ˜¯ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œç„¶åç”±æ“ä½œç³»ç»Ÿå°†è¿™ä¸ªè™šæ‹Ÿåœ°å€æ˜ å°„åˆ°é€‚å½“çš„ç‰©ç†å†…å­˜åœ°å€ä¸Šã€‚**è¿™æ ·ï¼Œåªè¦æ“ä½œç³»ç»Ÿå¤„ç†å¥½è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†å†…å­˜åœ°å€çš„æ˜ å°„ï¼Œå°±å¯ä»¥ä¿è¯ä¸åŒçš„ç¨‹åºæœ€ç»ˆè®¿é—®çš„å†…å­˜åœ°å€ä½äºä¸åŒçš„åŒºåŸŸï¼Œå½¼æ­¤æ²¡æœ‰é‡å ï¼Œå°±å¯ä»¥è¾¾åˆ°å†…å­˜åœ°å€ç©ºé—´éš”ç¦»çš„æ•ˆæœã€‚</p><h2 id="åˆ†åŒº">åˆ†åŒº</h2><p>ä»æ“ä½œç³»ç»Ÿå±‚çº§ä¸Šçœ‹ï¼Œè™šæ‹Ÿåœ°å€ç©ºé—´ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†<strong>å†…æ ¸åŒº</strong>å’Œ<strong>ç”¨æˆ·åŒº</strong>ã€‚</p><ul><li>å†…æ ¸åŒºï¼š<ul><li>å†…æ ¸ç©ºé—´ä¸ºå†…æ ¸ä¿ç•™ï¼Œä¸å…è®¸åº”ç”¨ç¨‹åºè¯»å†™è¯¥åŒºåŸŸçš„å†…å®¹æˆ–ç›´æ¥è°ƒç”¨å†…æ ¸ä»£ç å®šä¹‰çš„å‡½æ•°ã€‚</li><li>å†…æ ¸æ€»æ˜¯é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œæ˜¯æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚</li><li>ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹å¯¹åº”çš„è™šæ‹Ÿåœ°å€ç©ºé—´çš„å†…æ ¸åŒºéƒ½ä¼šæ˜ å°„åˆ°åŒä¸€å—ç‰©ç†å†…å­˜ä¸Šï¼ˆç³»ç»Ÿå†…æ ¸åªæœ‰ä¸€ä¸ªï¼‰ã€‚</li></ul></li></ul><p><img src="https://subingwen.cn/linux/file-descriptor/image-20210130093015907.png" alt="img"></p><p>æ¯ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´éƒ½æ˜¯ä» 0 åœ°å€å¼€å§‹çš„ï¼Œæˆ‘ä»¬åœ¨ç¨‹åºä¸­æ‰“å°çš„å˜é‡åœ°å€ä¹Ÿå…¶åœ¨è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„åœ°å€ï¼Œç¨‹åºæ˜¯æ— æ³•ç›´æ¥è®¿é—®ç‰©ç†å†…å­˜çš„ã€‚è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ç”¨æˆ·åŒºåœ°å€èŒƒå›´æ˜¯ 0~3Gï¼Œé‡Œè¾¹åˆ†ä¸ºå¤šä¸ªåŒºå—ï¼š</p><ul><li><p>ä¿ç•™åŒº: ä½äºè™šæ‹Ÿåœ°å€ç©ºé—´çš„æœ€åº•éƒ¨ï¼Œæœªèµ‹äºˆç‰©ç†åœ°å€ã€‚ä»»ä½•å¯¹å®ƒçš„å¼•ç”¨éƒ½æ˜¯éæ³•çš„ï¼Œç¨‹åºä¸­çš„ç©ºæŒ‡é’ˆï¼ˆNULLï¼‰æŒ‡å‘çš„å°±æ˜¯è¿™å—å†…å­˜åœ°å€ã€‚</p></li><li><p>.textæ®µ: ä»£ç æ®µä¹Ÿç§°æ­£æ–‡æ®µæˆ–æ–‡æœ¬æ®µï¼Œé€šå¸¸ç”¨äºå­˜æ”¾ç¨‹åºçš„æ‰§è¡Œä»£ç  (å³ CPU æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤)ï¼Œä»£ç æ®µä¸€èˆ¬æƒ…å†µä¸‹æ˜¯åªè¯»çš„ï¼Œè¿™æ˜¯å¯¹æ‰§è¡Œä»£ç çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚</p></li><li><p>.dataæ®µ: æ•°æ®æ®µé€šå¸¸ç”¨äºå­˜æ”¾ç¨‹åºä¸­å·²åˆå§‹åŒ–ä¸”åˆå€¼ä¸ä¸º 0 çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ã€‚æ•°æ®æ®µå±äºé™æ€å†…å­˜åˆ†é… (é™æ€å­˜å‚¨åŒº)ï¼Œå¯è¯»å¯å†™ã€‚</p></li><li><p>.bssæ®µ: æœªåˆå§‹åŒ–ä»¥åŠåˆå§‹ä¸º 0 çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†è¿™äº›æœªåˆå§‹åŒ–å˜é‡åˆå§‹åŒ–ä¸º 0</p></li><li><p>å †(heap)ï¼šç”¨äºå­˜æ”¾è¿›ç¨‹è¿è¡Œæ—¶åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚</p><ul><li><p>å †ä¸­å†…å®¹æ˜¯åŒ¿åçš„ï¼Œä¸èƒ½æŒ‰åå­—ç›´æ¥è®¿é—®ï¼Œåªèƒ½é€šè¿‡æŒ‡é’ˆé—´æ¥è®¿é—®ã€‚</p></li><li><p>å †å‘é«˜åœ°å€æ‰©å±• (å³ â€œå‘ä¸Šç”Ÿé•¿â€)ï¼Œæ˜¯ä¸è¿ç»­çš„å†…å­˜åŒºåŸŸã€‚è¿™æ˜¯ç”±äºç³»ç»Ÿç”¨é“¾è¡¨æ¥å­˜å‚¨ç©ºé—²å†…å­˜åœ°å€ï¼Œè‡ªç„¶ä¸è¿ç»­ï¼Œè€Œé“¾è¡¨ä»ä½åœ°å€å‘é«˜åœ°å€éå†ã€‚</p></li></ul></li><li><p>å†…å­˜æ˜ å°„åŒº(mmap)ï¼šä½œä¸ºå†…å­˜æ˜ å°„åŒºåŠ è½½ç£ç›˜æ–‡ä»¶ï¼Œæˆ–è€…åŠ è½½ç¨‹åºè¿ä½œè¿‡ç¨‹ä¸­éœ€è¦è°ƒç”¨çš„åŠ¨æ€åº“ã€‚</p></li><li><p>æ ˆ(stack): å­˜å‚¨å‡½æ•°å†…éƒ¨å£°æ˜çš„éé™æ€å±€éƒ¨å˜é‡ï¼Œå‡½æ•°å‚æ•°ï¼Œå‡½æ•°è¿”å›åœ°å€ç­‰ä¿¡æ¯ï¼Œæ ˆå†…å­˜ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ã€‚æ ˆå’Œå †ç›¸ååœ°å€ â€œå‘ä¸‹ç”Ÿé•¿â€ï¼Œåˆ†é…çš„å†…å­˜æ˜¯è¿ç»­çš„ã€‚</p></li><li><p>å‘½ä»¤è¡Œå‚æ•°ï¼šå­˜å‚¨è¿›ç¨‹æ‰§è¡Œçš„æ—¶å€™ä¼ é€’ç»™ main() å‡½æ•°çš„å‚æ•°ï¼Œargcï¼Œargv []</p></li><li><p>ç¯å¢ƒå˜é‡: å­˜å‚¨å’Œè¿›ç¨‹ç›¸å…³çš„ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚ï¼šå·¥ä½œè·¯å¾„ï¼Œè¿›ç¨‹æ‰€æœ‰è€…ç­‰ä¿¡æ¯</p></li></ul>]]></content>
    
    
    <summary type="html">è™šæ‹Ÿåœ°å€ç©ºé—´æ¦‚è¿°</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>å¤šçº¿ç¨‹</title>
    <link href="https://keqiudi.github.io/posts/15fc6e8c.html"/>
    <id>https://keqiudi.github.io/posts/15fc6e8c.html</id>
    <published>2023-07-14T09:01:14.000Z</published>
    <updated>2023-07-18T15:20:54.802Z</updated>
    
    <content type="html"><![CDATA[<h1>1.çº¿ç¨‹æ¦‚è¿°</h1><ul><li><p><strong>å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹éƒ½èƒ½å¤Ÿæé«˜ç¨‹åºçš„å¹¶å‘æ€§ï¼Œä½†å¤šçº¿ç¨‹å¯¹ç³»ç»Ÿèµ„æºæ¶ˆè€—æ›´å°‘ï¼Œä¸”å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹æ•ˆç‡éƒ½æ˜¯å·®ä¸å¤šçš„</strong></p></li><li><p>cpuä¼šå°†å•ä½æ—¶é—´åˆ†ä¸ºå¾ˆå¤šä»½ï¼Œæ¯ä¸€ä»½å«æ—¶é—´ç‰‡ï¼Œç”±ç³»ç»Ÿè¿›è¡Œè°ƒåº¦ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶éƒ½éœ€è¦æŠ¢æ—¶é—´ç‰‡ï¼ŒæŠ¢åˆ°çš„çº¿ç¨‹å°±æ‰§è¡Œæˆä¸º<strong>è¿è¡Œæ€</strong>ï¼Œæ²¡æŠ¢åˆ°å°±å¤„äº<strong>å°±ç»ªæ€</strong>ï¼Œæ‰§è¡Œå®Œä¹‹ååˆæˆä¸ºå°±ç»ªæ€ç»§ç»­æŠ¢æ—¶é—´ç‰‡ï¼ˆéƒ½æ˜¯éšæœºçš„ï¼Œæ— åºè¿è¡Œï¼‰ã€‚</p></li></ul><div class="tip "><p>çº¿ç¨‹æ˜¯è½»é‡çº§çš„è¿›ç¨‹ï¼ˆLWPï¼šlight weight processï¼‰ï¼Œåœ¨ Linux ç¯å¢ƒä¸‹çº¿ç¨‹çš„æœ¬è´¨ä»æ˜¯è¿›ç¨‹ã€‚åœ¨è®¡ç®—æœºä¸Šè¿è¡Œçš„ç¨‹åºæ˜¯ä¸€ç»„æŒ‡ä»¤åŠæŒ‡ä»¤å‚æ•°çš„ç»„åˆï¼ŒæŒ‡ä»¤æŒ‰ç…§æ—¢å®šçš„é€»è¾‘æ§åˆ¶è®¡ç®—æœºè¿è¡Œã€‚æ“ä½œç³»ç»Ÿä¼šä»¥è¿›ç¨‹ä¸ºå•ä½ï¼Œåˆ†é…ç³»ç»Ÿèµ„æºï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼Œ<strong>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦æ‰§è¡Œçš„æœ€å°å•ä½ã€‚</strong></p></div><p>å…ˆä»æ¦‚å¿µä¸Šäº†è§£ä¸€ä¸‹çº¿ç¨‹å’Œè¿›ç¨‹ä¹‹é—´çš„åŒºåˆ«ï¼š</p><ul><li><p>è¿›ç¨‹æœ‰è‡ªå·±<strong>ç‹¬ç«‹</strong>çš„åœ°å€ç©ºé—´ï¼Œå¤šä¸ªçº¿ç¨‹<strong>å…±ç”¨</strong>åŒä¸€ä¸ªåœ°å€ç©ºé—´</p><ul><li><p>çº¿ç¨‹æ›´åŠ èŠ‚çœç³»ç»Ÿèµ„æºï¼Œæ•ˆç‡ä¸ä»…å¯ä»¥ä¿æŒçš„ï¼Œè€Œä¸”èƒ½å¤Ÿæ›´é«˜</p></li><li><p>åœ¨ä¸€ä¸ª<strong>åœ°å€ç©ºé—´</strong>ä¸­å¤šä¸ªçº¿ç¨‹<strong>ç‹¬äº«</strong>ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å±äºè‡ªå·±çš„æ ˆåŒºï¼Œå¯„å­˜å™¨ (å†…æ ¸ä¸­ç®¡ç†çš„)</p></li><li><p>åœ¨ä¸€ä¸ª<strong>åœ°å€ç©ºé—´</strong>ä¸­å¤šä¸ªçº¿ç¨‹<strong>å…±äº«</strong>ï¼šä»£ç æ®µï¼Œå †åŒºï¼Œå…¨å±€æ•°æ®åŒºï¼Œæ‰“å¼€çš„æ–‡ä»¶ (æ–‡ä»¶æè¿°ç¬¦è¡¨) éƒ½æ˜¯çº¿ç¨‹å…±äº«çš„</p></li></ul><p>(è¯¦ç»†è§blogç¯‡)è™šæ‹Ÿåœ°å€ç©ºé—´ï¼šäºæ¯ä¸€ä¸ªç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼ˆå¦‚a.outï¼‰ï¼Œæ­¤æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç›¸åº”çš„è¿›ç¨‹ï¼Œç³»ç»Ÿéƒ½ä¼šè‡ªåŠ¨ä¸ºå…¶åˆ†é…ä¸€ä¸ª0~4Gçš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå…¶ä¸­1Gçš„å†…æ ¸ç©ºé—´ç”¨äºï¼šè¿›ç¨‹ç®¡ç†ã€å†…å­˜ç®¡ç†ã€è®¾å¤‡ç®¡ç†å’Œè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç­‰ã€‚</p><p>ä¸‹é¢è¯¦ç»†ä»‹ç»0~3Gçš„ç”¨æˆ·ç©ºé—´ï¼š</p><pre><code>     å¼ºè°ƒä¸€ç‚¹ï¼šä»¥ä¸‹è¯´æ˜çš„å„æ®µéƒ½æ˜¯ä¸ç¼–ç¨‹ç›¸å…³çš„ï¼Œä¸åŒ…æ‹¬è™šæ‹Ÿåœ°å€ç©ºé—´çš„å…¨éƒ¨ã€‚    0~3Gçš„ç”¨æˆ·ç©ºé—´ã€‚ä»å°åˆ°å¤§ï¼ˆä»ä¸‹å¾€ä¸Šï¼‰ä¾æ¬¡ä¸ºï¼šä¿ç•™åŒºï¼ˆå—ä¿æŠ¤çš„åœ°å€ï¼‰ã€ä»£ç æ®µã€æ•°æ®æ®µï¼ˆ.dataæ®µï¼‰ã€.bssæ®µã€å †ç©ºé—´ã€å†…å­˜æ˜ å°„æ®µã€æ ˆç©ºé—´ã€å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚ä¸‹é¢ä¾æ¬¡å¯¹æ¯ä¸€ä¸ªæ®µåšç®€å•çš„ä»‹ç»ï¼š</code></pre></li><li><p>çº¿ç¨‹æ˜¯ç¨‹åºçš„æœ€å°æ‰§è¡Œå•ä½ï¼Œè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­æœ€å°çš„èµ„æºåˆ†é…å•ä½</p><ul><li><p>æ¯ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹åªèƒ½æŠ¢ä¸€ä¸ª CPU æ—¶é—´ç‰‡</p></li><li><p>ä¸€ä¸ªåœ°å€ç©ºé—´ä¸­å¯ä»¥åˆ’åˆ†å‡ºå¤šä¸ªçº¿ç¨‹ï¼Œåœ¨æœ‰æ•ˆçš„èµ„æºåŸºç¡€ä¸Šï¼Œèƒ½å¤ŸæŠ¢æ›´å¤šçš„ CPU æ—¶é—´ç‰‡</p></li></ul></li><li><p>CPU çš„è°ƒåº¦å’Œåˆ‡æ¢ï¼šçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢æ¯”è¿›ç¨‹è¦å¿«çš„å¤š</p><p>ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼šè¿›ç¨‹ / çº¿ç¨‹åˆ†æ—¶å¤ç”¨ CPU æ—¶é—´ç‰‡ï¼Œåœ¨åˆ‡æ¢ä¹‹å‰ä¼šå°†ä¸Šä¸€ä¸ªä»»åŠ¡çš„çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œä¸‹æ¬¡åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼ŒåŠ è½½è¿™ä¸ªçŠ¶æ€ç»§ç»­è¿è¡Œï¼Œä»»åŠ¡ä»ä¿å­˜åˆ°å†æ¬¡åŠ è½½è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p></li><li><p>çº¿ç¨‹æ›´åŠ å»‰ä»·ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«ï¼Œé€€å‡ºä¹Ÿå¿«ï¼Œå¯¹ç³»ç»Ÿèµ„æºçš„å†²å‡»å°ã€‚</p><p><strong>ä¸€èˆ¬è€ƒè™‘å¤šçº¿ç¨‹ï¼Œåªæ‰§è¡Œä»»åŠ¡çš„è¯ï¼Œè€ƒè™‘å¤šçº¿ç¨‹</strong></p><p><strong>å½“åŒæ—¶å¯åŠ¨å¤šä¸ªç¨‹åºæ—¶ï¼Œè€ƒè™‘å¤šè¿›ç¨‹</strong></p><div class="tip "><p><strong>åœ¨å¤„ç†å¤šä»»åŠ¡ç¨‹åºçš„æ—¶å€™ä½¿ç”¨å¤šçº¿ç¨‹æ¯”ä½¿ç”¨å¤šè¿›ç¨‹è¦æ›´æœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯çº¿ç¨‹å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œå¦‚ä½•æ§åˆ¶çº¿ç¨‹çš„ä¸ªæ•°å‘¢ï¼Ÿ</strong></p></div><p>1.æ–‡ä»¶ IO æ“ä½œï¼šæ–‡ä»¶ IO å¯¹ CPU æ˜¯ä½¿ç”¨ç‡ä¸é«˜ï¼Œå› æ­¤å¯ä»¥åˆ†æ—¶å¤ç”¨ CPU æ—¶é—´ç‰‡ï¼Œçº¿ç¨‹çš„ä¸ªæ•° = 2 * CPU æ ¸å¿ƒæ•° (æ•ˆç‡æœ€é«˜)</p><p>2.å¤„ç†å¤æ‚çš„ç®—æ³• (ä¸»è¦æ˜¯ CPU è¿›è¡Œè¿ç®—ï¼Œå‹åŠ›å¤§)ï¼Œçº¿ç¨‹çš„ä¸ªæ•° = CPU çš„æ ¸å¿ƒæ•° (æ•ˆç‡æœ€é«˜)</p></li></ul><h1>2.åˆ›å»ºçº¿ç¨‹</h1><h2 id="çº¿ç¨‹å‡½æ•°">çº¿ç¨‹å‡½æ•°</h2><p>æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹ IDï¼ŒID ç±»å‹ä¸º <strong>pthread_t</strong>ï¼Œè¿™ä¸ª ID æ˜¯ä¸€ä¸ª<strong>æ— ç¬¦å·é•¿æ•´å½¢æ•°</strong>ï¼Œå¦‚æœæƒ³è¦å¾—åˆ°å½“å‰çº¿ç¨‹çš„çº¿ç¨‹ IDï¼Œå¯ä»¥è°ƒç”¨å¦‚ä¸‹å‡½æ•°ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ<span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span>ï¼‰<span class="function"><span class="type">pthread_t</span> <span class="title">pthread_self</span><span class="params">(<span class="type">void</span>)</span></span>;<span class="comment">// è¿”å›å½“å‰çº¿ç¨‹çš„çº¿ç¨‹ID</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è°ƒç”¨çº¿ç¨‹åˆ›å»ºå‡½æ•°ï¼Œå°±å¯å¾—åˆ°ä¸€ä¸ªå­çº¿ç¨‹ï¼Œå’Œè¿›ç¨‹ä¸åŒï¼Œéœ€è¦ç»™æ¯ä¸€ä¸ªåˆ›å»ºå‡ºçš„çº¿ç¨‹æŒ‡å®šä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œå¦åˆ™è¿™ä¸ªçº¿ç¨‹æ— æ³•å·¥ä½œã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span> <span class="comment">//çº¿ç¨‹åº“</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">pthread_create</span><span class="params">(<span class="type">pthread_t</span> *thread, <span class="type">const</span> <span class="type">pthread_attr_t</span> *attr,</span></span></span><br><span class="line"><span class="params"><span class="function">                   <span class="type">void</span> *(*start_routine) (<span class="type">void</span> *), <span class="type">void</span> *arg)</span></span>;</span><br><span class="line"><span class="comment">// Compile and link with -pthread, çº¿ç¨‹åº“çš„åå­—å«pthread</span></span><br><span class="line"><span class="comment">//å…¨å: libpthread.so libptread.a</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>å‚æ•°:<ul><li>thread: ä¼ å‡ºå‚æ•°ï¼Œæ˜¯æ— ç¬¦å·é•¿æ•´å½¢æ•°ï¼Œçº¿ç¨‹åˆ›å»ºæˆåŠŸï¼Œä¼šå°†çº¿ç¨‹ ID å†™å…¥åˆ°è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸­</li><li>attr: çº¿ç¨‹çš„å±æ€§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨é»˜è®¤å±æ€§å³å¯ï¼Œå†™ NULL</li><li>start_routine: å‡½æ•°æŒ‡é’ˆï¼Œåˆ›å»ºå‡ºçš„å­çº¿ç¨‹çš„å¤„ç†åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯è¯¥ï¼ˆå›è°ƒå‡½æ•°ï¼‰å·¥ä½œå‡½æ•°åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</li><li>arg: ä½œä¸ºå®å‚ä¼ é€’åˆ° start_routine æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°å†…éƒ¨ï¼Œå·¥ä½œå‡½æ•°çš„å‚æ•°ï¼Œä¼šè‡ªåŠ¨ä¼ å…¥</li></ul></li></ul><p>è¿”å›å€¼ï¼šçº¿ç¨‹åˆ›å»ºæˆåŠŸè¿”å› 0ï¼Œåˆ›å»ºå¤±è´¥è¿”å›å¯¹åº”çš„é”™è¯¯å·</p><div class="note warning flat"><p>æ³¨æ„ï¼š1.å›è°ƒå‡½æ•°è¿”å›å€¼ä¸ºvoid *å‹ï¼Œå‚æ•°ä¸ºvoid * argã€‚2.å›è°ƒå‡½æ•° çš„å‚æ•°å½“æœ‰å¤šä¸ªæ—¶ï¼Œå¯ä»¥ç”¨ç»“æ„ä½“å‚¨å­˜ï¼Œå†å°†è¯¥ç»“æ„ä½“ä¼ å…¥</p></div><h2 id="åˆ›å»ºçº¿ç¨‹">åˆ›å»ºçº¿ç¨‹</h2><p>ä¸‹é¢æ˜¯åˆ›å»ºçº¿ç¨‹çš„ç¤ºä¾‹ä»£ç ï¼Œåœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ä¸€å®šè¦ä¿è¯ç¼–å†™çš„çº¿ç¨‹å‡½æ•°ä¸è§„å®šçš„å‡½æ•°æŒ‡é’ˆç±»å‹ä¸€è‡´ï¼š<strong>void *(*start_routine) (void *)</strong>:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pthread_create.c </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span><span class="comment">//sleepå‡½æ•°æ‰€åœ¨å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child == i: = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¼‘æ¯, ä¼‘æ¯ä¸€ä¼šå„¿...</span></span><br><span class="line">    <span class="comment">// sleep(1);</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>linuxä¸‹ç¼–è¯‘æµ‹è¯•ç¨‹åºï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹é”™è¯¯ä¿¡æ¯:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gcc pthread_create.c</span> </span><br><span class="line">/tmp/cctkubA6.o: In function `main&#x27;:</span><br><span class="line">pthread_create.c:(.text+0x7f): undefined reference to `pthread_create&#x27;</span><br><span class="line">collect2: error: ld returned 1 exit status</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é”™è¯¯åŸå› æ˜¯å› ä¸ºç¼–è¯‘å™¨é“¾æ¥ä¸åˆ°çº¿ç¨‹åº“æ–‡ä»¶ï¼ˆåŠ¨æ€åº“ï¼‰ï¼Œéœ€è¦åœ¨ç¼–è¯‘çš„æ—¶å€™é€šè¿‡å‚æ•°æŒ‡å®šå‡ºæ¥ï¼ŒåŠ¨æ€åº“åä¸º <a href="http://libpthread.so">libpthread.so</a> éœ€è¦ä½¿ç”¨çš„å‚æ•°ä¸º -lï¼Œæ ¹æ®è§„åˆ™æå¤´å»å°¾æœ€ç»ˆå½¢æ€åº”è¯¥å†™æˆï¼š-lpthreadï¼ˆå‚æ•°å’Œå‚æ•°å€¼ä¸­é—´å¯ä»¥æœ‰ç©ºæ ¼ï¼‰ã€‚æ­£ç¡®çš„ç¼–è¯‘å‘½ä»¤ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pthread_create å‡½æ•°çš„å®šä¹‰åœ¨æŸä¸€ä¸ªåº“ä¸­, ç¼–è¯‘çš„æ—¶å€™éœ€è¦åŠ åº“å pthread</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gcc pthread_create.c -lpthread</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./a.out</span> </span><br><span class="line">å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: 139712560109312</span><br><span class="line">æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: 139712568477440</span><br><span class="line">i = 0</span><br><span class="line">i = 1</span><br><span class="line">i = 2</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note warning flat"><p>æ³¨æ„ï¼šåœ¨æ‰“å°çš„æ—¥å¿—è¾“å‡ºä¸­ä¸ºä»€ä¹ˆå­çº¿ç¨‹å¤„ç†å‡½æ•°æ²¡æœ‰æ‰§è¡Œå®Œæ¯•å‘¢ï¼ˆåªçœ‹åˆ°äº†å­çº¿ç¨‹çš„éƒ¨åˆ†æ—¥å¿—è¾“å‡ºï¼‰ï¼Ÿ<br>ä¸»çº¿ç¨‹ä¸€ç›´åœ¨è¿è¡Œï¼Œæ‰§è¡ŒæœŸé—´åˆ›å»ºå‡ºäº†å­çº¿ç¨‹ï¼Œè¯´æ˜ä¸»çº¿ç¨‹æœ‰ CPU æ—¶é—´ç‰‡ï¼Œåœ¨è¿™ä¸ªæ—¶é—´ç‰‡å†…å°†ä»£ç æ‰§è¡Œå®Œæ¯•äº†ï¼Œä¸»çº¿ç¨‹å°±é€€å‡ºäº†ã€‚<strong>å­çº¿ç¨‹è¢«åˆ›å»ºå‡ºæ¥ä¹‹åéœ€è¦æŠ¢cpuæ—¶é—´ç‰‡, æŠ¢ä¸åˆ°å°±ä¸èƒ½è¿è¡Œï¼Œå¦‚æœä¸»çº¿ç¨‹é€€å‡ºäº†, è™šæ‹Ÿåœ°å€ç©ºé—´å°±è¢«é‡Šæ”¾äº†, å­çº¿ç¨‹å°±ä¸€å¹¶è¢«é”€æ¯äº†ã€‚ä½†æ˜¯å¦‚æœæŸä¸€ä¸ªå­çº¿ç¨‹é€€å‡ºäº†, ä¸»çº¿ç¨‹ä»åœ¨è¿è¡Œ, è™šæ‹Ÿåœ°å€ç©ºé—´ä¾æ—§å­˜åœ¨ã€‚</strong></p></div><p>å¾—åˆ°çš„ç»“è®ºï¼š<strong>åœ¨æ²¡æœ‰äººä¸ºå¹²é¢„çš„æƒ…å†µä¸‹ï¼Œè™šæ‹Ÿåœ°å€ç©ºé—´çš„ç”Ÿå‘½å‘¨æœŸå’Œä¸»çº¿ç¨‹æ˜¯ä¸€æ ·çš„ï¼Œä¸å­çº¿ç¨‹æ— å…³</strong>ã€‚</p><p>ç›®å‰çš„è§£å†³æ–¹æ¡ˆï¼šè®©å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹å†é€€å‡ºï¼Œå¯ä»¥åœ¨ä¸»çº¿ç¨‹ä¸­æ·»åŠ æŒ‚èµ·å‡½æ•° sleep()ï¼Œé¿å…ä¸»çº¿ç¨‹å…ˆæ‰§è¡Œå®Œæ¯•åè™šæ‹Ÿåœ°å€ç©ºé—´è¢«é‡Šæ”¾;</p><h1>3.çº¿ç¨‹é€€å‡º</h1><div class="tip "><p>åœ¨ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºçš„æ—¶å€™ï¼Œå¦‚æœæƒ³è¦è®©çº¿ç¨‹é€€å‡ºï¼Œ<strong>ä½†æ˜¯ä¸ä¼šå¯¼è‡´è™šæ‹Ÿåœ°å€ç©ºé—´çš„é‡Šæ”¾ï¼ˆé’ˆå¯¹äºä¸»çº¿ç¨‹é€€å‡ºåï¼Œä¸æƒ³é‡Šæ”¾è™šæ‹Ÿç©ºé—´åœ°å€çš„æƒ…å†µï¼‰</strong>ï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨çº¿ç¨‹åº“ä¸­çš„çº¿ç¨‹é€€å‡ºå‡½æ•°ï¼Œåªè¦è°ƒç”¨è¯¥å‡½æ•°å½“å‰çº¿ç¨‹å°±é©¬ä¸Šé€€å‡ºäº†ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“åˆ°å…¶ä»–çº¿ç¨‹çš„æ­£å¸¸è¿è¡Œï¼Œ<strong>ä¸ç®¡æ˜¯åœ¨å­çº¿ç¨‹æˆ–è€…ä¸»çº¿ç¨‹ä¸­éƒ½å¯ä»¥ä½¿ç”¨ã€‚</strong></p></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">pthread_exit</span><span class="params">(<span class="type">void</span> *retval)</span>;</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°(void *retval)ï¼šçº¿ç¨‹é€€å‡ºçš„æ—¶å€™æºå¸¦çš„æ•°æ®ï¼Œå½“å‰å­çº¿ç¨‹çš„ä¸»çº¿ç¨‹ä¼šå¾—åˆ°è¯¥æ•°æ®ã€‚å¦‚æœä¸éœ€è¦ä½¿ç”¨ï¼ŒæŒ‡å®šä¸º NULL</li></ul><p>çº¿ç¨‹é€€å‡ºç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    sleep(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            pthread_exit(<span class="literal">NULL</span>);<span class="comment">// ç›´æ¥é€€å‡ºå­çº¿ç¨‹</span></span><br><span class="line">        &#125; </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child == i: = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸»çº¿ç¨‹è°ƒç”¨é€€å‡ºå‡½æ•°é€€å‡º, åœ°å€ç©ºé—´ä¸ä¼šè¢«é‡Šæ”¾</span></span><br><span class="line">    pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>4.çº¿ç¨‹å›æ”¶</h1><h2 id="çº¿ç¨‹å‡½æ•°-2">çº¿ç¨‹å‡½æ•°</h2><div class="tip "><p>çº¿ç¨‹å’Œè¿›ç¨‹ä¸€æ ·ï¼Œå­çº¿ç¨‹é€€å‡ºçš„æ—¶å€™å…¶å†…æ ¸èµ„æºä¸»è¦ç”±ä¸»çº¿ç¨‹å›æ”¶ï¼Œçº¿ç¨‹åº“ä¸­æä¾›çš„çº¿ç¨‹å›æ”¶å‡½å«åš  <strong>pthread_join()</strong>ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªé˜»å¡å‡½æ•°ï¼Œ<strong>å¦‚æœè¿˜æœ‰å­çº¿ç¨‹åœ¨è¿è¡Œï¼Œè°ƒç”¨è¯¥å‡½æ•°å°±ä¼šé˜»å¡ï¼Œå­çº¿ç¨‹é€€å‡ºå‡½æ•°è§£é™¤é˜»å¡è¿›è¡Œèµ„æºçš„å›æ”¶ï¼Œå‡½æ•°è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œåªèƒ½å›æ”¶ä¸€ä¸ªå­çº¿ç¨‹ï¼Œå¦‚æœæœ‰å¤šä¸ªå­çº¿ç¨‹åˆ™éœ€è¦å¾ªç¯è¿›è¡Œå›æ”¶ã€‚</strong></p></div><p>å¦å¤–é€šè¿‡çº¿ç¨‹å›æ”¶å‡½æ•°è¿˜å¯ä»¥è·å–åˆ°å­çº¿ç¨‹é€€å‡ºæ—¶ä¼ é€’å‡ºæ¥çš„æ•°æ®ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªé˜»å¡å‡½æ•°, å­çº¿ç¨‹åœ¨è¿è¡Œè¿™ä¸ªå‡½æ•°å°±é˜»å¡</span></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹é€€å‡º, å‡½æ•°è§£é™¤é˜»å¡, å›æ”¶å¯¹åº”çš„å­çº¿ç¨‹èµ„æº, ç±»ä¼¼äºå›æ”¶è¿›ç¨‹ä½¿ç”¨çš„å‡½æ•° wait()</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_join</span><span class="params">(<span class="type">pthread_t</span> thread, <span class="type">void</span> **retval)</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°:</p><ul><li>thread: è¦è¢«å›æ”¶çš„å­çº¿ç¨‹çš„çº¿ç¨‹ ID</li><li>retval: äºŒçº§æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€çº§æŒ‡é’ˆçš„åœ°å€ï¼Œæ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°ï¼Œè¿™ä¸ªåœ°å€ä¸­å­˜å‚¨äº† pthread_exit () ä¼ é€’å‡ºçš„æ•°æ®ï¼Œå¦‚æœä¸éœ€è¦è¿™ä¸ªå‚æ•°ï¼Œå¯ä»¥æŒ‡å®šä¸º NULL</li></ul></li><li><p>è¿”å›å€¼ï¼šçº¿ç¨‹å›æ”¶æˆåŠŸè¿”å› 0ï¼Œå›æ”¶å¤±è´¥è¿”å›é”™è¯¯å·ã€‚</p></li></ul><h2 id="å›æ”¶å­çº¿ç¨‹æ•°æ®">å›æ”¶å­çº¿ç¨‹æ•°æ®</h2><p>åœ¨å­çº¿ç¨‹é€€å‡ºçš„æ—¶å€™å¯ä»¥ä½¿ç”¨ pthread_exit() çš„å‚æ•°å°†æ•°æ®ä¼ å‡ºï¼Œåœ¨å›æ”¶è¿™ä¸ªå­çº¿ç¨‹çš„æ—¶å€™å¯ä»¥é€šè¿‡ phread_join() çš„ç¬¬äºŒä¸ªå‚æ•°æ¥æ¥æ”¶å­çº¿ç¨‹ä¼ é€’å‡ºçš„æ•°æ®ã€‚æ¥æ”¶æ•°æ®æœ‰å¾ˆå¤šç§å¤„ç†æ–¹å¼ï¼Œä¸‹é¢æ¥åˆ—ä¸¾å‡ ç§ï¼š</p><h3 id="ä½¿ç”¨å­çº¿ç¨‹æ ˆ">ä½¿ç”¨å­çº¿ç¨‹æ ˆ</h3><p>é€šè¿‡å‡½æ•° <em>pthread_exit(void *retval);</em> å¯ä»¥å¾—çŸ¥ï¼Œå­çº¿ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œéœ€è¦å°†æ•°æ®è®°å½•åˆ°ä¸€å—å†…å­˜ä¸­ï¼Œé€šè¿‡å‚æ•°ä¼ å‡ºçš„æ˜¯å­˜å‚¨æ•°æ®çš„å†…å­˜çš„åœ°å€ï¼Œè€Œä¸æ˜¯å…·ä½“æ•°æ®ï¼Œç”±å› ä¸ºå‚æ•°æ˜¯ <em>void*</em> ç±»å‹ï¼Œæ‰€æœ‰è¿™ä¸ªä¸‡èƒ½æŒ‡é’ˆå¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹çš„å†…å­˜åœ°å€ã€‚å…ˆæ¥çœ‹ç¬¬ä¸€ç§æ–¹å¼ï¼Œå°†å­çº¿ç¨‹é€€å‡ºæ•°æ®ä¿å­˜åœ¨å­çº¿ç¨‹è‡ªå·±çš„æ ˆåŒºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pthread_join.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Persion</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child == i: = %d\n&quot;</span>, i);</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="class"><span class="keyword">struct</span> <span class="title">Persion</span> <span class="title">p</span>;</span></span><br><span class="line">            p.age  =<span class="number">12</span>;</span><br><span class="line">            <span class="built_in">strcpy</span>(p.name, <span class="string">&quot;tom&quot;</span>);</span><br><span class="line">            p.id = <span class="number">100</span>;</span><br><span class="line">            <span class="comment">// è¯¥å‡½æ•°çš„å‚æ•°å°†è¿™ä¸ªåœ°å€ä¼ é€’ç»™äº†ä¸»çº¿ç¨‹çš„pthread_join()</span></span><br><span class="line">            pthread_exit(&amp;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;<span class="comment">// ä»£ç æ‰§è¡Œä¸åˆ°è¿™ä¸ªä½ç½®å°±é€€å‡ºäº†</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜»å¡ç­‰å¾…å­çº¿ç¨‹é€€å‡º</span></span><br><span class="line">    <span class="type">void</span>* ptr = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// ptræ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°, åœ¨å‡½æ•°å†…éƒ¨è®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€å—æœ‰æ•ˆå†…å­˜</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªå†…å­˜åœ°å€å°±æ˜¯pthread_exit() å‚æ•°æŒ‡å‘çš„å†…å­˜</span></span><br><span class="line">    pthread_join(tid, &amp;ptr);</span><br><span class="line">    <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Persion</span>* <span class="title">pp</span> =</span> (<span class="keyword">struct</span> Persion*)ptr;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹è¿”å›æ•°æ®: name: %s, age: %d, id: %d\n&quot;</span>, pp-&gt;name, pp-&gt;age, pp-&gt;id);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹èµ„æºè¢«æˆåŠŸå›æ”¶...\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å¹¶æ‰§è¡Œæµ‹è¯•ç¨‹åº:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># ç¼–è¯‘ä»£ç </span><br><span class="line">$ gcc pthread_join.c -lpthread</span><br><span class="line"># æ‰§è¡Œç¨‹åº</span><br><span class="line">$ ./a.out </span><br><span class="line">å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: <span class="number">140652794640128</span></span><br><span class="line">æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: <span class="number">140652803008256</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">i = <span class="number">2</span></span><br><span class="line">æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: <span class="number">140652794640128</span></span><br><span class="line">child == i: = <span class="number">0</span></span><br><span class="line">child == i: = <span class="number">1</span></span><br><span class="line">child == i: = <span class="number">2</span></span><br><span class="line">child == i: = <span class="number">3</span></span><br><span class="line">child == i: = <span class="number">4</span></span><br><span class="line">child == i: = <span class="number">5</span></span><br><span class="line">child == i: = <span class="number">6</span></span><br><span class="line">å­çº¿ç¨‹è¿”å›æ•°æ®: name: , age: <span class="number">0</span>, id: <span class="number">0</span></span><br><span class="line">å­çº¿ç¨‹èµ„æºè¢«æˆåŠŸå›æ”¶...</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é€šè¿‡æ‰“å°çš„æ—¥å¿—å¯ä»¥å‘ç°ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æ²¡æœ‰æ²¡æœ‰å¾—åˆ°å­çº¿ç¨‹è¿”å›çš„æ•°æ®ä¿¡æ¯ï¼Œå…·ä½“åŸå› æ˜¯è¿™æ ·çš„ï¼š</p><p><strong>å¦‚æœå¤šä¸ªçº¿ç¨‹å…±ç”¨åŒä¸€ä¸ªè™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æ ˆåŒºéƒ½æœ‰ä¸€å—å±äºè‡ªå·±çš„å†…å­˜ï¼Œç›¸å½“äºæ ˆåŒºè¢«è¿™å‡ ä¸ªçº¿ç¨‹å¹³åˆ†äº†ï¼Œå½“çº¿ç¨‹é€€å‡ºï¼Œçº¿ç¨‹åœ¨æ ˆåŒºçš„å†…å­˜ä¹Ÿå°±è¢«å›æ”¶äº†ï¼Œå› æ­¤éšç€å­çº¿ç¨‹çš„é€€å‡ºï¼Œå†™å…¥åˆ°æ ˆåŒºçš„æ•°æ®ä¹Ÿå°±è¢«é‡Šæ”¾äº†ã€‚</strong></p><h3 id="ä½¿ç”¨å…¨å±€å˜é‡">ä½¿ç”¨å…¨å±€å˜é‡</h3><p>ä½äºåŒä¸€è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„çº¿ç¨‹ï¼Œè™½ç„¶<strong>ä¸èƒ½å…±äº«æ ˆåŒºæ•°æ®ï¼Œä½†æ˜¯å¯ä»¥å…±äº«å…¨å±€æ•°æ®åŒºå’Œå †åŒºæ•°æ®</strong>ï¼Œå› æ­¤åœ¨å­çº¿ç¨‹é€€å‡ºçš„æ—¶å€™å¯ä»¥å°†ä¼ å‡ºæ•°æ®å­˜å‚¨åˆ°å…¨å±€å˜é‡ã€é™æ€å˜é‡æˆ–è€…å †å†…å­˜ä¸­ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­å°†æ•°æ®å­˜å‚¨åˆ°äº†å…¨å±€å˜é‡ä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Persion</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Persion</span> <span class="title">p</span>;</span><span class="comment">// å®šä¹‰å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child == i: = %d\n&quot;</span>, i);</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨å…¨å±€å˜é‡</span></span><br><span class="line">            p.age  =<span class="number">12</span>;</span><br><span class="line">            <span class="built_in">strcpy</span>(p.name, <span class="string">&quot;tom&quot;</span>);</span><br><span class="line">            p.id = <span class="number">100</span>;</span><br><span class="line">            <span class="comment">// è¯¥å‡½æ•°çš„å‚æ•°å°†è¿™ä¸ªåœ°å€ä¼ é€’ç»™äº†ä¸»çº¿ç¨‹çš„pthread_join()</span></span><br><span class="line">            pthread_exit(&amp;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜»å¡ç­‰å¾…å­çº¿ç¨‹é€€å‡º</span></span><br><span class="line">    <span class="type">void</span>* ptr = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// ptræ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°, åœ¨å‡½æ•°å†…éƒ¨è®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€å—æœ‰æ•ˆå†…å­˜</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªå†…å­˜åœ°å€å°±æ˜¯pthread_exit() å‚æ•°æŒ‡å‘çš„å†…å­˜</span></span><br><span class="line">    pthread_join(tid, &amp;ptr);</span><br><span class="line">    <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Persion</span>* <span class="title">pp</span> =</span> (<span class="keyword">struct</span> Persion*)ptr;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name: %s, age: %d, id: %d\n&quot;</span>, pp-&gt;name, pp-&gt;age, pp-&gt;id);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹èµ„æºè¢«æˆåŠŸå›æ”¶...\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨ä¸»çº¿ç¨‹æ ˆ">ä½¿ç”¨ä¸»çº¿ç¨‹æ ˆ</h3><p>è™½ç„¶æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å±äºè‡ªå·±çš„æ ˆåŒºç©ºé—´ï¼Œä½†æ˜¯<strong>ä½äºåŒä¸€ä¸ªåœ°å€ç©ºé—´çš„å¤šä¸ªçº¿ç¨‹æ˜¯å¯ä»¥ç›¸äº’è®¿é—®å¯¹æ–¹çš„æ ˆç©ºé—´ä¸Šçš„æ•°æ®çš„</strong>ã€‚ç”±äºå¾ˆå¤šæƒ…å†µä¸‹è¿˜éœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸­å›æ”¶å­çº¿ç¨‹èµ„æºï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹ä¸€èˆ¬éƒ½æ˜¯æœ€åé€€å‡ºï¼ŒåŸºäºè¿™ä¸ªåŸå› åœ¨ä¸‹é¢çš„ç¨‹åºä¸­å°†å­çº¿ç¨‹è¿”å›çš„æ•°æ®ä¿å­˜åˆ°äº†ä¸»çº¿ç¨‹çš„æ ˆåŒºå†…å­˜ä¸­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Persion</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">36</span>];</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Persion</span>* <span class="title">p</span> =</span> (<span class="keyword">struct</span> Persion*)arg;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child == i: = %d\n&quot;</span>, i);</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨ä¸»çº¿ç¨‹çš„æ ˆå†…å­˜</span></span><br><span class="line">            p-&gt;age  =<span class="number">12</span>;</span><br><span class="line">            <span class="built_in">strcpy</span>(p-&gt;name, <span class="string">&quot;tom&quot;</span>);</span><br><span class="line">            p-&gt;id = <span class="number">100</span>;</span><br><span class="line">            <span class="comment">// è¯¥å‡½æ•°çš„å‚æ•°å°†è¿™ä¸ªåœ°å€ä¼ é€’ç»™äº†ä¸»çº¿ç¨‹çš„pthread_join()</span></span><br><span class="line">            pthread_exit(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Persion</span> <span class="title">p</span>;</span></span><br><span class="line">    <span class="comment">// ä¸»çº¿ç¨‹çš„æ ˆå†…å­˜ä¼ é€’ç»™å­çº¿ç¨‹</span></span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, &amp;p);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜»å¡ç­‰å¾…å­çº¿ç¨‹é€€å‡º</span></span><br><span class="line">    <span class="type">void</span>* ptr = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// ptræ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°, åœ¨å‡½æ•°å†…éƒ¨è®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€å—æœ‰æ•ˆå†…å­˜</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªå†…å­˜åœ°å€å°±æ˜¯pthread_exit() å‚æ•°æŒ‡å‘çš„å†…å­˜</span></span><br><span class="line">    pthread_join(tid, &amp;ptr);</span><br><span class="line">    <span class="comment">// æ‰“å°ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;name: %s, age: %d, id: %d\n&quot;</span>, p.name, p.age, p.id);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹èµ„æºè¢«æˆåŠŸå›æ”¶...\n&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œè°ƒç”¨ pthread_create() åˆ›å»ºå­çº¿ç¨‹ï¼Œå¹¶å°†ä¸»çº¿ç¨‹ä¸­æ ˆç©ºé—´å˜é‡ p çš„åœ°å€ä¼ é€’åˆ°äº†å­çº¿ç¨‹ä¸­ï¼Œåœ¨å­çº¿ç¨‹ä¸­å°†è¦ä¼ é€’å‡ºçš„æ•°æ®å†™å…¥åˆ°äº†è¿™å—å†…å­˜ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ç¨‹åºçš„ main() å‡½æ•°ä¸­ï¼Œé€šè¿‡æŒ‡é’ˆå˜é‡ ptr æˆ–è€…é€šè¿‡ç»“æ„ä½“å˜é‡ p éƒ½å¯ä»¥è¯»å‡ºå­çº¿ç¨‹ä¼ å‡ºçš„æ•°æ®ã€‚</p><h2 id="æ‰‹åŠ¨å’Œè‡ªåŠ¨å›æ”¶èµ„æº">æ‰‹åŠ¨å’Œè‡ªåŠ¨å›æ”¶èµ„æº</h2><div class="tip "><p><strong>çº¿ç¨‹é€€å‡ºæœ‰å¤šç§æ–¹å¼ï¼Œå¦‚returnï¼Œpthread_exit,pthread_cancelç­‰ï¼›çº¿ç¨‹åˆ†ä¸ºå¯ç»“åˆçš„ï¼ˆjoinableï¼‰å’Œ åˆ†ç¦»çš„ï¼ˆdetachedï¼‰ä¸¤ç§ï¼Œå¦‚æœæ²¡æœ‰åœ¨åˆ›å»ºçº¿ç¨‹æ—¶å°†çº¿ç¨‹åˆ†ç¦»ï¼Œåˆ™çº¿ç¨‹é»˜è®¤æ˜¯å¯ç»“åˆçš„ã€‚å¯ç»“åˆçš„çº¿ç¨‹åœ¨çº¿ç¨‹é€€å‡ºåä¸ä¼šç«‹å³é‡Šæ”¾èµ„æºï¼Œå¿…é¡»è¦è°ƒç”¨pthread_joinæ¥æ˜¾å¼çš„ç»“æŸçº¿ç¨‹ã€‚åˆ†ç¦»çš„çº¿ç¨‹åœ¨çº¿ç¨‹é€€å‡ºæ—¶ç³»ç»Ÿä¼šè‡ªåŠ¨å›æ”¶èµ„æºã€‚</strong></p></div><p></p><ul><li><p>pthread_exit()ï¼šåªé€€å‡ºå½“å‰å­çº¿ç¨‹ã€‚<strong>æ³¨æ„</strong>ï¼šåœ¨ä¸»çº¿ç¨‹é€€å‡ºæ—¶ï¼Œå…¶å®ƒçº¿ç¨‹ä¸ä¼šç»“æŸã€‚åŒæ ·å¯ä»¥æ‰§è¡Œã€‚æ‰€ä»¥è¿™ä¸ªåªå­—éå¸¸é‡è¦ã€‚å¹¶ä¸”ï¼Œä¸returnä¸€æ ·ï¼Œpthread_exité€€å‡ºçš„çº¿ç¨‹ä¹Ÿéœ€è¦è°ƒç”¨pthread_joinå»å›æ”¶å­çº¿ç¨‹çš„èµ„æº(8kå·¦å³)ï¼Œä¸ä¼šè‡ªè¡Œå›æ”¶ï¼Œå¦åˆ™æœåŠ¡å™¨é•¿æ—¶é—´è¿è¡Œä¼šæµªè´¹èµ„æºå¯¼è‡´æ— æ³•å†åˆ›å»ºæ–°çº¿ç¨‹ã€‚</p></li><li><p>pthread_detach()ï¼Œè‡ªè¡Œå›æ”¶èµ„æº</p></li></ul><h1>5.çº¿ç¨‹åˆ†ç¦»</h1><div class="tip "><p><strong>æŸäº›æƒ…å†µä¸‹ï¼Œç¨‹åºä¸­çš„ä¸»çº¿ç¨‹æœ‰å±äºè‡ªå·±çš„ä¸šåŠ¡å¤„ç†æµç¨‹ï¼Œå¦‚æœè®©ä¸»çº¿ç¨‹è´Ÿè´£å­çº¿ç¨‹çš„èµ„æºå›æ”¶ï¼Œè°ƒç”¨ pthread_join() åªè¦å­çº¿ç¨‹ä¸é€€å‡ºä¸»çº¿ç¨‹å°±ä¼šä¸€ç›´è¢«é˜»å¡ï¼Œä¸»è¦çº¿ç¨‹çš„ä»»åŠ¡ä¹Ÿå°±ä¸èƒ½è¢«æ‰§è¡Œäº†ã€‚</strong></p></div><p>åœ¨çº¿ç¨‹åº“å‡½æ•°ä¸­ä¸ºæˆ‘ä»¬æä¾›äº†çº¿ç¨‹åˆ†ç¦»å‡½æ•° <strong>pthread_detach()</strong>ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¹‹åæŒ‡å®šçš„<strong>å­çº¿ç¨‹å°±å¯ä»¥å’Œä¸»çº¿ç¨‹åˆ†ç¦»ï¼Œå½“å­çº¿ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œå…¶å ç”¨çš„å†…æ ¸èµ„æºå°±è¢«ç³»ç»Ÿçš„å…¶ä»–è¿›ç¨‹æ¥ç®¡å¹¶å›æ”¶äº†ã€‚<strong>çº¿ç¨‹åˆ†ç¦»ä¹‹ååœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ <strong>pthread_join()</strong> å°±å›æ”¶ä¸åˆ°å­çº¿ç¨‹èµ„æºäº†ã€‚</strong>(detachåèµ„æºè‡ªåŠ¨å›æ”¶)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="comment">// å‚æ•°å°±å­çº¿ç¨‹çš„çº¿ç¨‹ID, ä¸»çº¿ç¨‹å°±å¯ä»¥å’Œè¿™ä¸ªå­çº¿ç¨‹åˆ†ç¦»äº†</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_detach</span><span class="params">(<span class="type">pthread_t</span> thread)</span>;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ä»£ç ä¸­ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºå­çº¿ç¨‹ï¼Œå¹¶è°ƒç”¨çº¿ç¨‹åˆ†ç¦»å‡½æ•°ï¼Œå®ç°äº†ä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹çš„åˆ†ç¦»ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;child == i: = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å­çº¿ç¨‹å’Œä¸»çº¿ç¨‹åˆ†ç¦»</span></span><br><span class="line">    pthread_detach(tid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®©ä¸»çº¿ç¨‹è‡ªå·±é€€å‡ºå³å¯ï¼Œå¿…é¡»æœ‰è¿™ä¸ªï¼Œå¦åˆ™è™šæ‹Ÿåœ°å€ç©ºé—´å†…å­˜ä¼šè¢«é‡Šæ”¾</span></span><br><span class="line">    pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>6.å…¶ä»–çº¿ç¨‹å‡½æ•°</h1><h2 id="çº¿ç¨‹å–æ¶ˆå‡½æ•°">çº¿ç¨‹å–æ¶ˆå‡½æ•°</h2><p>çº¿ç¨‹å–æ¶ˆçš„æ„æ€å°±æ˜¯åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ€æ­»å¦ä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ€æ­»ä¸€ä¸ªçº¿ç¨‹éœ€è¦åˆ†ä¸¤æ­¥ï¼š</p><ul><li>åœ¨çº¿ç¨‹ A ä¸­è°ƒç”¨çº¿ç¨‹å–æ¶ˆå‡½æ•° pthread_cancelï¼ŒæŒ‡å®šæ€æ­»çº¿ç¨‹ Bï¼Œè¿™æ—¶å€™çº¿ç¨‹ B æ˜¯æ­»ä¸äº†çš„</li><li>åœ¨çº¿ç¨‹ B ä¸­è¿›ç¨‹ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ï¼ˆä»ç”¨æˆ·åŒºåˆ‡æ¢åˆ°å†…æ ¸åŒºï¼‰ï¼Œå¦åˆ™çº¿ç¨‹ B å¯ä»¥ä¸€ç›´è¿è¡Œã€‚<br>è¿™å…¶å®å’Œä¸ƒæ­¥æ–­è‚ æ•£ã€å«ç¬‘åŠæ­¥ç™«çš„åŠŸæ•ˆæ˜¯ä¸€æ ·çš„ï¼Œåƒäº†æ¯’è¯ä¸åŠ¨æˆ–è€…ä¸ç¬‘ä¹Ÿæ²¡å•¥äº‹å„¿</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="comment">// å‚æ•°æ˜¯å­çº¿ç¨‹çš„çº¿ç¨‹ID</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_cancel</span><span class="params">(<span class="type">pthread_t</span> thread)</span>;</span><br></pre></td></tr></table></figure><ul><li><p>å‚æ•°ï¼šè¦æ€æ­»çš„çº¿ç¨‹çš„çº¿ç¨‹ ID</p></li><li><p>è¿”å›å€¼ï¼šå‡½æ•°è°ƒç”¨æˆåŠŸè¿”å› 0ï¼Œè°ƒç”¨å¤±è´¥è¿”å›é 0 é”™è¯¯å·ã€‚</p></li></ul><p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œä¸»çº¿ç¨‹è°ƒç”¨çº¿ç¨‹å–æ¶ˆå‡½æ•°ï¼Œåªè¦åœ¨å­çº¿ç¨‹ä¸­è¿›è¡Œäº†ç³»ç»Ÿè°ƒç”¨ï¼Œå½“å­çº¿ç¨‹æ‰§è¡Œåˆ°è¿™ä¸ªä½ç½®å°±æŒ‚æ‰äº†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å­çº¿ç¨‹çš„å¤„ç†ä»£ç </span></span><br><span class="line"><span class="type">void</span>* <span class="title function_">working</span><span class="params">(<span class="type">void</span>* arg)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// printfè¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨ç³»ç»Ÿå‡½æ•°, å› æ­¤è¿™æ˜¯ä¸ªé—´æ¥çš„ç³»ç»Ÿè°ƒç”¨,è¿è¡Œåˆ°å­çº¿ç¨‹å°±æŒ‚äº†</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯å­çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">9</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; child i: %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºä¸€ä¸ªå­çº¿ç¨‹</span></span><br><span class="line">    <span class="type">pthread_t</span> tid;</span><br><span class="line">    pthread_create(&amp;tid, <span class="literal">NULL</span>, working, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ, çº¿ç¨‹ID: %ld\n&quot;</span>, tid);</span><br><span class="line">    <span class="comment">// 2. å­çº¿ç¨‹ä¸ä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç , ä¸»çº¿ç¨‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;æˆ‘æ˜¯ä¸»çº¿ç¨‹, çº¿ç¨‹ID: %ld\n&quot;</span>, pthread_self());</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">3</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ€æ­»å­çº¿ç¨‹, å¦‚æœå­çº¿ç¨‹ä¸­åšç³»ç»Ÿè°ƒç”¨, å­çº¿ç¨‹å°±ç»“æŸäº†</span></span><br><span class="line">    pthread_cancel(tid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®©ä¸»çº¿ç¨‹è‡ªå·±é€€å‡ºå³å¯</span></span><br><span class="line">    pthread_exit(<span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å…³äºç³»ç»Ÿè°ƒç”¨æœ‰ä¸¤ç§æ–¹å¼ï¼š</strong></p><ul><li>ç›´æ¥è°ƒç”¨ Linux ç³»ç»Ÿå‡½æ•°</li><li>è°ƒç”¨æ ‡å‡† C åº“å‡½æ•°ï¼Œä¸ºäº†å®ç°æŸäº›åŠŸèƒ½ï¼Œåœ¨ Linux å¹³å°ä¸‹æ ‡å‡† C åº“å‡½æ•°ä¼šè°ƒç”¨ç›¸å…³çš„ç³»ç»Ÿå‡½æ•°</li></ul><h2 id="çº¿ç¨‹IDæ¯”è¾ƒ">çº¿ç¨‹IDæ¯”è¾ƒ</h2><p>åœ¨ Linux ä¸­çº¿ç¨‹ ID æœ¬è´¨å°±æ˜¯ä¸€ä¸ªæ— ç¬¦å·é•¿æ•´å½¢ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨æ¯”è¾ƒæ“ä½œç¬¦æ¯”è¾ƒä¸¤ä¸ªçº¿ç¨‹çš„ IDï¼Œä½†æ˜¯çº¿ç¨‹åº“æ˜¯å¯ä»¥è·¨å¹³å°ä½¿ç”¨çš„ï¼Œåœ¨æŸäº›å¹³å°ä¸Š <strong>pthread_t</strong> å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå•çº¯çš„æ•´å½¢ï¼Œè¿™ä¸­æƒ…å†µä¸‹æ¯”è¾ƒä¸¤ä¸ªçº¿ç¨‹çš„ ID å¿…é¡»è¦ä½¿ç”¨æ¯”è¾ƒå‡½æ•°ï¼Œå‡½æ•°åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">pthread_equal</span><span class="params">(<span class="type">pthread_t</span> t1, <span class="type">pthread_t</span> t2)</span>;</span><br></pre></td></tr></table></figure><ul><li>å‚æ•°ï¼št1 å’Œ t2 æ˜¯è¦æ¯”è¾ƒçš„çº¿ç¨‹çš„çº¿ç¨‹ ID</li><li>è¿”å›å€¼ï¼šå¦‚æœä¸¤ä¸ªçº¿ç¨‹ ID ç›¸ç­‰è¿”å›é 0 å€¼ï¼Œå¦‚æœä¸ç›¸ç­‰è¿”å› 0</li></ul><h1>7.C++çº¿ç¨‹ç±»ï¼ˆstd::threadï¼‰</h1><p><a href="https://blog.csdn.net/sjc_0910/article/details/118861539?spm=1001.2014.3001.5506"> C++11 å¤šçº¿ç¨‹ï¼ˆstd::threadï¼‰è¯¦è§£_c++å¤šçº¿ç¨‹_jcShan709çš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
    
    
    <summary type="html">çº¿ç¨‹ç›¸å…³çŸ¥è¯†ï¼ˆpthreadï¼‰</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Clionå¿«æ·é”®</title>
    <link href="https://keqiudi.github.io/posts/70b69f96.html"/>
    <id>https://keqiudi.github.io/posts/70b69f96.html</id>
    <published>2023-04-11T01:18:44.000Z</published>
    <updated>2023-07-17T11:17:07.781Z</updated>
    
    <content type="html"><![CDATA[<h1>CLionç¼–è¾‘å¿«æ·é”®</h1><p><strong>Ctrl+Spacebar</strong> åŸºæœ¬ä»£ç å®Œæˆ(ä»»ä½•ç±»ã€æ–¹æ³•æˆ–å˜é‡çš„åç§°)</p><p><strong>Ctrl+Shift+Spacebar</strong> æ™ºèƒ½ä»£ç å®Œæˆ(æŒ‰é¢„æœŸç±»å‹ç­›é€‰æ–¹æ³•å’Œå˜é‡åˆ—è¡¨)</p><p><strong>Ctrl+Shift+Enter</strong> å®Œæ•´çš„è¯­å¥</p><p><strong>Ctrl+P</strong> å‚æ•°ä¿¡æ¯(åœ¨æ–¹æ³•è°ƒç”¨å‚æ•°å†…)</p><p><strong>Ctrl+Q</strong> å¿«é€ŸæŸ¥æ‰¾æ–‡æ¡£</p><p><strong>Ctrl+Mouse over code</strong> ç®€çŸ­çš„ä¿¡æ¯</p><p><strong>Ctrl+F1</strong> åœ¨æ’å…¥ç¬¦å·å¤„æ˜¾ç¤ºé”™è¯¯æˆ–è­¦å‘Šçš„è¯´æ˜</p><p><strong>Alt+Insert</strong> ç”Ÿæˆä»£ç â€¦(Getters, Setters, Constructors, hashCode/equals, toString)</p><p><strong>Ctrl+O</strong> è¦†ç›–æ–¹æ³•</p><p><strong>Ctrl+I</strong> å®ç°æ–¹æ³•</p><p><strong>Ctrl+Alt+T</strong> å›´ç»•ä¸â€¦(å¦‚æœ. .å…¶ä»–,è¯•è¯•. .catch, for, synchronizedç­‰)</p><p><strong>Ctrl+/</strong> æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šè¡Œæ³¨é‡Š</p><p><strong>Ctrl+Shift+/</strong> æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šå—æ³¨é‡Š</p><p><strong>Ctrl+W</strong> é€‰æ‹©è¿ç»­é€’å¢ä»£ç å—</p><p><strong>Ctrl+Shift+W</strong> å‡å°‘å½“å‰é€‰æ‹©åˆ°ä»¥å‰çš„çŠ¶æ€</p><p><strong>Alt+Q</strong> æ˜¾ç¤ºå¼ºåº¦åŠ¨ä½œå’Œå¿«é€Ÿä¿®å¤</p><p><strong>Ctrl+Alt+L</strong> é‡æ–°æ ¼å¼åŒ–ä»£ç </p><p><strong>Ctrl+Alt+O</strong> ä¼˜åŒ–è¿›å£</p><p><strong>Ctrl+Alt+I</strong> è‡ªåŠ¨ç¼©è¿›çº¿(å¹´ä»£)</p><p><strong>Tab/Shift+Tab</strong> ç¼©è¿›/ unindenté€‰å®šçš„è¡Œ</p><p><strong>Ctrl+X</strong> å‰ªåˆ‡å½“å‰è¡Œæˆ–é€‰å®šå—åˆ°å‰ªè´´æ¿</p><p><strong>Ctrl+C</strong> å¤åˆ¶å½“å‰è¡Œæˆ–é€‰å®šå—åˆ°å‰ªè´´æ¿</p><p><strong>Ctrl+V</strong> ä»å‰ªè´´æ¿ç²˜è´´</p><p><strong>Ctrl+Shift+V</strong> ä»æœ€è¿‘çš„ç¼“å†²åŒºç²˜è´´â€¦</p><p><strong>Ctrl+D</strong> å¤åˆ¶å½“å‰è¡Œæˆ–é€‰å®šå—</p><p><strong>Ctrl+Y</strong> åˆ é™¤æ’å…¥ç¬¦å·å¤„çš„è¡Œ</p><p><strong>Ctrl+Shift+J</strong> æ™ºèƒ½çº¿è¿æ¥</p><p><strong>Ctrl+Enter</strong> æ™ºèƒ½çº¿åˆ†è£‚</p><p><strong>Shift+Enter</strong> å¼€å§‹æ–°çš„ä¸€è¡Œ</p><p><strong>Ctrl+Shift+U</strong> åœ¨æ’å…¥ç¬¦å·æˆ–é€‰å®šå—ä¸Šåˆ‡æ¢å¤§å°å†™</p><p><strong>Ctrl+Shift+]/[</strong> é€‰æ‹©ç›´åˆ°ä»£ç å—ç»“æŸ/å¼€å§‹</p><p><strong>Ctrl+Delete</strong> åˆ é™¤åˆ°å­—å°¾</p><p><strong>Ctrl+Backspace</strong> åˆ é™¤åˆ°å•è¯å¼€å§‹</p><p><strong>Ctrl+ NumPad +/-</strong> å±•å¼€/æŠ˜å ä»£ç å—</p><p><strong>Ctrl+Alt+ NumPad +/-</strong> å±•å¼€æ‰€æœ‰/æŠ˜å æ‰€æœ‰</p><p><strong>Ctrl+F4</strong> å…³é—­æ´»åŠ¨ç¼–è¾‘å™¨é€‰é¡¹å¡</p><p><strong>Alt+Shift+Click</strong> å°†æ’å…¥ç¬¦å·æ”¾ç½®åœ¨å¤šä¸ªä½ç½®</p><p><strong>Esc</strong> æ¢å¤å•æ’å…¥å­—ç¬¦æ¨¡å¼</p><p><strong>Alt+G/Alt+Shift+G</strong> æ·»åŠ /åˆ é™¤ä¸‹æ¬¡å‡ºç°çš„å½“å‰å•è¯é€‰æ‹©</p><h1>CLionæŸ¥æ‰¾å’Œæ›¿æ¢</h1><p><strong>Double Shift</strong> åˆ°å¤„å¯»æ‰¾</p><p><strong>Ctrl+F</strong> æ‰¾åˆ°</p><p><strong>F3 / Shift+F3</strong> æŸ¥æ‰¾ä¸‹ä¸€ä¸ª/æ‰¾åˆ°ä¹‹å‰</p><p><strong>Ctrl+R</strong> å–ä»£</p><p><strong>Ctrl+Shift+F</strong> æ‰¾åˆ°çš„è·¯å¾„</p><p><strong>Ctrl+Shift+R</strong> åœ¨è·¯å¾„æ›¿æ¢</p><h1>CLionç¼–è¯‘ã€è¿è¡Œå¿«æ·é”®</h1><p><strong>Ctrl+F9</strong> å»ºè®¾é¡¹ç›®</p><p><strong>Alt+Shift+F10</strong> é€‰æ‹©é…ç½®å¹¶è¿è¡Œ</p><p><strong>Alt+Shift+F9</strong> é€‰æ‹©é…ç½®å’Œè°ƒè¯•</p><p><strong>Shift+F10</strong> è¿è¡Œ</p><p><strong>Shift+F9</strong> è°ƒè¯•</p><h1>CLion Debugå¿«æ·é”®</h1><p><strong>F8</strong> æ­¥è¿›</p><p><strong>F7</strong> è¿›å…¥</p><p><strong>Shift+F8</strong> æ­¥å‡º</p><p><strong>Alt+F9</strong> è¿è¡Œåˆ°å…‰æ ‡</p><p><strong>Alt+F8</strong> è®¡ç®—è¡¨è¾¾å¼</p><p><strong>F9</strong> æ¢å¤ç¨‹åº</p><p><strong>Ctrl+F8</strong> Toggle breakpoint</p><p><strong>Ctrl+Shift+F8</strong> æŸ¥çœ‹æ–­ç‚¹</p><h1>CLion Liveæ¨¡æ¿å¿«æ·é”®</h1><p><strong>Ctrl+Alt+J</strong> ä½¿ç”¨Liveæ¨¡æ¿åŒ…å›´</p><p><strong>Ctrl+J</strong> æ’å…¥Liveæ¨¡æ¿</p><p><strong>for</strong> (ç´¢å¼•;,)å¾ªç¯</p><p><strong>iter</strong> è¿­ä»£èŒƒå›´(C + + 11)</p><p><strong>itit</strong> ä½¿ç”¨Begin/Endæˆå‘˜å‡½æ•°è¿­ä»£</p><p><strong>incboost</strong> åœ¨CMakeä¸­åŒ…å«ä½¿ç”¨Boostçš„æŒ‡ç¤º</p><p><strong>function</strong> åœ¨CMakeä¸­åˆ›å»ºæ–°çš„å‡½æ•°å®šä¹‰å™¨</p><h1>CLionæœç´¢æ–‡ä»¶ã€å¯¼èˆªå¿«æ·é”®</h1><p><strong>Ctrl+N</strong> æœç´¢ç±»æ–‡ä»¶</p><p><strong>Ctrl+Shift+N</strong> æœç´¢æ–‡ä»¶</p><p><strong>Ctrl+Alt+Shift+N</strong> å®šä½åˆ°ç¬¦å·</p><p><strong>Alt+Right Arrow/Left Arrow</strong> è½¬åˆ°ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªç¼–è¾‘å™¨é€‰é¡¹å¡</p><p><strong>F12</strong> è¿”å›åˆ°å‰ä¸€ä¸ªå·¥å…·çª—å£</p><p><strong>Esc</strong> è½¬åˆ°ç¼–è¾‘å™¨(ä»å·¥å…·çª—å£)</p><p><strong>Shift+Esc</strong> éšè—æ´»åŠ¨çš„æˆ–æœ€è¿‘æ´»åŠ¨çš„çª—å£</p><p><strong>Ctrl+Shift+F4</strong> å…³é—­æ´»åŠ¨è¿è¡Œ/ä¿¡æ¯/å‘ç°/â€¦é€‰é¡¹å¡</p><p><strong>Ctrl+G</strong> å»è¡Œ</p><p><strong>Ctrl+E</strong> æœ€è¿‘æ–‡ä»¶å¼¹å‡º</p><p><strong>Ctrl+Alt+Left Arrow/Right Arrow</strong> å‘å/å‘å‰å¯¼èˆª</p><p><strong>Ctrl+Shift+Backspace</strong> å¯¼èˆªåˆ°æœ€åä¸€æ¬¡ç¼–è¾‘ä½ç½®</p><p><strong>Alt+F1</strong> åœ¨ä»»æ„è§†å›¾ä¸­é€‰æ‹©å½“å‰æ–‡ä»¶æˆ–ç¬¦å·</p><p><strong>Ctrl+B</strong> å®šä½å£°æ˜ æˆ– <strong>Ctrl + é¼ æ ‡å·¦é”®</strong></p><p><strong>Ctrl+Alt+B</strong> æœç´¢å®ç°ç±»(å¹´ä»£)</p><p><strong>Ctrl+Alt+Home</strong> è½¬åˆ°ç›¸å…³ç¬¦å·(å¤´/æº)</p><p><strong>Ctrl+Shift+I</strong> æ–‡ä»¶)</p><p><strong>Ctrl+Shift+B</strong> å¼€æ”¾å¿«é€Ÿå®šä¹‰æŸ¥æ‰¾</p><p><strong>Ctrl+U</strong> è¿›å…¥ç±»å‹å£°æ˜</p><p><strong>Alt+Up Arrow/Down Arrow</strong> çˆ¶ç±»æ–¹æ³•/è¶…ç±»</p><p><strong>Ctrl+]/[</strong> è½¬åˆ°å‰ä¸€ä¸ª/ä¸‹ä¸€ä¸ªæ–¹æ³•</p><p><strong>Ctrl+F12</strong> ç§»åŠ¨åˆ°ä»£ç å—ç»“æŸ/ç§»åŠ¨åˆ°ä»£ç å¼€å§‹</p><p><strong>Ctrl+H</strong> å¼¹å‡ºæ–‡ä»¶ç»“æ„</p><p><strong>Ctrl+Alt+H</strong> ç±»å‹å±‚æ¬¡ç»“æ„</p><p><strong>F2/Shift+F2</strong> è°ƒç”¨å±‚æ¬¡ç»“æ„</p><p><strong>F11</strong> ä¸‹ä¸€ä¸ª/ä»¥å‰çš„é”™è¯¯çªå‡ºæ˜¾ç¤º</p><p><strong>Ctrl+F11</strong> åˆ‡æ¢ä¹¦ç­¾</p><p><strong>Ctrl+0â€¦9</strong> ç”¨åŠ©è®°ç¬¦åˆ‡æ¢ä¹¦ç­¾</p><p><strong>Shift+F11</strong> è½¬åˆ°ç¼–å·ä¹¦ç­¾</p><h1>CLionå¸¸ç”¨å¿«æ·é”®</h1><p><strong>Alt+0â€¦9</strong> æ‰“å¼€ç›¸åº”çš„å·¥å…·çª—å£</p><p><strong>Alt+Shift+I</strong> ç”¨å½“å‰é…ç½®æ–‡ä»¶æ£€æŸ¥å½“å‰æ–‡ä»¶</p><p><strong>Ctrl+`</strong> å¿«é€Ÿå¼€å…³ç”µæµæ–¹æ¡ˆ</p><p><strong>Ctrl+Alt+S</strong> ç¼–è¾‘åº”ç”¨ç¨‹åºè®¾ç½®</p><p><strong>Ctrl+Shift+F12</strong> éšè—æ‰€æœ‰å·¥å…·çª—å£</p><p><strong>Alt+Shift+F</strong> æ·»åŠ åˆ°æ”¶è—å¤¹</p><h1>CLion ä½¿ç”¨è¿‡çš„æœç´¢</h1><p><strong>Alt+F7</strong> å‘ç°ä½¿ç”¨</p><p><strong>Ctrl+F7</strong> åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ç”¨æ³•</p><p><strong>Ctrl+Shift+F7</strong> çªå‡ºæ˜¾ç¤ºæ–‡ä»¶ä¸­çš„ç”¨æ³•</p><p><strong>Ctrl+Alt+F7</strong> æ˜¾ç¤ºç”¨æ³•</p><h1>VCS/Gitå¿«æ·é”®</h1><p><strong>Ctrl+K</strong> å‘VCS/Gitæäº¤é¡¹ç›®</p><p><strong>Ctrl+T</strong> ä»VCSæ›´æ–°é¡¹ç›®</p><p><strong>Alt+Shift+C</strong> æŸ¥çœ‹æœ€è¿‘çš„å˜åŒ–</p><p><strong>Alt+`</strong> VCS/Gitå¿«é€Ÿå¼¹å‡º</p><h1>CLioné‡æ„å¿«æ·é”®</h1><p><strong>Ctrl+Alt+Shift+T</strong> é‡æ„</p><p><strong>F5</strong> å¤åˆ¶</p><p><strong>F6</strong> ç§»åŠ¨</p><p><strong>Alt+Delete</strong> å®‰å…¨çš„åˆ é™¤</p><p><strong>Shift+F6</strong> é‡å‘½å</p><p><strong>Ctrl+F6</strong> æ›´æ”¹ç­¾å</p><p><strong>Ctrl+Alt+M</strong> æå–åŠŸèƒ½</p><p><strong>Ctrl+Alt+N</strong> å†…è”</p><p><strong>Ctrl+Alt+P</strong> å¼•å…¥å‚æ•°</p><p><strong>Ctrl+Alt+V</strong> å¼•å…¥å˜é‡</p><p><strong>Ctrl+Alt+C</strong> ä»‹ç»å¸¸æ•°</p><p><strong>Ctrl+Alt+D</strong> ä»‹ç»å®šä¹‰</p>]]></content>
    
    
    <summary type="html">ä¸€äº›Clionå¸¸ç”¨çš„å¿«æ·é”®ä¸€å…±120ä¸ª</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>STM32</title>
    <link href="https://keqiudi.github.io/posts/b900f0d0.html"/>
    <id>https://keqiudi.github.io/posts/b900f0d0.html</id>
    <published>2023-04-02T15:03:08.000Z</published>
    <updated>2023-07-18T15:21:46.982Z</updated>
    
    <content type="html"><![CDATA[<h1>1.IDEé€‰æ‹©</h1><p><strong>keil</strong></p><p><strong>Clion</strong></p><p><a href="https://zhuanlan.zhihu.com/p/145801160">é…ç½®CLionç”¨äºSTM32å¼€å‘ã€ä¼˜é›…ã®åµŒå…¥å¼å¼€å‘ã€‘ - çŸ¥ä¹ (zhihu.com)</a></p><h1>2.æ—¶é’ŸRCC</h1><p><a href="https://blog.csdn.net/as480133937/article/details/98845509">ã€STM32ã€‘ç³»ç»Ÿæ—¶é’ŸRCCè¯¦è§£(è¶…è¯¦ç»†ï¼Œè¶…å…¨é¢)_rccæ—¶é’Ÿ_Zå°æ—‹çš„åšå®¢-CSDNåšå®¢</a></p><h1>3.STM32-GPIOä»‹ç»</h1><p><a href="https://blog.csdn.net/qq_44016222/article/details/123206403?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=stm32GPIO&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-123206403.nonecase&amp;spm=1018.2226.3001.4187"> STM32-GPIOä»‹ç»_stm32gpio_KevinFlynçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="HALåº“-GPIOå‡½æ•°åº“">HALåº“ GPIOå‡½æ•°åº“</h2><p><a href="https://blog.csdn.net/as480133937/article/details/98983268"> ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹ä¸‰----å¤–éƒ¨ä¸­æ–­(HALåº“GPIOè®²è§£)_HAL_GPIO_EXTI_callback_Zå°æ—‹çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="å•ç‰‡æœºå¼•è„šçš„ä¸Šæ‹‰ã€ä¸‹æ‹‰å’Œä¸‰æ€">å•ç‰‡æœºå¼•è„šçš„ä¸Šæ‹‰ã€ä¸‹æ‹‰å’Œä¸‰æ€</h2><p>**ä¸Šæ‹‰ï¼š**ä¸Šæ‹‰æ˜¯æŒ‡å•ç‰‡æœºçš„å¼•è„šé€šè¿‡ç”µé˜»æ¥VCCï¼Œè¿™æ ·å¯ä»¥æŠŠè¿™ä¸ªå¼•è„šçš„ç”µå¹³å›ºå®šä¸ºé«˜ç”µå¹³ã€‚</p><p>**ä¸‹æ‹‰ï¼š**ä¸‹æ‹‰çš„æƒ…å†µå’Œä¸Šæ‹‰çš„ç›¸åï¼Œæ˜¯ä¸ºäº†æŠŠå¼•è„šå›ºå®šä¸ºä½ç”µå¹³ï¼Œè¦æœ‰ä¸‹æ‹‰ç”µé˜»ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢è¯¯é…ç½®å¯¼è‡´çƒ§æ‰èŠ¯ç‰‡ã€‚</p><p>**ä¸‰æ€ï¼š**ä¸‰æ€åˆç§°ä¸ºé«˜é˜»æ€ï¼Œç®€å•ç†è§£å°±æ˜¯ç”µå¹³çš„é«˜ä½ç”±è¿™æ ¹çº¿ä¸Šçš„å¤–éƒ¨ç”µè·¯å†³å®šï¼Œå½“å¤–éƒ¨ç”µè·¯ä¸ºé«˜ç”µå¹³çš„æ—¶å€™ï¼Œå®ƒä¹Ÿæ˜¯é«˜ç”µå¹³ï¼›å½“å¤–éƒ¨ç”µè·¯ä¸ºä½ç”µå¹³çš„æ—¶å€™ï¼Œå®ƒä¹Ÿæ˜¯ä½ç”µå¹³ï¼›å½“å¤–éƒ¨ç”µè·¯ä¸ºé«˜é˜»æ€çš„æ—¶å€™ï¼Œå®ƒå°±æ˜¯é«˜é˜»æ€çš„ï¼ŒçŠ¶æ€å®Œå…¨å’Œå¤–éƒ¨ç”µè·¯ä¸€æ ·ã€‚</p><h2 id="ä¸Šå‡æ²¿å’Œä¸‹é™æ²¿"><strong>ä¸Šå‡æ²¿å’Œä¸‹é™æ²¿</strong></h2><p>**ç”µå¹³ï¼š**ç®€å•ç†è§£å°±æ˜¯ç”µå‹ï¼Œä½†å´ä¸ç›¸åŒã€‚</p><p>**ä¸Šå‡æ²¿è§¦å‘ï¼š**æ•°å­—ç”µè·¯ä¸­ï¼Œæ•°å­—ç”µå¹³ä»ä½ç”µå¹³ï¼ˆæ•°å­—â€œ0â€ä»£è¡¨ä½ç”µå¹³ï¼‰å˜ä¸ºé«˜ç”µå¹³ï¼ˆæ•°å­—â€œ1â€ä»£è¡¨é«˜ç”µå¹³ï¼‰çš„é‚£ä¸€ç¬é—´å«ä½œä¸Šå‡æ²¿ã€‚ä¸Šå‡æ²¿è§¦å‘æ˜¯å½“ä¿¡å·æœ‰ä¸Šå‡æ²¿æ—¶çš„å¼€å…³åŠ¨ä½œï¼Œå½“ç”µä½ç”±ä½å˜é«˜è€Œè§¦å‘è¾“å‡ºå˜åŒ–çš„å°±å«ä¸Šå‡æ²¿è§¦å‘ã€‚ä¹Ÿå°±æ˜¯å½“æµ‹åˆ°çš„ä¿¡å·ç”µä½æ˜¯ä»ä½åˆ°é«˜ä¹Ÿå°±æ˜¯ä¸Šå‡æ—¶å°±è§¦å‘ï¼Œå«åšä¸Šå‡æ²¿è§¦å‘ã€‚</p><p>**ä¸‹é™æ²¿è§¦å‘ï¼š**æ•°å­—ç”µè·¯ä¸­ï¼Œæ•°å­—ç”µå¹³ä»é«˜ç”µå¹³ï¼ˆæ•°å­—â€œ1â€ï¼‰å˜ä¸ºä½ç”µå¹³ï¼ˆæ•°å­—â€œ0â€ï¼‰çš„é‚£ä¸€ç¬é—´å«ä½œä¸‹é™æ²¿ã€‚ ä¸‹é™æ²¿è§¦å‘æ˜¯å½“ä¿¡å·æœ‰ä¸‹é™æ²¿æ—¶çš„å¼€å…³åŠ¨ä½œï¼Œå½“ç”µä½ç”±é«˜å˜ä½è€Œè§¦å‘è¾“å‡ºå˜åŒ–çš„å°±å«ä¸‹é™æ²¿è§¦å‘ã€‚ä¹Ÿå°±æ˜¯å½“æµ‹åˆ°çš„ä¿¡å·ç”µä½æ˜¯ä»é«˜åˆ°ä½ä¹Ÿå°±æ˜¯ä¸‹é™æ—¶å°±è§¦å‘ï¼Œå«åšä¸‹é™æ²¿è§¦å‘ã€‚</p><h1>å®šæ—¶å™¨</h1><h2 id="å®šæ—¶å™¨çš„ä»‹ç»">å®šæ—¶å™¨çš„ä»‹ç»</h2><h3 id="STM32G070RBT6å®šæ—¶å™¨èµ„æº">STM32G070RBT6å®šæ—¶å™¨èµ„æº</h3><blockquote><p>STM32G070RBT6æ‹¥æœ‰ä¸€ä¸ªPWMé«˜çº§å®šæ—¶å™¨ï¼Œäº”ä¸ª16ä½é€šç”¨å®šæ—¶å™¨ï¼Œä¸¤ä¸ªåŸºç¡€å®šæ—¶å™¨ï¼Œä¸¤ä¸ªçœ‹é—¨ç‹—å®šæ—¶å™¨ï¼Œä¸€ä¸ªSysTickå®šæ—¶å™¨ï¼Œå…±æœ‰11ä¸ªå®šæ—¶å™¨ã€‚</p></blockquote><p>åŸºæœ¬å®šæ—¶å™¨ TIM6 å’Œ TIM7 æ˜¯ä¸€ä¸ª 16 ä½çš„åªèƒ½å‘ä¸Šè®¡æ•°çš„å®šæ—¶å™¨ï¼Œåªèƒ½å®šæ—¶ï¼Œæ²¡æœ‰å¤–éƒ¨ IOã€‚é€šç”¨å®šæ—¶å™¨ TIM14/15/16/17 æ˜¯ 16 ä½çš„åªèƒ½å‘ä¸Šè®¡æ•°çš„å®šæ—¶å™¨ï¼Œå¯ä»¥å®šæ—¶ï¼Œå¯ä»¥è¾“å‡ºæ¯”è¾ƒï¼Œå¯ä»¥è¾“å…¥æ•è·ï¼Œå…¶ä¸­TIM15æ‹¥æœ‰å¤–éƒ¨è¾“å…¥å¼•è„šï¼Œå’Œä¸¤ä¸ªè¾“å‡ºé€šé“ï¼ŒTIM14/16/17éƒ½ä»…åªæœ‰ä¸€ä¸ªé€šé“ã€‚é«˜çº§å®šæ—¶å™¨ TIM1 æ˜¯ä¸€ä¸ª 16 ä½çš„å¯ä»¥å‘ä¸Š/ä¸‹è®¡æ•°çš„å®šæ—¶å™¨ï¼Œå¯ä»¥å®šæ—¶ï¼Œå¯ä»¥è¾“å‡ºæ¯”è¾ƒï¼Œå¯ä»¥è¾“å…¥æ•æ‰ï¼Œè¿˜å¯ä»¥æœ‰ä¸‰ç›¸ç”µæœºäº’è¡¥è¾“å‡ºä¿¡å·ï¼Œæœ‰ 8 ä¸ªå¤–éƒ¨ IOã€‚</p><h3 id="åŸºæœ¬å®šæ—¶å™¨åŠŸèƒ½æ¡†å›¾è®²è§£">åŸºæœ¬å®šæ—¶å™¨åŠŸèƒ½æ¡†å›¾è®²è§£</h3><p>åŸºæœ¬å®šæ—¶å™¨çš„æ ¸å¿ƒæ˜¯æ—¶åŸºï¼Œä¸ä»…åŸºæœ¬å®šæ—¶å™¨æœ‰ï¼Œé€šç”¨å®šæ—¶å™¨å’Œé«˜çº§å®šæ—¶å™¨ä¹Ÿæœ‰ã€‚å­¦ä¹ å®šæ—¶å™¨æ—¶ï¼Œæˆ‘ä»¬å…ˆä»ç®€å•çš„åŸºæœ¬å®šæ—¶å™¨å­¦èµ·ã€‚</p><h4 id="æ—¶é’Ÿæº">æ—¶é’Ÿæº</h4><p>å®šæ—¶å™¨æ—¶é’Ÿ TIMxCLKï¼Œå³å†…éƒ¨æ—¶é’Ÿ CK_INTï¼Œç» APB é¢„åˆ†é¢‘å™¨ååˆ†é¢‘æä¾›ï¼Œå¦‚æœAPB1 é¢„åˆ†é¢‘ç³»æ•°ç­‰äº 1ï¼Œåˆ™é¢‘ç‡ä¸å˜ï¼Œå¦åˆ™é¢‘ç‡ä¹˜ä»¥ 2ï¼Œåº“å‡½æ•°ä¸­ APB é¢„åˆ†é¢‘çš„ç³»æ•°æ˜¯ 1ï¼Œå³TPCLK=64Mï¼Œæ‰€ä»¥å®šæ—¶å™¨TIMxCLK=64MHzã€‚</p><h4 id="è®¡æ•°å™¨æ—¶é’Ÿ">è®¡æ•°å™¨æ—¶é’Ÿ</h4><p>å®šæ—¶å™¨æ—¶é’Ÿç»è¿‡ PSC é¢„åˆ†é¢‘å™¨ä¹‹åï¼Œå³è®¡æ•°å™¨æ—¶é’Ÿ CK_CNTï¼Œç”¨æ¥é©±åŠ¨è®¡æ•°å™¨è®¡æ•°ã€‚PSC æ˜¯ä¸€ä¸ª16 ä½çš„é¢„åˆ†é¢‘å™¨ï¼Œå¯ä»¥å¯¹å®šæ—¶å™¨æ—¶é’Ÿ TIMxCLK è¿›è¡Œ 1~65536 ä¹‹é—´çš„ä»»ä½•ä¸€ä¸ªæ•°è¿›è¡Œåˆ†é¢‘ã€‚å…·ä½“è®¡ç®—æ–¹å¼ä¸ºï¼šCK_CNT=TIMxCLK/(PSC+1)ã€‚</p><h4 id="è®¡æ•°å™¨">è®¡æ•°å™¨</h4><p>è®¡æ•°å™¨ CNT æ˜¯ä¸€ä¸ª 16 ä½çš„è®¡æ•°å™¨ï¼Œåªèƒ½å¾€ä¸Šè®¡æ•°ï¼Œæœ€å¤§è®¡æ•°å€¼ä¸º 65535ã€‚å½“è®¡æ•°è¾¾åˆ°è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨çš„æ—¶å€™äº§ç”Ÿæ›´æ–°äº‹ä»¶ï¼Œå¹¶æ¸…é›¶ä»å¤´å¼€å§‹è®¡æ•°ã€‚</p><h4 id="è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨">è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨</h4><p>è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨ ARR æ˜¯ä¸€ä¸ª 16 ä½çš„å¯„å­˜å™¨ï¼Œè¿™é‡Œé¢è£…ç€è®¡æ•°å™¨èƒ½è®¡æ•°çš„æœ€å¤§æ•°å€¼ã€‚å½“è®¡æ•°åˆ°è¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œå¦‚æœä½¿èƒ½äº†ä¸­æ–­çš„è¯ï¼Œå®šæ—¶å™¨å°±äº§ç”Ÿæº¢å‡ºä¸­æ–­ã€‚</p><h4 id="å®šæ—¶å™¨æ—¶é—´çš„è®¡ç®—">å®šæ—¶å™¨æ—¶é—´çš„è®¡ç®—</h4><p>å®šæ—¶å™¨çš„å®šæ—¶æ—¶é—´ç­‰äºè®¡æ•°å™¨çš„ä¸­æ–­å‘¨æœŸä¹˜ä»¥ä¸­æ–­çš„æ¬¡æ•°ã€‚è®¡æ•°å™¨åœ¨ CK_CNT çš„é©±åŠ¨ä¸‹ï¼Œè®¡ä¸€ä¸ªæ•°çš„æ—¶é—´åˆ™æ˜¯ CK_CNT çš„å€’æ•°ï¼Œç­‰äºï¼š1/ï¼ˆTIMxCLK/(PSC+1)ï¼‰ï¼Œäº§ç”Ÿä¸€æ¬¡ä¸­æ–­çš„æ—¶é—´åˆ™ç­‰äºï¼š(1/CK_CNT) * (ARR+1)ã€‚å¦‚æœåœ¨ä¸­æ–­æœåŠ¡ç¨‹åºé‡Œé¢è®¾ç½®ä¸€ä¸ªå˜é‡ timeï¼Œç”¨æ¥è®°å½•ä¸­æ–­çš„æ¬¡æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¡ç®—å‡ºæˆ‘ä»¬éœ€è¦çš„å®šæ—¶æ—¶é—´ç­‰äºï¼š(1/CK_CNT) * (ARR+1) * timeã€‚</p><h2 id="å®éªŒå†…å®¹">å®éªŒå†…å®¹</h2><h3 id="â… -å®šæ—¶å™¨æ§åˆ¶å°ç¯æ¯ç§’é—ªçƒä¸€æ¬¡">â… .å®šæ—¶å™¨æ§åˆ¶å°ç¯æ¯ç§’é—ªçƒä¸€æ¬¡</h3><h3 id="å®éªŒåŸç†">å®éªŒåŸç†</h3><p>å®šæ—¶å™¨æº¢å‡ºæ—¶é—´ï¼ˆusï¼‰= (å®šæ—¶å™¨é¢„åˆ†é¢‘å€¼+1)*(å®šæ—¶å™¨è‡ªåŠ¨é‡è£…è½½å€¼+1)/(å®šæ—¶å™¨è¾“å…¥æ—¶é’Ÿé¢‘ç‡(MHz))</p><p>é€šè¿‡é…ç½®åŸºç¡€å®šæ—¶å™¨TIM7çš„ <em><strong>Psc</strong></em> (é¢„åˆ†é¢‘å€¼)ä¸ <em><strong>Arr</strong></em> (è‡ªåŠ¨é‡è£…è½½å€¼)ï¼Œä½¿å¾—å…¶æº¢å‡ºæ—¶é—´ä¸º1 sï¼›åœ¨å®šæ—¶å™¨ä¸­æ–­å›è°ƒå‡½æ•°ä¸­è°ƒç”¨GPIOçŠ¶æ€ç¿»è½¬å‡½æ•°æ§åˆ¶LEDçš„å¼•è„šç”µå¹³ç¿»è½¬ï¼Œä»è€Œå®ç°å°ç¯æ¯ç§’é—ªçƒä¸€æ¬¡ã€‚</p><h3 id="STM32CubeMXçš„é…ç½®">STM32CubeMXçš„é…ç½®</h3><p><a href="https://blog.csdn.net/as480133937/article/details/99231677">ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹ä¸ƒâ€”PWMè¾“å‡º(å‘¼å¸ç¯)_stm32cubemx pwmå‘¼å¸ç¯_Zå°æ—‹çš„åšå®¢-CSDNåšå®¢</a></p><h4 id="Keilå·¥ç¨‹ä»£ç è®²è§£">Keilå·¥ç¨‹ä»£ç è®²è§£</h4><h4 id="å¼•ç”¨æˆ–å®šä¹‰çš„å‡½æ•°">å¼•ç”¨æˆ–å®šä¹‰çš„å‡½æ•°</h4><h5 id="éœ€è¦å¼•ç”¨çš„å‡½æ•°ï¼š">éœ€è¦å¼•ç”¨çš„å‡½æ•°ï¼š</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‡½æ•°åŸå‹ */</span></span><br><span class="line">HAL_StatusTypeDef <span class="title function_">HAL_TIM_Base_Start_IT</span><span class="params">(TIM_HandleTypeDef *htim)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å‡½æ•°å¼•ç”¨ä¸¾ä¾‹ */</span></span><br><span class="line">HAL_TIM_Base_Start_IT(&amp;htim7);<span class="comment">//ä»¥ä¸­æ–­å·¥ä½œæ–¹å¼å¯åŠ¨å®šæ—¶å™¨TIM7ï¼Œå‘ç”ŸUEVäº‹ä»¶æ—¶äº§ç”Ÿä¸­æ–­</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‡½æ•°åŸå‹ */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_GPIO_TogglePin</span><span class="params">(GPIO_TypeDef *GPIOx, <span class="type">uint16_t</span> GPIO_Pin)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å‡½æ•°å¼•ç”¨ä¸¾ä¾‹ */</span></span><br><span class="line">HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13); <span class="comment">//æ§åˆ¶PC13ç¿»è½¬ç”µå¹³</span></span><br></pre></td></tr></table></figure><h4 id="éœ€è¦å®šä¹‰çš„å‡½æ•°ï¼š">éœ€è¦å®šä¹‰çš„å‡½æ•°ï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å‡½æ•°åŸå‹ */</span></span><br><span class="line">__weak <span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å‡½æ•°é‡å®šä¹‰ä¸¾ä¾‹ */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/* åˆ¤æ–­è¿›å…¥ä¸­æ–­å®šæ—¶å™¨æ˜¯å¦ä¸ºTIM7 */</span></span><br><span class="line"><span class="keyword">if</span> (htim == &amp;htim7)&#123;</span><br><span class="line"><span class="comment">/* æ§åˆ¶PC13å¼•è„šç¿»è½¬ç”µå¹³ */</span></span><br><span class="line">HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><h5 id="æ‹“å±•ï¼š">æ‹“å±•ï¼š</h5><p><a href="https://baike.baidu.com/item/%E4%B8%AD%E6%96%AD/3933007?fromModule=lemma_search-box">ä¸­æ–­ï¼ˆInterruptï¼‰</a>ï¼šæ˜¯æŒ‡è®¡ç®—æœºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå‡ºç°æŸäº›æ„å¤–æƒ…å†µéœ€ä¸»æœºå¹²é¢„æ—¶ï¼Œæœºå™¨èƒ½è‡ªåŠ¨åœæ­¢æ­£åœ¨è¿è¡Œçš„ç¨‹åºå¹¶è½¬å…¥å¤„ç†æ–°æƒ…å†µçš„ç¨‹åºï¼Œå¤„ç†å®Œæ¯•ååˆè¿”å›åŸè¢«æš‚åœçš„ç¨‹åºç»§ç»­è¿è¡Œã€‚</p><p><a href="https://zhidao.baidu.com/question/345550524.html#:~:text=UEV%EF%BC%8C%E9%95%BF%E7%A7%B0%EF%BC%8Cupdate,event%EF%BC%8C%E4%B8%AD%E6%96%87%E4%B8%BA%E6%9B%B4%E6%96%B0%E4%BA%8B%E4%BB%B6%EF%BC%8C%E6%88%96%E8%80%85%E8%AF%B4%E4%BA%8B%E4%BB%B6%E6%9B%B4%E6%96%B0%E5%8F%91%E7%94%9F%EF%BC%8C%E6%98%AF%E6%8C%87%E8%BF%99%E4%B8%AA%E4%BA%8B%E4%BB%B6%E5%8F%91%E7%94%9F%E5%90%8E%EF%BC%8C%E5%B0%86%E4%BC%9A%E5%B0%86%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9A%84%E5%AF%84%E5%AD%98%E5%99%A8%E8%BF%9B%E8%A1%8C%E6%9B%B4%E6%96%B0%EF%BC%8C%E4%BB%A5%E4%BD%BF%E5%AE%9A%E6%97%B6%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%9C%A8%E6%96%B0%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%EF%BC%8C%E4%BE%8B%E5%A6%82%E5%BD%93%E4%B8%80%E4%B8%AA%E5%AE%9A%E6%97%B6%E5%91%A8%E6%9C%9F%E7%BB%93%E6%9D%9F%EF%BC%88%E8%AE%A1%E6%95%B0%E5%99%A8%E4%B8%8A%E6%BA%A2%EF%BC%89%E6%88%96%E8%80%85%E5%85%B6%E4%BB%96%E4%BA%8B%E4%BB%B6%E3%80%82">UEVäº‹ä»¶</a>ï¼šå…¨ç§°â€”â€”update eventï¼Œä¸­æ–‡ä¸ºæ›´æ–°äº‹ä»¶ï¼Œæˆ–è€…è¯´äº‹ä»¶æ›´æ–°å‘ç”Ÿï¼Œæ˜¯æŒ‡è¿™ä¸ªäº‹ä»¶å‘ç”Ÿåï¼Œå°†ä¼šå°†å®šæ—¶å™¨çš„å¯„å­˜å™¨è¿›è¡Œæ›´æ–°ï¼Œä»¥ä½¿å®šæ—¶å™¨å·¥ä½œåœ¨æ–°çš„é…ç½®ä¸‹ï¼Œä¾‹å¦‚å½“ä¸€ä¸ªå®šæ—¶å‘¨æœŸç»“æŸï¼ˆè®¡æ•°å™¨ä¸Šæº¢ï¼‰æˆ–è€…å…¶ä»–äº‹ä»¶ã€‚</p><p><a href="https://baike.baidu.com/item/%E8%BD%AE%E8%AF%A2?fromModule=lemma_search-box">è½®è¯¢ï¼ˆPollingï¼‰</a>ï¼šæ˜¯ä¸€ç§CPUå†³ç­–å¦‚ä½•æä¾›å‘¨è¾¹è®¾å¤‡æœåŠ¡çš„æ–¹å¼ï¼Œåˆç§°â€œç¨‹æ§è¾“å…¥è¾“å‡ºâ€ï¼ˆProgrammed I/Oï¼‰ã€‚è½®è¯¢æ³•çš„æ¦‚å¿µæ˜¯ï¼šç”±CPUå®šæ—¶å‘å‡ºè¯¢é—®ï¼Œä¾åºè¯¢é—®æ¯ä¸€ä¸ªå‘¨è¾¹è®¾å¤‡æ˜¯å¦éœ€è¦å…¶æœåŠ¡ï¼Œæœ‰å³ç»™äºˆæœåŠ¡ï¼ŒæœåŠ¡ç»“æŸåå†é—®ä¸‹ä¸€ä¸ªå‘¨è¾¹ï¼Œæ¥ç€ä¸æ–­å‘¨è€Œå¤å§‹ã€‚</p><p><strong>æ§åˆ¶åŸºç¡€å®šæ—¶å™¨å¯åŠ¨çš„HALåº“å‡½æ•°</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HAL_TIM_Base_Start(&amp;htimx); <span class="comment">// ä»¥è½®è¯¢å·¥ä½œæ–¹å¼å¯åŠ¨å®šæ—¶å™¨ï¼Œä¸ä¼šäº§ç”Ÿä¸­æ–­ã€‚</span></span><br><span class="line">HAL_TIM_Base_Start_IT(&amp;htimx); <span class="comment">// ä»¥ä¸­æ–­å·¥ä½œæ–¹å¼å¯åŠ¨å®šæ—¶å™¨ï¼Œå‘ç”ŸUEVäº‹ä»¶æ—¶äº§ç”Ÿä¸­æ–­</span></span><br><span class="line">HAL_TIM_Base_Start_DMA(&amp;htimx); <span class="comment">// ä»¥DMAå·¥ä½œæ–¹å¼å¯åŠ¨å®šæ—¶å™¨</span></span><br></pre></td></tr></table></figure><p><strong>GPIOå¼•è„šç›¸å…³çš„éƒ¨åˆ†HALåº“å‡½æ•°</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HAL_GPIO_WritePin(GPIOX, GPIO_PIN_XX, GPIO_PIN_RESET); <span class="comment">// æ§åˆ¶PX_XXå¼•è„šè¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">HAL_GPIO_WritePin(GPIOX, GPIO_PIN_XX, GPIO_PIN_SET); <span class="comment">// æ§åˆ¶PX_XXå¼•è„šè¾“å‡ºé«˜ç”µå¹³</span></span><br><span class="line">HAL_GPIO_TogglePin(GPIOX, GPIO_PIN_XX); <span class="comment">// æ§åˆ¶PX_XXå¼•è„šç¿»è½¬ç”µå¹³</span></span><br><span class="line">HAL_GPIO_ReadPin(GPIOX, GPIO_PIN_XX); <span class="comment">// è¯»å–PX_XXå¼•è„šå½“å‰çŠ¶æ€</span></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq562029186/article/details/76216311">__weakä¿®é¥°ç¬¦</a>ï¼šåœ¨ HAL åº“ä¸­ï¼Œå¾ˆå¤š<a href="https://so.csdn.net/so/search?q=%E5%9B%9E%E8%B0%83&amp;spm=1001.2101.3001.7020">å›è°ƒ</a>å‡½æ•°å‰é¢ä½¿ç”¨__weak ä¿®é¥°ç¬¦ã€‚ä¾‹å¦‚æœ¬æ¬¡å®éªŒæ‰€ç”¨åˆ°çš„å®šæ—¶å™¨ä¸­æ–­å›è°ƒå‡½æ•°ï¼š<code>void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim) </code>å…¶å‡½æ•°åŸå‹ä¸ºï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__weak <span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span>;</span><br></pre></td></tr></table></figure><p>åŠ ä¸Šäº†__weak ä¿®é¥°ç¬¦çš„å‡½æ•°,ç”¨æˆ·å¯ä»¥åœ¨ç”¨æˆ·æ–‡ä»¶ä¸­é‡æ–°å®šä¹‰ä¸€ä¸ªåŒåå‡½æ•°ï¼Œæœ€ç»ˆç¼–è¯‘å™¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šé€‰æ‹©ç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰é‡æ–°å®šä¹‰è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šæ‰§è¡Œ weak å£°æ˜çš„å‡½æ•°ï¼Œå¹¶ä¸”ç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ã€‚</p></blockquote><h4 id="åœ¨main-cæ–‡ä»¶ä¸­åœ¨æ‰€æŒ‡ç¤ºçš„ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç ">åœ¨main.cæ–‡ä»¶ä¸­åœ¨æ‰€æŒ‡ç¤ºçš„ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç </h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ä»¥ä¸­æ–­æ¨¡å¼å¼€å¯å®šæ—¶å™¨7 */</span></span><br><span class="line">HAL_TIM_Base_Start_IT(&amp;htim7);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å®šæ—¶å™¨ä¸­æ–­å›è°ƒå‡½æ•° */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/* åˆ¤æ–­è¿›å…¥ä¸­æ–­å®šæ—¶å™¨æ˜¯å¦ä¸ºTIM7 */</span></span><br><span class="line"><span class="keyword">if</span> (htim == &amp;htim7)&#123;</span><br><span class="line"><span class="comment">/* æ§åˆ¶è¿æ¥LEDçš„å¼•è„šç¿»è½¬ç”µå¹³ */</span></span><br><span class="line">HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åœ¨å•ç‰‡æœºä¸Šè§‚å¯Ÿå®éªŒç°è±¡</strong></p><h3 id="â…¡-è½¯ä»¶PWMå®ç°æ§åˆ¶èœ‚é¸£å™¨å“åº¦">â…¡.è½¯ä»¶PWMå®ç°æ§åˆ¶èœ‚é¸£å™¨å“åº¦</h3><h4 id="å®éªŒåŸç†-2">å®éªŒåŸç†</h4><h5 id="ï¼ˆ1ï¼‰PWM">ï¼ˆ1ï¼‰PWM</h5><p><a href="https://baike.baidu.com/item/PWM%E6%8A%80%E6%9C%AF/10204668">è„‰å†²å®½åº¦è°ƒåˆ¶(PWM)</a>ï¼Œæ˜¯è‹±æ–‡â€œPulse Width Modulationâ€çš„ç¼©å†™ï¼Œç®€ç§°<strong>è„‰å®½è°ƒåˆ¶</strong>ï¼Œæ˜¯åˆ©ç”¨å¾®å¤„ç†å™¨çš„æ•°å­—è¾“å‡ºæ¥å¯¹æ¨¡æ‹Ÿç”µè·¯è¿›è¡Œæ§åˆ¶çš„ä¸€ç§éå¸¸æœ‰æ•ˆçš„æŠ€æœ¯ï¼Œå¹¿æ³›åº”ç”¨åœ¨ä»æµ‹é‡ã€é€šä¿¡åˆ°åŠŸç‡æ§åˆ¶ä¸å˜æ¢çš„è®¸å¤šé¢†åŸŸä¸­ã€‚</p><p>ä»¥å•ç‰‡æœºä¸ºä¾‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå•ç‰‡æœºçš„IOå£è¾“å‡ºçš„æ˜¯<strong>æ•°å­—ä¿¡å·</strong>ï¼Œ<strong>IOå£åªèƒ½è¾“å‡ºé«˜ç”µå¹³å’Œä½ç”µå¹³</strong></p><p>å‡è®¾é«˜ç”µå¹³ä¸º5V ä½ç”µå¹³åˆ™ä¸º0V é‚£ä¹ˆæˆ‘ä»¬è¦<strong>è¾“å‡ºä¸åŒçš„æ¨¡æ‹Ÿç”µå‹</strong>ï¼Œå°±è¦ç”¨åˆ°PWMï¼Œé€šè¿‡æ”¹å˜IOå£è¾“å‡ºçš„<strong>æ–¹æ³¢çš„å ç©ºæ¯”</strong>ä»è€Œè·å¾—ä½¿ç”¨æ•°å­—ä¿¡å·æ¨¡æ‹Ÿæˆçš„æ¨¡æ‹Ÿç”µå‹ä¿¡å·</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œç”µå‹æ˜¯ä»¥ä¸€ç§è¿æ¥1æˆ–æ–­å¼€0çš„é‡å¤è„‰å†²åºåˆ—è¢«å¤¹åˆ°æ¨¡æ‹Ÿè´Ÿè½½ä¸Šå»çš„ï¼ˆä¾‹å¦‚LEDç¯ï¼Œç›´æµç”µæœºç­‰ï¼‰ï¼Œè¿æ¥å³æ˜¯ç›´æµä¾›ç”µè¾“å‡ºï¼Œæ–­å¼€å³æ˜¯ç›´æµä¾›ç”µæ–­å¼€ã€‚é€šè¿‡å¯¹è¿æ¥å’Œæ–­å¼€æ—¶é—´çš„æ§åˆ¶ï¼Œç†è®ºä¸Šæ¥è®²ï¼Œå¯ä»¥è¾“å‡ºä»»æ„ä¸å¤§äºæœ€å¤§ç”µå‹å€¼ï¼ˆå³0~5Vä¹‹é—´ä»»æ„å¤§å°ï¼‰çš„æ¨¡æ‹Ÿç”µå‹</p><p>æ¯”æ–¹è¯´ å ç©ºæ¯”ä¸º50% é‚£å°±æ˜¯é«˜ç”µå¹³æ—¶é—´ä¸€åŠï¼Œä½ç”µå¹³æ—¶é—´ä¸€åŠï¼Œåœ¨ä¸€å®šçš„é¢‘ç‡ä¸‹ï¼Œå°±å¯ä»¥å¾—åˆ°æ¨¡æ‹Ÿçš„2.5Vè¾“å‡ºç”µå‹ é‚£ä¹ˆ75%çš„å ç©ºæ¯” å¾—åˆ°çš„ç”µå‹å°±æ˜¯3.75V</p><p>pwmçš„è°ƒèŠ‚ä½œç”¨æ¥æºäºå¯¹â€œå å‘¨æœŸâ€çš„å®½åº¦æ§åˆ¶ï¼Œâ€œå å‘¨æœŸâ€å˜å®½ï¼Œè¾“å‡ºçš„èƒ½é‡å°±ä¼šæé«˜ï¼Œé€šè¿‡é˜»å®¹å˜æ¢ç”µè·¯æ‰€å¾—åˆ°çš„å¹³å‡ç”µå‹å€¼ä¹Ÿä¼šä¸Šå‡ï¼Œâ€œå å‘¨æœŸâ€å˜çª„ï¼Œè¾“å‡ºçš„ç”µå‹ä¿¡å·çš„ç”µå‹å¹³å‡å€¼å°±ä¼šé™ä½ï¼Œé€šè¿‡é˜»å®¹å˜æ¢ç”µè·¯æ‰€å¾—åˆ°çš„å¹³å‡ç”µå‹å€¼ä¹Ÿä¼šä¸‹é™</p><p>ä¹Ÿå°±æ˜¯ï¼Œ<strong>åœ¨ä¸€å®šçš„é¢‘ç‡ä¸‹ï¼Œé€šè¿‡ä¸åŒçš„å ç©ºæ¯”å³å¯å¾—åˆ°ä¸åŒçš„è¾“å‡ºæ¨¡æ‹Ÿç”µå‹</strong></p><p>pwmå°±æ˜¯é€šè¿‡è¿™ç§åŸç†å®ç°D/Aè½¬æ¢çš„ã€‚</p><ul><li><strong>å ç©ºæ¯”æ˜¯æŒ‡åœ¨ä¸€ä¸ªè„‰å†²å¾ªç¯å†…ï¼Œé€šç”µæ—¶é—´ç›¸å¯¹äºæ€»æ—¶é—´æ‰€å çš„æ¯”ä¾‹ã€‚ å ç©ºæ¯”(Duty Ratio)åœ¨ç”µä¿¡é¢†åŸŸä¸­æœ‰å¦‚ä¸‹å«ä¹‰ï¼šä¾‹å¦‚ï¼šè„‰å†²å®½åº¦1Î¼sï¼Œä¿¡å·å‘¨æœŸ4Î¼sçš„è„‰å†²åºåˆ—å ç©ºæ¯”ä¸º0.25</strong></li></ul><h5 id="ï¼ˆ2ï¼‰PWMæ§åˆ¶èœ‚é¸£å™¨å“åº¦çš„åŸç†">ï¼ˆ2ï¼‰PWMæ§åˆ¶èœ‚é¸£å™¨å“åº¦çš„åŸç†</h5><p><strong>èœ‚é¸£å™¨éŸ³é‡çš„å¤§å°ä¸ç”µå‹å¤§å°æˆæ­£æ¯”</strong>ï¼Œå› æ­¤é€šè¿‡è°ƒèŠ‚è½¯ä»¶pwmçš„å ç©ºæ¯”ï¼Œæ¥å¾—åˆ°ä¸åŒçš„è¾“å‡ºæ¨¡æ‹Ÿç”µå‹ï¼Œå³å¯æ§åˆ¶èœ‚é¸£å™¨çš„å“åº¦ã€‚</p><h4 id="STM32CubeMXçš„é…ç½®-2">STM32CubeMXçš„é…ç½®</h4><p><strong>Step1ï¼šé…ç½®RCC</strong></p><p><strong>Step2ï¼šé…ç½®SYS</strong></p><p><strong>Step3ï¼šé…ç½®åŸºç¡€å®šæ—¶å™¨TIM7</strong></p><p>è¦å®ç°é€šè¿‡è°ƒèŠ‚è½¯ä»¶PWMçš„å ç©ºæ¯”æ¨¡æ‹Ÿä¸åŒçš„è¾“å‡ºç”µå‹ï¼ŒPWMéœ€æœ‰è¾ƒé«˜é¢‘ç‡ã€‚</p><p>æ‰€ä»¥æ­¤å¤„è®¾Psc = 31ï¼Œ Arr = 99ï¼›</p><p><strong>Step4ï¼šæŸ¥çœ‹å¼€å‘æ¿åŸç†å›¾æŸ¥æ‰¾åˆ°èœ‚é¸£å™¨BEEPå¼•è„š -&gt; PC12</strong></p><p><em>å¦‚æœä½¿ç”¨çš„æ˜¯å…¶ä»–å¼€å‘æ¿ï¼Œåˆ™æ ¹æ®æ‰€ä½¿ç”¨å¼€å‘æ¿çš„åŸç†å›¾å¯»æ‰¾åˆ°æ¥BEEPï¼ˆèœ‚é¸£å™¨ï¼‰çš„å¼•è„šï¼Œè‹¥è¯¥å¼€å‘æ¿æ— èœ‚é¸£å™¨ï¼Œå¯å¯»æ‰¾ä¸€ä¸ªå¼•å‡ºçš„å¼•è„šï¼Œå‡†å¤‡ä¸€ä¸ªèœ‚é¸£å™¨æ¨¡å—/èœ‚é¸£å™¨ï¼ŒæŒ‰ç…§èœ‚é¸£å™¨çš„æ­£è´Ÿææ‰‹åŠ¨å°†èœ‚é¸£å™¨çš„ä¸€ç«¯ä¸æ‰€é€‰å¼•è„šç›¸è¿ï¼Œå¦ä¸€ç«¯ä¸å¼€å‘æ¿ä¸Šçš„GNDç›¸è¿</em></p><p><strong>Step5ï¼šé…ç½®BEEPå¼•è„šPC12ä¸ºGPIO_Outputï¼ˆè¾“å‡ºï¼‰æ¨¡å¼</strong></p><p><strong>Step6ï¼šé…ç½®æ—¶é’Ÿæ ‘,ä¸»é¢‘ç‡è®¾ä¸º64HMz</strong></p><p><strong>Step7ï¼šé…ç½®å·¥ç¨‹å±æ€§</strong></p><p><strong>Step8ï¼šç”ŸæˆKeilå·¥ç¨‹</strong></p><h6 id="åœ¨main-cæ–‡ä»¶ä¸­åœ¨æ‰€æŒ‡ç¤ºçš„ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç -2">åœ¨main.cæ–‡ä»¶ä¸­åœ¨æ‰€æŒ‡ç¤ºçš„ä½ç½®æ·»åŠ ä»¥ä¸‹ä»£ç </h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ‰€å®šä¹‰çš„å…¨å±€å˜é‡ */</span></span><br><span class="line"><span class="type">uint8_t</span> counter = <span class="number">0</span>; <span class="comment">//è®¡æ•°å™¨</span></span><br><span class="line"><span class="type">uint8_t</span> pwmrate = <span class="number">20</span>;<span class="comment">//è½¯ä»¶PWMçš„å ç©ºæ¯”</span></span><br><span class="line"><span class="type">_Bool</span> sw = <span class="number">0</span>; <span class="comment">//ç”¨äºæ§åˆ¶pwmrateçš„è‡ªå¢æˆ–è‡ªå‡ã€_Boolä¸ºå¸ƒå°”ç±»å‹å˜é‡ï¼Œåªæœ‰1ä½å³0å’Œ1ã€‘</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ä»¥ä¸­æ–­æ¨¡å¼å¼€å¯å®šæ—¶å™¨7 */</span></span><br><span class="line">HAL_TIM_Base_Start_IT(&amp;htim7);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å®šæ—¶å™¨ä¸­æ–­å›è°ƒå‡½æ•° */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">HAL_TIM_PeriodElapsedCallback</span><span class="params">(TIM_HandleTypeDef *htim)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/* è½¯ä»¶PWM */</span></span><br><span class="line"><span class="keyword">if</span> (counter &lt;= <span class="number">100</span>)</span><br><span class="line">&#123;</span><br><span class="line">counter++;</span><br><span class="line"><span class="comment">/* å½“è®¡æ•°å€¼å°äºç­‰äºpwmrateæ—¶PC12ä¸º1ï¼Œåä¹‹ä¸º0 */</span></span><br><span class="line"><span class="comment">/* å ç©ºæ¯”ä¸º pwmrate/100ï¼…ï¼Œå³pamrate */</span></span><br><span class="line"><span class="keyword">if</span>(counter &lt;= pwmrate)</span><br><span class="line">HAL_GPIO_WritePin(GPIOC, GPIO_PIN_12, GPIO_PIN_SET);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">HAL_GPIO_WritePin(GPIOC, GPIO_PIN_12, GPIO_PIN_RESET);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å½“counterå€¼è¶…è¿‡100å½’é›¶ */</span></span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">counter = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å½“pwmrateå³å ç©ºæ¯”å°äº100ï¼Œä¸”swä¸º0æ—¶ï¼Œå ç©ºæ¯”é€æ¸å¢åŠ ï¼Œç›´è‡³100 */</span></span><br><span class="line"><span class="keyword">if</span> (pwmrate &lt; <span class="number">100</span> &amp;&amp; sw == <span class="number">0</span>)</span><br><span class="line">pwmrate++;</span><br><span class="line"><span class="comment">/* å½“pwmrateå³å ç©ºæ¯”å¤§äºæˆ–ç­‰äº100æ—¶ï¼Œswç½®ä¸º1 */</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">sw = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å½“pwmrateå³å ç©ºæ¯”å¤§äº20ï¼Œä¸”swä¸º1æ—¶ï¼Œå ç©ºæ¯”é€æ¸å‡å°ï¼Œç›´è‡³20 */</span></span><br><span class="line"><span class="keyword">if</span> (pwmrate &gt; <span class="number">20</span> &amp;&amp; sw == <span class="number">1</span>)</span><br><span class="line">pwmrate--;</span><br><span class="line"><span class="comment">/* å½“pwmrateå³å ç©ºæ¯”å°äºæˆ–ç­‰äº20æ—¶ï¼Œswç½®0 */</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">sw = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å»¶æ—¶20msï¼Œä½¿ç°è±¡å¯ä»¥è¢«äººè§‚æµ‹åˆ° */</span></span><br><span class="line">HAL_Delay(<span class="number">20</span>);</span><br></pre></td></tr></table></figure><h6 id="åœ¨å•ç‰‡æœºä¸Šè§‚å¯Ÿå®éªŒç°è±¡">åœ¨å•ç‰‡æœºä¸Šè§‚å¯Ÿå®éªŒç°è±¡</h6><blockquote><h6 id="æ‹“å±•ï¼šHALåº“ä¸­çš„éƒ¨åˆ†é‡å®šä¹‰å˜é‡ç±»å‹">æ‹“å±•ï¼šHALåº“ä¸­çš„éƒ¨åˆ†é‡å®šä¹‰å˜é‡ç±»å‹</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="comment">/* ä½äºâ€œstdint.hâ€æ–‡ä»¶ä¸­ */</span></span><br><span class="line">&gt;<span class="comment">/* exact-width signed integer types */</span></span><br><span class="line">&gt;<span class="keyword">typedef</span>   <span class="type">signed</span>          <span class="type">char</span> <span class="type">int8_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span>   <span class="type">signed</span> <span class="type">short</span>     <span class="type">int</span> <span class="type">int16_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span>   <span class="type">signed</span>           <span class="type">int</span> <span class="type">int32_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span>   <span class="type">signed</span>       __INT64 <span class="type">int64_t</span>;</span><br><span class="line">&gt;<span class="comment">/* exact-width unsigned integer types */</span></span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span>          <span class="type">char</span> <span class="type">uint8_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span>     <span class="type">int</span> <span class="type">uint16_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span>           <span class="type">int</span> <span class="type">uint32_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span>       __INT64 <span class="type">uint64_t</span>;</span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨çš„ç±»å‹æœ‰ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="keyword">typedef</span>   <span class="type">signed</span> <span class="type">short</span>     <span class="type">int</span> <span class="type">int16_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span>   <span class="type">signed</span>           <span class="type">int</span> <span class="type">int32_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span>          <span class="type">char</span> <span class="type">uint8_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span>     <span class="type">int</span> <span class="type">uint16_t</span>;</span><br><span class="line">&gt;<span class="keyword">typedef</span> <span class="type">unsigned</span>           <span class="type">int</span> <span class="type">uint32_t</span>;</span><br></pre></td></tr></table></figure></blockquote><h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3><p><a href="https://www.cnblogs.com/dongxiaodong/p/14351398.html">ã€æ¥æºäºç½‘ç»œã€‘STM32å®šæ—¶å™¨è¯¦ç»†ç¯‡ï¼ˆåŸºäºHALåº“ï¼‰</a></p><p><a href="https://blog.csdn.net/as480133937/article/details/103439546">ã€æ¥æºäºç½‘ç»œã€‘PWMåŸç† PWMé¢‘ç‡ä¸å ç©ºæ¯”è¯¦è§£-zå°æ—‹</a></p><p><a href="https://blog.csdn.net/as480133937/article/details/99201209">ã€æ¥æºäºç½‘ç»œã€‘ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹å…­----å®šæ—¶å™¨ä¸­æ–­-zå°æ—‹</a></p><p><a href="https://blog.csdn.net/as480133937/article/details/99231677">ã€æ¥æºäºç½‘ç»œã€‘ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹ä¸ƒâ€”PWMè¾“å‡º(å‘¼å¸ç¯) -zå°æ—‹</a></p><h1>4.STM32ä¸²å£é€šä¿¡ã€LCDçš„ä½¿ç”¨åŠSPIã€IIC</h1><p><a href="https://blog.csdn.net/as480133937/article/details/99073783">ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹å››â€”UARTä¸²å£é€šä¿¡è¯¦è§£_hal_uart_transmit_Zå°æ—‹çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="ä¸²å£-USART-ã€SPIã€IICçš„ä»‹ç»ï¼ˆæ–‡æœ«é™„ç›¸å…³åšå®¢ï¼‰">ä¸²å£(USART)ã€SPIã€IICçš„ä»‹ç»ï¼ˆæ–‡æœ«é™„ç›¸å…³åšå®¢ï¼‰</h2><h3 id="STM32G070RBT6â€”â€”â€”ä¸²å£">STM32G070RBT6â€”â€”â€”ä¸²å£</h3><p><strong>1.é€šä¿¡æ–¹å¼</strong></p><p>STM32G070RBT6æ‹¥æœ‰å››ä¸ªä¸²å£ï¼Œæ¯ä¸ªä¸²å£éƒ½æ‹¥æœ‰å¤šç§ä¸åŒçš„å·¥ä½œå¼ï¼Œå¤§è‡´å¯ä»¥æŒ‰ç…§å¦‚ä¸‹åˆ†ç±»ï¼š</p><p>ç¬¬ä¸€åˆ†ç±»ä¸º<strong>å¹¶è¡Œé€šä¿¡å’Œä¸²è¡Œé€šä¿¡</strong>ï¼Œè€Œç”±äºä¸²è¡Œé€šä¿¡çš„ä¼˜ç‚¹ä»¥åŠå¯¹ç¼ºç‚¹çš„å¼¥è¡¥ï¼Œå¯¼è‡´å¦‚ä»ŠåŸºæœ¬éƒ½é‡‡ç”¨<strong>ä¸²è¡Œé€šä¿¡</strong>ï¼›</p><p>å¯¹äºä¸²è¡Œé€šä¿¡ï¼ŒåˆæŒ‰ç…§æ˜¯å¦æœ‰åŒæ­¥æ—¶é’Ÿå’Œæ”¶å‘é—´çš„æ•°æ®ä¼ è¾“æ–¹å‘åˆ†æˆä¸¤å¤§ç±»ï¼›</p><pre><code> å…¶ä¸­ï¼ŒæŒ‰ç…§æ˜¯å¦æœ‰åŒæ­¥æ—¶é’Ÿåˆ†æˆåŒæ­¥å’Œå¼‚æ­¥ï¼š</code></pre><p>åŒæ­¥é€šä¿¡ï¼šå¸¦æ—¶é’ŸåŒæ­¥ä¿¡å·ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹åœ¨åŒä¸€æ—¶é’Ÿçš„æ§åˆ¶ä¸‹ï¼Œå®ç°åŒæ­¥ä¼ è¾“ã€‚</p><p>å¼‚æ­¥é€šä¿¡ï¼šä¸å¸¦æ—¶é’ŸåŒæ­¥ä¿¡å·ï¼Œä½¿ç”¨å„è‡ªçš„æ—¶é’Ÿæ§åˆ¶ã€‚ ä½†éœ€è¦åŒæ–¹ç›¸äº’çº¦å®šå¥½æ•°æ®ä¼ è¾“é€Ÿç‡ã€‚</p><pre><code> ä¼ è¾“é€Ÿç‡çš„è¡¡é‡æ–¹å¼â€”â€”æ³¢ç‰¹ç‡â€”å•ä½ï¼šbpsï¼ˆä½/ç§’ï¼‰ æŒ‰ç…§æ•°æ®ä¼ è¾“æ–¹å‘åˆ†æˆå•å·¥ã€åŠåŒå·¥å’Œå…¨å·¥ï¼š</code></pre><p>å•å·¥é€šä¿¡ï¼šæ•°æ®åªæ²¿ç€ä¸€ä¸ªæ–¹å‘ä¼ è¾“ï¼Œå‘é€ç«¯å’Œæ¥å—ç«¯å›ºå®šï¼Œåªéœ€è¦ä¸€æ ¹æ•°æ®çº¿ã€‚</p><p>åŠåŒå·¥é€šä¿¡ï¼šæ•°æ®å¯ä»¥æ²¿ç€ä¸¤ä¸ªæ–¹å‘ä¼ è¾“ï¼Œä½†ä¸èƒ½åŒæ—¶è¿›è¡Œï¼Œéœ€è¦ä¸¤æ ¹æ•°æ®çº¿ã€‚</p><p>å…¨åŒå·¥é€šä¿¡ï¼šæ•°æ®å¯ä»¥æ²¿ç€ä¸¤ä¸ªæ–¹å‘ä¼ è¾“ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œï¼Œéœ€è¦ä¸¤æ ¹æ•°æ®çº¿ã€‚</p><p>å¤§çº²å›¾ï¼š<a href="https://i.postimg.cc/TYmzmtBG/20210720113312701.png">https://i.postimg.cc/TYmzmtBG/20210720113312701.png</a></p><p><strong>2.UARTåè®®</strong></p><ul><li><strong>USART-é€šç”¨åŒæ­¥å¼‚æ­¥æ”¶å‘å™¨(Universal Synchronous Asynchronous Receiver and Transmitter)æ˜¯ä¸€ä¸ªä¸²è¡Œé€šä¿¡è®¾å¤‡ï¼Œå¯ä»¥çµæ´»åœ°ä¸å¤–éƒ¨è®¾å¤‡è¿›è¡Œå…¨åŒå·¥æ•°æ®äº¤æ¢ã€‚</strong></li><li><strong>UART-é€šç”¨å¼‚æ­¥æ”¶å‘å™¨(Universal Asynchronous Receiver and Transmitter)ï¼Œå®ƒæ˜¯åœ¨ USART åŸºç¡€ä¸Šè£å‰ªæ‰äº†åŒæ­¥é€šä¿¡åŠŸèƒ½ï¼ˆæ—¶é’ŸåŒæ­¥ï¼‰ï¼Œåªæœ‰å¼‚æ­¥é€šä¿¡ã€‚ç®€å•åŒºåˆ†åŒæ­¥å’Œå¼‚æ­¥å°±æ˜¯çœ‹é€šä¿¡æ—¶éœ€ä¸éœ€è¦å¯¹å¤–æä¾›æ—¶é’Ÿè¾“å‡ºï¼Œæˆ‘ä»¬å¹³æ—¶ç”¨çš„ä¸²å£é€šä¿¡åŸºæœ¬éƒ½æ˜¯ UARTã€‚</strong></li></ul><p><strong>UART-å…¨åŒå·¥</strong></p><p><a href="https://blog.csdn.net/k666499436/article/details/124354165">STM32ä¸²å£é€šä¿¡è¯¦è§£_rivencodeçš„åšå®¢-CSDNåšå®¢</a></p><h3 id="STM32G070RBT6â€”â€”â€”SPIé€šè®¯åè®®">STM32G070RBT6â€”â€”â€”SPIé€šè®¯åè®®</h3><p><strong>SPI-å…¨åŒå·¥</strong></p><p><a href="https://great.blog.csdn.net/article/details/109460814"> SPIåè®®è¯¦è§£ï¼ˆå›¾æ–‡å¹¶èŒ‚+è¶…è¯¦ç»†ï¼‰_å°éº¦å¤§å”çš„åšå®¢-CSDNåšå®¢</a></p><h3 id="STM32G070RBT6â€”â€”â€”IICï¼ˆI2Cï¼‰">STM32G070RBT6â€”â€”â€”IICï¼ˆI2Cï¼‰</h3><p><strong>IIC-åŠåŒå·¥</strong></p><p><a href="https://blog.csdn.net/weixin_44933419/article/details/114991088?ops_request_misc=%7B%22request%5Fid%22%3A%22168112795916800226579942%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168112795916800226579942&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-114991088-null-null.142%5Ev82%5Einsert_down1,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&amp;utm_term=IIC&amp;spm=1018.2226.3001.4187"> å¸¸ç”¨é€šä¿¡åè®®â€”â€”IICè¯¦è§£ï¼ˆå…¨ç½‘æœ€å…¨ï¼‰_iicé€šä¿¡åè®®_é˜¿æ³¢ç½—å•¦å•¦å•¦å•¦çš„åšå®¢-CSDNåšå®¢</a></p><p><strong>printfçš„é‡å®šå‘é—®é¢˜:</strong></p><p><a href="https://zhuanlan.zhihu.com/p/145801160">é…ç½®CLionç”¨äºSTM32å¼€å‘ã€ä¼˜é›…ã®åµŒå…¥å¼å¼€å‘ã€‘ - çŸ¥ä¹ (zhihu.com)</a></p><h2 id="LCDæ˜¾ç¤º">LCDæ˜¾ç¤º</h2><p><strong>è§ç¬¬å››æ¬¡åŸ¹è®­</strong></p><h1>5.STM32ADC å¤–è®¾</h1><p><a href="https://blog.csdn.net/as480133937/article/details/99627062">ã€STM32ã€‘HALåº“ STM32CubeMXæ•™ç¨‹ä¹â€”ADC_stm32cubemx adc_Zå°æ—‹çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="ADC-ä»‹ç»">ADC ä»‹ç»</h2><p><strong>ä»€ä¹ˆæ˜¯ ADCï¼Ÿ</strong></p><p>Analog-to-Digital Converter çš„ç¼©å†™ã€‚æŒ‡æ¨¡/æ•°è½¬æ¢å™¨æˆ–è€…æ¨¡æ‹Ÿ/æ•°å­—è½¬æ¢å™¨ã€‚æ˜¯æŒ‡å°†è¿ç»­</p><p>å˜é‡çš„æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸ºç¦»æ•£çš„æ•°å­—ä¿¡å·çš„å™¨ä»¶ã€‚å…¸å‹çš„æ¨¡æ‹Ÿæ•°å­—è½¬æ¢å™¨å°†æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸º</p><p>è¡¨ç¤ºä¸€å®šæ¯”ä¾‹ç”µå‹å€¼çš„æ•°å­—ä¿¡å·ã€‚ç®€å•åœ°è¯´å°±æ˜¯å°†æ¨¡æ‹Ÿç”µå‹å€¼ï¼Œè½¬æ¢æˆå¯¹åº”çš„è‚‰çœ¼å¯è¯»æ•°</p><p>å€¼ 12 ä½ ADC æ˜¯ä¸€ç§é€æ¬¡é€¼è¿‘å‹æ¨¡æ‹Ÿæ•°å­—è½¬æ¢å™¨ã€‚A/D è½¬æ¢å¯ä»¥å•æ¬¡ã€è¿ç»­ã€æ‰«ææˆ–é—´æ–­</p><p>æ¨¡å¼æ‰§è¡Œã€‚ADC çš„ç»“æœå¯ä»¥å·¦å¯¹é½æˆ–å³å¯¹é½æ–¹å¼å­˜å‚¨åœ¨ 16 ä½æ•°æ®å¯„å­˜å™¨ä¸­</p><p>â€œè¾“å…¥çš„æ¨¡æ‹Ÿé‡â€æ˜¯è¾“å…¥ç”µå‹ä¿¡å·ï¼Œâ€œSTARTâ€ç”¨æ¥æ§åˆ¶ ADC å¯åŠ¨è½¬æ¢ï¼Œâ€œCLOCKâ€æ˜¯ ADC æ¨¡å—çš„è¾“å…¥æ—¶é’Ÿï¼Œâ€œEOCâ€æ˜¯ ADC è½¬æ¢ç»“æŸä¿¡å·ï¼Œ</p><p>â€œOEâ€æ˜¯ ADC è½¬æ¢ç»“æœè¾“å‡ºå…è®¸ä¿¡å·ï¼Œâ€œVREFâ€æ˜¯å‚è€ƒç”µå‹ã€‚</p><h3 id="ADC-çš„è½¬æ¢æ¨¡å¼-é‡è¦ï¼Œè¯·åŠ¡å¿…çœ‹æ‡‚">ADC çš„è½¬æ¢æ¨¡å¼ (é‡è¦ï¼Œè¯·åŠ¡å¿…çœ‹æ‡‚)</h3><p><strong>å•æ¬¡è½¬æ¢æ¨¡å¼</strong>ï¼šADC åªæ‰§è¡Œä¸€æ¬¡è½¬æ¢ï¼›</p><p><strong>è¿ç»­è½¬æ¢æ¨¡å¼</strong>ï¼šè½¬æ¢ç»“æŸä¹‹åé©¬ä¸Šå¼€å§‹æ–°çš„è½¬æ¢ï¼›</p><p><strong>æ‰«ææ¨¡å¼</strong>ï¼šADC æ‰«æè¢«è§„åˆ™é€šé“å’Œæ³¨å…¥é€šé“é€‰ä¸­çš„æ‰€æœ‰é€šé“ï¼Œåœ¨æ¯ä¸ªç»„çš„æ¯ä¸ªé€šé“ä¸Šæ‰§è¡Œå•æ¬¡è½¬æ¢ã€‚</p><p>åœ¨æ¯ä¸ªè½¬æ¢ç»“æŸæ—¶ï¼Œè¿™ä¸€ç»„çš„ä¸‹ä¸€ä¸ªé€šé“è¢«è‡ªåŠ¨è½¬æ¢ã€‚å¦‚æœè®¾ç½®äº† CONT ä½</p><p>ï¼ˆå¼€å¯äº†è¿ç»­ è½¬æ¢æ¨¡å¼ï¼‰ï¼Œè½¬æ¢ä¸ä¼šåœ¨é€‰æ‹©ç»„çš„æœ€åä¸€ä¸ªé€šé“ä¸Šåœæ­¢ï¼Œè€Œæ˜¯å†æ¬¡ä»é€‰æ‹©ç»„</p><p>çš„ç¬¬ä¸€ä¸ªé€šé“ç»§ç»­è½¬æ¢ã€‚</p><p><strong>é—´æ–­æ¨¡å¼</strong>ï¼šè§¦å‘ä¸€æ¬¡ï¼Œè½¬æ¢ä¸€ä¸ªé€šé“ï¼Œå†è§¦å‘ï¼Œå†è½¬æ¢ã€‚åœ¨æ‰€é€‰è½¬æ¢é€šé“å¾ªç¯ï¼Œç”±è§¦å‘ä¿¡å·å¯åŠ¨æ–°ä¸€è½®çš„è½¬æ¢ï¼Œç›´åˆ°è½¬æ¢å®Œæˆä¸ºæ­¢ã€‚ï¼ˆæ‰«ææ¨¡å¼ç®€å•çš„è¯´æ˜¯ä¸€æ¬¡å¯¹æ‰€æœ‰æ‰€é€‰ä¸­çš„é€šé“è¿›è¡Œè½¬æ¢ï¼Œ</p><p>æ¯”å¦‚å¼€äº† ch0ï¼Œch1ï¼Œch4ï¼Œch5ã€‚ ch0 è½¬æ¢å®Œä»¥åå°±ä¼šè‡ªåŠ¨è½¬æ¢é€šé“ 1,4,5</p><p>ç›´åˆ°è½¬æ¢å®Œè¿™ä¸ªè¿‡ç¨‹ä¸èƒ½è¢«æ‰“æ–­ã€‚å¦‚æœå¼€å¯äº†è¿ç»­è½¬æ¢æ¨¡å¼ï¼Œåˆ™ä¼šåœ¨è½¬æ¢å®Œ ch5 ä¹‹åå¼€å§‹</p><p>æ–°ä¸€è½®çš„è½¬æ¢ã€‚è¿™å°±å¼•å…¥äº†é—´æ–­æ¨¡å¼ï¼Œå¯ä»¥è¯´æ˜¯å¯¹æ‰«ææ¨¡å¼çš„ä¸€ç§è¡¥å……ã€‚å®ƒå¯ä»¥æŠŠ 0,1,4,5</p><p>è¿™å››ä¸ªé€šé“è¿›è¡Œåˆ†ç»„ã€‚å¯ä»¥åˆ†æˆ 0,1 ä¸€ç»„ï¼Œ4,5 ä¸€ç»„ã€‚ä¹Ÿå¯ä»¥æ¯ä¸ªé€šé“å•ç‹¬é…ç½®ä¸ºä¸€ç»„ã€‚</p><p>è¿™æ ·æ¯ä¸€ç»„è½¬æ¢ä¹‹å‰éƒ½éœ€è¦å…ˆè§¦å‘ä¸€æ¬¡ã€‚ï¼‰</p><p><strong>ADC å•é€šé“ï¼š</strong></p><p>åªè¿›è¡Œä¸€æ¬¡ ADC è½¬æ¢ï¼š<strong>é…ç½®ä¸ºâ€œå•æ¬¡è½¬æ¢æ¨¡å¼â€ï¼Œæ‰«ææ¨¡å¼å…³é—­</strong>ã€‚ADC é€šé“è½¬æ¢ä¸€æ¬¡åï¼Œ</p><p>å°±åœæ­¢è½¬æ¢ã€‚ç­‰å¾…å†æ¬¡ä½¿èƒ½åæ‰ä¼šé‡æ–°è½¬æ¢</p><p>è¿›è¡Œè¿ç»­ ADC è½¬æ¢ï¼š<strong>é…ç½®ä¸ºâ€œè¿ç»­è½¬æ¢æ¨¡å¼â€ï¼Œæ‰«ææ¨¡å¼å…³é—­</strong>ã€‚ADC é€šé“è½¬æ¢ä¸€æ¬¡åï¼Œ</p><p>æ¥ç€è¿›è¡Œä¸‹ä¸€æ¬¡è½¬æ¢ï¼Œä¸æ–­è¿ç»­ã€‚</p><p><strong>ADC å¤šé€šé“ï¼š</strong></p><p>åªè¿›è¡Œä¸€æ¬¡ ADC è½¬æ¢ï¼š<strong>é…ç½®ä¸ºâ€œå•æ¬¡è½¬æ¢æ¨¡å¼â€ï¼Œæ‰«ææ¨¡å¼ä½¿èƒ½</strong>ã€‚ADC çš„å¤šä¸ªé€šé“ï¼ŒæŒ‰ç…§é…ç½®çš„é¡ºåºä¾æ¬¡è½¬æ¢ä¸€æ¬¡åï¼Œå°±åœæ­¢è½¬æ¢ã€‚ç­‰å¾…å†æ¬¡ä½¿èƒ½åæ‰ä¼šé‡æ–°è½¬æ¢</p><p>è¿›è¡Œè¿ç»­ ADC è½¬æ¢ï¼š<strong>é…ç½®ä¸ºâ€œè¿ç»­è½¬æ¢æ¨¡å¼â€ï¼Œæ‰«ææ¨¡å¼ä½¿èƒ½</strong>ã€‚ADC çš„å¤šä¸ªé€šé“ï¼ŒæŒ‰ç…§</p><p>é…ç½®çš„é¡ºåºä¾æ¬¡è½¬æ¢ä¸€æ¬¡åï¼Œæ¥ç€è¿›è¡Œä¸‹ä¸€æ¬¡è½¬æ¢ï¼Œä¸æ–­è¿ç»­ã€‚</p><p>ä¹Ÿå°±æ˜¯ï¼š<strong>å¤šé€šé“å¿…é¡»ä½¿èƒ½æ‰«ææ¨¡å¼</strong></p><p><strong>å·¦å¯¹é½æˆ–å³å¯¹é½</strong></p><p>å› ä¸º ADC å¾—åˆ°çš„æ•°æ®æ˜¯ 12 ä½ç²¾åº¦çš„ï¼Œä½†æ˜¯æ•°æ®å­˜å‚¨åœ¨ 16 ä½ï¼Œæ‰€ä»¥ ADC çš„å­˜å‚¨ç»“æœå¯</p><p>ä»¥åˆ†ä¸ºå·¦å¯¹é½æˆ–å³å¯¹é½ä¸¤ç§æ–¹å¼</p><p><strong>æ³¨å…¥é€šé“ï¼Œè§„åˆ™é€šé“ï¼š</strong></p><p><strong>æ³¨å…¥é€šé“ï¼š</strong></p><p>ç¨‹åºæ­£å¸¸è¿è¡Œçš„é€šé“</p><p><strong>è§„åˆ™é€šé“ï¼š</strong></p><p>æ³¨å…¥é€šé“å¯ä»¥æ‰“æ–­è§„åˆ™é€šé“ï¼Œå¦‚æœåœ¨è§„åˆ™é€šé“è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œæœ‰æ³¨å…¥é€šé“è¿›è¡Œè½¬æ¢ï¼Œé‚£ä¹ˆå°±</p><p>è¦å…ˆè½¬æ¢å®Œæ³¨å…¥é€šé“ï¼Œç­‰æ³¨å…¥é€šé“è½¬æ¢å®Œæˆåï¼Œå†å›åˆ°è§„åˆ™é€šé“çš„è½¬æ¢æµç¨‹ï¼ˆç±»ä¼¼äºä¸­æ–­ï¼‰</p><h3 id="ADC-æ—¶é’Ÿ">ADC æ—¶é’Ÿ</h3><p>ADC æ¨¡å—çš„æ—¶é’Ÿæ¥æºæ˜¯ ADC é¢„åˆ†é¢‘å™¨çš„ ADCCLK</p><p>RCC æ§åˆ¶å™¨ä¸º ADC æ—¶é’Ÿæä¾›ä¸€ä¸ªä¸“ç”¨çš„å¯ç¼–ç¨‹é¢„åˆ†é¢‘å™¨ã€‚ åˆ†é¢‘å› å­ç”± RCC_CFGR çš„</p><p>ADCPRE[1:0]é…ç½®ï¼Œå¯é…ç½® 2/4/6/8 åˆ†é¢‘</p><p><strong>STM32 çš„ ADC æœ€å¤§çš„è½¬æ¢é€Ÿç‡ä¸º 1MHz,ä¹Ÿå°±æ˜¯è¯´æœ€å¿«è½¬æ¢æ—¶é—´ä¸º 1usï¼Œä¸ºäº†ä¿è¯ ADCè½¬æ¢ç»“æœçš„å‡†ç¡®æ€§ï¼ŒADC çš„æ—¶é’Ÿæœ€å¥½ä¸è¶…è¿‡ 14M</strong></p><h3 id="ADC-å·¥ä½œæµç¨‹">ADC å·¥ä½œæµç¨‹</h3><p>ADC ä¸€èˆ¬ç”¨äºé‡‡é›†å°ç”µå‹ï¼Œå…¶è¾“å…¥å€¼ä¸èƒ½è¶…è¿‡ VDDAï¼Œå³ ADC è¾“å…¥èŒƒå›´ï¼šVREF- â‰¤ VIN â‰¤ VREF+. <strong>ä¸€èˆ¬æŠŠVSSA å’ŒVREF-æ¥åœ°ï¼ŒVREF+ å’ŒVDDA æ¥ 3V3ï¼Œé‚£ä¹ˆADCçš„è¾“å…¥èŒƒå›´æ˜¯0~3.3Vï¼è¶…è¿‡ä¼šçƒ§åå•ç‰‡æœºï¼ï¼</strong></p><h3 id="ADC-å‡½æ•°">ADC å‡½æ•°</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">HAL_ADC_Start(&amp;hadcx); <span class="comment">//è½®è¯¢æ¨¡å¼å¼€å¯ ADC</span></span><br><span class="line">HAL_ADC_Start_IT(&amp;hadcx); <span class="comment">//ä¸­æ–­è½®è¯¢æ¨¡å¼å¼€å¯ ADC</span></span><br><span class="line">HAL_ADC_Start_DMA(&amp;hadcx)ï¼› <span class="comment">//DMA æ¨¡å¼å¼€å¯ ADC</span></span><br><span class="line">HAL_ADC_Stop() <span class="comment">//è½®è¯¢æ¨¡å¼å…³é—­ ADC</span></span><br><span class="line">HAL_ADC_Stop_IT() <span class="comment">//ä¸­æ–­è½®è¯¢æ¨¡å¼å…³é—­ ADC</span></span><br><span class="line">HAL_ADC_Stop_DMA() <span class="comment">//DMA æ¨¡å¼å…³é—­ ADC</span></span><br><span class="line">HAL_ADCEx_Calibration_Start(&amp;hadcx); <span class="comment">//ADC æ ¡å‡†å‡½æ•°</span></span><br><span class="line">HAL_ADC_GetValue() <span class="comment">//è¯»å– ADC è½¬æ¢å€¼</span></span><br><span class="line">HAL_ADC_PollForConversion(&amp;hadc1, <span class="number">50</span>); <span class="comment">//ç­‰å¾…è½¬æ¢ç»“æŸå‡½æ•°ï¼Œ50 ä¸ºç­‰å¾…æ—¶é—´ï¼ˆmsï¼‰</span></span><br><span class="line">HAL_ADC_ConvCpltCallback() <span class="comment">//ADC ä¸­æ–­å›è°ƒå‡½æ•°ï¼Œè½¬æ¢å®Œæˆåå›è°ƒï¼ŒDMA æ¨¡å¼ä¸‹</span></span><br><span class="line">DMA ä¼ è¾“å®Œæˆåè°ƒç”¨</span><br><span class="line">HAL_ADC_ConfigChannel() <span class="comment">//é…ç½®è§„åˆ™ç»„é€šé“</span></span><br><span class="line">â€¢HAL_ADC_AnalogWDGConfig(ï¼‰ <span class="comment">//çœ‹é—¨ç‹—é…ç½®</span></span><br></pre></td></tr></table></figure><h2 id="DMA-çš„åŸºæœ¬ä»‹ç»">DMA çš„åŸºæœ¬ä»‹ç»</h2><p><strong>ä»€ä¹ˆæ˜¯ DMA (DMA çš„åŸºæœ¬å®šä¹‰)</strong></p><p><strong>DMAï¼Œå…¨ç§° Direct Memory Accessï¼Œå³ç›´æ¥å­˜å‚¨å™¨è®¿é—®ã€‚</strong></p><p><strong>DMA ä¼ è¾“å°†æ•°æ®ä»ä¸€ä¸ªåœ°å€ç©ºé—´å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°å€ç©ºé—´ï¼Œæä¾›åœ¨å¤–è®¾å’Œå­˜å‚¨å™¨ä¹‹é—´æˆ–è€…</strong></p><p><strong>å­˜å‚¨å™¨å’Œå­˜å‚¨å™¨ä¹‹é—´çš„é«˜é€Ÿæ•°æ®ä¼ è¾“ã€‚</strong></p><p>æˆ‘ä»¬çŸ¥é“ CPU æœ‰è½¬ç§»æ•°æ®ã€è®¡ç®—ã€æ§åˆ¶ç¨‹åºè½¬ç§»ç­‰å¾ˆå¤šåŠŸèƒ½ï¼Œç³»ç»Ÿè¿ä½œçš„æ ¸å¿ƒå°±æ˜¯ CPUï¼ŒCPU æ— æ—¶ä¸åˆ»çš„åœ¨å¤„ç†ç€å¤§é‡çš„äº‹åŠ¡ï¼Œä½†æœ‰äº›äº‹æƒ…å´æ²¡æœ‰é‚£ä¹ˆé‡è¦ï¼Œæ¯”æ–¹è¯´æ•°æ®çš„å¤åˆ¶å’Œå­˜å‚¨æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†çš„ CPU èµ„æºæ‹¿å‡ºæ¥ï¼Œè®© CPU å»å¤„ç†å…¶ä»–çš„å¤æ‚è®¡ç®—äº‹åŠ¡ï¼Œæ˜¯ä¸æ˜¯èƒ½å¤Ÿæ›´å¥½çš„åˆ©ç”¨ CPU çš„èµ„æºå‘¢ï¼Ÿ</p><p>**å› æ­¤ï¼šè½¬ç§»æ•°æ®ï¼ˆå°¤å…¶æ˜¯è½¬ç§»å¤§é‡æ•°æ®ï¼‰æ˜¯å¯ä»¥ä¸éœ€è¦ CPU å‚ä¸ã€‚**æ¯”å¦‚å¸Œæœ›å¤–è®¾ A çš„æ•°æ®æ‹·è´åˆ°å¤–è®¾ Bï¼Œåªè¦ç»™ä¸¤ç§å¤–è®¾æä¾›ä¸€æ¡æ•°æ®é€šè·¯ï¼Œç›´æ¥è®©æ•°æ®ç”± A æ‹·è´åˆ° B ä¸ç»è¿‡CPU çš„å¤„ç†ã€‚</p><p>æ•°æ®ä¼ è¾“ä¹‹é—´æœ‰ä¸€ä¸ª<strong>ç‹¬ç«‹çš„DMAé€šé“</strong>ã€‚</p><p><strong>ADC</strong> <strong>ä½¿ç”¨</strong> <strong>DMA</strong> <strong>ç›¸å…³å‡½æ•°ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HAL_ADC_Start_DMA(ADC_HandleTypeDef *hadc, <span class="type">uint32_t</span>* pData, <span class="type">uint32_t</span> Length);</span><br></pre></td></tr></table></figure><h2 id="å®éªŒ">å®éªŒ</h2><p>1.ä½¿ç”¨ ADC æŸ¥è¯¢æ¨¡å¼ï¼Œé‡‡é›†ç”µé˜»åˆ†å‹å€¼ï¼Œæ˜¾ç¤ºåœ¨ LCD ä¸Šï¼ŒåŒæ—¶æ§åˆ¶ RGB ç¯</p><p>2.æŸ¥çœ‹å¼€å‘æ¿ç¡¬ä»¶åŸç†å›¾æ‰¾åˆ° ADC é‡‡é›†</p><p>3.å¼€å¯ ADC å¤–è®¾ï¼Œä½¿èƒ½ IN0 ç«¯å£</p><p>4.è®¾ç½®ç«¯å£</p><p>5.è®¾ç½® GPIO è¾“å‡º</p><p>6.è®¾ç½® SPIï¼ŒåŠ LCD ç«¯å£*</p><p>7.è®¾ç½®æ—¶é’Ÿ</p><p>8.è®¾ç½®å‚¨å­˜ä½ç½®åŠç¼–è¯‘å™¨</p><p>9.è®¾ç½®æ·»åŠ å¤´æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆä»£ç </p><p>10.ä»£ç ç¼–å†™åŠæ³¨é‡Š</p>]]></content>
    
    
    <summary type="html">STM32å•ç‰‡æœºå¼€å‘</summary>
    
    
    
    <category term="åµŒå…¥å¼" scheme="https://keqiudi.github.io/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
    
    <category term="åµŒå…¥å¼" scheme="https://keqiudi.github.io/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¸¸ç”¨æŒ‡ä»¤</title>
    <link href="https://keqiudi.github.io/posts/519ff8b5.html"/>
    <id>https://keqiudi.github.io/posts/519ff8b5.html</id>
    <published>2023-03-06T13:19:40.000Z</published>
    <updated>2023-07-18T15:23:35.739Z</updated>
    
    <content type="html"><![CDATA[<h1>1.Linux ç›®å½•ç»“æ„</h1><p>Linuxåªæœ‰ä¸€ä¸ªæ ¹ç›®å½•å«:  <strong>/</strong>  çš„æ–‡ä»¶å¤¹ï¼Œå…¨éƒ¨å†…å®¹éƒ½åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹ï¼Œå¼€å¤´æ€»æ˜¯  <strong>/</strong> ã€‚</p><ul><li>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œè·¯å¾„ä¹‹é—´çš„å±‚çº§å…³ç³»ï¼Œä½¿ç”¨ï¼š/æ¥è¡¨ç¤º</li><li>åœ¨Windowsç³»ç»Ÿä¸­ï¼Œè·¯å¾„ä¹‹é—´çš„å±‚çº§å…³ç³»ï¼Œä½¿ç”¨ï¼š\æ¥è¡¨ç¤º</li></ul><p><strong>Linuxä¾‹</strong>ï¼š/user/local/hello.txt(æ ¹ç›®å½•/)</p><p><strong>windowsä¾‹</strong>ï¼šD\data\work\hello.txt(Dç›˜)</p><p><strong>æ³¨æ„:</strong></p><ul><li>å¼€å¤´çš„ / è¡¨ç¤º æ ¹ç›®å½•</li><li>åé¢çš„ / è¡¨ç¤º å±‚çº§å…³ç³»</li></ul><h1>2.è·¯å¾„</h1><h2 id="ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„">ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„</h2><ul><li>cd  /home/itheima/Desktop   <strong>ç»å¯¹è·¯å¾„å†™æ³•</strong></li><li>cd  Desktop                               <strong>ç›¸å¯¹è·¯å¾„å†™æ³•</strong></li></ul><p><strong>ç»å¯¹è·¯å¾„</strong>ï¼šä»¥æ ¹ç›®å½•ï¼ˆ/ï¼‰ä¸ºèµ·ç‚¹ï¼Œæè¿°è·¯å¾„çš„ä¸€ç§å†™æ³•ï¼Œè·¯å¾„æè¿°ä»¥ / å¼€å¤´</p><p><strong>ç›¸å¯¹è·¯å¾„</strong>ï¼šä»¥å½“å‰ç›®å½•ä¸ºèµ·ç‚¹ï¼Œæè¿°è·¯å¾„çš„ä¸€ç§å†™æ³•ï¼Œè·¯å¾„æè¿°æ— éœ€ä»¥ /  å¼€å¤´</p><p><strong>ç›¸å¯¹è·¯å¾„å†™æ³•ï¼š</strong>./ è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹ï¼Œâ€¦/è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•</p><h2 id="ç‰¹æ®Šè·¯å¾„ç¬¦">ç‰¹æ®Šè·¯å¾„ç¬¦</h2><ul><li><strong>.</strong>    è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œæ¯”å¦‚: cd ./Desktop è¡¨ç¤ºåˆ‡æ¢æˆåˆ°å½“å‰ç›®å½•ä¸‹çš„Desktopç›®å½•å†…ï¼Œå’Œcd Desktopæ•ˆæœä¸€è‡´</li><li><strong>â€¦</strong>     è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ï¼Œæ¯”å¦‚:  cd  <strong>â€¦</strong>  å³å¯åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•, cd â€¦/â€¦ åˆ‡æ¢åˆ°ä¸ŠäºŒçº§ç›®å½•</li><li>~     è¡¨ç¤ºHOMEç›®å½•ï¼Œæ¯”å¦‚:  cd ~   å³å¯åˆ‡æ¢åˆ°HOMEç›®å½•æˆ–cd ~/Desktopï¼Œåˆ‡æ¢åˆ°HOMEå†…çš„Desktopç›®å½•</li></ul><h1>3.Linuxå‘½ä»¤</h1><p><strong>é€šç”¨æ ¼å¼ï¼š</strong></p><p><strong>command  [-options]  [parameter]</strong></p><ul><li><p>command: å‘½ä»¤æœ¬èº«</p></li><li><p>-options:[å¯é€‰ï¼Œéå¿…å¡«]ï¼Œå‘½ä»¤çš„ä¸€äº›é€‰é¡¹ï¼Œæ§åˆ¶å‘½ä»¤è¡Œä¸ºç»†èŠ‚</p></li><li><p>parameterï¼š[å¯é€‰ï¼Œéå¿…å¡«]ï¼Œå‘½ä»¤çš„å‚æ•°ï¼Œå¤šæ•°ç”¨äºå‘½ä»¤çš„æŒ‡å‘ç›®æ ‡</p><p>ä¸‰éƒ¨åˆ† : æœ¬ä½“ï¼Œé€‰é¡¹ï¼Œå‚æ•°</p><p><strong>å®ä¾‹ï¼š</strong></p><p>ls -l /home/itheima , lså‘½ä»¤æœ¬èº«ï¼Œ-lé€‰é¡¹ï¼Œ/home/itheimaæ˜¯å‚æ•°</p></li></ul><h2 id="lså‘½ä»¤">lså‘½ä»¤</h2><p><strong>è¯­æ³•ï¼š ls     [-a -l -h]     [Linuxè·¯å¾„]</strong></p><ul><li>-a ï¼Œ-lï¼Œ-h æ˜¯<strong>å¯é€‰</strong>é€‰é¡¹</li><li>Linuxè·¯å¾„æ˜¯å‘½ä»¤<strong>å¯é€‰</strong>å‚æ•°</li></ul><p>å½“ä¸ä½¿ç”¨é€‰é¡¹å’Œå‚æ•°ï¼Œç›´æ¥ä½¿ç”¨lså‘½ä»¤æœ¬ä½“ï¼Œè¡¨ç¤ºï¼šä»¥å¹³é“ºçš„å½¢å¼ï¼Œåˆ—å‡ºå½“å‰å·¥ä½œç›®å½•ä¸‹çš„å†…å®¹</p><ul><li><p>-aé€‰é¡¹ï¼Œè¡¨ç¤ºallï¼Œåˆ—å‡ºå…¨éƒ¨éšè—æ–‡ä»¶/æ–‡ä»¶å¤¹</p></li><li><p>-lé€‰é¡¹ï¼Œè¡¨ç¤ºï¼šåˆ—è¡¨ï¼ˆç«–å‘æ’åˆ—ï¼‰çš„å½¢å¼å±•ç¤ºå†…å®¹ï¼Œå¹¶å±•ç¤ºæ›´å¤šä¿¡æ¯</p></li><li><p>-ié€‰é¡¹ï¼Œè¡¨ç¤ºï¼šè¦æŸ¥çœ‹æ–‡ä»¶æˆ–ç›®å½•çš„incodeç¼–å·</p></li><li><p>-alï¼Œ-laï¼Œ-l -aï¼Œä¸‰ç§éƒ½è¡¨ç¤ºåŒæ—¶è¿ç”¨-aï¼Œ-låŠŸèƒ½</p></li><li><p>-h è¡¨ç¤ºä»¥æ˜“äºé˜…è¯»çš„å½¢å¼ï¼Œåˆ—å‡ºæ–‡ä»¶å¤§å°ï¼Œå¦‚Kã€Mã€Gï¼Œ<strong>åŒæ—¶-hå¿…é¡»æ­é…-lä¸€èµ·ä½¿ç”¨</strong>ã€‚ä¾‹:  ls -lh</p></li><li><p>ls -lah = ls -a -l -hï¼Œéƒ½æ˜¯ä¸‰ä¸ªé€‰é¡¹ä¸€èµ·ä½¿ç”¨</p></li></ul><h2 id="cdå‘½ä»¤ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰">cdå‘½ä»¤ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰</h2><ul><li>cd : Change Directory (æ›´æ”¹ç›®å½•)</li><li>cdå‘½ä»¤å¯ä»¥åˆ‡æ¢å½“å‰å·¥ä½œç›®å½•(è¿›å…¥æŸä¸ªæ–‡ä»¶å¤¹)</li></ul><p><strong>è¯­æ³•ï¼š cd  [Linuxè·¯å¾„]</strong></p><ul><li>cdå‘½ä»¤æ— éœ€é€‰é¡¹ï¼Œåªæœ‰å‚æ•°ï¼Œè¡¨ç¤ºè¦åˆ‡æ¢åˆ°å“ªä¸ªç›®å½•ä¸‹ï¼ˆå†ls åˆ—å‡ºç›®å½•ä¸‹å†…å®¹ï¼‰</li><li>cdå‘½ä»¤ç›´æ¥æ‰§è¡Œï¼Œä¸å†™å‚æ•°ï¼Œè¡¨ç¤ºä»å½“å‰ç›®å½•å›åˆ°ç”¨æˆ·çš„HOMEç›®å½•</li></ul><h2 id="pwdå‘½ä»¤">pwdå‘½ä»¤</h2><p>pwd ï¼š Print Work Directory</p><p><strong>pwd ï¼šæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•ï¼Œç›´æ¥æ‰“å°å½“å‰å·¥ä½œç›®å½•</strong></p><p>è¯­æ³•ï¼š pwd</p><ul><li>pwd å‘½ä»¤ï¼Œæ— é€‰é¡¹ï¼Œæ— å‚æ•°ï¼Œç›´æ¥è¾“å…¥pwdå³å¯</li></ul><h2 id="mkdirå‘½ä»¤åˆ›å»ºç›®å½•-æ–‡ä»¶å¤¹">mkdirå‘½ä»¤åˆ›å»ºç›®å½•(æ–‡ä»¶å¤¹)</h2><p>mkdir : Make Directory  â€”â€”åˆ›å»º æ–‡ä»¶å¤¹</p><p><strong>è¯­æ³•ï¼šmkdir  [-p]  Linuxè·¯å¾„</strong></p><ul><li>å‚æ•°å¿…å¡«ï¼Œè¡¨ç¤ºLinuxè·¯å¾„ï¼Œå³è¦åˆ›å»ºçš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„å‡å¯ä»¥</li><li>-pé€‰é¡¹å¯é€‰ï¼Œè¡¨ç¤ºè‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„çˆ¶ç›®å½•ï¼Œé€‚ç”¨äºåˆ›å»ºè¿ç»­å¤šå±‚çº§çš„ç›®å½•</li></ul><p>ä¾‹å­ï¼š</p><p>mkdir test  åœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªtestæ–‡ä»¶å¤¹</p><p>mkdir /home/keqiudi/test åœ¨keqiudié‡Œé¢åˆ›å»ºä¸€ä¸ªtestæ–‡ä»¶å¤¹</p><p>mkdir home/good/666 åˆ›å»ºå¤±è´¥ï¼Œå› ä¸º<strong>ä¸Šçº§ç›®å½•homeå’Œgoodå¹¶ä¸å­˜åœ¨</strong>ï¼Œæ‰€ä»¥æ— æ³•åˆ›å»º666ç›®å½•</p><p>mkdir -p home/good/666 åˆ›å»ºæˆåŠŸï¼Œé€šè¿‡-på°†ä¸€æ•´ä¸ªé“¾æ¡éƒ½åˆ›å»ºå®Œæˆ</p><p>**æ³¨æ„ï¼š**åˆ›å»ºæ–‡ä»¶å¤¹éœ€è¦ä¿®æ”¹æƒé™ï¼Œè¯·ç¡®ä¿æ“ä½œå‡åœ¨HOMEç›®å½•å†…ï¼Œä¸è¦å†HOMEå¤–æ“ä½œæ¶‰åŠæƒé™é—®é¢˜ï¼ŒHOMEå¤–æ— æ³•æˆåŠŸ</p><h2 id="æ–‡ä»¶æ“ä½œå‘½ä»¤par1">æ–‡ä»¶æ“ä½œå‘½ä»¤par1</h2><h3 id="touchå‘½ä»¤">touchå‘½ä»¤</h3><p><strong>ä½œç”¨ï¼šåˆ›å»ºæ–‡ä»¶å¤¹</strong></p><p><strong>è¯­æ³•ï¼štouch  Linuxè·¯å¾„</strong></p><ul><li>touchå‘½ä»¤æ— é€‰é¡¹ï¼Œå‚æ•°å¿…å¡«ï¼Œè¡¨ç¤ºè¦åˆ›å»ºçš„æ–‡ä»¶è·¯å¾„ï¼Œ ç›¸å¯¹ã€ç»å¯¹ã€ç‰¹æ®Šè·¯å¾„ç¬¦å‡å¯ä½¿ç”¨</li></ul><h3 id="catå‘½ä»¤">catå‘½ä»¤</h3><p><strong>ä½œç”¨ï¼š1.æŸ¥çœ‹æ–‡ä»¶å†…å®¹ 2.åˆå¹¶æ–‡ä»¶</strong></p><p><strong>è¯­æ³•ï¼š cat Linuxè·¯å¾„</strong></p><ul><li>catåŒæ ·æ²¡æœ‰é€‰é¡¹ï¼Œåªæœ‰å¿…å¡«å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºï¼šè¢«æŸ¥çœ‹çš„æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ã€ç»å¯¹ã€ç‰¹æ®Šè·¯å¾„ç¬¦éƒ½å¯ä»¥ä½¿ç”¨</li></ul><p><strong>è¯­æ³•ï¼šcat æ–‡ä»¶å æ–‡ä»¶å</strong></p><ul><li>å°†ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œåˆå¹¶</li></ul><h3 id="moreå‘½ä»¤">moreå‘½ä»¤</h3><p><strong>ä½œç”¨ï¼šæŸ¥çœ‹æ–‡ä»¶å†…å®¹</strong></p><p><strong>è¯­æ³•ï¼š more Linuxè·¯å¾„</strong></p><ul><li><p>catæ˜¯å°†å†…å®¹å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥</p></li><li><p>moreæ”¯æŒç¿»é¡µï¼Œå¦‚æœæ–‡ä»¶å†…å®¹è¿‡å¤šï¼Œå¯ä»¥ä¸€é¡µä¸€é¡µçš„å±•ç¤º</p><p>åŒæ ·æ²¡æœ‰é€‰é¡¹ï¼Œåªæœ‰å¿…å¡«å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºï¼šè¢«æŸ¥çœ‹çš„æ–‡ä»¶è·¯å¾„ï¼Œç›¸å¯¹ã€ç»å¯¹ã€ç‰¹æ®Šè·¯å¾„ç¬¦éƒ½å¯ä»¥ä½¿ç”¨</p></li><li><p>å†æŸ¥çœ‹çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ç©ºæ ¼ç¿»é¡µ</p></li><li><p>é€šè¿‡qé€€å‡ºæŸ¥çœ‹</p></li></ul><h3 id="lesså‘½ä»¤">lesså‘½ä»¤</h3><p><strong>ä½œç”¨ï¼šä¸moreç±»ä¼¼ï¼ŒåŠŸèƒ½ä¸Šå¼ºäºmore</strong></p><p><strong>ç”¨æ³•ï¼šless Linuxè·¯å¾„</strong></p><ul><li>é€€å‡ºæŒ‰qé”®</li></ul><h3 id="headå‘½ä»¤">headå‘½ä»¤</h3><p><strong>ä½œç”¨ï¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å¼€å¤´è‹¥å¹²è¡Œ</strong></p><p><strong>è¯­æ³•ï¼šhead [é€‰é¡¹] filename</strong></p><p><strong>é€‰é¡¹ï¼š</strong></p><ul><li>-nï¼Œnä»£è¡¨æ˜¾ç¤ºçš„è¡Œæ•°</li><li>-qï¼Œä¸æ˜¾ç¤ºç»™å®šæ–‡ä»¶çš„æ ‡é¢˜</li><li>-vï¼Œå§‹ç»ˆæ˜¾ç¤ºç»™å®šæ–‡ä»¶çš„æ ‡é¢˜</li></ul><h2 id="æ–‡ä»¶æ“ä½œå‘½ä»¤part2">æ–‡ä»¶æ“ä½œå‘½ä»¤part2</h2><h3 id="cpå‘½ä»¤">cpå‘½ä»¤</h3><p>ä½œç”¨:ç”¨äºå¤åˆ¶æ–‡ä»¶\æ–‡ä»¶å¤¹ï¼Œcpå‘½ä»¤æ¥è‡ªï¼šcopy</p><p><strong>è¯­æ³•ï¼šcp [-r]  å‚æ•°1 å‚æ•°2</strong></p><ul><li>-ré€‰é¡¹ï¼Œå¯é€‰ï¼Œç”¨äºå¤åˆ¶æ–‡ä»¶å¤¹ä½¿ç”¨ï¼Œè¡¨ç¤ºé€’å½’</li><li>å‚æ•°1ï¼ŒLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¢«å¤åˆ¶çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹,å¦‚æœ</li><li>å‚æ•°2ï¼ŒLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¦å¤åˆ¶å»çš„åœ°æ–¹,æ²¡æœ‰æ–‡ä»¶å°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹</li></ul><p>å¤åˆ¶æ–‡ä»¶å¤¹å¿…é¡»è¦åŠ  -r</p><h3 id="mvå‘½ä»¤">mvå‘½ä»¤</h3><p>**ä½œç”¨ï¼š**å¯¹æ–‡ä»¶æˆ–ç›®å½•é‡æ–°å‘½å,æˆ–è€…ç§»åŠ¨æ–‡ä»¶\æ–‡ä»¶å¤¹ï¼Œmvæ¥è‡ªè‹±æ–‡: <strong>move</strong></p><p><strong>è¯­æ³•ï¼š mv  [é€‰é¡¹] å‚æ•°1 å‚æ•°2</strong></p><ul><li>é€‰é¡¹ï¼š-i  åŒåæ—¶è¯¢é—®æ˜¯å¦è¦†ç›–ï¼Œè¾“å…¥yè¡¨ç¤ºåŒæ„</li><li>å‚æ•°1ï¼šLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¢«ç§»åŠ¨çš„æ–‡ä»¶</li><li>å‚æ•°2ï¼šLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¦ç§»åŠ¨çš„åœ°æ–¹ï¼Œå½“ç›®æ ‡ä¸å­˜åœ¨æ—¶ï¼Œå°†ä¼šæœ‰æ”¹åçš„æ•ˆæœ</li></ul><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>è‹¥ç›®æ ‡æ–‡ä»¶æ˜¯åˆ°æŸä¸€<strong>ç›®å½•</strong>æ–‡ä»¶çš„è·¯å¾„ï¼Œåˆ™æºæ–‡ä»¶ä¼šè¢«ç§»åˆ°æ­¤ç›®å½•ä¸‹ï¼Œä¸”æ–‡ä»¶åä¸å˜</li><li>è‹¥ç›®æ ‡æ–‡ä»¶ä¸æ˜¯<strong>ç›®å½•</strong>æ–‡ä»¶æ—¶ï¼Œåˆ™æºæ–‡ä»¶åï¼ˆåªèƒ½æœ‰ä¸€ä¸ªï¼‰ä¼šå˜æˆæ­¤ç›®æ ‡æ–‡ä»¶åï¼Œå¹¶ä¸”è¦†ç›–å·²å­˜åœ¨çš„åŒåæ–‡ä»¶ï¼ŒåŸæ–‡ä»¶æ¶ˆå¤±</li><li>å½“ç›®æ ‡æ–‡ä»¶æ˜¯<strong>ç›®å½•</strong>æ–‡ä»¶æ—¶ï¼Œæºæ–‡ä»¶æˆ–ç›®å½•å‚æ•°å¯ä»¥æœ‰å¤šä¸ªï¼Œåˆ™æ‰€æœ‰çš„æºæ–‡ä»¶éƒ½ä¼šè¢«ç§»åŠ¨åˆ°ç›®æ ‡æ–‡ä»¶ä¸­ã€‚æ‰€æœ‰ç§»åˆ°è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½å°†ä¿ç•™ä»¥å‰çš„æ–‡ä»¶å</li></ul><h3 id="rmå‘½ä»¤">rmå‘½ä»¤</h3><p><strong>ä½œç”¨ï¼šç”¨äºåˆ é™¤æ–‡ä»¶ã€æ–‡ä»¶å¤¹ï¼Œrmæ¥è‡ªè‹±æ–‡ï¼šremove</strong></p><p><strong>è¯­æ³•ï¼šrm [-r -f] å‚æ•°1 å‚æ•°2 å‚æ•°3  â€¦  å‚æ•°N</strong></p><ul><li><p>åŒcpå‘½ä»¤ä¸€æ ·ï¼Œ<strong>-r</strong>é€‰é¡¹ç”¨äºåˆ é™¤æ–‡ä»¶å¤¹ï¼ˆåˆ é™¤æ–‡ä»¶å¤¹å¿…é¡»åŠ ï¼‰</p></li><li><p><strong>-f</strong>è¡¨ç¤ºforceï¼Œå¼ºåˆ¶åˆ é™¤(ä¸ä¼šå¼¹å‡ºæç¤ºç¡®è®¤ä¿¡æ¯)</p><ul><li>æ™®é€šç”¨æˆ·åˆ é™¤å†…å®¹ä¸ä¼šå¼¹å‡ºæç¤ºï¼Œåªæœ‰rootç®¡ç†å‘˜ç”¨æˆ·åˆ é™¤å†…å®¹ä¼šæœ‰æç¤º</li><li>æ‰€ä»¥ä¸€èˆ¬æ™®é€šç”¨æˆ·ç”¨ä¸åˆ°-fé€‰é¡¹</li></ul></li><li><p>å‚æ•°1ã€å‚æ•°2ã€â€¦ã€å‚æ•°N è¡¨ç¤ºè¦åˆ é™¤çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹è·¯å¾„ï¼ŒæŒ‰ç…§ç©ºæ ¼éš”å¼€</p></li></ul><p><em><em>rmå‘½ä»¤æ”¯æŒé€šé…ç¬¦</em>ï¼Œç”¨æ¥åšæ¨¡ç³ŠåŒ¹é…</em>*</p><ul><li><p>ç¬¦å·*è¡¨ç¤ºé€šé…ç¬¦ï¼Œå³åŒ¹é…ä»»æ„å†…å®¹(åŒ…å«ç©º)ï¼Œç¤ºä¾‹:</p></li><li><p>test*ï¼Œè¡¨ç¤ºåŒ¹é…ä»»ä½•ä»¥testå¼€å¤´çš„å†…å®¹</p></li><li><p>*testï¼Œè¡¨ç¤ºåŒ¹é…ä»»ä½•ä»¥testç»“å°¾çš„å†…å®¹</p></li><li><p>*test*ï¼Œè¡¨ç¤ºä»»ä½•åŒ…å«testçš„å†…å®¹</p><p>åˆ é™¤æ‰€æœ‰ä»¥testå¼€å¤´çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶</p><p><strong>ä¾‹ï¼šrm -r test</strong>*</p></li></ul><p><strong>åœ¨rootæ—¶åˆ é™¤å†…å®¹ä¼šæœ‰æç¤ºï¼Œä½†-fé€‰é¡¹å¼ºåˆ¶åˆ é™¤å¯ä»¥ä¸ä¼šå¼¹å‡ºæç¤º</strong></p><ul><li>å¯ä»¥è¾“å…¥ su - rootï¼Œå¹¶è¾“å…¥å¯†ç 123456(å’Œæ™®é€šç”¨æˆ·é»˜è®¤ä¸€æ ·)ä¸´æ—¶åˆ‡æ¢åˆ°rootç”¨æˆ·ä½“éªŒ</li><li>é€šè¿‡è¾“å…¥exitå‘½ä»¤ï¼Œé€€å›æ™®é€šç”¨æˆ·ã€‚(ä¸´æ—¶ç”¨rootï¼Œç”¨å®Œè®°å¾—é€€å‡ºï¼Œä¸è¦ä¸€ç›´ç”¨)</li></ul><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>rmæ˜¯ä¸€ä¸ªå±é™©çš„å‘½ä»¤ï¼Œç‰¹åˆ«æ˜¯åœ¨root(è¶…çº§ç®¡ç†å‘˜)ç”¨æˆ·çš„æ—¶å€™ã€‚è¯·è°¨æ…ä½¿ç”¨ã€‚</li><li>åƒä¸‡ä¸è¦å†rootç®¡ç†å‘˜ç”¨æˆ·ä¸‹æ‰§è¡Œ:<ul><li>rm -rf /</li><li>rm -rf /*</li><li>æ•ˆæœç›¸å½“äºåœ¨windowsä¸Šæ‰§è¡ŒCç›˜æ ¼å¼åŒ–</li></ul></li></ul><h2 id="æŸ¥æ‰¾å’Œæ’åºå‘½ä»¤">æŸ¥æ‰¾å’Œæ’åºå‘½ä»¤</h2><h3 id="whichå‘½ä»¤-å‘½ä»¤æŸ¥æ‰¾">whichå‘½ä»¤(å‘½ä»¤æŸ¥æ‰¾)</h3><p>Linuxå‘½ä»¤ï¼Œæœ¬ä½“æ˜¯ä¸€ä¸ªä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œç¨‹åºï¼Œå’Œwindowsä¸­çš„.exeæ–‡ä»¶æ˜¯ä¸€ä¸ªæ„æ€</p><p><strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡whichå‘½ä»¤ï¼ŒæŸ¥çœ‹æ‰€ä½¿ç”¨çš„ä¸€ç³»åˆ—å‘½ä»¤çš„bæœ¬ä½“ç¨‹åºæ–‡ä»¶å­˜æ”¾åœ¨å“ªé‡Œ</strong></p><p><strong>è¯­æ³• :  which è¦æŸ¥æ‰¾çš„å‘½ä»¤</strong></p><p><strong>ä¾‹</strong>ï¼šwhich cd    which pwd      which  touchâ€¦</p><h3 id="findå‘½ä»¤-æ–‡ä»¶æŸ¥æ‰¾">findå‘½ä»¤(æ–‡ä»¶æŸ¥æ‰¾)</h3><p><strong>ä½œç”¨ï¼šfindå‘½ä»¤å¯ä»¥å»æœç´¢æŒ‡å®šçš„æ–‡ä»¶</strong></p><p><strong>åŸºæœ¬è¯­æ³•ï¼šfind   èµ·å§‹è·¯å¾„  -name   è¢«æŸ¥æ‰¾æ–‡ä»¶å</strong></p><p>æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾æ–‡ä»¶</p><p><strong>è¯­æ³•ï¼šfind  èµ·å§‹è·¯å¾„  -size +/- n[kMG]</strong></p><ul><li>+ã€-è¡¨ç¤ºå¤§äºå’Œå°äº</li><li>nè¡¨ç¤ºå¤§å°æ•°å­—</li><li>kMGè¡¨ç¤ºå¤§å°å•ä½, k(å°å†™)è¡¨ç¤ºkbï¼ŒMè¡¨ç¤ºMBï¼ŒGè¡¨ç¤ºGB</li></ul><p><strong>ä¾‹ï¼š</strong></p><ul><li>æŸ¥æ‰¾å°äº10KBæ–‡ä»¶ï¼š<strong>find / -size -10k</strong></li><li>æŸ¥æ‰¾å¤§äº100MBçš„æ–‡ä»¶ï¼š<strong>find / -size +100M</strong></li></ul><h2 id="grepå‘½ä»¤">grepå‘½ä»¤</h2><p>grepå‘½ä»¤</p><p>**ä½œç”¨ï¼š**ä»æ–‡ä»¶ä¸­é€šè¿‡å…³é”®å­—è¿‡æ»¤æ–‡ä»¶è¡Œï¼Œä¼šæ˜¾ç¤ºå‡ºæ‰€æœ‰åŒ…å«å…³é”®å­—çš„ä¸€è¡Œå¹¶ä¸”æ ‡çº¢</p><p><strong>è¯­æ³•ï¼šgrep [-n] å…³é”®å­— æ–‡ä»¶è·¯å¾„</strong></p><ul><li>é€‰é¡¹-nï¼Œå¯é€‰ï¼Œè¡¨ç¤ºåœ¨ç»“æœä¸­æ˜¾ç¤ºåŒ¹é…çš„è¡Œçš„è¡Œå·</li><li>å…³é”®å­—ï¼Œå‚æ•°ï¼Œ<strong>å¿…å¡«</strong>ï¼Œè¡¨ç¤ºè¿‡æ»¤çš„å…³é”®å­—ï¼Œå¸¦æœ‰ç©ºæ ¼æˆ–å…¶ä»–ç‰¹æ®Šç¬¦å·ï¼Œå»ºè®®ç”¨â€ â€ å°†å…³é”®å­—åŒ…å›´</li><li>æ–‡ä»¶è·¯å¾„ï¼Œå‚æ•°ï¼Œ<strong>å¿…å¡«</strong>ï¼Œè¡¨ç¤ºè¦è¿‡æ»¤å†…å®¹çš„æ–‡ä»¶è·¯å¾„ï¼Œ<strong>å¯ä½œä¸ºå†…å®¹è¾“å…¥ç«¯å£</strong></li></ul><h2 id="wcå‘½ä»¤">wcå‘½ä»¤</h2><p>**ä½œç”¨ï¼š**wcå‘½ä»¤å¯ä»¥ç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•°ã€å•è¯æ•°é‡ç­‰</p><p><strong>è¯­æ³•ï¼š wc [-c  -m  -l  -w]  æ–‡ä»¶è·¯å¾„</strong></p><ul><li>é€‰é¡¹ï¼Œ-cï¼Œç»Ÿè®¡bytesæ•°é‡</li><li>é€‰é¡¹ï¼Œ-mï¼Œç»Ÿè®¡å­—ç¬¦æ•°é‡</li><li>é€‰é¡¹ï¼Œ-lï¼Œç»Ÿè®¡è¡Œæ•°</li><li>é€‰é¡¹ï¼Œ-wï¼Œç»Ÿè®¡å•è¯æ•°é‡</li><li>å‚æ•°ï¼Œæ–‡ä»¶è·¯å¾„ï¼ŒèƒŒç»Ÿè®¡çš„æ–‡ä»¶ï¼Œ<strong>å¯ä½œä¸ºå†…å®¹è¾“å…¥</strong></li></ul><h2 id="ç®¡é“ç¬¦ï¼š">ç®¡é“ç¬¦ï¼š|</h2><p>**ä½œç”¨ï¼š**å°†ç®¡é“ç¬¦å·¦è¾¹å‘½ä»¤çš„ç»“æœï¼Œä½œä¸ºå³è¾¹å‘½ä»¤çš„è¾“å…¥</p><p>**ä¾‹å­ï¼š**cat test.txt | grep keqiudi</p><p>ç›¸å½“äºå·¦è¾¹çš„ç»“æœç›´æ¥æ˜¯å³è¾¹çš„è¾“å…¥è·¯å¾„</p><p>å³å°†ä¼šåœ¨test.txtä¸­æ‰¾å‡ºå«æœ‰keqiudiçš„å†…å®¹</p><p>é€šå¸¸ æ­é…ä½¿ç”¨å’ŒåµŒå¥—ä½¿ç”¨</p><p>cat test.txt | grep keqiudi | grep kqd</p><p>è¿™å°†ä¼šåœ¨test.txtä¸­æ‰¾å‡ºå«æœ‰keqiudiçš„å†…å®¹ï¼Œå†ç»§ç»­åœ¨è¿™ä¹‹ä¸­æ‰¾å‡ºå«æœ‰kqdçš„å†…å®¹</p><h2 id="echoå‘½ä»¤">echoå‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šå¯ä»¥ç”¨echoå‘½ä»¤åœ¨å‘½ä»¤è¡Œå†…è¾“å‡ºæŒ‡å®šå†…å®¹</strong></p><p><strong>è¯­æ³•ï¼šecho è¾“å…¥çš„å†…å®¹</strong></p><ul><li>æ— éœ€é€‰é¡¹ï¼Œåªéœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè¦è¾“å‡ºçš„å†…å®¹</li></ul><p>**ä¾‹ï¼š**åœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºï¼šHello Linux</p><p>echo Hello Linux</p><p>æ³¨æ„ï¼šå¸¦æœ‰ç©ºæ ¼æˆ–\ç­‰ç‰¹æ®Šç¬¦å·ï¼Œå»ºè®®ç”¨åŒå¼•å·åŒ…å›´ï¼Œä¸åŒ…å›´ç©ºæ ¼åé¢å¾ˆå®¹æ˜“è¢«è¯†åˆ«ä¸ºå‚æ•°2ã€‚</p><h2 id="åå¼•å·">åå¼•å·`</h2><p><strong>è¢«åå¼•å·`åŒ…å›´çš„å†…å®¹ï¼Œä¼šè¢«ä½œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œè€Œéæ™®é€šå­—ç¬¦</strong></p><p>echo pwd  ç»“æœä¸ºpwd</p><p>echo ï¼ˆåå¼•å·ï¼‰pwdï¼ˆåå¼•å·ï¼‰ ç»“æœä¸ºå½“å‰å·¥ä½œç›®å½•</p><h2 id="é‡å®šå‘ç¬¦">é‡å®šå‘ç¬¦</h2><p><strong>é‡å®šå‘ç¬¦å·ï¼š&gt;å’Œ&gt;&gt;</strong></p><ul><li>ç¬¬ä¸€ä¸ªç¬¦å·&gt;ï¼Œè¡¨ç¤ºå°†å·¦ä¾§å‘½ä»¤çš„ç»“æœï¼Œ<strong>è¦†ç›–</strong>å†™å…¥åˆ°ç¬¦å·å³ä¾§æŒ‡å®šæ–‡ä»¶ä¸­</li><li>ç¬¬äºŒä¸ªç¬¦å·&gt;&gt;ï¼Œè¡¨ç¤ºå°†å·¦ä¾§å‘½ä»¤çš„ç»“æœï¼Œ<strong>è¿½åŠ </strong>å†™å…¥åˆ°ç¬¦å·å³ä¾§æŒ‡å®šæ–‡ä»¶ä¸­</li></ul><p><strong>ä¾‹å­ï¼š</strong></p><p>echo â€œHello Linuxâ€ &gt; test.txt</p><p>å°†ä¼šæŠŠHello Linuxå†™å…¥åˆ°test.txtä¸­</p><p>echo â€œkeqiudiâ€ &gt;&gt; test.txt</p><p>å°†ä¼šæŠŠkeqiudiè¿½åŠ åˆ°test.txtæ–‡ä»¶ä¸­</p><h2 id="tailå‘½ä»¤">tailå‘½ä»¤</h2><p>**ä½œç”¨ï¼š**tailå¯ä»¥æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨çš„å†…å®¹ï¼Œè·Ÿè¸ªæ–‡ä»¶çš„æœ€æ–°æ›´æ”¹</p><p>**è¯­æ³•ï¼š**tail [-f -num] Linuxè·¯å¾„</p><ul><li>å‚æ•°ï¼ŒLinuxè·¯å¾„ï¼Œè¡¨ç¤ºè¢«è·Ÿè¸ªçš„æ–‡ä»¶è·¯å¾„</li><li>é€‰é¡¹ï¼Œ-fï¼Œè¡¨ç¤ºæŒç»­è·Ÿè¸ª</li><li>é€‰é¡¹ï¼Œ-numï¼Œè¡¨ç¤ºï¼ŒæŸ¥çœ‹å°¾éƒ¨å¤šå°‘è¡Œï¼Œä¸å¡«é»˜è®¤10è¡Œ</li></ul><p>ç”¨**-f**æ—¶ï¼Œå†å¼€ä¸€ä¸ªå‘½ä»¤è¡Œï¼Œå¯¹è¯¥æ–‡ä»¶å†…éƒ¨å†…å®¹è¿›è¡Œçš„å¢æ·»æˆ–åˆ å‡å†…å®¹å¯ä»¥åœ¨ä¹‹å‰çš„å‘½ä»¤è¡Œä¸­æŒç»­è¿½è¸ªï¼ˆè§‚å¯Ÿåˆ°ï¼‰ä¸ä¼šç«‹å³åœæ­¢ï¼ŒCtrl c åœæ­¢</p><h2 id="vi-vimç¼–è¾‘å™¨">vi/vimç¼–è¾‘å™¨</h2><p><strong>ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼š</strong></p><ul><li><strong>å‘½ä»¤æ¨¡å¼ï¼š (Command code)</strong></li></ul><p>â€‹             å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œæ‰€æ•²çš„æŒ‰é”®ç¼–è¾‘å™¨éƒ½ç†è§£ä¸ºå‘½ä»¤ï¼Œä»¥å‘½ä»¤é©±åŠ¨æ‰§è¡Œä¸åŒçš„åŠŸèƒ½ã€‚æ­¤æ¨¡å‹ä¸‹ï¼Œä¸èƒ½è‡ªç”±è¿›è¡Œæ–‡æœ¬ç¼–è¾‘ã€‚</p><ul><li><strong>è¾“å…¥æ¨¡å¼ï¼šï¼ˆinsert modeï¼‰</strong></li></ul><p>â€‹            ä¹Ÿå°±æ˜¯æ‰€è°“çš„ç¼–è¾‘æ¨¡å¼ï¼Œæ’å…¥æ¨¡å¼ã€‚æ­¤æ¨¡å¼ä¸‹ï¼Œå¯ä»¥å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œè‡ªç”±ç¼–è¾‘ã€‚</p><ul><li><strong>åº•çº¿å‘½ä»¤æ¨¡å¼(Last line mode)</strong></li></ul><p>â€‹          ä»¥ï¼šå¼€å§‹ï¼Œé€šå¸¸ç”¨äºæ–‡ä»¶çš„ä¿å­˜ã€é€€å‡º</p><p><strong>æ³¨ï¼šæ‰“å¼€é»˜è®¤ä¸ºå‘½ä»¤æ¨¡å¼</strong></p><p><strong>è¾“å…¥æ¨¡å¼å’Œåº•çº¿å‘½ä»¤æ¨¡å¼ä¸è¿é€š</strong></p><p><strong>è¯­æ³•ï¼š  vi   æ–‡ä»¶è·¯å¾„</strong></p><p>â€‹             <strong>vim æ–‡ä»¶è·¯å¾„(vimå…¼å®¹å…¨éƒ¨çš„viåŠŸèƒ½ï¼Œæ¨èä½¿ç”¨vim)</strong></p><pre><code> - å¦‚æœæ–‡ä»¶è·¯å¾„è¡¨ç¤ºçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæ­¤å‘½ä»¤ä¼šå…ˆåˆ›å»ºå†ç¼–è¾‘æ–°æ–‡ä»¶ - å¦‚æœæ–‡ä»¶è·¯å¾„è¡¨ç¤ºçš„æ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆæ­¤å‘½ä»¤ç”¨äºç¼–è¾‘å·²æœ‰æ–‡ä»¶</code></pre><h3 id="å‘½ä»¤æ¨¡å¼å¿«æ·é”®">å‘½ä»¤æ¨¡å¼å¿«æ·é”®</h3><p><strong>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥:</strong></p><ul><li><p><strong>i <strong>â€”â€”å½“å‰å…‰æ ‡ä½ç½®è¿›å…¥</strong>è¾“å…¥æ¨¡å¼</strong></p></li><li><p><strong>a</strong>â€”â€”åœ¨å½“å‰å…‰æ ‡ä½ç½®ä¹‹åè¿›å…¥<strong>è¾“å…¥æ¨¡å¼</strong></p></li><li><p><strong>I</strong> â€”â€”åœ¨å½“å‰è¡Œçš„å¼€å¤´ï¼Œè¿›å…¥<strong>è¾“å…¥æ¨¡å¼</strong></p></li><li><p><strong>A</strong>â€”â€”åœ¨å½“å‰è¡Œçš„ç»“å°¾ï¼Œè¿›å…¥<strong>è¾“å…¥æ¨¡å¼</strong></p></li><li><p><strong>o</strong>â€”â€”åœ¨å½“å‰å…‰æ ‡ä¸‹ä¸€è¡Œè¿›å…¥<strong>è¾“å…¥æ¨¡å¼</strong></p></li><li><p><strong>O</strong>â€”â€”åœ¨å½“å‰å…‰æ ‡çš„ä¸Šä¸€è¡Œè¿›å…¥<strong>è¾“å…¥æ¨¡å¼</strong></p></li><li><p><strong>esc</strong>â€”â€”ä»»ä½•æƒ…å†µä¸‹è¾“å…¥<strong>escéƒ½èƒ½å›åˆ°å‘½ä»¤æ¨¡å¼</strong></p></li><li><p><strong>dd</strong>â€”â€”åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œå†…å®¹</p></li><li><p><strong>yy</strong>â€”â€”å¤åˆ¶å½“å‰è¡Œ</p></li><li><p><strong>p</strong>â€”â€”ç²˜è´´å¤åˆ¶çš„å†…å®¹</p></li><li><p><strong>u</strong>â€”â€”æ’¤é”€ä¿®æ”¹</p></li><li><p><strong>dG</strong>â€”â€”ä»å½“å‰è¡Œå¼€å§‹ï¼Œå‘ä¸‹å…¨éƒ¨åˆ é™¤</p></li><li><p><strong>dgg</strong>â€”â€”ä»å½“å‰è¡Œå¼€å§‹ï¼Œå‘ä¸Šå…¨éƒ¨åˆ é™¤</p></li><li><p><strong>wq</strong>â€”â€”wä¸ºä¿å­˜æ–‡ä»¶ï¼Œqä¸ºé€€å‡ºæ–‡ä»¶ï¼Œ<strong>wqåŒæ—¶ä¸ºä¿å­˜å¹¶é€€å‡º</strong></p></li><li><p>/ â€”â€”è¿›å…¥æœç´¢æ¨¡å¼</p><p><strong>å…¶ä½™å¿«æ·é”®è‡ªè¡Œåœ¨ç½‘ä¸ŠæŸ¥è¯¢</strong></p></li></ul><h3 id="åº•çº¿å‘½ä»¤æ¨¡å¼">åº•çº¿å‘½ä»¤æ¨¡å¼</h3><p>åœ¨å‘½ä»¤æ¨¡å¼ä¸­æŒ‰  **ï¼š**è¿›å…¥åº•çº¿å‘½ä»¤æ¨¡å¼</p><ul><li><strong>wq</strong> â€”â€”ä¿å­˜é€€å‡º(<strong>å¸¸ç”¨</strong>)</li><li><strong>q</strong>    â€”â€”ä»…é€€å‡º</li><li><strong>qï¼</strong>â€”â€”å¼ºåˆ¶é€€å‡º</li><li><strong>w</strong>   â€”â€”ä»…ä¿å­˜</li><li><strong>wï¼</strong>â€”â€”å¼ºåˆ¶ä¿å­˜</li><li><strong>set nu</strong> â€”â€”æ˜¾ç¤ºè¡Œå·</li><li><strong>set paste</strong> â€”â€” è®¾ç½®ç²˜è´´æ¨¡å¼</li></ul><h1>4.rootç”¨æˆ·ï¼ˆè¶…çº§ç®¡ç†å‘˜ï¼‰</h1><p>rootç”¨æˆ·æ‹¥æœ‰æœ€å¤§çš„ç³»ç»Ÿæ“ä½œæƒé™ï¼Œè€Œæ™®é€šç”¨æˆ·åœ¨è®¸å¤šåœ°æ–¹çš„æƒé™æ˜¯å—é™çš„ã€‚</p><ul><li>æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œä¸€èˆ¬åœ¨HOMEç›®å½•å†…æ˜¯ä¸å—é™çš„</li><li>ä¸€æ—¦å‡ºäº†HOMEç›®å½•ï¼Œå¤§å¤šæ•°åœ°æ–¹ï¼Œæ™®é€šç”¨æˆ·ä»…æœ‰åªè¯»å’Œæ‰§è¡Œçš„æƒé™ï¼Œæ— ä¿®æ”¹çš„æƒé™</li></ul><h2 id="su-å’Œ-exit-å‘½ä»¤">su å’Œ exit å‘½ä»¤</h2><p>suå‘½ä»¤å°±æ˜¯ç”¨äºè´¦æˆ·åˆ‡æ¢çš„ç³»ç»Ÿå‘½ä»¤ï¼Œè‹±æ–‡å•è¯ä¸ºï¼š<strong>Switch User</strong></p><p><strong>è¯­æ³•ï¼š su  -   ç”¨æˆ·å    é€šå¸¸åˆ‡æ¢åˆ°root ç”¨æˆ· ï¼ˆsu - rootï¼‰</strong></p><ul><li><p>-ç¬¦å·æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºæ˜¯å¦åœ¨åˆ‡æ¢ç”¨æˆ·ååŠ è½½ç¯å¢ƒå˜é‡ï¼Œä¸€èˆ¬å¸¦ä¸Š</p></li><li><p>å‚æ•°ï¼šç”¨æˆ·åï¼Œè¡¨ç¤ºè¦åˆ‡æ¢çš„ç”¨æˆ·ï¼Œç”¨æˆ·åä¹Ÿå¯ä»¥çœç•¥ï¼Œçœç•¥è¡¨ç¤ºå´æ¢åˆ°root</p></li><li><p>ä½¿ç”¨æ™®é€šç”¨æˆ·ï¼Œåˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·éœ€è¦è¾“å…¥å¯†ç ï¼Œå¦‚åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼ˆå¯†ç é»˜è®¤ä¸ºï¼š123456ï¼‰</p></li><li><p>ä½¿ç”¨rootç”¨æˆ·åˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·ï¼Œ<strong>æ— éœ€å¯†ç </strong>ï¼Œå¯ä»¥ç›´æ¥åˆ‡æ¢</p></li></ul><p>**exitå‘½ä»¤ï¼š**åˆ‡æ¢ç”¨æˆ·åï¼Œåœ¨rootç”¨æˆ·ä¸‹è¾“å…¥exitï¼Œé€€å‡ºrootæƒé™ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·é”®ï¼šctrl + d</p><h2 id="sudoå‘½ä»¤">sudoå‘½ä»¤</h2><p>å¯ä»¥è®©ä¸€æ¡æ™®é€šå‘½ä»¤å¸¦æœ‰rootæƒé™ï¼Œ<strong>è¯­æ³•ï¼šsudo å…¶ä»–å‘½ä»¤</strong></p><ul><li>éœ€è¦ä»¥rootç”¨æˆ·æ‰§è¡Œvisudoå‘½ä»¤ï¼Œå¢åŠ é…ç½®æ–¹å¯è®©æ™®é€šç”¨æˆ·æœ‰sudoå‘½ä»¤çš„æ‰§è¡Œæƒé™</li></ul><p>åœ¨æ‰“å¼€çš„æ–‡ä»¶æœ€åæ·»åŠ : <strong>ç”¨æˆ·å  ALL=(ALL)          NOPASSWD: ALL</strong></p><p>å†é€šè¿‡wqä¿å­˜</p><p>åˆ‡æ¢å›æ™®é€šç”¨æˆ·åï¼Œæ‰§è¡Œçš„å‘½ä»¤ï¼Œå‡ä»¥rootè¿è¡Œ</p><p><strong>sudo passwd ç”¨æˆ·åâ€”ä¸ºå½“å‰ç”¨æˆ·è®¾ç½®å¯†ç </strong></p><h1>5.ç”¨æˆ·å’Œç”¨æˆ·ç»„</h1><h2 id="ç”¨æˆ·ç»„ç®¡ç†">ç”¨æˆ·ç»„ç®¡ç†</h2><p>ä»¥ä¸‹å‘½ä»¤éœ€rootç”¨æˆ·æ‰§è¡Œ</p><ul><li>åˆ›å»ºç”¨æˆ·ç»„</li></ul><p><strong>groupadd ç”¨æˆ·ç»„å</strong></p><ul><li>åˆ é™¤ç”¨æˆ·ç»„</li></ul><p><strong>groupdel ç”¨æˆ·ç»„å</strong></p><ul><li>åˆ›å»ºç”¨æˆ·</li></ul><p><strong>useradd [-g -d] ç”¨æˆ·å</strong></p><p>é€‰é¡¹ï¼š-gæŒ‡å®šç”¨æˆ·çš„ç»„ï¼Œä¸æŒ‡å®š-gï¼Œä¼šåˆ›å»ºåŒåç»„å¹¶è‡ªåŠ¨åŠ å…¥ï¼ŒæŒ‡å®š-géœ€è¦ç»„å·²ç»å­˜åœ¨ï¼Œå¦‚å·²å­˜åœ¨åŒåç»„ï¼Œå¿…é¡»ä½¿ç”¨-g</p><p>é€‰å‹ï¼š-dæŒ‡å®šç”¨æˆ·HOMEè·¯å¾„ï¼Œä¸æŒ‡å®šï¼ŒHOMEç›®å½•é»˜è®¤åœ¨ï¼š/home/ç”¨æˆ·å</p><p><strong>userdel [-r] ç”¨æˆ·å</strong></p><p>é€‰é¡¹ï¼š-r ï¼Œåˆ é™¤ç”¨æˆ·çš„HOMEç›®å½•ï¼Œä¸ä½¿ç”¨-rï¼Œåˆ é™¤ç”¨æˆ·æ—¶ï¼ŒHOMEç›®å½•ä¿ç•™</p><ul><li>æŸ¥çœ‹ç”¨æˆ·æ‰€å±ç»„</li></ul><p>id [ç”¨æˆ·å]</p><p>å‚æ•°ï¼šç”¨æˆ·åï¼Œè¢«æŸ¥çœ‹çš„ç”¨æˆ·ï¼Œå¦‚æœä¸æä¾›åˆ™æŸ¥çœ‹è‡ªèº«</p><ul><li>ä¿®æ”¹ç”¨æˆ·æ‰€å±ç»„</li><li>usermod -aG ç”¨æˆ·ç»„ ç”¨æˆ·åï¼Œå°†æŒ‡å®šç”¨æˆ·åŠ å…¥æŒ‡å®šç”¨æˆ·ç»„</li></ul><h3 id="getent"><strong>getent</strong></h3><p><strong>ä½¿ç”¨getentå‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æœ‰å“ªäº›ç”¨æˆ·</strong></p><p><strong>è¯­æ³•:  getent passwd</strong></p><p>å¾—åˆ°çš„ä¿¡æ¯å…±ä¸ƒä¸ª</p><p>ç”¨æˆ·åï¼šå¯†ç (x):ç”¨æˆ·IDï¼šç»„IDï¼šæè¿°ä¿¡æ¯(æ— ç”¨)ï¼šHOMEç›®å½•ï¼šæ‰§è¡Œç»ˆç«¯ï¼ˆé»˜è®¤bashï¼‰</p><p><strong>æŸ¥çœ‹ç³»ç»Ÿä¸­æœ‰å“ªäº›ç”¨æˆ·ç»„</strong></p><p><strong>è¯­æ³•ï¼šgetent group</strong></p><h1>6.æƒé™æ§åˆ¶ä¿¡æ¯</h1><h2 id="æŸ¥çœ‹æƒé™æ§åˆ¶ä¿¡æ¯">æŸ¥çœ‹æƒé™æ§åˆ¶ä¿¡æ¯</h2><p>é€šè¿‡ls -l å¯ä»¥åˆ—è¡¨å½¢å¼æŸ¥çœ‹å†…å®¹ï¼Œå¹¶æ˜¾ç¤ºæƒé™ç»†èŠ‚</p><p><strong>ä¾‹ï¼š</strong></p><p>drwxr-xâ€”  7 keqiudi keqiudi 4096 Mar  7 16:25 keqiudi</p><p>-rw-rw-r-- 1   keqiudi keqiudi   46   Mar  7 16:25 test.txt</p><ul><li><p><strong>ç¬¬ä¸€åˆ—ä»£è¡¨</strong>ï¼šæ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹çš„æƒé™æ§åˆ¶ä¿¡æ¯</p></li><li><p><strong>ç¬¬ä¸‰åˆ—ä»£è¡¨</strong>ï¼šæ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·</p></li><li><p><strong>ç¬¬å››åˆ—ä»£è¡¨</strong>ï¼šæ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·ç»„</p></li></ul><p><strong>ç¬¬ä¸€åˆ—æƒé™æ§åˆ¶ä¿¡æ¯ï¼š</strong></p><p>æƒé™ç»†èŠ‚æ€»å…±åˆ†ä¸º<strong>10</strong>ä¸ªæ§½ä½ï¼š</p><p><strong>ç¬¬ä¸€ä¸ªä½ç½®ï¼š-æˆ–dæˆ–l</strong></p><ul><li>**-**è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶</li><li><strong>d</strong> è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶å¤¹(directory)</li><li><strong>I</strong>è¡¨ç¤ºè½¯é“¾æ¥(å¿«æ·æ–¹å¼)</li></ul><p><strong>ç¬¬2-4ä¸ªä½ç½®ï¼šè¡¨ç¤ºæ‰€å±ç”¨æˆ·æƒé™ï¼ˆuï¼ˆuserç®€ç§°ï¼‰ï¼‰</strong></p><p>**2ï¼š**ræˆ–-  æƒé™</p><p>**3ï¼š**wæˆ–- æƒé™</p><p>**4ï¼š**xæˆ–- æƒé™</p><p><strong>ç¬¬5-7ä¸ªä½ç½®ï¼šè¡¨ç¤ºæ‰€å±ç”¨æˆ·ç»„æƒé™ï¼ˆgï¼ˆgroupç®€ç§°ï¼‰ï¼‰</strong></p><p>**5ï¼š**ræˆ–-  æƒé™</p><p>**6ï¼š**wæˆ–- æƒé™</p><p>**7ï¼š**xæˆ–- æƒé™</p><p><strong>ç¬¬8-10ä¸ªä½ç½®ï¼šè¡¨ç¤ºå…¶ä»–ç”¨æˆ·æƒé™ï¼ˆoï¼ˆotherç®€ç§°ï¼‰ï¼‰</strong></p><p>**8ï¼š**ræˆ–-  æƒé™</p><p>**9ï¼š**wæˆ–- æƒé™</p><p>**10ï¼š**xæˆ–- æƒé™</p><p>ä¾‹ï¼šdrwxr-xr-xï¼Œè¡¨ç¤ºï¼š</p><ul><li>è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œd</li><li>æ‰€å±ç”¨æˆ·çš„æƒé™æ˜¯æœ‰ræœ‰wæœ‰xï¼Œrwx</li><li>æ‰€å±ç”¨æˆ·ç»„æƒé™æœ‰ræ— wæœ‰xï¼Œr-x(-è¡¨ç¤ºæ— æ­¤æƒé™)</li><li>å…¶ä»–ç”¨æˆ·æƒé™æ—¶ï¼šæœ‰ræ— wæœ‰xï¼Œr-x</li></ul><p><strong>rwxå«ä¹‰ï¼š</strong></p><ul><li><strong>rè¡¨ç¤ºè¯»æƒé™</strong>ï¼šé’ˆå¯¹æ–‡ä»¶å¤¹ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡ä»¶å¤¹çš„å†…å®¹ï¼Œå¦‚lså‘½ä»¤</li><li><strong>wè¡¨ç¤ºå†™æƒé™</strong>ï¼šé’ˆå¯¹æ–‡ä»¶å¤¹ï¼Œå¯ä»¥å†æ–‡ä»¶å¤¹å†…ï¼šåˆ›å»ºã€åˆ é™¤ã€æ”¹åç­‰æ“ä½œ</li><li><strong>xè¡¨ç¤ºæ‰§è¡Œæƒé™</strong>ï¼šé’ˆå¯¹æ–‡ä»¶å¤¹ï¼Œè¡¨ç¤ºå¯ä»¥æ›´æ”¹å·¥ä½œç›®å½•åˆ°æ­¤æ–‡ä»¶å¤¹ï¼Œå³cdè¿›å…¥</li></ul><h2 id="ä¿®æ”¹æƒé™æ§åˆ¶ä¿¡æ¯">ä¿®æ”¹æƒé™æ§åˆ¶ä¿¡æ¯</h2><h3 id="chmodå‘½ä»¤">chmodå‘½ä»¤</h3><p><strong>ï¼ˆ1ï¼‰ä»¥ç¬¦å·æ¨¡å¼æ”¹å˜æƒé™</strong></p><p><strong>ä½œç”¨ï¼šä¿®æ”¹æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹çš„æƒé™ä¿¡æ¯ã€‚</strong></p><p><strong>æ³¨æ„ï¼Œåªæœ‰æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹çš„æ‰€å±ç”¨æˆ·æˆ–rootç”¨æˆ·å¯ä»¥æ›´æ”¹</strong></p><p><strong>è¯­æ³•ï¼šchmod [é€‰é¡¹] [who] [æ“ä½œç¬¦å·] [æƒé™ç¬¦å·] [æ–‡ä»¶å/æ–‡ä»¶å¤¹]</strong></p><p><strong>é€‰é¡¹ï¼š</strong>-Rï¼Œå¯é€‰ï¼Œå¯¹ç›®å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸å­ç›®å½•è¿›è¡Œç›¸åŒçš„æƒé™å˜æ›´(å³ä»¥é€’å½’çš„æ–¹å¼é€ä¸ªå˜æ›´)</p><p><strong>who:</strong> å¯ä¸ºuï¼Œgï¼Œoï¼Œa(æ‰€æœ‰ç”¨æˆ·)</p><p><strong>æ“ä½œç¬¦å·ï¼š</strong>+æ·»åŠ æƒé™ï¼Œ-å–æ¶ˆæƒé™ï¼Œ=èµ‹äºˆæŒ‡å®šæƒé™å¹¶å–æ¶ˆå…¶ä»–æƒé™</p><p>**æƒé™ç¬¦å·ï¼š**rè¯»ï¼Œwå†™ï¼Œxæ‰§è¡Œ</p><p>**uï¼š**ç”¨æˆ·æƒé™</p><p>**gï¼š**ç”¨æˆ·ç»„æƒé™</p><p>**oï¼š**å…¶ä»–ç”¨æˆ·æƒé™</p><p>**aï¼š**æ‰€æœ‰ç”¨æˆ·æƒé™</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><ul><li><p>å†™æ³•1ï¼šchmod a+x hello.txt ï¼Œè¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·æ·»åŠ æ‰§è¡Œæƒé™</p></li><li><p>å†™æ³•2ï¼šchmod u=rwxï¼Œg=rxï¼Œo=x   hello.txtï¼Œè¡¨ç¤ºå°†æ–‡ä»¶æƒé™æ”¹ä¸ºï¼šrwxr-x-</p></li><li><p>chmod -R u=rwxï¼Œg=rxï¼Œo=x  testï¼Œè¡¨ç¤ºå°†æ–‡ä»¶å¤¹testä»¥åŠæ–‡ä»¶å¤¹å†…éƒ¨æƒé™è®¾ç½®ä¸ºï¼šrwxr-xâ€“x</p></li></ul><p><strong>ï¼ˆ2ï¼‰ä»¥ç»å¯¹æ–¹å¼æ”¹å˜æƒé™</strong></p><p><strong>è¯­æ³•ï¼šchmod mode æ–‡ä»¶å</strong></p><p>**modeï¼š**Linuxä¸­modeï¼Œç”±1~4ä½å…«è¿›åˆ¶æ•°å­—è¡¨ç¤ºï¼Œç¬¬ä¸€ä½è¡¨ç¤ºç”¨æˆ·IDä¸º4æˆ–ç»„IDä¸º2æˆ–ç²˜ç€å±æ€§ä¸º1ï¼Œç¬¬äºŒä½è¡¨ç¤ºuæƒé™ï¼Œç¬¬ä¸‰ä½è¡¨ç¤ºgæƒé™ï¼Œç¬¬å››ä½è¡¨ç¤ºoæƒé™(é€šå¸¸ä¿®æ”¹æƒé™ç¬¬ä¸€ä½ä¸å†™)</p><p><strong>æƒé™çš„æ•°å­—åºå·</strong>ï¼š<strong>rè®°ä¸º4ï¼Œwè®°ä¸º2ï¼Œxè®°ä¸º1</strong></p><p>å¯ä»¥é€šè¿‡chmod 751/0751 hello.txt</p><p>æ‰€ä»¥751è¡¨ç¤ºï¼š rwx(7) r-x(5) --x(1)ï¼Œå³rwxr-xâ€“x</p><p>7-5-1çš„ä¸‰ä¸ªä½ç½®æƒé™äºŒè¿›åˆ¶è¡¨ç¤ºï¼š111 101 001</p><h3 id="chownå‘½ä»¤">chownå‘½ä»¤</h3><p>**ä½œç”¨ï¼š**ä¿®æ”¹æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·å’Œç”¨æˆ·ç»„</p><p>æ™®é€šç”¨æˆ·æ— æ³•ä¿®æ”¹æ‰€å±ä¸ºå…¶ä»–ç”¨æˆ·æˆ–ç»„ï¼Œæ‰€ä»¥æ­¤å‘½ä»¤åªé€‚ç”¨äºrootç”¨æˆ·æ‰§è¡Œ</p><p>**è¯­æ³•ï¼š**chown [-R] [ç”¨æˆ·] [:] [ç”¨æˆ·ç»„] æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</p><ul><li>é€‰é¡¹ï¼š-Rï¼ŒåŒchmodï¼Œå¯¹æ–‡ä»¶å¤¹å†…å…¨éƒ¨å†…å®¹åº”ç”¨ç›¸åŒè§„åˆ™</li><li>é€‰é¡¹ï¼Œç”¨æˆ·ï¼Œä¿®æ”¹æ‰€å±ç”¨æˆ·</li><li>é€‰é¡¹ï¼Œç”¨æˆ·ç»„ï¼Œä¿®æ”¹æ‰€å±ç”¨æˆ·ç»„</li><li>ï¼šç”¨äºåˆ†éš”ç”¨æˆ·å’Œç”¨æˆ·ç»„</li></ul><p><strong>ç¤ºä¾‹ï¼š</strong></p><ul><li>chown root hello.txt å°†hello.txtæ‰€å±ç”¨æˆ·ä¿®æ”¹ä¸ºroot</li><li>chown :root hello.txt  å°†hello.txtæ‰€å±ç”¨æˆ·ç»„ä¿®æ”¹ä¸ºroot</li><li>chown root:keqiudi hello.txt å°†hello.txtæ‰€å±ç”¨æˆ·ä¿®æ”¹ä¸ºrootï¼Œç”¨æˆ·ç»„ä¿®æ”¹ä¸ºkeqiudi</li></ul><h1>7.é“¾æ¥æ–‡ä»¶å‘½ä»¤</h1><h2 id="ç¡¬é“¾æ¥">ç¡¬é“¾æ¥</h2><ul><li><p>å…ˆæ¥çœ‹çœ‹ ln é»˜è®¤åˆ›å»ºçš„ç¡¬é“¾æ¥ï¼Œç”±äº Linux ä¸‹çš„æ–‡ä»¶æ˜¯é€šè¿‡ç´¢å¼•èŠ‚ç‚¹ï¼ˆInodeï¼‰æ¥è¯†åˆ«æ–‡ä»¶ï¼Œåœ¨ Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹å· (Inode Number)ã€‚</p></li><li><p>åœ¨ Linux ä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹æ˜¯å­˜åœ¨çš„ï¼Œæ‰€ä»¥ç¡¬è¿æ¥æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œçš„è¿æ¥ï¼Œå³æ¯ä¸€ä¸ªç¡¬é“¾æ¥éƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹åº”åŒºåŸŸçš„æ–‡ä»¶ã€‚ä¿®æ”¹ä»»æ„ä¸€ä¸ªç¡¬é“¾æ¥å¯¹åº”çš„æ–‡ä»¶å†…å®¹ï¼Œå…¶ä½™çš„éƒ½å°†ä¼šè¢«ä¿®æ”¹ã€‚</p></li></ul><p>è¯­æ³•ï¼šln [é€‰é¡¹] [æºæ–‡ä»¶] [ç›®æ ‡æ–‡ä»¶]</p><p>ä¸å¡«é€‰é¡¹ï¼Œé»˜è®¤åˆ›å»ºç¡¬é“¾æ¥</p><p>æ³¨æ„ï¼š</p><ul><li>ä¸èƒ½å¯¹ç›®å½•æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥</li><li>ä¸èƒ½åœ¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¹‹é—´åˆ›å»ºç¡¬é“¾æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé“¾æ¥æ–‡ä»¶å’Œè¢«é“¾æ¥æ–‡ä»¶å¿…é¡»ä½äºåŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­</li><li>åªåˆ é™¤ä¸€ä¸ªè¿æ¥å¹¶ä¸å½±å“ç´¢å¼•èŠ‚ç‚¹æœ¬èº«å’Œå…¶å®ƒçš„è¿æ¥ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªé“¾æ¥è¢«åˆ é™¤åï¼Œæ–‡ä»¶çš„æ•°æ®å—åŠç›®å½•çš„è¿æ¥æ‰ä¼šè¢«é‡Šæ”¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶æ‰ä¼šè¢«çœŸæ­£åˆ é™¤</li></ul><h2 id="è½¯é“¾æ¥">è½¯é“¾æ¥</h2><ul><li>è½¯é“¾æ¥åˆå«ç¬¦å·é“¾æ¥ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†å¦ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„åï¼Œå¯ä»¥å°†æ–‡ä»¶ï¼Œæ–‡ä»¶å¤¹é“¾æ¥åˆ°å…¶ä»–ä½ç½®</li><li>è½¯è¿æ¥å¯ä»¥æ˜¯ä»»æ„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥é“¾æ¥ä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œåœ¨å¯¹ç¬¦å·æ–‡ä»¶è¿›è¡Œè¯»æˆ–å†™æ“ä½œçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠè¯¥æ“ä½œè½¬æ¢ä¸ºå¯¹æºæ–‡ä»¶çš„æ“ä½œï¼Œä½†åˆ é™¤é“¾æ¥æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä»…ä»…åˆ é™¤é“¾æ¥æ–‡ä»¶ï¼Œè€Œä¸åˆ é™¤æºæ–‡ä»¶æœ¬èº«ï¼Œè¿™ä¸€ç‚¹ç±»ä¼¼äº Windows æ“ä½œç³»ç»Ÿä¸‹çš„<strong>å¿«æ·æ–¹å¼ã€‚</strong></li></ul><p><strong>è¯­æ³•ï¼šln -s  å‚æ•°1 å‚æ•°2</strong></p><ul><li>-sï¼Œåˆ›å»ºè½¯é“¾æ¥  symbolicç¬¦å·é“¾æ¥</li><li>å‚æ•°1ï¼šè¢«é“¾æ¥çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</li><li>å‚æ•°2ï¼šè¦é“¾æ¥å»çš„ç›®çš„åœ°</li></ul><p>ä¾‹:</p><ul><li><p>ln -s /etc/yum.conf  ~/yum.conf</p><p>åœ¨homeç›®å½•åˆ›å»ºä¸€ä¸ªyum.confçš„è½¯é“¾æ¥(å¿«æ·æ–¹å¼)</p></li></ul><h1>8.è”æœºå¸®åŠ©å‘½ä»¤</h1><h2 id="manå‘½ä»¤">manå‘½ä»¤</h2><p>manå‘½ä»¤æ ¼å¼åŒ–å¹¶æ˜¾ç¤ºæŸä¸€å‘½ä»¤çš„è”æœºå¸®åŠ©æ‰‹å†Œï¼ˆmanualçš„ç¼©å†™è¡¨ç¤ºæ‰‹å†Œï¼‰</p><p><strong>è¯­æ³•ï¼šman [é€‰é¡¹] å‘½ä»¤å</strong></p><p>**é€‰é¡¹ï¼š**ç•¥ï¼Œå¯ä¸å¡«</p><h2 id="helpå¸®åŠ©å‘½ä»¤">helpå¸®åŠ©å‘½ä»¤</h2><p>helpå‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰shellå†…ç½®å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯</p><p><strong>è¯­æ³•ï¼šhelp å‘½ä»¤å</strong></p><p>**è¯´æ˜ï¼š**ç”¨æˆ·å¯ä»¥åˆ©ç”¨helpå‘½ä»¤æŸ¥çœ‹shellå†…ç½®å‘½ä»¤çš„ç”¨æ³•ï¼Œè‹¥helpå‘½ä»¤åé¢ä¸å¸¦ä»»ä½•å‚æ•°ï¼Œåˆ™æ˜¾ç¤ºhelpå‘½ä»¤çš„ç”¨æ³•ï¼Œåˆ—å‡ºshellçš„å†…ç½®å‘½ä»¤åˆ—è¡¨ã€‚</p><h1>9.è¿›ç¨‹ç®¡ç†å‘½ä»¤</h1><h2 id="niceå‘½ä»¤">niceå‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šniceå‘½ä»¤ç”¨æ¥ä¿®æ”¹è¿›ç¨‹çš„ä¼˜å…ˆçº§</strong></p><p><strong>è¯­æ³•ï¼šnice [é€‰é¡¹] [å‘½ä»¤]</strong></p><p>**è¯´æ˜ï¼š**Linuxä¸­ï¼Œå‘½ä»¤é€šå¸¸ä»¥è¿›ç¨‹çš„å½¢å¼è¿è¡Œï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç›¸å¯¹ä¼˜å…ˆçº§ï¼Œå½±å“åˆ°ç³»ç»Ÿå¯¹è¿›ç¨‹æ‰€éœ€èµ„æºçš„åˆ†é…ï¼Œç”¨æˆ·ä½¿ç”¨niceå‘½ä»¤å¯ä»¥ä¿®æ”¹ç›¸åº”è¿›ç¨‹çš„è°ƒåº¦ä¼˜å…ˆçº§ã€‚nice çš„å–å€¼èŒƒå›´ä¸º-20~19ï¼Œ<strong>æ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</strong>ï¼Œåªæœ‰rootå¯ä»¥æŒ‡å®šè´Ÿæ•°ï¼Œæ™®é€šç”¨æˆ·æŒ‡å®šçš„niceå€¼å¿…é¡»æ˜¯æ­£æ•°ï¼Œåœ¨ä¸éœ€è¦å‘½ä»¤é©¬ä¸Šè¿è¡Œæ—¶ï¼Œå¯ä»¥ç”¨niceé™ä½åå°æˆ–æ‰¹å¤„ç†è¿›ç¨‹çš„ä¼˜å…ˆçº§</p><p>é€‰é¡¹ï¼š</p><ul><li>-nï¼Œâ€“adjustment=N     å°†niceçš„å€¼åŠ ä¸Šæ•´æ•°Nï¼ˆé»˜è®¤ä¸º10ï¼‰</li><li>â€“help     æ˜¾ç¤ºhelpå¸®åŠ©ä¿¡æ¯ï¼Œç„¶åç»ˆæ­¢</li></ul><p>ä¾‹å­ï¼š</p><p>nice -n 1 ls    å°†lsçš„ä¼˜å…ˆçº§åŠ 1å¹¶æ‰§è¡Œ</p><p>nice ls å°†lsçš„ä¼˜å…ˆçº§åŠ 10å¹¶æ‰§è¡Œï¼ˆé»˜è®¤ï¼‰</p><h2 id="killå‘½ä»¤">killå‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šç»ˆæ­¢ä¸€ä¸ªç¨‹åºçš„è¿è¡Œ</strong></p><p><strong>è¯­æ³•ï¼škill [-s ] [ç¨‹åº]ã€€æˆ–ã€€kill [-l ]</strong></p><p><strong>å‚æ•°ï¼š</strong></p><ul><li>-l ï¼ŒæŒ‡&lt;ä¿¡æ¯ç¼–å·&gt; ã€€è‹¥ä¸åŠ &lt;ä¿¡æ¯ç¼–å·&gt;é€‰é¡¹ï¼Œåˆ™ -l å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡æ¯åç§°ï¼ˆä¿¡å·åˆ—è¡¨ï¼‰ã€‚</li><li>-s ï¼ŒæŒ‡&lt;ä¿¡æ¯åç§°æˆ–ç¼–å·&gt; ã€€æŒ‡å®šè¦é€å‡ºçš„ä¿¡æ¯ã€‚</li><li>[ç¨‹åº] ï¼Œ[ç¨‹åº]å¯ä»¥æ˜¯ç¨‹åºçš„PIDæˆ–æ˜¯PGIDï¼Œä¹Ÿå¯ä»¥æ˜¯å·¥ä½œç¼–å·ã€‚</li></ul><p><strong>ä½¿ç”¨ kill -l å‘½ä»¤åˆ—å‡ºæ‰€æœ‰å¯ç”¨ä¿¡å·ã€‚</strong></p><p><strong>æœ€å¸¸ç”¨çš„ä¿¡å·æ˜¯ï¼š</strong></p><ul><li>1 (HUP)ï¼šé‡æ–°åŠ è½½è¿›ç¨‹ã€‚   1ä¸ºä¿¡æ¯ç¼–å·ï¼ŒHUPä¸ºä¿¡æ¯åç§°-1 == -HUP</li><li>9 (KILL)ï¼šæ€æ­»ä¸€ä¸ªè¿›ç¨‹ã€‚    9ä¸ºä¿¡æ¯ç¼–å·ï¼ŒHUPä¸ºä¿¡æ¯åç§°-9 == -KILL</li><li>15 (TERM)ï¼šæ­£å¸¸åœæ­¢ä¸€ä¸ªè¿›ç¨‹ã€‚ï¼ˆé»˜è®¤æƒ…å†µä¸‹å‘é€15ï¼‰</li></ul><p><strong>ä¾‹å­ï¼š</strong></p><pre><code>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># kill 12345   <span class="comment">//æ€æ­»è¿›ç¨‹12345</span></span></span><br><span class="line"></span><br><span class="line">å†™æ³•ä¸€:<span class="meta"># kill -KILL 123456  <span class="comment">//å¼ºåˆ¶æ€æ­»è¿›ç¨‹12345</span></span></span><br><span class="line">å†™æ³•äºŒ:<span class="meta"># kill -9 123456 <span class="comment">//å¼ºåˆ¶æ€æ­»è¿›ç¨‹12345ï¼Œä¸ä¸Šæ–¹ç­‰ä»·</span></span></span><br><span class="line">å†™æ³•ä¸‰:<span class="meta"># kill -s 9 123456  <span class="comment">//å¼ºåˆ¶æ€æ­»12345</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta"># kill -HUP 123456 <span class="comment">//å‘é€SIGHUPä¿¡å·ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸‹ä¿¡å·</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure></code></pre><h2 id="sleepå‘½ä»¤">sleepå‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šä½¿è¿›ç¨‹æš‚åœæ‰§è¡Œä¸€æ®µæ—¶é—´</strong></p><p><strong>è¯­æ³•ï¼šsleep æ—¶é—´å€¼ï¼ˆsï¼‰</strong></p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sleep <span class="number">2</span>; cat test.txt <span class="comment">//ä½¿è¿›ç¨‹å…ˆæš‚åœ2ç§’ï¼Œç„¶ååœ¨æ˜¾ç¤ºå‡ºtest.txtçš„å†…å®¹</span></span><br></pre></td></tr></table></figure><h2 id="pså‘½ä»¤">pså‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šåˆ—å‡ºå½“å‰çš„è¿›ç¨‹</strong></p><p><strong>è¯­æ³•ï¼šps [å‚æ•°]</strong></p><p><strong>å‚æ•°ï¼š</strong></p><ul><li>-A, åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹</li></ul><h1>10.æ–‡ä»¶å‹ç¼©å’Œè§£å‹ç¼©å‘½ä»¤</h1><h2 id="gzipå‘½ä»¤">gzipå‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šå¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©å’Œè§£å‹ï¼Œå‹ç¼©æ–‡ä»¶æ‹“å±•åä¸º .gz</strong></p><p><strong>è¯­æ³•ï¼šgzip [é€‰é¡¹] [æ–‡ä»¶æˆ–ç›®å½•]</strong></p><p><strong>é€‰é¡¹ï¼š</strong></p><ul><li>-d :  å°†è¢«å‹ç¼©çš„æ–‡ä»¶è§£å‹</li><li>-vï¼šæ˜¾ç¤ºå‡ºæ–‡ä»¶åå’Œå‹ç¼©æ¯”</li><li>-lï¼šå¯¹äºæ¯ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œåˆ—å‡ºä¿¡æ¯</li></ul><p><strong>æ³¨æ„ï¼šä¸èƒ½å‹ç¼©æ–‡ä»¶å¤¹-ç›®å½•</strong></p><p><strong>ç¤ºä¾‹ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#gzip test.txt <span class="comment">//å°†test.txtå‹ç¼©ä¸ºtest.txt.gz</span></span></span><br><span class="line"><span class="meta">#gzip -dv test.txt <span class="comment">//å°†.gzè§£å‹</span></span></span><br><span class="line"><span class="meta">#gzip * <span class="comment">//å°†è¯¥ç›®å½•ä¸‹æ–‡ä»¶å…¨éƒ¨å‹ç¼©</span></span></span><br><span class="line"><span class="meta">#gzip -d * <span class="comment">//å°†ç›®å½•ä¸‹æ–‡ä»¶å…¨éƒ¨è§£å‹</span></span></span><br></pre></td></tr></table></figure><h2 id="unzipå‘½ä»¤">unzipå‘½ä»¤</h2><p><strong>ä½œç”¨ï¼šunzipå‘½ä»¤å¯¹ZIPæ ¼å¼çš„å‹ç¼©æ–‡ä»¶è¿›è¡Œè§£å‹.æ–‡ä»¶å¸¦æœ‰åç¼€.zip</strong></p><p><strong>è¯­æ³•ï¼šunzip [é€‰é¡¹] è¢«å‹ç¼©çš„æ–‡ä»¶å</strong></p><p>**è¯´æ˜ï¼š**è¢«å‹ç¼©çš„æ–‡ä»¶åæ˜¯ZIPæ–‡ä»¶çš„è·¯å¾„åï¼Œå…¶ä¸­åªæœ‰æ–‡ä»¶åå¯ä»¥æ˜¯é€šé…ç¬¦(*ç­‰)è€Œæ•´ä¸ªè·¯å¾„ä¸èƒ½æ˜¯é€šé…ç¬¦ï¼Œå‚æ•°ä¸­å¯ä»¥ç»™å‡ºå¤šä¸ªæ–‡ä»¶åï¼Œå½¼æ­¤ç”¨ç©ºæ ¼åˆ†å¼€</p><p><strong>é€‰é¡¹:</strong></p><ul><li>-v ï¼šæ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¿¡æ¯</li><li>-d ç›®å½• ï¼šå°†å‹ç¼©æ–‡ä»¶åŠ å‹åæ”¾åˆ°æŒ‡å®šç›®å½•ä¸­</li><li>-x æ–‡ä»¶åˆ—è¡¨ï¼šè§£å‹ç¼©æ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶åˆ—è¡¨ä¸­æ‰€æŒ‡å®šçš„æ–‡ä»¶å¹¶ä¸è§£å‹ç¼©</li></ul><p>æ³¨æ„ï¼šLinuxä¸‹å¯èƒ½éœ€è¦å…ˆå®‰è£…unzip</p><p>sudo apt install unzip</p><h1>11.å„ç±»å°æŠ€å·§å¿«æ·é”®</h1><h2 id="ctrl-c-å¼ºåˆ¶åœæ­¢">ctrl +c å¼ºåˆ¶åœæ­¢</h2><ul><li>LinuxæŸäº›ç¨‹åºè¿è¡Œï¼Œctrl + c å¯ä»¥å¼ºåˆ¶åœæ­¢å®ƒ</li><li>å‘½ä»¤è¾“å…¥é”™è¯¯ï¼Œä¹Ÿå¯é€šè¿‡ ctrl + c ï¼Œé€€å‡ºå½“å‰å‘½ä»¤çš„è¾“å…¥</li></ul><h2 id="ctrl-dé€€å‡ºæˆ–ç™»å‡º">ctrl +dé€€å‡ºæˆ–ç™»å‡º</h2><ul><li>ctrl +d é€€å‡ºè´¦æˆ·çš„ç™»å½•</li><li>é€€å‡ºæŸäº›ç‰¹å®šç¨‹åºçš„ä¸“å±é¡µé¢ï¼ˆpythonç­‰ï¼‰ **psï¼š**ä¸èƒ½ç”¨äºé€€å‡ºvi/vim</li></ul><h2 id="historyå‘½ä»¤">historyå‘½ä»¤</h2><ul><li><p>å¯ä»¥é€šè¿‡historyå‘½ä»¤ï¼ŒæŸ¥çœ‹å†å²è¾“å…¥è¿‡çš„å‘½ä»¤</p></li><li><p>å¯ä»¥é€šè¿‡ï¼šï¼+ å‘½ä»¤å‰ç¼€ï¼Œè‡ªåŠ¨æ‰§è¡Œä¸Šä¸€æ¬¡åŒ¹é…å‰ç¼€</p><p><strong>ctrl + r ï¼Œè¾“å…¥å†…å®¹å»åŒ¹é…å†å²å‘½ä»¤</strong></p></li><li><p>å›è½¦é”®å¯ä»¥ç›´æ¥æ‰§è¡Œ</p></li><li><p>é”®ç›˜å·¦å³é”®ï¼Œå¯ä»¥å¾—åˆ°æ­¤å‘½ä»¤(ä¸æ‰§è¡Œ)</p></li></ul><h2 id="å…‰æ ‡ç§»åŠ¨å¿«æ·é”®">å…‰æ ‡ç§»åŠ¨å¿«æ·é”®</h2><ul><li><strong>ctrl + a</strong>ï¼Œè·³åˆ°å‘½ä»¤å¼€å¤´</li><li><strong>ctrl + e</strong> ï¼Œè·³åˆ°å‘½ä»¤ç»“å°¾</li><li><strong>ctrl + é”®ç›˜å·¦é”®</strong>ï¼Œå‘å·¦è·³ä¸€ä¸ªå•è¯</li><li><strong>ctrl + é”®ç›˜å³é”®</strong>ï¼Œå‘å³è·³ä¸€ä¸ªå•è¯</li></ul><h2 id="æ¸…å±">æ¸…å±</h2><ul><li>é€šè¿‡å¿«æ·é”®<strong>ctrl +l</strong> ï¼Œå¯ä»¥æ¸…ç©ºç»ˆç«¯å†…å®¹</li><li>æˆ–è€…é€šè¿‡å‘½ä»¤clearå¾—åˆ°åŒæ ·çš„æ•ˆæœ</li></ul><h1>12.åŒ…ç®¡ç†</h1><p><strong>Linuxå‘½ä»¤è¡Œå†…çš„åº”ç”¨å•†åº—å®‰è£…è½¯ä»¶ï¼ŒCentOSå’ŒUbuntuç”¨çš„ä¸åŒåŒ…ç®¡ç†å™¨ã€‚</strong></p><p>CentOSä½¿ç”¨<strong>yum</strong>ç®¡ç†å™¨ï¼ŒUbuntuä½¿ç”¨<strong>apt</strong>ç®¡ç†å™¨</p><p><strong>æ•…ä»¥ä¸‹åˆ†ä¸¤ç§è®¨è®ºï¼š</strong></p><h2 id="CentOS">CentOS</h2><h3 id="yumå‘½ä»¤">yumå‘½ä»¤</h3><p>**yumï¼š**RPMåŒ…è½¯ä»¶ç®¡ç†å™¨ï¼Œç”¨äºè‡ªåŠ¨åŒ–å®‰è£…é…ç½®Linuxè½¯ä»¶ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨è§£å†³ä¾èµ–é—®é¢˜</p><p><strong>è¯­æ³•ï¼šyum   [-y]    install/remove/search    è½¯ä»¶åç§°</strong></p><ul><li><strong>é€‰é¡¹ï¼š</strong>-yï¼Œè‡ªåŠ¨ç¡®è®¤ï¼Œæ— éœ€æ‰‹åŠ¨ç¡®è®¤å®‰è£…è¿‡ç¨‹æˆ–å¸è½½è¿‡ç¨‹</li><li>**installï¼š**å®‰è£…</li><li>**removeï¼š**å¸è½½</li><li>**searchï¼š**æœç´¢</li></ul><p><strong>æ³¨æ„ï¼šyumå‘½ä»¤éœ€è¦rootæƒé™ï¼Œä¸”éœ€è¦è”ç½‘</strong></p><p>ä¾‹å­ï¼š</p><ul><li><strong>yum [-y] install wgetï¼Œé€šè¿‡yumå‘½ä»¤å®‰è£…wgetç¨‹åº</strong></li><li><strong>yum [-y] remove wgetï¼Œå¸è½½wget</strong></li><li><strong>yum  search wget ï¼Œæœç´¢æ˜¯å¦æœ‰wgetå®‰è£…åŒ…</strong></li></ul><h2 id="Ubuntu">Ubuntu</h2><h3 id="aptå‘½ä»¤">aptå‘½ä»¤</h3><p><strong>ç”¨æ³•ä¸yumä¸€è‡´ï¼ŒåŒæ ·éœ€è¦rootæƒé™</strong></p><p><strong>è¯­æ³•ï¼šapt   [-y]    install/remove/search    è½¯ä»¶åç§°</strong></p><ul><li><strong>apt [-y] install wgetï¼Œå®‰è£…wgetç¨‹åº</strong></li><li><strong>apt [-y] remove wgetï¼Œå¸è½½wget</strong></li><li><strong>apt  search wget ï¼Œæœç´¢æ˜¯å¦æœ‰wgetå®‰è£…åŒ…</strong></li></ul>]]></content>
    
    
    <summary type="html">Linuxçš„çŸ¥è¯†</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>socket</title>
    <link href="https://keqiudi.github.io/posts/174bd570.html"/>
    <id>https://keqiudi.github.io/posts/174bd570.html</id>
    <published>2023-03-03T14:01:44.000Z</published>
    <updated>2023-07-20T13:25:17.756Z</updated>
    
    <content type="html"><![CDATA[<h1>1.socketå¥—æ¥å­—:</h1><h2 id="æ¦‚å¿µï¼š">æ¦‚å¿µï¼š</h2><ul><li><strong>å±€åŸŸç½‘å’Œå¹¿åŸŸç½‘</strong><ul><li><strong>å±€åŸŸç½‘</strong>ï¼šå±€åŸŸç½‘å°†ä¸€å®šåŒºåŸŸå†…çš„å„ç§è®¡ç®—æœºã€å¤–éƒ¨è®¾å¤‡å’Œæ•°æ®åº“è¿æ¥èµ·æ¥å½¢æˆè®¡ç®—æœºé€šä¿¡çš„ç§æœ‰ç½‘ç»œã€‚</li><li><strong>å¹¿åŸŸç½‘</strong>ï¼šåˆç§°å¹¿åŸŸç½‘ã€å¤–ç½‘ã€å…¬ç½‘ã€‚æ˜¯è¿æ¥ä¸åŒåœ°åŒºå±€åŸŸç½‘æˆ–åŸåŸŸç½‘è®¡ç®—æœº é€šä¿¡çš„è¿œç¨‹å…¬å…±ç½‘ç»œã€‚</li><li><strong>IP</strong>ï¼ˆInternet Protocolï¼‰ï¼šæœ¬è´¨æ˜¯ä¸€ä¸ªæ•´å½¢æ•°ï¼Œç”¨äºè¡¨ç¤ºè®¡ç®—æœºåœ¨ç½‘ç»œä¸­çš„åœ°å€ã€‚IP åè®®ç‰ˆæœ¬æœ‰ä¸¤ä¸ªï¼šIPv4 å’Œ IPv6</li></ul></li></ul><p><strong>IPv4</strong>ï¼ˆInternet Protocol version4ï¼‰ï¼š</p><ul><li>ä½¿ç”¨ä¸€ä¸ª 32 ä½çš„æ•´å½¢æ•°æè¿°ä¸€ä¸ª IP åœ°å€ï¼Œ4 ä¸ªå­—èŠ‚ï¼Œint å‹<br>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç‚¹åˆ†åè¿›åˆ¶å­—ç¬¦ä¸²æè¿°è¿™ä¸ª IP åœ°å€ï¼š 192.168.247.135<br>åˆ†æˆäº† 4 ä»½ï¼Œæ¯ä»½ 1 å­—èŠ‚ï¼Œ8bitï¼ˆcharï¼‰ï¼Œæœ€å¤§å€¼ä¸º 255<br>0.0.0.0 æ˜¯æœ€å°çš„ IP åœ°å€<br>255.255.255.255 æ˜¯æœ€å¤§çš„ IP åœ°å€<br>æŒ‰ç…§ IPv4 åè®®è®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨çš„ IP åœ°å€å…±æœ‰ 2^32^ ä¸ª</li></ul><p><strong>IPv6</strong>ï¼ˆInternet Protocol version6ï¼‰ï¼š</p><ul><li>ä½¿ç”¨ä¸€ä¸ª 128 ä½çš„æ•´å½¢æ•°æè¿°ä¸€ä¸ª IP åœ°å€ï¼Œ16 ä¸ªå­—èŠ‚<br>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æè¿°è¿™ä¸ª IP åœ°å€ï¼š2001:0db8:3c4d:0015:0000:0000:1a2f:1a2b<br>åˆ†æˆäº† 8 ä»½ï¼Œæ¯ä»½ 2 å­—èŠ‚ï¼Œæ¯ä¸€éƒ¨åˆ†ä»¥ 16 è¿›åˆ¶çš„æ–¹å¼è¡¨ç¤º<br>æŒ‰ç…§ IPv6 åè®®è®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨çš„ IP åœ°å€å…±æœ‰ 2^128^ ä¸ª</li></ul><p><strong>æŸ¥çœ‹IPåœ°å€ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">linux</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ifconfig</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">windows</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ipconfig</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æµ‹è¯•ç½‘ç»œæ˜¯å¦ç•…é€š</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸»æœºa: 192.168.1.11</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å½“å‰ä¸»æœº: 192.168.1.12</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ping 192.168.1.11     <span class="comment"># æµ‹è¯•æ˜¯å¦å¯ç”¨è¿æ¥å±€åŸŸç½‘</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ping www.baidu.com    <span class="comment"># æµ‹è¯•æ˜¯å¦å¯ç”¨è¿æ¥å¤–ç½‘</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç‰¹æ®Šçš„IPåœ°å€: 127.0.0.1  ==&gt; å’Œæœ¬åœ°çš„IPåœ°å€æ˜¯ç­‰ä»·çš„</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‡è®¾å½“å‰ç”µè„‘æ²¡æœ‰è”ç½‘, å°±æ²¡æœ‰IPåœ°å€, åˆè¦åšç½‘ç»œæµ‹è¯•, å¯ç”¨ä½¿ç”¨ 127.0.0.1 è¿›è¡Œæœ¬åœ°æµ‹è¯•</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><strong>ç«¯å£:</strong></li></ul><p>ç«¯å£çš„ä½œç”¨æ˜¯å®šä½åˆ°ä¸»æœºä¸Šçš„æŸä¸€ä¸ªè¿›ç¨‹ï¼Œé€šè¿‡è¿™ä¸ªç«¯å£è¿›ç¨‹å°±å¯ä»¥æ¥å—åˆ°å¯¹åº”çš„ç½‘ç»œæ•°æ®äº†ã€‚</p><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>æ¯”å¦‚: åœ¨ç”µè„‘ä¸Šè¿è¡Œäº†å¾®ä¿¡å’ŒQQ, å°æ˜é€šè¿‡å®¢æˆ·ç«¯ç»™æˆ‘çš„çš„å¾®ä¿¡å‘æ¶ˆæ¯, ç”µè„‘ä¸Šçš„å¾®ä¿¡å°±æ”¶åˆ°äº†æ¶ˆæ¯, ä¸ºä»€ä¹ˆ?</p><ul><li>è¿è¡Œåœ¨ç”µè„‘ä¸Šçš„å¾®ä¿¡å’ŒQQéƒ½ç»‘å®šäº†ä¸åŒçš„ç«¯å£</li><li>é€šè¿‡IPåœ°å€å¯ä»¥å®šä½åˆ°æŸä¸€å°ä¸»æœºï¼Œé€šè¿‡ç«¯å£å°±å¯ä»¥å®šä½åˆ°ä¸»æœºä¸Šçš„æŸä¸€ä¸ªè¿›ç¨‹</li><li>é€šè¿‡æŒ‡å®šçš„IPå’Œç«¯å£ï¼Œå‘é€æ•°æ®çš„æ—¶å€™å¯¹ç«¯å°±èƒ½æ¥å—åˆ°æ•°æ®äº†</li></ul></div><p>ç«¯å£ä¹Ÿæ˜¯ä¸€ä¸ªæ•´å½¢æ•° unsigned short ï¼Œä¸€ä¸ª 16 ä½æ•´å½¢æ•°ï¼Œæœ‰æ•ˆç«¯å£çš„å–å€¼èŒƒå›´æ˜¯ï¼š<strong>0 ~ 65535</strong>(0 ~ 2^16^-1)</p><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>æé—®ï¼šè®¡ç®—æœºä¸­æ‰€æœ‰çš„è¿›ç¨‹éƒ½éœ€è¦å…³è”ä¸€ä¸ªç«¯å£å—ï¼Œä¸€ä¸ªç«¯å£å¯ä»¥è¢«é‡å¤ä½¿ç”¨å—?</p></div><ul><li><p><strong>ä¸éœ€è¦ï¼Œå¦‚æœè¿™ä¸ªè¿›ç¨‹ä¸éœ€è¦ç½‘ç»œé€šä¿¡ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹å°±ä¸éœ€è¦ç»‘å®šç«¯å£çš„</strong></p></li><li><p><strong>ä¸€ä¸ªç«¯å£åªèƒ½ç»™æŸä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œå¤šä¸ªè¿›ç¨‹ä¸èƒ½åŒæ—¶ä½¿ç”¨åŒä¸€ä¸ªç«¯å£</strong></p></li><li><p><strong>OSI/ISO ç½‘ç»œ(ä¸ƒå±‚)åˆ†å±‚æ¨¡å‹</strong></p><p>OSIï¼ˆOpen System Interconnectï¼‰ï¼Œå³å¼€æ”¾å¼ç³»ç»Ÿäº’è”ã€‚ ä¸€èˆ¬éƒ½å«OSIå‚è€ƒæ¨¡å‹ï¼Œæ˜¯ISOï¼ˆå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ç»„ç»‡ï¼‰åœ¨1985å¹´ç ”ç©¶çš„ç½‘ç»œäº’è”æ¨¡å‹ã€‚</p><p><img src="https://subingwen.cn/linux/socket/ip%E5%9B%9B%E5%B1%82%E5%8D%8F%E8%AE%AE%E6%A8%A1%E5%9E%8B.png" alt="img"></p><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><ul><li>ç‰©ç†å±‚ï¼šè´Ÿè´£æœ€åå°†ä¿¡æ¯ç¼–ç æˆç”µæµè„‰å†²æˆ–å…¶å®ƒä¿¡å·ç”¨äºç½‘ä¸Šä¼ è¾“</li><li>æ•°æ®é“¾è·¯å±‚:<br>æ•°æ®é“¾è·¯å±‚é€šè¿‡ç‰©ç†ç½‘ç»œé“¾è·¯ä¾›æ•°æ®ä¼ è¾“ã€‚<br>è§„å®šäº†0å’Œ1çš„åˆ†åŒ…å½¢å¼ï¼Œç¡®å®šäº†ç½‘ç»œæ•°æ®åŒ…çš„å½¢å¼ï¼›</li><li>ç½‘ç»œå±‚<br>ç½‘ç»œå±‚è´Ÿè´£åœ¨æºå’Œç»ˆç‚¹ä¹‹é—´å»ºç«‹è¿æ¥;<br>æ­¤å¤„éœ€è¦ç¡®å®šè®¡ç®—æœºçš„ä½ç½®ï¼Œé€šè¿‡IPv4ï¼ŒIPv6æ ¼å¼çš„IPåœ°å€æ¥æ‰¾åˆ°å¯¹åº”çš„ä¸»æœº</li><li>ä¼ è¾“å±‚<br>ä¼ è¾“å±‚å‘é«˜å±‚æä¾›å¯é çš„ç«¯åˆ°ç«¯çš„ç½‘ç»œæ•°æ®æµæœåŠ¡ã€‚<br>æ¯ä¸€ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¼šåœ¨ç½‘å¡æ³¨å†Œä¸€ä¸ªç«¯å£å·ï¼Œè¯¥å±‚å°±æ˜¯ç«¯å£ä¸ç«¯å£çš„é€šä¿¡</li><li>ä¼šè¯å±‚<br>ä¼šè¯å±‚å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢è¡¨ç¤ºå±‚ä¸å®ä½“ä¹‹é—´çš„é€šä¿¡ä¼šè¯ï¼›<br>å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼ˆè‡ªåŠ¨çš„æ‰‹æœºä¿¡æ¯ã€è‡ªåŠ¨çš„ç½‘ç»œå¯»å€ï¼‰;</li><li>è¡¨ç¤ºå±‚:<br>å¯¹åº”ç”¨å±‚æ•°æ®ç¼–ç å’Œè½¬åŒ–, ç¡®ä¿ä»¥ä¸€ä¸ªç³»ç»Ÿåº”ç”¨å±‚å‘é€çš„ä¿¡æ¯ å¯ä»¥è¢«å¦ä¸€ä¸ªç³»ç»Ÿåº”ç”¨å±‚è¯†åˆ«;</li><li>åº”ç”¨å±‚ï¼š</li></ul></div></li></ul><p><strong>tcp/ip å››å±‚æ¨¡å‹ï¼š</strong></p><ul><li>åº”ç”¨å±‚ï¼šå¯¹åº”iso/osiçš„åº”ç”¨å±‚ã€è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚</li><li>ä¼ è¾“å±‚ï¼šå¯¹åº”iso/osiçš„ä¼ è¾“å±‚</li><li>ç½‘ç»œäº’è”å±‚ï¼š å¯¹åº”iso/osiçš„ç½‘ç»œäº’è”å±‚</li><li>ç½‘ç»œæ¥å£å±‚ï¼šå¯¹åº”iso/osiæ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚</li></ul><h2 id="ç½‘ç»œåè®®">ç½‘ç»œåè®®</h2><p>ç½‘ç»œåè®®æŒ‡çš„æ˜¯è®¡ç®—æœºç½‘ç»œä¸­äº’ç›¸é€šä¿¡çš„å¯¹ç­‰å®ä½“ä¹‹é—´äº¤æ¢ä¿¡æ¯æ—¶æ‰€å¿…é¡»éµå®ˆçš„è§„åˆ™çš„é›†åˆã€‚ä¸€èˆ¬ç³»ç»Ÿç½‘ç»œåè®®åŒ…æ‹¬äº”ä¸ªéƒ¨åˆ†ï¼šé€šä¿¡ç¯å¢ƒï¼Œä¼ è¾“æœåŠ¡ï¼Œè¯æ±‡è¡¨ï¼Œä¿¡æ¯çš„ç¼–ç æ ¼å¼ï¼Œæ—¶åºã€è§„åˆ™å’Œè¿‡ç¨‹ã€‚ä¸‹é¢æ˜¯å¸¸ç”¨çš„åè®®æ ¼å¼ï¼š</p><p><strong>TCP åè®® -&gt; ä¼ è¾“å±‚åè®®ï¼š</strong></p><p><img src="https://subingwen.cn/linux/socket/tcp.png" alt="img"></p><p><strong>UDP åè®® -&gt; ä¼ è¾“å±‚åè®®ï¼š</strong></p><p><img src="https://subingwen.cn/linux/socket/udp.png" alt="img"></p><p><strong>IP åè®® -&gt; ç½‘ç»œå±‚åè®®</strong>ï¼š</p><p><img src="https://subingwen.cn/linux/socket/ip.png" alt="img"></p><p><strong>ä»¥å¤ªç½‘å¸§åè®® -&gt; ç½‘ç»œæ¥å£å±‚åè®®</strong>ï¼š</p><p><img src="https://subingwen.cn/linux/socket/mac.png" alt="img"></p><p><strong>æ•°æ®çš„å°è£…ï¼š</strong></p><p><img src="https://subingwen.cn/linux/socket/1558001080021.png" alt="1558001080021"></p><p>åœ¨ç½‘ç»œé€šä¿¡çš„æ—¶å€™, ç¨‹åºçŒ¿éœ€è¦è´Ÿè´£çš„åº”ç”¨å±‚æ•°æ®çš„å¤„ç†(æœ€ä¸Šå±‚)</p><ul><li><p>åº”ç”¨å±‚çš„æ•°æ®å¯ä»¥ä½¿ç”¨æŸäº›åè®®è¿›è¡Œå°è£…ï¼Œä¹Ÿå¯ä»¥ä¸å°è£…</p></li><li><p>ç¨‹åºçŒ¿éœ€è¦è°ƒç”¨å‘é€æ•°æ®çš„æ¥å£å‡½æ•°ï¼Œå°†æ•°æ®å‘é€å‡ºå»</p></li><li><p>ç¨‹åºçŒ¿è°ƒç”¨çš„ API åšåº•å±‚æ•°æ®å¤„ç†</p></li><li><p>ä¼ è¾“å±‚ä½¿ç”¨ä¼ è¾“å±‚åè®®æ‰“åŒ…æ•°æ®</p><ul><li>ç½‘ç»œå±‚ä½¿ç”¨ç½‘ç»œå±‚åè®®æ‰“åŒ…æ•°æ®</li><li>ç½‘ç»œæ¥å£å±‚ä½¿ç”¨ç½‘ç»œæ¥å£å±‚åè®®æ‰“åŒ…æ•°æ®</li><li>æ•°æ®è¢«å‘é€åˆ° internet</li><li>æ¥æ”¶ç«¯æ¥æ”¶åˆ°å‘é€ç«¯çš„æ•°æ®</li></ul></li><li><p>æ¥æ”¶ç«¯æ¥æ”¶åˆ°å‘é€ç«¯çš„æ•°æ®</p><ul><li><p>ç¨‹åºçŒ¿è°ƒç”¨æ¥æ”¶æ•°æ®çš„å‡½æ•°æ¥æ”¶æ•°æ®</p></li><li><p>è°ƒç”¨çš„ API åšç›¸å…³çš„åº•å±‚å¤„ç†:</p></li><li><p>ç½‘ç»œæ¥å£å±‚æ‹†åŒ… ==&gt; ç½‘ç»œå±‚çš„åŒ…</p></li><li><p>ç½‘ç»œå±‚æ‹†åŒ… ==&gt; ç½‘ç»œå±‚çš„åŒ…</p></li><li><p>ä¼ è¾“å±‚æ‹†åŒ… ==&gt; ä¼ è¾“å±‚æ•°æ®</p></li><li><p>å¦‚æœåº”ç”¨å±‚ä¹Ÿä½¿ç”¨äº†åè®®å¯¹æ•°æ®è¿›è¡Œäº†å°è£…ï¼Œæ•°æ®çš„åŒ…çš„è§£æéœ€è¦ç¨‹åºçŒ¿åš</p></li></ul></li></ul><h2 id="socketç¼–ç¨‹">socketç¼–ç¨‹</h2><p>Socketå¥—æ¥å­—ç”±è¿œæ™¯ç ”ç©¶è§„åˆ’å±€ï¼ˆAdvanced Research Projects Agency, ARPAï¼‰èµ„åŠ©åŠ é‡Œç¦å°¼äºšå¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„ä¸€ä¸ªç ”ç©¶ç»„ç ”å‘ã€‚å…¶ç›®çš„æ˜¯å°†TCP/IPåè®®ç›¸å…³è½¯ä»¶ç§»æ¤åˆ°UNIXç±»ç³»ç»Ÿä¸­ã€‚è®¾è®¡è€…å¼€å‘äº†ä¸€ä¸ªæ¥å£ï¼Œä»¥ä¾¿åº”ç”¨ç¨‹åºèƒ½ç®€å•åœ°è°ƒç”¨è¯¥æ¥å£é€šä¿¡ã€‚è¿™ä¸ªæ¥å£ä¸æ–­å®Œå–„ï¼Œæœ€ç»ˆå½¢æˆäº†Socketå¥—æ¥å­—ã€‚Linuxç³»ç»Ÿé‡‡ç”¨äº†Socketå¥—æ¥å­—ï¼Œå› æ­¤ï¼ŒSocketæ¥å£å°±è¢«å¹¿æ³›ä½¿ç”¨ï¼Œåˆ°ç°åœ¨å·²ç»æˆä¸ºäº‹å®ä¸Šçš„æ ‡å‡†ã€‚ä¸å¥—æ¥å­—ç›¸å…³çš„å‡½æ•°è¢«åŒ…å«åœ¨å¤´æ–‡ä»¶sys/socket.hä¸­ã€‚</p><p>å¥—æ¥å­—å¯¹åº”ç¨‹åºçŒ¿æ¥è¯´å°±æ˜¯ä¸€å¥—ç½‘ç»œé€šä¿¡çš„æ¥å£ï¼Œä½¿ç”¨è¿™å¥—æ¥å£å°±å¯ä»¥å®Œæˆç½‘ç»œé€šä¿¡ã€‚ç½‘ç»œé€šä¿¡çš„ä¸»ä½“ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ã€‚åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šä¿¡çš„æ—¶å€™éœ€è¦é¢‘ç¹æåˆ°ä¸‰ä¸ªæ¦‚å¿µï¼šIPã€ç«¯å£ã€é€šä¿¡æ•°æ®ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹éœ€è¦æ³¨æ„çš„ä¸€äº›ç»†èŠ‚é—®é¢˜ã€‚</p><h3 id="å­—èŠ‚åº">å­—èŠ‚åº</h3><p>åœ¨å„ç§è®¡ç®—æœºä½“ç³»ç»“æ„ä¸­ï¼Œå¯¹äºå­—èŠ‚ã€å­—ç­‰çš„å­˜å‚¨æœºåˆ¶æœ‰æ‰€ä¸åŒï¼Œå› è€Œå¼•å‘äº†è®¡ç®—æœºé€šä¿¡é¢†åŸŸä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå³é€šä¿¡åŒæ–¹äº¤æµçš„ä¿¡æ¯å•å…ƒï¼ˆæ¯”ç‰¹ã€å­—èŠ‚ã€å­—ã€åŒå­—ç­‰ç­‰ï¼‰åº”è¯¥ä»¥ä»€ä¹ˆæ ·çš„é¡ºåºè¿›è¡Œä¼ é€ã€‚å¦‚æœä¸è¾¾æˆä¸€è‡´çš„è§„åˆ™ï¼Œé€šä¿¡åŒæ–¹å°†æ— æ³•è¿›è¡Œæ­£ç¡®çš„ç¼–/è¯‘ç ä»è€Œå¯¼è‡´é€šä¿¡å¤±è´¥ã€‚</p><p><strong>å­—èŠ‚åºï¼Œé¡¾åæ€ä¹‰å­—èŠ‚çš„é¡ºåºï¼Œå°±æ˜¯å¤§äºä¸€ä¸ªå­—èŠ‚ç±»å‹çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜æ”¾é¡ºåºï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºå•å­—ç¬¦æ¥è¯´æ˜¯æ²¡æœ‰å­—èŠ‚åºé—®é¢˜çš„ï¼Œå­—ç¬¦ä¸²æ˜¯å•å­—ç¬¦çš„é›†åˆï¼Œå› æ­¤å­—ç¬¦ä¸²ä¹Ÿæ²¡æœ‰å­—èŠ‚åºé—®é¢˜ã€‚</strong></p><p>ç›®å‰åœ¨å„ç§ä½“ç³»çš„è®¡ç®—æœºä¸­é€šå¸¸é‡‡ç”¨çš„å­—èŠ‚å­˜å‚¨æœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ï¼š<strong>Big-Endian å’Œ Little-Endian</strong>ï¼Œä¸‹é¢å…ˆä»å­—èŠ‚åºè¯´èµ·ã€‚</p><ul><li><p><strong>Little-Endian -&gt; ä¸»æœºå­—èŠ‚åº (å°ç«¯)</strong></p></li><li></li><li><p>æ•°æ®çš„<strong>ä½</strong>ä½å­—èŠ‚å­˜å‚¨åˆ°å†…å­˜çš„<strong>ä½</strong>åœ°å€ä½ , æ•°æ®çš„<strong>é«˜</strong>ä½å­—èŠ‚å­˜å‚¨åˆ°å†…å­˜çš„<strong>é«˜</strong>åœ°å€ä½</p></li><li><p>æˆ‘ä»¬ä½¿ç”¨çš„ <strong>PC æœº</strong>ï¼Œæ•°æ®çš„å­˜å‚¨é»˜è®¤ä½¿ç”¨çš„æ˜¯<strong>å°ç«¯</strong></p></li><li><p><strong>Big-Endian -&gt; ç½‘ç»œå­—èŠ‚åº (å¤§ç«¯)</strong></p></li><li><p>æ®çš„<strong>ä½ä½å­—èŠ‚</strong>å­˜å‚¨åˆ°å†…å­˜çš„<strong>é«˜åœ°å€ä½</strong> , æ•°æ®çš„<strong>é«˜ä½å­—èŠ‚</strong>å­˜å‚¨åˆ°å†…å­˜çš„<strong>ä½åœ°å€ä½</strong></p></li><li><p>å¥—æ¥å­—<strong>é€šä¿¡</strong>è¿‡ç¨‹ä¸­æ“ä½œçš„æ•°æ®éƒ½æ˜¯<strong>å¤§ç«¯å­˜å‚¨</strong>çš„ï¼ŒåŒ…æ‹¬ï¼šæ¥æ”¶/å‘é€çš„æ•°æ®ã€IPåœ°å€ã€ç«¯å£ã€‚</p></li></ul><p>ä¸‹é¢ç»™ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/ æœ‰ä¸€ä¸ª<span class="number">16</span>è¿›åˆ¶çš„æ•°, æœ‰<span class="number">32</span>ä½ (<span class="type">int</span>): <span class="number">0xab5c01ff</span></span><br><span class="line"><span class="comment">// å­—èŠ‚åº, æœ€å°çš„å•ä½: char å­—èŠ‚, int æœ‰4ä¸ªå­—èŠ‚, éœ€è¦å°†å…¶æ‹†åˆ†ä¸º4ä»½</span></span><br><span class="line"><span class="comment">// ä¸€ä¸ªå­—èŠ‚ unsigned char, æœ€å¤§å€¼æ˜¯ 255(åè¿›åˆ¶) ==&gt; ff(16è¿›åˆ¶) </span></span><br><span class="line">                 å†…å­˜ä½åœ°å€ä½                å†…å­˜çš„é«˜åœ°å€ä½</span><br><span class="line">---------------------------------------------------------------------------&gt;</span><br><span class="line">å°ç«¯:         <span class="number">0xff</span>        <span class="number">0x01</span>        <span class="number">0x5c</span>        <span class="number">0xab</span></span><br><span class="line">å¤§ç«¯:         <span class="number">0xab</span>        <span class="number">0x5c</span>        <span class="number">0x01</span>        <span class="number">0xff</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å‡½æ•°:</strong></p><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>BSD Socket æä¾›äº†å°è£…å¥½çš„è½¬æ¢æ¥å£ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜ä½¿ç”¨ã€‚åŒ…æ‹¬ä»ä¸»æœºå­—èŠ‚åºåˆ°ç½‘ç»œå­—èŠ‚åºçš„è½¬æ¢å‡½æ•°ï¼šhtonsã€htonlï¼›ä»ç½‘ç»œå­—èŠ‚åºåˆ°ä¸»æœºå­—èŠ‚åºçš„è½¬æ¢å‡½æ•°ï¼šntohsã€ntohlã€‚</p></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="comment">// u:unsigned</span></span><br><span class="line"><span class="comment">// 16: 16ä½, 32:32ä½</span></span><br><span class="line"><span class="comment">// h: host, ä¸»æœºå­—èŠ‚åº</span></span><br><span class="line"><span class="comment">// n: net, ç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="comment">// s: short</span></span><br><span class="line"><span class="comment">// l: int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™å¥—apiä¸»è¦ç”¨äº ç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­ IP å’Œ ç«¯å£ çš„ è½¬æ¢</span></span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªçŸ­æ•´å½¢ä»ä¸»æœºå­—èŠ‚åº -&gt; ç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">htons</span><span class="params">(<span class="type">uint16_t</span> hostshort)</span>;</span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªæ•´å½¢ä»ä¸»æœºå­—èŠ‚åº -&gt; ç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">htonl</span><span class="params">(<span class="type">uint32_t</span> hostlong)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªçŸ­æ•´å½¢ä»ç½‘ç»œå­—èŠ‚åº -&gt; ä¸»æœºå­—èŠ‚åº</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">ntohs</span><span class="params">(<span class="type">uint16_t</span> netshort)</span></span><br><span class="line"><span class="comment">// å°†ä¸€ä¸ªæ•´å½¢ä»ç½‘ç»œå­—èŠ‚åº -&gt; ä¸»æœºå­—èŠ‚åº</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">ntohl</span><span class="params">(<span class="type">uint32_t</span> netlong)</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="IP-åœ°å€è½¬æ¢">IP åœ°å€è½¬æ¢</h3><p>è™½ç„¶ IP åœ°å€æœ¬è´¨æ˜¯ä¸€ä¸ªæ•´å½¢æ•°ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªå­—ç¬¦ä¸²æ¥æè¿°ï¼Œä¸‹é¢çš„å‡½æ•°æè¿°äº†å¦‚ä½•å°†ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„ IP åœ°å€è¿›è¡Œå¤§å°ç«¯è½¬æ¢ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸»æœºå­—èŠ‚åºçš„IPåœ°å€è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line"><span class="comment">// ä¸»æœºå­—èŠ‚åºçš„IPåœ°å€æ˜¯å­—ç¬¦ä¸², ç½‘ç»œå­—èŠ‚åºIPåœ°å€æ˜¯æ•´å½¢</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">inet_pton</span><span class="params">(<span class="type">int</span> af, <span class="type">const</span> <span class="type">char</span> *src, <span class="type">void</span> *dst)</span>; </span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li>af: åœ°å€æ— (IP åœ°å€çš„å®¶æ—åŒ…æ‹¬ ipv4 å’Œ ipv6) åè®®<ul><li>AF_INET: ipv4 æ ¼å¼çš„ ip åœ°å€</li><li>AF_INET6: ipv6 æ ¼å¼çš„ ip åœ°å€</li></ul></li><li>src: ä¼ å…¥å‚æ•°ï¼Œå¯¹åº”è¦è½¬æ¢çš„ç‚¹åˆ†åè¿›åˆ¶çš„ ip åœ°å€: 192.168.1.100</li><li>dst: ä¼ å‡ºå‚æ•°ï¼Œå‡½æ•°è°ƒç”¨å®Œæˆï¼Œè½¬æ¢å¾—åˆ°çš„å¤§ç«¯æ•´å½¢ IP è¢«å†™å…¥åˆ°è¿™å—å†…å­˜ä¸­</li><li>è¿”å›å€¼ï¼šæˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0 æˆ–è€… - 1</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="comment">// å°†å¤§ç«¯çš„æ•´å½¢æ•°, è½¬æ¢ä¸ºå°ç«¯çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€        </span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> *<span class="title function_">inet_ntop</span><span class="params">(<span class="type">int</span> af, <span class="type">const</span> <span class="type">void</span> *src, <span class="type">char</span> *dst, <span class="type">socklen_t</span> size)</span>;</span><br></pre></td></tr></table></figure><ul><li>af: åœ°å€æ— (IP åœ°å€çš„å®¶æ—åŒ…æ‹¬ ipv4 å’Œ ipv6) åè®®<ul><li>AF_INET: ipv4 æ ¼å¼çš„ ip åœ°å€</li><li>AF_INET6: ipv6 æ ¼å¼çš„ ip åœ°å€</li></ul></li><li>src: ä¼ å…¥å‚æ•°ï¼Œè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸­å­˜å‚¨äº†å¤§ç«¯çš„æ•´å½¢IPåœ°å€</li><li>dst: ä¼ å‡ºå‚æ•°ï¼Œå­˜å‚¨è½¬æ¢å¾—åˆ°çš„å°ç«¯çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€</li><li>size: ä¿®é¥°dstå‚æ•°çš„, æ ‡è®°dstæŒ‡å‘çš„å†…å­˜ä¸­æœ€å¤šå¯ä»¥å­˜å‚¨å¤šå°‘ä¸ªå­—èŠ‚</li><li>è¿”å›å€¼ï¼šæˆåŠŸè¿”å› 1ï¼Œå¤±è´¥è¿”å› 0 æˆ–è€… - 1<ul><li>æˆåŠŸ: æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸‰ä¸ªå‚æ•°å¯¹åº”çš„å†…å­˜åœ°å€, é€šè¿‡è¿”å›å€¼ä¹Ÿå¯ä»¥ç›´æ¥å–å‡ºè½¬æ¢å¾—åˆ°çš„IPå­—ç¬¦ä¸²</li><li>å¤±è´¥: NULL</li><li></li></ul></li></ul><p>è¿˜æœ‰ä¸€ç»„å‡½æ•°ä¹Ÿèƒ½è¿›ç¨‹ IP åœ°å€å¤§å°ç«¯çš„è½¬æ¢ï¼Œä½†æ˜¯åªèƒ½å¤„ç† ipv4 çš„ ip åœ°å€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç‚¹åˆ†åè¿›åˆ¶IP -&gt; å¤§ç«¯æ•´å½¢</span></span><br><span class="line"><span class="type">in_addr_t</span> <span class="title function_">inet_addr</span> <span class="params">(<span class="type">const</span> <span class="type">char</span> *cp)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤§ç«¯æ•´å½¢ -&gt; ç‚¹åˆ†åè¿›åˆ¶IP</span></span><br><span class="line"><span class="type">char</span>* <span class="title function_">inet_ntoa</span><span class="params">(<span class="keyword">struct</span> in_addr in)</span>;</span><br></pre></td></tr></table></figure><h3 id="sockaddræ•°æ®ç»“æ„">sockaddræ•°æ®ç»“æ„</h3><p><img src="https://subingwen.cn/linux/socket/sockaddr.png" alt="img"></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å†™æ•°æ®çš„æ—¶å€™ä¸å¥½ç”¨</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr</span> &#123;</span></span><br><span class="line"><span class="type">sa_family_t</span> sa_family;       <span class="comment">// åœ°å€æ—åè®®, ipv4</span></span><br><span class="line"><span class="type">char</span>        sa_data[<span class="number">14</span>];     <span class="comment">// ç«¯å£(2å­—èŠ‚) + IPåœ°å€(4å­—èŠ‚) + å¡«å……(8å­—èŠ‚)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span>  <span class="type">uint16_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>    <span class="type">uint32_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">uint16_t</span> <span class="type">in_port_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">uint32_t</span> <span class="type">in_addr_t</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> <span class="type">sa_family_t</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __SOCKADDR_COMMON_SIZE (sizeof (unsigned short int))</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">in_addr_t</span> s_addr;</span><br><span class="line">&#125;;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// sizeof(struct sockaddr) == sizeof(struct sockaddr_in)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">sa_family_t</span> sin_family;<span class="comment">/* åœ°å€æ—åè®®: AF_INET */</span></span><br><span class="line">    <span class="type">in_port_t</span> sin_port;         <span class="comment">/* ç«¯å£, 2å­—èŠ‚-&gt; å¤§ç«¯  */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">in_addr</span> <span class="title">sin_addr</span>;</span>    <span class="comment">/* IPåœ°å€, 4å­—èŠ‚ -&gt; å¤§ç«¯  */</span></span><br><span class="line">    <span class="comment">/* å¡«å…… 8å­—èŠ‚ */</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> sin_zero[<span class="keyword">sizeof</span> (<span class="keyword">struct</span> sockaddr) - <span class="keyword">sizeof</span>(sin_family) -</span><br><span class="line">               <span class="keyword">sizeof</span> (<span class="type">in_port_t</span>) - <span class="keyword">sizeof</span> (<span class="keyword">struct</span> in_addr)];</span><br><span class="line">&#125;;  </span><br><span class="line"></span><br><span class="line">é€šå¸¸ç”¨</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">clientaddr</span>&#123;</span></span><br><span class="line">    <span class="type">int</span> client_fd;<span class="comment">//é€šä¿¡å¥—æ¥å­—</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">client_addr</span>//å‚¨å­˜ä»<span class="title">accept</span>åé¦ˆæ¥çš„å®¢æˆ·ç«¯<span class="title">ip</span>ä¿¡æ¯  </span></span><br><span class="line"><span class="class">&#125;//è¯¥ç»“æ„ä½“é€šå¸¸ç”¨äºæ¯ä¸ªå­çº¿ç¨‹</span></span><br></pre></td></tr></table></figure><h3 id="å¥—æ¥å­—å‡½æ•°">å¥—æ¥å­—å‡½æ•°</h3><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>ä½¿ç”¨å¥—æ¥å­—é€šä¿¡å‡½æ•°éœ€è¦åŒ…å«å¤´æ–‡ä»¶ <strong>&lt;arpa/inet.h&gt;ï¼ˆLinuxä¸‹ï¼‰ï¼Œå¦‚æœåŒ…å«äº†è¿™ä¸ªå¤´æ–‡ä»¶, &lt;sys/socket.h&gt;</strong> å°±ä¸ç”¨åœ¨åŒ…å«äº†ã€‚</p></div><p><strong>1.ç›‘å¬å¥—æ¥å­—ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">socket</span><span class="params">(<span class="type">int</span> domain, <span class="type">int</span> type, <span class="type">int</span> protocol)</span>;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li>domain: ä½¿ç”¨çš„åœ°å€æ—åè®®<ul><li>AF_INET: ä½¿ç”¨ IPv4 æ ¼å¼çš„ ip åœ°å€</li><li>AF_INET6: ä½¿ç”¨ IPv4 æ ¼å¼çš„ ip åœ°å€</li></ul></li><li>type:<ul><li>SOCK_STREAM: ä½¿ç”¨æµå¼çš„ä¼ è¾“åè®®</li><li>SOCK_DGRAM: ä½¿ç”¨æŠ¥å¼ (æŠ¥æ–‡) çš„ä¼ è¾“åè®®</li></ul></li><li>protocol: ä¸€èˆ¬å†™ 0 å³å¯ï¼Œä½¿ç”¨é»˜è®¤çš„åè®®<ul><li>SOCK_STREAM: æµå¼ä¼ è¾“é»˜è®¤ä½¿ç”¨çš„æ˜¯ tcp</li><li>SOCK_DGRAM: æŠ¥å¼ä¼ è¾“é»˜è®¤ä½¿ç”¨çš„ udpã€</li><li>SOCK_RAW: åŸå§‹å¥—æ¥å­—</li></ul></li><li>è¿”å›å€¼:<br>æˆåŠŸï¼šå¯ç”¨äºå¥—æ¥å­—é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦<br>å¤±è´¥: -1</li></ul><p>å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦å¯ä»¥æ“ä½œå†…æ ¸ä¸­çš„æŸä¸€å—å†…å­˜ï¼Œç½‘ç»œé€šä¿¡æ˜¯åŸºäºè¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ¥å®Œæˆçš„ã€‚</p><p><strong>2.ç»‘å®šIPå’Œç«¯å£</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†æ–‡ä»¶æè¿°ç¬¦å’Œæœ¬åœ°çš„IPä¸ç«¯å£è¿›è¡Œç»‘å®š   </span></span><br><span class="line"><span class="type">int</span> <span class="title function_">bind</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> addrlen)</span>;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li>sockfd: ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡ socket () è°ƒç”¨å¾—åˆ°çš„è¿”å›å€¼</li><li>addr: ä¼ å…¥å‚æ•°ï¼Œè¦ç»‘å®šçš„ IP å’Œç«¯å£ä¿¡æ¯éœ€è¦åˆå§‹åŒ–åˆ°è¿™ä¸ªç»“æ„ä½“ä¸­ï¼ŒIPå’Œç«¯å£è¦è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åº</li><li>addrlen: å‚æ•° addr æŒ‡å‘çš„å†…å­˜å¤§å°ï¼Œsizeof (struct sockaddr)<br>è¿”å›å€¼ï¼šæˆåŠŸè¿”å› 0ï¼Œå¤±è´¥è¿”å› - 1</li></ul><p><strong>3.è®¾ç½®ç›‘å¬</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»™ç›‘å¬çš„å¥—æ¥å­—è®¾ç½®ç›‘å¬</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">listen</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">int</span> backlog)</span>;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li>sockfd: æ–‡ä»¶æè¿°ç¬¦ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ socket () å¾—åˆ°ï¼Œåœ¨ç›‘å¬ä¹‹å‰å¿…é¡»è¦ç»‘å®š bind ()</li><li>backlog: åŒæ—¶èƒ½å¤„ç†çš„æœ€å¤§è¿æ¥è¦æ±‚ï¼Œæœ€å¤§å€¼ä¸º 128</li><li>è¿”å›å€¼ï¼šå‡½æ•°è°ƒç”¨æˆåŠŸè¿”å› 0ï¼Œè°ƒç”¨å¤±è´¥è¿”å› -1</li></ul><p><strong>4.é€šä¿¡å¥—æ¥å­—</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç­‰å¾…å¹¶æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚, å»ºç«‹æ–°çš„è¿æ¥, ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦(é€šä¿¡çš„)</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">accept</span><span class="params">(<span class="type">int</span> sockfd, <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> *addrlen)</span>;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li>sockfd: ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦</li><li>addr: ä¼ å‡ºå‚æ•°ï¼Œé‡Œè¾¹å­˜å‚¨äº†å»ºç«‹è¿æ¥çš„å®¢æˆ·ç«¯çš„åœ°å€ä¿¡æ¯</li><li>addrlen: ä¼ å…¥ä¼ å‡ºå‚æ•°ï¼Œç”¨äºå­˜å‚¨ addr æŒ‡å‘çš„å†…å­˜å¤§å°<br>è¿”å›å€¼ï¼šå‡½æ•°è°ƒç”¨æˆåŠŸï¼Œå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œç”¨äºå’Œå»ºç«‹è¿æ¥çš„è¿™ä¸ªå®¢æˆ·ç«¯é€šä¿¡ï¼Œè°ƒç”¨å¤±è´¥è¿”å› -1</li></ul><p><strong>ä¸»:å½“å®¢æˆ·ç«¯ä¿¡æ¯(IP,ç«¯å£)ä¸è¢«è¦æ±‚çŸ¥æ™“æ—¶ï¼Œé€šå¸¸åä¸¤ä¸ªå‚æ•°ä¸ºnullptr</strong></p><p><strong>acceptå‡½æ•°æ˜¯ä¸€ä¸ªé˜»å¡å‡½æ•°ï¼Œå½“æ²¡æœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚çš„æ—¶å€™ï¼Œè¯¥å‡½æ•°é˜»å¡ï¼›å½“æ£€æµ‹åˆ°æœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚æ—¶ï¼Œé˜»å¡è§£é™¤ï¼Œæ–°è¿æ¥å°±å»ºç«‹äº†ï¼Œå¾—åˆ°çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ŒåŸºäºè¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦å°±å¯ä»¥å’Œå®¢æˆ·ç«¯é€šä¿¡äº†ã€‚</strong></p><p><strong>5.æ•°æ®æ¥å—å’Œä¼ é€’å‡½æ•°(éœ€è¦åŒ…å«å¤´æ–‡ä»¶unistd.h)ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥æ”¶æ•°æ®(ä¸¤ä¸ªä¸ºä¸€ç»„)</span></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">read</span><span class="params">(<span class="type">int</span> sock_fd, <span class="type">void</span> *buf, <span class="type">size_t</span> size)</span>;<span class="comment">//æ²¡æœ‰æ”¶åˆ°æ•°æ®ä¼šé˜»å¡ï¼Œç›´åˆ°æ”¶åˆ°æ•°æ®</span></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> sock_fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> len)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">recv</span><span class="params">(<span class="type">int</span> sock_fd, <span class="type">void</span> *buf, <span class="type">size_t</span> size, <span class="type">int</span> flags)</span>;</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">send</span><span class="params">(<span class="type">int</span> sock_fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> len, <span class="type">int</span> flags)</span>;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li><p>sockfd: ç”¨äºé€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œaccept () å‡½æ•°çš„è¿”å›å€¼</p></li><li><p>buf: æŒ‡å‘ä¸€å—æœ‰æ•ˆå†…å­˜ï¼Œç”¨äºå­˜å‚¨æ¥æ”¶æ˜¯æ•°æ®</p></li><li><p>size: å‚æ•° buf æŒ‡å‘çš„å†…å­˜çš„å®¹é‡</p></li><li><p>flags: ç‰¹æ®Šçš„å±æ€§ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ï¼ŒæŒ‡å®šä¸º 0</p></li><li><p>è¿”å›å€¼:<br>å¤§äº 0ï¼šå®é™…æ¥æ”¶çš„å­—èŠ‚æ•°<br>ç­‰äº 0ï¼šå®¢æˆ·ç«¯/æœåŠ¡ç«¯æ–­å¼€äº†è¿æ¥<br>-1ï¼šæ¥æ”¶æ•°æ®å¤±è´¥äº†</p></li><li><p>å¦‚æœè¿æ¥æ²¡æœ‰æ–­å¼€ï¼Œæ¥æ”¶ç«¯æ¥æ”¶ä¸åˆ°æ•°æ®ï¼Œæ¥æ”¶æ•°æ®çš„å‡½æ•°ä¼šé˜»å¡ç­‰å¾…æ•°æ®åˆ°è¾¾ï¼Œæ•°æ®åˆ°è¾¾åå‡½æ•°è§£é™¤é˜»å¡ï¼Œå¼€å§‹æ¥æ”¶æ•°æ®ï¼Œå½“å‘é€ç«¯æ–­å¼€è¿æ¥ï¼Œæ¥æ”¶ç«¯æ— æ³•æ¥æ”¶åˆ°ä»»ä½•æ•°æ®ï¼Œä½†æ˜¯è¿™æ—¶å€™å°±ä¸ä¼šé˜»å¡äº†ï¼Œå‡½æ•°ç›´æ¥è¿”å›0ã€‚</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æˆåŠŸè¿æ¥æœåŠ¡å™¨ä¹‹å, å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨éšæœºç»‘å®šä¸€ä¸ªç«¯å£</span></span><br><span class="line"><span class="comment">// æœåŠ¡å™¨ç«¯è°ƒç”¨accept()çš„å‡½æ•°, ç¬¬äºŒä¸ªå‚æ•°å­˜å‚¨çš„å°±æ˜¯å®¢æˆ·ç«¯çš„IPå’Œç«¯å£ä¿¡æ¯</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">connect</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> addrlen)</span>;</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°:</strong></p><ul><li>sockfd: é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡è°ƒç”¨ socket () å‡½æ•°å°±å¾—åˆ°äº†</li><li>addr: å­˜å‚¨äº†è¦è¿æ¥çš„æœåŠ¡å™¨ç«¯çš„åœ°å€ä¿¡æ¯: iP å’Œ ç«¯å£ï¼Œè¿™ä¸ª IP å’Œç«¯å£ä¹Ÿéœ€è¦è½¬æ¢ä¸ºå¤§ç«¯ç„¶åå†èµ‹å€¼</li><li>addrlen: addr æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜çš„å¤§å° sizeof (struct sockaddr)</li><li>è¿”å›å€¼ï¼šè¿æ¥æˆåŠŸè¿”å› 0ï¼Œè¿æ¥å¤±è´¥è¿”å› - 1</li></ul><h3 id="ç«¯å£å¤ç”¨ï¼ˆsetsockoptï¼‰">ç«¯å£å¤ç”¨ï¼ˆsetsockoptï¼‰</h3><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><strong>ç«¯å£å¤ç”¨æœ€å¸¸ç”¨çš„ç”¨é€”åº”è¯¥æ˜¯é˜²æ­¢æœåŠ¡å™¨é‡å¯æ—¶ä¹‹å‰ç»‘å®šçš„ç«¯å£è¿˜æœªé‡Šæ”¾æˆ–è€…ç¨‹åºçªç„¶é€€å‡ºè€Œç³»ç»Ÿæ²¡æœ‰é‡Šæ”¾ç«¯å£ã€‚è¿™ç§æƒ…å†µä¸‹å¦‚æœè®¾å®šäº†ç«¯å£å¤ç”¨ï¼Œåˆ™æ–°å¯åŠ¨çš„æœåŠ¡å™¨è¿›ç¨‹å¯ä»¥ç›´æ¥ç»‘å®šç«¯å£ã€‚å¦‚æœæ²¡æœ‰è®¾å®šç«¯å£å¤ç”¨ï¼Œç»‘å®šä¼šå¤±è´¥ï¼Œæç¤ºADDRå·²ç»åœ¨ä½¿ç”¨ä¸­â€”â€”é‚£åªå¥½ç­‰ç­‰å†é‡è¯•äº†ï¼Œéº»çƒ¦ï¼</strong></p></div><ul><li><strong>èµ·å› </strong>: ç”±socketçŠ¶æ€è½¬æ¢å›¾å¯çŸ¥, ä¸»åŠ¨å…³é—­è¿æ¥çš„ä¸€ç«¯éƒ½ä¼šæœ‰ä¸€ä¸ªTIME_WAIT, æ—¶é—´ä¸º2msl, ä»¥ç¡®ä¿å¯¹ç«¯æ”¶åˆ°æœ€åä¸€ä¸ªACK</li><li><strong>å½±å“</strong>: å¦‚æœæ˜¯æœåŠ¡å™¨ç«¯éœ€è¦ä¸»åŠ¨æ–­å¼€è¿æ¥(ä¾‹å¦‚ç½‘ç«™æ›´æ–°ç­‰), é‚£ä¹ˆå†æ¬¡é‡å¯åˆ™éœ€è¦æµªè´¹2mslæ—¶é—´, ä¸ºäº†å‡å°‘è¿™ç§æ—¶é—´å¼€é”€, å› æ­¤æœ‰äº†<a href="https://so.csdn.net/so/search?q=%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8&amp;spm=1001.2101.3001.7020">ç«¯å£å¤ç”¨</a></li><li><strong>ä½œç”¨</strong>: å¯ä»¥ç«‹é©¬é‡å¯æœåŠ¡å™¨, è€Œä¸å¿…ç­‰å¾…2msl, ä¸”ä¸ä¼šåœ¨bindçš„æ—¶å€™å‘ç”Ÿç«¯å£è¢«å ç”¨çš„é”™è¯¯.</li></ul><p>â€‹       <strong>å‡½æ•°åŸå‹+å®ä¾‹ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setsockopt</span><span class="params">(<span class="type">int</span> sockFd, <span class="type">int</span> level, <span class="type">int</span> optname, <span class="type">const</span> <span class="type">void</span> *optval, <span class="type">socklen_t</span> optlen)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> opt;</span><br><span class="line"><span class="keyword">if</span> (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, (<span class="type">const</span> <span class="type">void</span> *) &amp;opt, <span class="keyword">sizeof</span>(opt))) &#123;</span><br><span class="line">    perror(<span class="string">&quot;setsockopt&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;<span class="comment">//è®¾ç½®ç«¯å£å¤ç”¨</span></span><br><span class="line"><span class="comment">/*  Returns 0 on success, -1 for errors. */</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- æ³¨æ„ï¼šåœ¨æ‰€æœ‰TCPæœåŠ¡å™¨ä¸­ï¼Œåœ¨è°ƒç”¨bindä¹‹å‰è®¾ç½®ç«¯å£å¤ç”¨</span><br></pre></td></tr></table></figure><h2 id="TCPé€šä¿¡æµç¨‹">TCPé€šä¿¡æµç¨‹</h2><p>TCP æ˜¯ä¸€ä¸ªé¢å‘è¿æ¥çš„ï¼Œå®‰å…¨çš„ï¼Œæµå¼ä¼ è¾“åè®®ï¼Œè¿™ä¸ªåè®®æ˜¯ä¸€ä¸ªä¼ è¾“å±‚åè®®ã€‚</p><ul><li>é¢å‘è¿æ¥ï¼šæ˜¯ä¸€ä¸ªåŒå‘è¿æ¥ï¼Œé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å®Œæˆï¼Œæ–­å¼€è¿æ¥éœ€è¦é€šè¿‡å››æ¬¡æŒ¥æ‰‹å®Œæˆã€‚</li><li>å®‰å…¨ï¼štcp é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä¼šå¯¹å‘é€çš„æ¯ä¸€æ•°æ®åŒ…éƒ½ä¼šè¿›è¡Œæ ¡éªŒï¼Œå¦‚æœå‘ç°æ•°æ®ä¸¢å¤±ï¼Œä¼šè‡ªåŠ¨é‡ä¼ </li><li>æµå¼ä¼ è¾“ï¼šå‘é€ç«¯å’Œæ¥æ”¶ç«¯å¤„ç†æ•°æ®çš„é€Ÿåº¦ï¼Œæ•°æ®çš„é‡éƒ½å¯ä»¥ä¸ä¸€è‡´</li></ul><p><img src="https://subingwen.cn/linux/socket/tcp.jpg" alt="img"></p><h3 id="æœåŠ¡å™¨ç«¯é€šä¿¡æµç¨‹ï¼š">æœåŠ¡å™¨ç«¯é€šä¿¡æµç¨‹ï¼š</h3><ul><li>1.åˆ›å»ºç”¨äºç›‘å¬çš„å¥—æ¥å­—ï¼Œè¿™ä¸ªå¥—æ¥å­—æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> lfd = socket();</span><br></pre></td></tr></table></figure><ul><li>2.å°†å¾—åˆ°çš„ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦å’Œæœ¬åœ°çš„ IP ç«¯å£è¿›è¡Œç»‘å®š</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bind();</span><br></pre></td></tr></table></figure><ul><li>3.è®¾ç½®ç›‘å¬ (æˆåŠŸä¹‹åå¼€å§‹ç›‘å¬ï¼Œç›‘å¬çš„æ˜¯å®¢æˆ·ç«¯çš„è¿æ¥)</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">listen();</span><br></pre></td></tr></table></figure><ul><li>4.ç­‰å¾…å¹¶æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œå»ºç«‹æ–°çš„è¿æ¥ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ (é€šä¿¡çš„)ï¼Œ<strong>æ²¡æœ‰æ–°è¿æ¥è¯·æ±‚å°±é˜»å¡</strong></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> cfd = accept();</span><br></pre></td></tr></table></figure><ul><li>5.é€šä¿¡ï¼Œè¯»å†™æ“ä½œé»˜è®¤éƒ½æ˜¯é˜»å¡çš„</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥æ”¶æ•°æ®</span></span><br><span class="line">read(); / recv();</span><br><span class="line"><span class="comment">// å‘é€æ•°æ®</span></span><br><span class="line">write(); / send();</span><br></pre></td></tr></table></figure><ul><li>6.æ–­å¼€è¿æ¥ï¼Œå…³é—­å¥—æ¥å­—(close()å‡½æ•°éœ€è¦åŒ…å«unistd.hå¤´æ–‡ä»¶)</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">close();</span><br></pre></td></tr></table></figure><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><strong>åœ¨ tcp çš„æœåŠ¡å™¨ç«¯ï¼Œæœ‰ä¸¤ç±»æ–‡ä»¶æè¿°ç¬¦</strong></p><ul><li><strong>ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦</strong><ul><li><strong>åªéœ€è¦æœ‰ä¸€ä¸ª</strong></li><li><strong>ä¸è´Ÿè´£å’Œå®¢æˆ·ç«¯é€šä¿¡ï¼Œè´Ÿè´£æ£€æµ‹å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œæ£€æµ‹åˆ°ä¹‹åè°ƒç”¨ accept å°±å¯ä»¥å»ºç«‹æ–°çš„è¿æ¥</strong></li></ul></li><li><strong>é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦</strong><ul><li><strong>è´Ÿè´£å’Œå»ºç«‹è¿æ¥çš„å®¢æˆ·ç«¯é€šä¿¡</strong></li><li><strong>å¦‚æœæœ‰ N ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å»ºç«‹äº†æ–°çš„è¿æ¥ï¼Œé€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦å°±æœ‰ N ä¸ªï¼Œæ¯ä¸ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½å¯¹åº”ä¸€ä¸ªé€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦</strong></li></ul></li></ul></div><ul><li><p><strong>æ–‡ä»¶æè¿°ç¬¦å¯¹åº”çš„å†…å­˜ç»“æ„ï¼š</strong></p><ul><li><p>ä¸ªæ–‡ä»¶æ–‡ä»¶æè¿°ç¬¦å¯¹åº”ä¸¤å—å†…å­˜, ä¸€å—å†…å­˜æ˜¯è¯»ç¼“å†²åŒº, ä¸€å—å†…å­˜æ˜¯å†™ç¼“å†²åŒº</p></li><li><p>è¯»æ•°æ®: é€šè¿‡æ–‡ä»¶æè¿°ç¬¦å°†å†…å­˜ä¸­çš„æ•°æ®è¯»å‡º, è¿™å—å†…å­˜ç§°ä¹‹ä¸ºè¯»ç¼“å†²åŒº</p></li><li><p>å†™æ•°æ®: é€šè¿‡æ–‡ä»¶æè¿°ç¬¦å°†æ•°æ®å†™å…¥åˆ°æŸå—å†…å­˜ä¸­, è¿™å—å†…å­˜ç§°ä¹‹ä¸ºå†™ç¼“å†²åŒº</p></li></ul></li><li><p><strong>ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦(socket_fd):</strong></p><ul><li><p>å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ä¼šå‘é€åˆ°æœåŠ¡å™¨ç«¯ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦çš„è¯»ç¼“å†²åŒºä¸­<br>â€‹</p></li><li><p>è¯»ç¼“å†²åŒºä¸­æœ‰æ•°æ®ï¼Œè¯´æ˜æœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥<br>â€‹</p></li><li><p>è°ƒç”¨ accept () å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæ£€æµ‹ç›‘å¬æ–‡ä»¶æè¿°ç¬¦çš„è¯»ç¼“å†²åŒº<br>â€‹</p></li><li><p>æ£€æµ‹ä¸åˆ°æ•°æ®ï¼Œè¯¥å‡½æ•°é˜»å¡<br>â€‹</p></li><li><p>å¦‚æœæ£€æµ‹åˆ°æ•°æ®ï¼Œè§£é™¤é˜»å¡ï¼Œæ–°çš„è¿æ¥å»ºç«‹</p></li></ul></li><li><p><strong>é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦(correspondence_fdï¼‰:</strong></p></li><li><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½æœ‰<strong>é€šä¿¡</strong>çš„æ–‡ä»¶æè¿°ç¬¦</p></li><li><p>å‘é€æ•°æ®ï¼šè°ƒç”¨å‡½æ•° write () /send ()ï¼Œæ•°æ®è¿›å…¥åˆ°å†…æ ¸ä¸­</p><ul><li><p>æ•°æ®å¹¶æ²¡æœ‰è¢«å‘é€å‡ºå»ï¼Œè€Œæ˜¯å°†æ•°æ®å†™å…¥åˆ°äº†é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦å¯¹åº”çš„å†™ç¼“å†²åŒºä¸­</p></li><li><p>å†…æ ¸æ£€æµ‹åˆ°é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦å†™ç¼“å†²åŒºä¸­æœ‰æ•°æ®ï¼Œå†…æ ¸ä¼šå°†æ•°æ®å‘é€åˆ°ç½‘ç»œä¸­<br>â€‹</p></li></ul></li><li><p>æ¥æ”¶æ•°æ®ï¼šè°ƒç”¨çš„å‡½æ•° read () /recv (), ä»å†…æ ¸è¯»æ•°æ®</p><ul><li><p>æ•°æ®å¦‚ä½•è¿›å…¥åˆ°å†…æ ¸ç¨‹åºçŒ¿ä¸éœ€è¦å¤„ç†ï¼Œæ•°æ®è¿›å…¥åˆ°é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦çš„è¯»ç¼“å†²åŒºä¸­</p></li><li><p>æ•°æ®è¿›å…¥åˆ°å†…æ ¸ï¼Œå¿…é¡»ä½¿ç”¨é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå°†æ•°æ®ä»è¯»ç¼“å†²åŒºä¸­è¯»å‡ºå³å¯</p></li></ul></li></ul><p><strong>å®¢æˆ·ç«¯çš„é€šä¿¡æµç¨‹ï¼š</strong></p><ul><li>1.åˆ›å»ºä¸€ä¸ªé€šä¿¡çš„å¥—æ¥å­—</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> cfd = socket();</span><br></pre></td></tr></table></figure><ul><li>2.è¿æ¥æœåŠ¡å™¨ï¼Œéœ€è¦çŸ¥é“æœåŠ¡å™¨ç»‘å®šçš„ IP å’Œç«¯å£</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">connect</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure><ul><li>3.é€šä¿¡</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥æ”¶æ•°æ®</span></span><br><span class="line">read(); / recv();</span><br><span class="line"><span class="comment">// å‘é€æ•°æ®</span></span><br><span class="line">write(); / send();</span><br></pre></td></tr></table></figure><ul><li>4.æ–­å¼€è¿æ¥ï¼Œå…³é—­æ–‡ä»¶æè¿°ç¬¦ (å¥—æ¥å­—)</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">close();</span><br></pre></td></tr></table></figure><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>åŸºäºtcpçš„æœåŠ¡å™¨ç«¯é€šä¿¡ä»£ç :</p></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºç›‘å¬çš„å¥—æ¥å­—</span></span><br><span class="line">    <span class="type">int</span> lfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(lfd == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;socket&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å°†socket()è¿”å›å€¼å’Œæœ¬åœ°çš„IPç«¯å£ç»‘å®šåˆ°ä¸€èµ·</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr</span>;</span></span><br><span class="line">    addr.sin_family = AF_INET;</span><br><span class="line">    addr.sin_port = htons(<span class="number">10000</span>);   <span class="comment">// å¤§ç«¯ç«¯å£</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// INADDR_ANYä»£è¡¨æœ¬æœºçš„æ‰€æœ‰IP, å‡è®¾æœ‰ä¸‰ä¸ªç½‘å¡å°±æœ‰ä¸‰ä¸ªIPåœ°å€</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªå®å¯ä»¥ä»£è¡¨ä»»æ„ä¸€ä¸ªIPåœ°å€</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªå®ä¸€èˆ¬ç”¨äºæœ¬åœ°çš„ç»‘å®šæ“ä½œ</span></span><br><span class="line">    addr.sin_addr.s_addr = INADDR_ANY;  <span class="comment">// è¿™ä¸ªå®çš„å€¼ä¸º0 == 0.0.0.0</span></span><br><span class="line"><span class="comment">//    inet_pton(AF_INET, &quot;192.168.237.131&quot;, &amp;addr.sin_addr.s_addr);</span></span><br><span class="line">    <span class="type">int</span> ret = bind(lfd, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    <span class="keyword">if</span>(ret == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;bind&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è®¾ç½®ç›‘å¬</span></span><br><span class="line">    ret = listen(lfd, <span class="number">128</span>);</span><br><span class="line">    <span class="keyword">if</span>(ret == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;listen&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. é˜»å¡ç­‰å¾…å¹¶æ¥å—å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">cliaddr</span>;</span></span><br><span class="line">    <span class="type">int</span> clilen = <span class="keyword">sizeof</span>(cliaddr);</span><br><span class="line">    <span class="type">int</span> cfd = accept(lfd, (<span class="keyword">struct</span> sockaddr*)&amp;cliaddr, &amp;clilen);</span><br><span class="line">    <span class="keyword">if</span>(cfd == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;accept&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰“å°å®¢æˆ·ç«¯çš„åœ°å€ä¿¡æ¯</span></span><br><span class="line">    <span class="type">char</span> ip[<span class="number">24</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å®¢æˆ·ç«¯çš„IPåœ°å€: %s, ç«¯å£: %d\n&quot;</span>,</span><br><span class="line">           inet_ntop(AF_INET, &amp;cliaddr.sin_addr.s_addr, ip, <span class="keyword">sizeof</span>(ip)),</span><br><span class="line">           ntohs(cliaddr.sin_port));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. å’Œå®¢æˆ·ç«¯é€šä¿¡</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ¥æ”¶æ•°æ®</span></span><br><span class="line">        <span class="type">char</span> buf[<span class="number">1024</span>];</span><br><span class="line">        <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="type">int</span> len = read(cfd, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="keyword">if</span>(len &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;å®¢æˆ·ç«¯say: %s\n&quot;</span>, buf);</span><br><span class="line">            write(cfd, buf, len);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(len  == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;å®¢æˆ·ç«¯æ–­å¼€äº†è¿æ¥...\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            perror(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    close(cfd);</span><br><span class="line">    close(lfd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®¢æˆ·ç«¯çš„é€šä¿¡æµç¨‹">å®¢æˆ·ç«¯çš„é€šä¿¡æµç¨‹</h3><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>åœ¨å•çº¿ç¨‹çš„æƒ…å†µä¸‹å®¢æˆ·ç«¯é€šä¿¡çš„æ–‡ä»¶æè¿°ç¬¦æœ‰ä¸€ä¸ª, æ²¡æœ‰ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦</p></div><ol><li>åˆ›å»ºä¸€ä¸ªé€šä¿¡çš„å¥—æ¥å­—</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> cfd = socket();</span><br></pre></td></tr></table></figure><ol start="2"><li>è¿æ¥æœåŠ¡å™¨, éœ€è¦çŸ¥é“æœåŠ¡å™¨ç»‘å®šçš„IPå’Œç«¯å£</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connect();</span><br></pre></td></tr></table></figure><ol start="3"><li>é€šä¿¡</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥æ”¶æ•°æ®</span></span><br><span class="line">read(); / recv();</span><br><span class="line"><span class="comment">// å‘é€æ•°æ®</span></span><br><span class="line">write(); / send();</span><br></pre></td></tr></table></figure><ol start="4"><li>æ–­å¼€è¿æ¥, å…³é—­æ–‡ä»¶æè¿°ç¬¦(å¥—æ¥å­—)</li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">close();</span><br></pre></td></tr></table></figure><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>åœ¨åŸºäºtcpé€šä¿¡çš„å®¢æˆ·ç«¯é€šä¿¡ä»£ç :</p></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// client.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºé€šä¿¡çš„å¥—æ¥å­—</span></span><br><span class="line">    <span class="type">int</span> fd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(fd == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;socket&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. è¿æ¥æœåŠ¡å™¨</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">addr</span>;</span></span><br><span class="line">    addr.sin_family = AF_INET;</span><br><span class="line">    addr.sin_port = htons(<span class="number">10000</span>);   <span class="comment">// å¤§ç«¯ç«¯å£</span></span><br><span class="line">    inet_pton(AF_INET, <span class="string">&quot;192.168.237.131&quot;</span>, &amp;addr.sin_addr.s_addr);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ret = connect(fd, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="keyword">sizeof</span>(addr));</span><br><span class="line">    <span class="keyword">if</span>(ret == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;connect&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. å’ŒæœåŠ¡å™¨ç«¯é€šä¿¡</span></span><br><span class="line">    <span class="type">int</span> number = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å‘é€æ•°æ®</span></span><br><span class="line">        <span class="type">char</span> buf[<span class="number">1024</span>];</span><br><span class="line">        <span class="built_in">sprintf</span>(buf, <span class="string">&quot;ä½ å¥½, æœåŠ¡å™¨...%d\n&quot;</span>, number++);</span><br><span class="line">        write(fd, buf, <span class="built_in">strlen</span>(buf)+<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ¥æ”¶æ•°æ®</span></span><br><span class="line">        <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="type">int</span> len = read(fd, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="keyword">if</span>(len &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æœåŠ¡å™¨say: %s\n&quot;</span>, buf);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(len  == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æœåŠ¡å™¨æ–­å¼€äº†è¿æ¥...\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            perror(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sleep(<span class="number">1</span>);   <span class="comment">// æ¯éš”1så‘é€ä¸€æ¡æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>2.ä¸€ä¸ªç®€å•çš„é”®å€¼æ•°æ®åº“ï¼š</h1><h2 id="ä¹ é¢˜å’Œæºç ">ä¹ é¢˜å’Œæºç </h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">é¢˜ç›®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">main.cpp</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ClassTcp.h</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">ClassTcp.cpp</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -5">ClassMessage.h</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -6">ClassMessage.cpp</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">ASYNC CPP GROUP FINAL <span class="title function_">PROJECT</span><span class="params">(<span class="number">2022</span>)</span>:Simple Key</span><br><span class="line">Value Database</span><br><span class="line">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œä½ ä»¬è¦å®ç°ä¸€ä¸ªç®€å•çš„é”®å€¼æ•°æ®åº“ã€‚</span><br><span class="line">æ¶æ„å¦‚å›¾æ‰€ç¤ºï¼š</span><br><span class="line">è¦æ±‚</span><br><span class="line">ä½ ä»¬è¦ç¼–å†™databaseæœåŠ¡ç«¯ï¼Œä»æ–‡ä»¶ä¸­è¯»å–å’Œå†™å…¥æ•°æ®ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæ€»æ•°æ®é‡ä¸ä¼šå¤§äºå†…å­˜å®¹é‡ã€‚</span><br><span class="line">ä½ ä»¬éœ€è¦å®ç°ä»¥ä¸‹æ“ä½œï¼š</span><br><span class="line"><span class="title function_">Put</span><span class="params">(Key,Value)</span> - å°†key valueä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚</span><br><span class="line"><span class="title function_">Delete</span><span class="params">(Key)</span> - å°†æŒ‡å®škeyåˆ é™¤ã€‚</span><br><span class="line"><span class="title function_">Get</span><span class="params">(Key)</span> - è¿”å›æŒ‡å®šKeyçš„valueã€‚</span><br><span class="line">ä½ ä»¬åªéœ€è¦ç¼–å†™æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬ä¼šç”¨ç¼–å†™å¥½çš„Clientæµ‹è¯•ä½ çš„ç¨‹åºï¼Œæ‰€ä»¥è¯·æ³¨æ„ä½ ä»¬å¿…é¡»æŒ‰ç…§æŒ‡å®šåè®®æ¥ä¸Clien</span><br><span class="line">é€šä¿¡ã€‚</span><br><span class="line">æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªè¿æ¥å‘ä½ çš„datbaseå‘é€è¯·æ±‚ï¼Œæ‰€ä»¥ä¸ºä½ çš„æ•°æ®ç»“æ„æ·»åŠ çº¿ç¨‹å®‰å…¨çš„ç‰¹æ€§æ˜¯å¿…é¡»çš„ï¼Œä½†æˆ‘ä»¬ä¸ä¼š</span><br><span class="line">å‘å‡ºæœ‰å†™å†™å†²çªæˆ–è¯»å†™å†²çªçš„è¯·æ±‚ã€‚</span><br><span class="line">åè®®æ ¼å¼:</span><br><span class="line"></span><br><span class="line">Headerï¼š<span class="comment">//åœ¨ä¼ è¾“æ•°æ®å‰éƒ½ä¼šå…ˆå‘é€ä¸€éåè®®å¤´çš„æ•°æ®</span></span><br><span class="line">Field       Length    Type     Meaning</span><br><span class="line">MagicNumber 4 bytes   UInt32<span class="comment">// é­”æ•°ï¼ˆå›ºå®šä¸º1234ï¼‰</span></span><br><span class="line">Size        4 bytes   UInt32 <span class="comment">//åŒ…å¤§å°ï¼Œä¸åŒ…æ‹¬å¤´éƒ¨</span></span><br><span class="line">Type        4 bytes   UInt32 <span class="comment">//åŒ…ç±»å‹</span></span><br><span class="line">Padding     4 bytes   UInt32 <span class="comment">//å¡«å……ï¼ˆå›ºå®šä¸º0ï¼‰</span></span><br><span class="line">Types:</span><br><span class="line">        Number         Meaning</span><br><span class="line">           0            Putè¯·æ±‚</span><br><span class="line">           1            Deleteè¯·æ±‚</span><br><span class="line">           2            Getè¯·æ±‚</span><br><span class="line">               3            Putå“åº”</span><br><span class="line">               4            Deleteå“åº”</span><br><span class="line">               5            Getå“åº”</span><br><span class="line"> </span><br><span class="line">        Put Request Body:</span><br><span class="line">   Field     Length    Type      Meaning</span><br><span class="line">  Key Size   4 bytes   UInt32     Keyçš„é•¿åº¦</span><br><span class="line">  Key        N bytes   Byte[]     Key</span><br><span class="line">  Value Size 4 bytes   UInt32     Valueçš„é•¿åº¦</span><br><span class="line">  Value      N bytes   Byte[]     Value</span><br><span class="line">       </span><br><span class="line">       Delete Request Body:</span><br><span class="line">  Field     Length   Type    Meaning</span><br><span class="line">  Key Size  4 bytes UInt32   Keyçš„é•¿åº¦</span><br><span class="line">  Key       N bytes Byte[]   Key</span><br><span class="line">      </span><br><span class="line">      Get Request Body:</span><br><span class="line">   Field    Length   Type    Meaning</span><br><span class="line">   Key Size 4 bytes UInt32   Keyçš„é•¿åº¦</span><br><span class="line">   Key      N bytes Byte[]   Key</span><br><span class="line">   </span><br><span class="line">       Put Response Body:</span><br><span class="line">   Field Length Type Meaning</span><br><span class="line">   Status 1 byte Bool æ˜¯å¦æˆåŠŸ</span><br><span class="line">   </span><br><span class="line">       Delete Response Body:</span><br><span class="line">   Field    Length   Type    Meaning</span><br><span class="line">   Status   1 byte   Bool    æ˜¯å¦æˆåŠŸ</span><br><span class="line">  </span><br><span class="line">       Get Response Body:</span><br><span class="line">   Field       Length     Type    Meaning</span><br><span class="line">  Value Size   4 bytes   UInt32   Valueçš„é•¿åº¦</span><br><span class="line">  Value        N bytes   Byte[]   Value</span><br><span class="line">Notes:</span><br><span class="line">æˆ‘ä»¬ä¸ä¼šä½¿ç”¨ä¸€ä¸ªè¿æ¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ã€‚</span><br><span class="line">æˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨å¤šä¸ªè¿æ¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä½†è¿™äº›è¯·æ±‚ä¹‹é—´ä¸ä¼šæœ‰ç«Ÿæ€æ¡ä»¶ã€‚</span><br><span class="line">ä½ çš„ç¨‹åºæ‰€å­˜å‚¨çš„Key Valueå¯¹çš„æ€»å†…å­˜é‡ä¸ä¼šè¶…è¿‡å†…å­˜æ€»é‡ã€‚</span><br><span class="line">æˆ‘ä»¬å¯èƒ½ä¼šé‡å¯ä½ çš„ç¨‹åºï¼Œè¯·ç¡®ä¿ä½ ç¡®å®å¯¹æ•°æ®è¿›è¡Œäº†æŒä¹…åŒ–ã€‚</span><br><span class="line">æˆ‘ä»¬å‡å®šæ‰€æœ‰çš„é€šä¿¡éƒ½æ˜¯å¯é ï¼Œå› æ­¤ä¸ä¼šå‡ºç°æ–­è¿çš„æƒ…å†µã€‚</span><br><span class="line">æˆ‘ä»¬è‡³å¤šåŒæ—¶ä½¿ç”¨100ä¸ªè¿æ¥ã€‚</span><br><span class="line">æ–‡ä¸­æåŠçš„æ‰€æœ‰Intå‡ä½¿ç”¨å°ç«¯åºã€‚</span><br><span class="line">ç¨åæˆ‘ä»¬ä¼šæ”¾å‡ºClientçš„æºç ä½œä¸ºå‚è€ƒ</span><br><span class="line"> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Created by: keqiudi</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ClassTCP.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">TCP *TOC=<span class="keyword">new</span> TCP;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    TOC-&gt;<span class="built_in">Socket_Start</span>();<span class="comment">//å¯åŠ¨æœåŠ¡å™¨</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiudi on 2023/2/27.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CLIONSERVER_CLASSTCP_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CLIONSERVER_CLASSTCP_H <span class="comment">//é˜²æ­¢å¤´æ–‡ä»¶é‡å¤å¼•ç”¨ï¼Œé™ä½ç¼–è¯‘æ•ˆç‡</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TCP</span>&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> ser_addr;</span><br><span class="line">    <span class="type">int</span> socket_fd;</span><br><span class="line">    <span class="type">int</span> bin_d;</span><br><span class="line">    <span class="type">int</span> lis;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">TCP</span>();</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Message_import</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">Message_save</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Socket_Start</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Connect_Start</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//CLIONSERVER_CLASSTCP_H</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiudi on 2023/2/27.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ClassMessage.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">map&lt;string,string&gt;Map;<span class="comment">//å…¨å±€Mapå®¹å™¨</span></span><br><span class="line">mutex WriteMutexMap;<span class="comment">//åˆ›å»ºå…¨å±€é”ï¼Œé¿å…å¤šçº¿ç¨‹å¯¹mapå®¹å™¨çš„æ“ä½œé€ æˆæ•°æ®æ··ä¹±</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">extern</span> TCP *TOC;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TCP::Socket_Start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;socket_fd = <span class="built_in">socket</span>(AF_INET,SOCK_STREAM,<span class="number">0</span>); <span class="comment">//åˆ›é€ ç›‘å¬çš„å¥—æ¥å­—</span></span><br><span class="line">    <span class="keyword">if</span>(socket_fd==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;socket&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ser_addr.sin_family=AF_INET;<span class="comment">//å°†socket()è¿”å›å€¼å’Œæœ¬åœ°çš„IPï¼ˆIPv4ï¼‰ç«¯å£ç»‘å®šåˆ°ä¸€èµ·</span></span><br><span class="line">    ser_addr.sin_port=<span class="built_in">htons</span>(<span class="number">9999</span>);<span class="comment">//å¤§ç«¯ç«¯å£</span></span><br><span class="line">    ser_addr.sin_addr.s_addr=INADDR_ANY;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> opt=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">setsockopt</span>(socket_fd,SOL_SOCKET,SO_REUSEADDR,&amp;opt,<span class="built_in">sizeof</span>(opt));<span class="comment">//è®¾ç½®ç«¯å£å¤ç”¨</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">this</span>-&gt;bin_d= <span class="built_in">bind</span>(socket_fd,(<span class="keyword">struct</span> sockaddr*)&amp;ser_addr,<span class="built_in">sizeof</span>(ser_addr));<span class="comment">//è®¾ç½®ç›‘å¬</span></span><br><span class="line">    <span class="keyword">if</span>(bin_d==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;bind&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>-&gt;lis= <span class="built_in">listen</span>(socket_fd,<span class="number">100</span>);<span class="comment">//100è¡¨ç¤ºä¸€æ¬¡åŒæ—¶æœ€å¤§ç›‘å¬æ•°</span></span><br><span class="line">    <span class="keyword">if</span>(lis==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;listen&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">this</span>-&gt;<span class="built_in">Connect_Start</span>();</span><br><span class="line">&#125;</span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">working</span><span class="params">(Message message,<span class="keyword">struct</span> Client_Message client_message)</span> </span>&#123;</span><br><span class="line">    message.client_message = client_message;   <span class="comment">//æ‹·è´ä¸€ä»½messageç±»ä½¿æ¯ä¸ªå­çº¿ç¨‹å•ç‹¬ä½¿ç”¨ï¼Œåƒä¸‡ä¸èƒ½å…¨éƒ¨å…±ç”¨ä¸€ä¸ªç±» </span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (message.<span class="built_in">Message_get</span>(message) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;<span class="comment">//å­çº¿ç¨‹é€€å‡º</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TCP::Connect_Start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Client_Message</span> Client;</span><br><span class="line"></span><br><span class="line">    Message message;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        Client.connect_fd= <span class="built_in">accept</span>(socket_fd, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);<span class="comment">//é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">        <span class="keyword">if</span> (Client.connect_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">perror</span>(<span class="string">&quot;accept&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="function">thread <span class="title">t</span><span class="params">(working,message,Client)</span></span>;<span class="comment">//åˆ›å»ºå­çº¿ç¨‹</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">        t.<span class="built_in">detach</span>();<span class="comment">//åˆ†ç¦»å­çº¿ç¨‹,</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">TCP::Message_save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   ofstream outFile;</span><br><span class="line">    outFile.<span class="built_in">open</span>(<span class="string">&quot;DATA.txt&quot;</span>,ios::out);</span><br><span class="line">    <span class="keyword">if</span>(!outFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    WriteMutexMap.<span class="built_in">lock</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> &amp; it : Map)</span><br><span class="line">    &#123;</span><br><span class="line">        outFile &lt;&lt; it.first &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; it.second &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    WriteMutexMap.<span class="built_in">unlock</span>();</span><br><span class="line">    outFile.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TCP::Message_import</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    string key,value;</span><br><span class="line">    ifstream inFile;</span><br><span class="line"></span><br><span class="line">    inFile.<span class="built_in">open</span>(<span class="string">&quot;DATA.txt&quot;</span>,ios::in);</span><br><span class="line">    <span class="keyword">if</span>(!inFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!inFile.<span class="built_in">eof</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        inFile &gt;&gt; key;</span><br><span class="line">        inFile &gt;&gt; value;</span><br><span class="line">        Map.<span class="built_in">insert</span>(<span class="built_in">pair</span>&lt;string,string&gt;(key, value));</span><br><span class="line">    &#125;</span><br><span class="line">    inFile.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">TCP::~<span class="built_in">TCP</span>() &#123;</span><br><span class="line">    <span class="keyword">delete</span> TOC;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -5"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiudi on 2023/2/27.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CLIONSERVER_CLASSMESSAGE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CLIONSERVER_CLASSMESSAGE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ClassTCP.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Client_Message</span>&#123;</span><br><span class="line">    <span class="type">int</span> connect_fd;<span class="comment">//ç”¨äºé€šä¿¡çš„å¥—æ¥å­—</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> client_addr;<span class="comment">//ä¸ç”¨çš„ä¸œè¥¿æ‡’å¾—æ”¹äº†,ä¸å½±å“</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Message</span>&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">struct</span> &#123;</span><br><span class="line">         <span class="type">uint32_t</span> MagicNumber;</span><br><span class="line">         <span class="type">uint32_t</span> Size;</span><br><span class="line">         <span class="type">uint32_t</span> Type;</span><br><span class="line">         <span class="type">uint32_t</span> Padding;</span><br><span class="line">    &#125;inf;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Message</span>();</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">Message_get</span><span class="params">(Message message)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Types_Request</span><span class="params">(Message message)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Put_Response</span><span class="params">(Message message)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Delete_Response</span><span class="params">(Message message)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Get_Response</span><span class="params">(Message message)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">header_send</span><span class="params">(Message message,<span class="type">uint32_t</span> MagicNumber,<span class="type">uint32_t</span> Size,<span class="type">uint32_t</span> Type,<span class="type">uint32_t</span> Padding)</span></span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Client_Message</span> client_message;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//CLIONSERVER_CLASSMESSAGE_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -6"><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by keqiudi on 2023/2/27.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ClassTCP.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;ClassMessage.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">extern</span> map&lt;string, string&gt; Map;<span class="comment">//å…¨å±€mapå®¹å™¨</span></span><br><span class="line"><span class="keyword">extern</span> TCP *TOC;</span><br><span class="line"></span><br><span class="line">Message::<span class="built_in">Message</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;inf.MagicNumber = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;inf.Size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;inf.Type = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;inf.Padding = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Message::Message_get</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">size_t</span> len, len1, len2, len3;<span class="comment">//Headeræ•°æ®å­˜å‚¨</span></span><br><span class="line">        len = <span class="built_in">read</span>(message.client_message.connect_fd, &amp;(<span class="keyword">this</span>-&gt;inf.MagicNumber), <span class="built_in">sizeof</span>(<span class="keyword">this</span>-&gt;inf.MagicNumber));</span><br><span class="line">        len1 = <span class="built_in">read</span>(message.client_message.connect_fd, &amp;(<span class="keyword">this</span>-&gt;inf.Size), <span class="built_in">sizeof</span>(<span class="keyword">this</span>-&gt;inf.MagicNumber));</span><br><span class="line">        len2 = <span class="built_in">read</span>(message.client_message.connect_fd, &amp;(<span class="keyword">this</span>-&gt;inf.Type), <span class="built_in">sizeof</span>(<span class="keyword">this</span>-&gt;inf.MagicNumber));</span><br><span class="line">        len3 = <span class="built_in">read</span>(message.client_message.connect_fd, &amp;(<span class="keyword">this</span>-&gt;inf.Padding), <span class="built_in">sizeof</span>(<span class="keyword">this</span>-&gt;inf.MagicNumber));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">-1</span> || len1 == <span class="number">-1</span> || len2 == <span class="number">-1</span> || len3 == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">perror</span>(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (len == <span class="number">0</span> || len1 == <span class="number">0</span> || len2 == <span class="number">0</span> || len3 == <span class="number">0</span>) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;å®¢æˆ·ç«¯æ–­å¼€è¿æ¥&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="built_in">close</span>(message.client_message.connect_fd);<span class="comment">//å…³é—­å­çº¿ç¨‹é€šä¿¡å¥—æ¥å­—</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>-&gt;<span class="built_in">Types_Request</span>(message);<span class="comment">//æ ¹æ®Typeç±»å‹è¿›è¡Œä¸åŒçš„æ“ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Message::Types_Request</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">this</span>-&gt;inf.Type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">Put_Response</span>(message);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            TOC-&gt;<span class="built_in">Message_import</span>();</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">Delete_Response</span>(message);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            TOC-&gt;<span class="built_in">Message_import</span>();</span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">Get_Response</span>(message);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Message::header_send</span><span class="params">(Message message, <span class="type">uint32_t</span> MagicNumber, <span class="type">uint32_t</span> Size, <span class="type">uint32_t</span> Type, <span class="type">uint32_t</span> Padding)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;MagicNumber, <span class="built_in">sizeof</span>(MagicNumber)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;Size, <span class="built_in">sizeof</span>(Size)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;Type, <span class="built_in">sizeof</span>(Type)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;Padding, <span class="built_in">sizeof</span>(Padding)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Message::Put_Response</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">    string key, value;</span><br><span class="line">    <span class="type">uint32_t</span> keysize, valuesize;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, &amp;keysize, <span class="built_in">sizeof</span>(keysize)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;read error&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    key.<span class="built_in">resize</span>(keysize);<span class="comment">//è®¾ç½®keyçš„å¤§å°</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(key.<span class="built_in">data</span>()), keysize) ==</span><br><span class="line">        <span class="number">-1</span>)<span class="comment">//.data()å°†å­—ç¬¦ä¸²ç±»å‹è½¬æ¢ä¸ºconst char*æŒ‡é’ˆï¼Œconst_cast&lt;char *&gt;(key.data())å°†const char*è½¬æ¢ä¸ºchar,ä¸èƒ½ç›´æ¥å¯¹å­—ç¬¦ä¸²ç±»å‹è¿›è¡Œå–åœ°å€,</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;read error&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, &amp;valuesize, <span class="built_in">sizeof</span>(valuesize)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;read error&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    value.<span class="built_in">resize</span>(valuesize);<span class="comment">//è®¾ç½®valueçš„å¤§å°</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(value.<span class="built_in">data</span>()), valuesize) ==<span class="number">-1</span>)<span class="comment">//const_cast&lt;char *&gt;(key.data())å°†const char*è½¬æ¢ä¸ºchar*</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;read error&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map[key] = value;<span class="comment">//å°†æ•°æ®å­˜å…¥mapä¸­</span></span><br><span class="line">    <span class="type">bool</span> result = TOC-&gt;<span class="built_in">Message_save</span>();<span class="comment">//å°†æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶ä¸­,è¿”å›å€¼ä½œä¸ºå›åº”</span></span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> MagicNumber = <span class="number">1234</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Size = <span class="built_in">sizeof</span>(<span class="type">bool</span>);</span><br><span class="line">    <span class="type">uint32_t</span> Type = <span class="number">3</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Padding = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">header_send</span>(message, MagicNumber, Size, Type, Padding);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;result, <span class="built_in">sizeof</span>(result)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Message::Delete_Response</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">    string key;</span><br><span class="line">    <span class="type">uint32_t</span> keysize;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, &amp;keysize, <span class="built_in">sizeof</span>(keysize)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    key.<span class="built_in">resize</span>(keysize);<span class="comment">//è®¾ç½®keyçš„å¤§å°</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(key.<span class="built_in">data</span>()), keysize) ==</span><br><span class="line">        <span class="number">-1</span>)<span class="comment">//const_cast&lt;char *&gt;(key.data())å°†const char*è½¬æ¢ä¸ºchar*</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Map.<span class="built_in">erase</span>(key);</span><br><span class="line">    <span class="type">bool</span> result = TOC-&gt;<span class="built_in">Message_save</span>();<span class="comment">//å°†æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶ä¸­,è¿”å›å€¼ä½œä¸ºå›åº”</span></span><br><span class="line">    <span class="type">uint32_t</span> MagicNumber = <span class="number">1234</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Size = <span class="built_in">sizeof</span>(<span class="type">bool</span>);</span><br><span class="line">    <span class="type">uint32_t</span> Type = <span class="number">4</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Padding = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">header_send</span>(message, MagicNumber, Size, Type, Padding);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;result, <span class="built_in">sizeof</span>(result)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Message::Get_Response</span><span class="params">(Message message)</span> </span>&#123;</span><br><span class="line">    string key;</span><br><span class="line">    <span class="type">uint32_t</span> keysize;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, &amp;keysize, <span class="built_in">sizeof</span>(keysize)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    key.<span class="built_in">resize</span>(keysize);<span class="comment">//è®¾ç½®keyçš„å¤§å°</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">read</span>(message.client_message.connect_fd, <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(key.<span class="built_in">data</span>()), keysize) ==</span><br><span class="line">        <span class="number">-1</span>)<span class="comment">//const_cast&lt;char *&gt;(key.data())å°†const char*è½¬æ¢ä¸ºchar*</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;read&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> iter = Map.<span class="built_in">find</span>(key);</span><br><span class="line">    string value = (iter-&gt;second);</span><br><span class="line">    <span class="type">uint32_t</span> valuesize = (iter-&gt;second).<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">uint32_t</span> MagicNumber = <span class="number">1234</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Size = valuesize + <span class="number">4</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Type = <span class="number">5</span>;</span><br><span class="line">    <span class="type">uint32_t</span> Padding = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">header_send</span>(message, MagicNumber, Size, Type, Padding);</span><br><span class="line">    cout &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; valuesize &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, &amp;valuesize, <span class="built_in">sizeof</span>(valuesize)) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; value &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">write</span>(message.client_message.connect_fd, <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(value.<span class="built_in">data</span>()), valuesize) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="ç›¸å…³ç¬”è®°">ç›¸å…³ç¬”è®°</h2><h3 id="map">map</h3><p>mapæ˜¯STLï¼ˆæ ‡å‡†æ¨¡æ¿åº“ï¼‰çš„ä¸€ä¸ªå…³è”å®¹å™¨ï¼Œå®ƒæä¾›ä¸€å¯¹ä¸€çš„hash</p><ul><li><p>ç¬¬ä¸€ä¸ªå¯ä»¥ç§°ä¸ºå…³é”®å­—(key)ï¼Œæ¯ä¸ªå…³é”®å­—ï¼ˆkeyï¼‰åªèƒ½åœ¨mapä¸­å‡ºç°ä¸€æ¬¡ï¼›</p></li><li><p>ç¬¬äºŒä¸ªå¯èƒ½ç§°ä¸ºè¯¥å…³é”®å­—çš„å€¼(value)ï¼›</p></li></ul><p><strong>mapçš„åŠŸèƒ½</strong>ï¼š</p><p>è‡ªåŠ¨å»ºç«‹key ï¼ valueçš„å¯¹åº”ã€‚key å’Œ valueå¯ä»¥æ˜¯ä»»æ„ä½ éœ€è¦çš„ç±»å‹ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰ç±»å‹ã€‚</p><p>map&lt;type_name,type_name&gt;</p><p><strong>ä½¿ç”¨map</strong></p><p>ä½¿ç”¨mapå¾—åŒ…å«mapç±»æ‰€åœ¨çš„å¤´æ–‡ä»¶</p><p>#include <map> //æ³¨æ„ï¼ŒSTLå¤´æ–‡ä»¶æ²¡æœ‰æ‰©å±•å.h</p><p>mapå¯¹è±¡æ˜¯æ¨¡æ¿ç±»ï¼Œéœ€è¦å…³é”®å­—å’Œå­˜å‚¨å¯¹è±¡ä¸¤ä¸ªæ¨¡æ¿å‚æ•°ï¼š</p><p>std:map&lt;<strong>int</strong>, string&gt; personnel;</p><p><strong>ç”¨æ³•ï¼š</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªmapå¯¹è±¡</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="type">int</span>, <span class="built_in">string</span>&gt; mapStudent;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ç¬¬ä¸€ç§ ç”¨insertå‡½æ•¸æ’å…¥pair</span></span><br><span class="line">mapStudent.insert(<span class="built_in">pair</span>&lt;<span class="type">int</span>, <span class="built_in">string</span>&gt;(<span class="number">000</span>, <span class="string">&quot;student_zero&quot;</span>));</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ç¬¬äºŒç§ ç”¨insertå‡½æ•°æ’å…¥value_typeæ•°æ®</span></span><br><span class="line">mapStudent.insert(<span class="built_in">map</span>&lt;<span class="type">int</span>, <span class="built_in">string</span>&gt;::value_type(<span class="number">001</span>, <span class="string">&quot;student_one&quot;</span>));</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ç¬¬ä¸‰ç§ ç”¨&quot;array&quot;æ–¹å¼æ’å…¥</span></span><br><span class="line">mapStudent[<span class="number">123</span>] = <span class="string">&quot;student_first&quot;</span>;<span class="comment">//123ä¸ºkeyï¼Œ&quot;student_first&quot;ä¸ºvalue</span></span><br><span class="line">mapStudent[<span class="number">456</span>] = <span class="string">&quot;student_second&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//mapæŸ¥æ‰¾å…ƒç´ </span></span><br><span class="line">mapStudent.find(key)<span class="comment">//å½“æ‰€æŸ¥æ‰¾çš„å…³é”®keyå‡ºç°æ—¶ï¼Œå®ƒè¿”å›æ•°æ®æ‰€åœ¨å¯¹è±¡çš„ä½ç½®,å¦åˆ™è¿”å›map::end()ä½ç½®</span></span><br><span class="line">ç”¨<span class="keyword">auto</span> iter = mapStudent.find(key);<span class="comment">//å¾—åˆ°æŒ‡å‘keyçš„ä¸€ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">  iter-&gt;first<span class="comment">//keyçš„å€¼</span></span><br><span class="line">  iter-&gt;second<span class="comment">//valueçš„å€¼</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//mapåˆ é™¤å…ƒç´ </span></span><br><span class="line">mapStudent.erase(key)<span class="comment">//åˆ é™¤å…³é”®å­—ï¼Œå¦‚æœæˆåŠŸåˆ é™¤è¿”å›1ï¼Œå¦åˆ™è¿”å›0</span></span><br><span class="line">mapStudent.clear()<span class="comment">//æ¸…ç©ºæ‰€æœ‰å…ƒç´ </span></span><br><span class="line">mapStudent.(mapStudent.begin(),mapStudent.end());<span class="comment">//ä¸ä¸Šæ–¹ç­‰åŒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–mapçš„å¤§å°</span></span><br><span class="line"><span class="type">int</span> nSize = mapStudent.size();</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>çš„åŸºæœ¬æ“ä½œå‡½æ•°ï¼šæ›´å¤šè§CSDN </span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong></p><p>ä»¥ä¸Šä¸‰ç§ç”¨æ³•ï¼Œè™½ç„¶éƒ½å¯ä»¥å®ç°æ•°æ®çš„æ’å…¥ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå½“ç„¶äº†ç¬¬ä¸€ç§å’Œç¬¬äºŒç§åœ¨æ•ˆæœä¸Šæ˜¯å®Œæˆä¸€æ ·çš„ï¼Œç”¨insertå‡½æ•°æ’å…¥æ•°æ®ï¼Œåœ¨æ•°æ®çš„ æ’å…¥ä¸Šæ¶‰åŠåˆ°é›†åˆçš„å”¯ä¸€æ€§è¿™ä¸ªæ¦‚å¿µï¼Œå³å½“mapä¸­æœ‰è¿™ä¸ªå…³é”®å­—æ—¶ï¼Œ<strong>insertæ“ä½œæ˜¯ä¸èƒ½åœ¨æ’å…¥æ•°æ®çš„</strong>ï¼Œä½†æ˜¯ç”¨<strong>æ•°ç»„</strong>æ–¹å¼å°±ä¸åŒäº†ï¼Œå®ƒ<strong>å¯ä»¥è¦†ç›–ä»¥å‰è¯¥å…³é”®å­—å¯¹ åº”çš„å€¼</strong>ï¼Œç”¨ç¨‹åºè¯´æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">map&lt;string,string&gt;Map;</span><br><span class="line"><span class="comment">//ä»¥ä¸‹éƒ½æ˜¯stringç±»å‹</span></span><br><span class="line">Map[<span class="string">&quot;key&quot;</span>] = <span class="string">&quot;value&quot;</span>;<span class="comment">//keyä¸valueå¯¹åº”</span></span><br><span class="line"></span><br><span class="line">Map.<span class="built_in">insert</span>(<span class="built_in">pair</span>&lt;string, string&gt;(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;other&quot;</span>));<span class="comment">//æ“ä½œå¤±è´¥ï¼Œå·²ç»å­˜åœ¨keyï¼Œinsertå¤±è´¥ï¼Œ</span></span><br><span class="line">Map[<span class="string">&quot;key&quot;</span>] = <span class="string">&quot;other&quot;</span>;<span class="comment">//æ“ä½œæˆåŠŸï¼Œç”¨æ•°ç»„å†™å…¥ç›¸åŒkey æ—¶ï¼Œä¼šå°†åŸæ¥å­˜åœ¨çš„valueè¦†ç›–</span></span><br></pre></td></tr></table></figure><p><strong>è¡¥å……ï¼š</strong></p><p><strong>mapçš„éå†(è¿­ä»£å™¨)</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">map</span>è¿­ä»£å™¨</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="type">char</span>,<span class="built_in">string</span>&gt;::iterator it;      <span class="comment">//itèƒ½è¯»å†™map&lt;char,string&gt;çš„å…ƒç´ </span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="type">char</span>,<span class="built_in">string</span>&gt;::const_iterator it;<span class="comment">//itåªèƒ½è¯»map&lt;char,string&gt;çš„å…ƒç´ ï¼Œä¸å¯ä»¥ä¿®æ”¹map&lt;char,string&gt;ä¸­çš„å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> &amp; iter : Map)</span><br><span class="line">    &#123;</span><br><span class="line">        outFile &lt;&lt; iter.first &lt;&lt;<span class="built_in">endl</span></span><br><span class="line">        outFile &lt;&lt; iter.second &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//iter.firstæ˜¯å…³é”®å­keyçš„å€¼</span></span><br><span class="line"><span class="comment">//iter.secondæ˜¯valueçš„å€¼</span></span><br><span class="line"><span class="comment">//éå†çš„æ—¶å€™æŒ‰ç…§keyå€¼éå†</span></span><br></pre></td></tr></table></figure><h3 id="perrorå‡½æ•°">perrorå‡½æ•°</h3><p>perrorå‡½æ•°å¯ä»¥åœ¨å‘ç”Ÿé”™è¯¯æ—¶å¤šè¾“å‡ºçš„æ•°æ®</p><p>ä¸‹æ–¹ä¸ºä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(lis==<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;listen&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="data-æˆå‘˜å‡½æ•°ç”¨æ³•">data()æˆå‘˜å‡½æ•°ç”¨æ³•</h3><p><strong>æ ‡å‡†åº“çš„stringç±»ä¾›äº†3ä¸ªæˆå‘˜å‡½æ•°æ¥ä»ä¸€ä¸ªstringå¾—åˆ°cç±»å‹çš„å­—ç¬¦æ•°ç»„</strong>ï¼šc_str()ã€data()ã€copy(p,n)ã€‚</p><p><strong>1. c_str()ï¼šç”Ÿæˆä¸€ä¸ªconst char*æŒ‡é’ˆï¼ŒæŒ‡å‘ä»¥ç©ºå­—ç¬¦ç»ˆæ­¢çš„æ•°ç»„</strong></p><p><strong>2. data()ï¼šç”Ÿæˆä¸€ä¸ªconst char*æŒ‡é’ˆï¼ŒæŒ‡å‘çš„æ•°ç»„ä¸ä»¥ç©ºå­—ç¬¦ç»“æŸ</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­¤å¤„ç”¨äºé€šä¿¡æ—¶è¯»å–æ•°æ®readå‡½æ•°çš„å‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨æ„é€šå¸¸ä¸ç›´æ¥å¯¹å­—ç¬¦ä¸²ç±»å‹ç›´æ¥å–åœ°å€ï¼ï¼ï¼ï¼Œstringæ˜¯ä¸ªç±»ï¼Œæ‰€ä»¥éœ€è¦dataï¼ˆï¼‰è·å–æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">string keyï¼›</span><br><span class="line"><span class="built_in">read</span>(message.client_message.connect_fd, <span class="built_in">const_cast</span>&lt;<span class="type">char</span> *&gt;(key.<span class="built_in">data</span>()ï¼Œkeysize)ï¼›</span><br><span class="line">     </span><br><span class="line"><span class="comment">//const_cast&lt;char *&gt;å¯ä»¥å°†const char*è½¬åŒ–ä¸ºchar*å‹</span></span><br></pre></td></tr></table></figure><h3 id="resize-å‡½æ•°">resize å‡½æ•°</h3><p>resize()ï¼Œè®¾ç½®å¤§å°;</p><p>reserve()ï¼Œè®¾ç½®å®¹é‡;</p><p>resize()æ˜¯åˆ†é…å®¹å™¨çš„å†…å­˜å¤§å°ï¼Œè€Œreserve()åªæ˜¯è®¾ç½®å®¹å™¨å®¹é‡å¤§å°ï¼Œä½†å¹¶æ²¡æœ‰çœŸæ­£åˆ†é…å†…å­˜ã€‚</p><p>resize()å¯ä»¥ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å¤§å°å’Œåˆå§‹å€¼ï¼Œåˆå§‹å€¼é»˜è®¤ä¸º0ï¼Œreserve()åªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œä¸èƒ½è®¾ç½®åˆå§‹å€¼ï¼Œå…¶åˆå§‹å€¼ä¸ºç³»ç»Ÿéšæœºç”Ÿæˆã€‚</p><p>ä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">string key1;</span><br><span class="line"><span class="type">uint32_t</span> keysize;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;key2;</span><br><span class="line"></span><br><span class="line">key1.<span class="built_in">resize</span>(keysize);<span class="comment">//å¯ä»¥ä¸ºå­—ç¬¦ä¸²è®¾ç½®å¤§å°</span></span><br><span class="line">key2.<span class="built_in">resize</span>(keysize);<span class="comment">//ä¸ºvectorå®¹å™¨è®¾ç½®å¤§å°</span></span><br></pre></td></tr></table></figure><h3 id="å¤šçº¿ç¨‹std-thread">å¤šçº¿ç¨‹std::thread</h3><p>å¤´æ–‡ä»¶#include<thread></p><p>çœ‹çœ‹CSDNå…¨é¢ç”¨æ³•ï¼š<a href="https://blog.csdn.net/sjc_0910/article/details/118861539?spm=1001.2014.3001.5506">(10æ¡æ¶ˆæ¯) C++11 å¤šçº¿ç¨‹ï¼ˆstd::threadï¼‰è¯¦è§£_std::threadï¼ˆï¼‰æ˜¯ä¸ªå‡½æ•°å—_sjc_0910çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/lu_embedded/article/details/121639992?spm=1001.2014.3001.5506">(10æ¡æ¶ˆæ¯) ä¸¤ç§ C++ å¤šçº¿ç¨‹ç¼–ç¨‹æ–¹å¼ï¼Œçœ‹å®Œä¸æ‡‚æ‰“æˆ‘â€¦_c++å¤šçº¿ç¨‹_é˜¿åŸºç±³ä¸œçš„åšå®¢-CSDNåšå®¢</a></p><p>åˆ›å»ºçº¿ç¨‹åŸºæœ¬ç”¨æ³•:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line">thread <span class="title function_">t</span><span class="params">(å·¥ä½œçš„å‡½æ•°,è¯¥å‡½æ•°å‚æ•°,è¯¥å‡½æ•°å‚æ•°,,,,,)</span></span><br></pre></td></tr></table></figure><p>æˆ‘çš„ç”¨æ³•ï¼ˆå…·ä½“è§ä¸Šæ–¹ä»£ç ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TCP::Connect_Start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Client_Message</span> Client;<span class="comment">//è¿™ä¸ªåœ°æ–¹å¯ä»¥ç›´æ¥ç”¨ä¸€ä¸ªin connect_fdï¼Œä¸‹é¢ä¼ å‚çš„æ—¶å€™åŒæ ·ä¹Ÿä¼ è¿›å»ï¼Œå½“ä¸ç”¨å®¢æˆ·ç«¯æ•°æ®çš„æ—¶å€™,å°±ä¸ç”¨ç»“æ„ä½“äº†</span></span><br><span class="line"></span><br><span class="line">    Message message;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        Client.connect_fd= <span class="built_in">accept</span>(socket_fd, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);<span class="comment">//é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">        <span class="keyword">if</span> (Client.connect_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="built_in">perror</span>(<span class="string">&quot;accept&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="function">thread <span class="title">t</span><span class="params">(working,message,Client)</span></span>;<span class="comment">//åˆ›å»ºå­çº¿ç¨‹</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å­çº¿ç¨‹åˆ›å»ºæˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">        t.<span class="built_in">detach</span>();<span class="comment">//åˆ†ç¦»å­çº¿ç¨‹ï¼Œä½¿å­çº¿ç¨‹ç‹¬ç«‹äºä¸»çº¿ç¨‹å¹¶å‘è¿è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">working</span><span class="params">(Message message,<span class="keyword">struct</span> Client_Message client_message)</span> </span>&#123;</span><br><span class="line">    message.client_message = client_message;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;<span class="comment">//è¿™é‡Œçš„å¾ªç¯é¿å…ä¼ å…¥æ•°æ®è¢«å›æ”¶</span></span><br><span class="line">        <span class="keyword">if</span> (message.<span class="built_in">Message_get</span>(message) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;<span class="comment">//å­çº¿ç¨‹é€€å‡ºï¼Œä¸€å®šè¦æœ‰</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">//æ¯ä¸ªçº¿ç¨‹çš„å…¥å£å‡½æ•°</span></span><br></pre></td></tr></table></figure><p><strong>å…³äºæˆ‘åœ¨ç¬¬ä¸€æ¬¡å†™å¤šçº¿ç¨‹çŠ¯çš„è‡´å‘½é”™è¯¯ï¼š</strong></p><p>åˆšå¼€å§‹å†™æˆ‘ç«Ÿç„¶è®©æ‰€æœ‰çº¿ç¨‹å…±ç”¨å…¨å±€çš„ä¸€ä¸ªç±»ï¼ï¼ï¼(è¿™æ ·ä¼šå¯¼è‡´ä¸åŒçº¿ç¨‹åœ¨åŒæ—¶è¯»å†™è¯¥ç±»æ•°æ®ï¼Œä¸€å®šä¼šçˆ†ç‚¸)  è¡€çš„æ•™è®­ï¼ï¼</p><p><strong>æ³¨æ„ï¼šåœ¨å†™å­çº¿ç¨‹çš„å·¥ä½œå‡½æ•°æ—¶ï¼Œæœ€å¥½æ˜¯è®©è¿™ä¸ªthread_workingå‡½æ•°ç‹¬ç«‹(ç‹¬ç«‹äºç±»)å‡ºæ¥ï¼Œä¸è¦ä»€ä¹ˆä¸œè¥¿éƒ½ä¸€èµ·ç”¨</strong></p><p>è¿™ä¸ªåœ°æ–¹åé¢ä¿®æ”¹ä¸ºäº†å°†ä½¿ç”¨ç±»åœ¨æ¯ä¸ªå­çº¿ç¨‹ä¸­æ‹·è´ä¸€ä»½ç±»ï¼ˆæ‰€æœ‰æ•°æ®éƒ½ä¼šæ‹·è´ä¸€ä»½ï¼‰ï¼Œä½¿æ‰€æœ‰çš„çº¿ç¨‹å•ç‹¬ä½¿ç”¨ä¸åŒçš„ç±»ï¼Œè¿™æ ·å°±é¿å…äº†åŒæ—¶è¯»å†™å¯¼è‡´ç¨‹åºå´©æºƒ</p><p>è¿˜æœ‰ä¸€å®šè¦è®©å­çº¿ç¨‹é€€å‡ºï¼Œä¸é€€å‡ºä¹Ÿä¼šçˆ†ç‚¸</p><p>è¿˜æœ‰åˆ«å¿˜äº†æ–­å¼€è¿æ¥æ—¶close()å…³é—­é€šä¿¡å¥—æ¥å­—</p><h3 id="std-mutex-äº’æ–¥é”">std::mutex(äº’æ–¥é”)</h3><p>å¤´æ–‡ä»¶:#include<mutex></p><p><code>std::mutex</code>æ˜¯ C++11 ä¸­æœ€åŸºæœ¬çš„äº’æ–¥é‡ï¼Œä¸€ä¸ªçº¿ç¨‹å°†mutexé”ä½æ—¶ï¼Œå…¶å®ƒçš„çº¿ç¨‹å°±ä¸èƒ½æ“ä½œmutexï¼Œç›´åˆ°è¿™ä¸ªçº¿ç¨‹å°†mutexè§£é”ã€‚</p><p><strong>ä¸€èˆ¬éƒ½æ˜¯åˆ›å»ºå…¨å±€é”</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line">map&lt;string,string&gt;Map;</span><br><span class="line">mutex WriteMutexMap;<span class="comment">//åˆ›å»ºå…¨å±€é”ï¼Œé¿å…å¤šçº¿ç¨‹å¯¹mapå®¹å™¨çš„æ“ä½œé€ æˆæ•°æ®æ··ä¹±</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨å†™å…¥æ•°æ®æ—¶çš„ç®€å•æ“ä½œï¼š</span></span><br><span class="line"></span><br><span class="line">WriteMutexMap.<span class="built_in">lock</span>();<span class="comment">//æ­¤æ—¶é”ä½ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½æ“ä½œæ•°æ®</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> &amp; it : Map)</span><br><span class="line">    &#123;</span><br><span class="line">        outFile &lt;&lt; it.first &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; it.second &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    WriteMutexMap.<span class="built_in">unlock</span>();<span class="comment">//è§£é”</span></span><br><span class="line">    outFile.<span class="built_in">close</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨å‡½æ•°ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line">mutex WriteMutexMap;</span><br><span class="line"></span><br><span class="line">WriteMutexMap.<span class="built_in">lock</span>();<span class="comment">//å°†mutexä¸Šé”ã€‚å¦‚æœmutexå·²ç»è¢«å…¶å®ƒçº¿ç¨‹ä¸Šé”ï¼Œï¼Œé‚£ä¹ˆä¼šé˜»å¡ï¼Œç›´åˆ°è§£é”ï¼›å¦‚æœmutexå·²ç»è¢«åŒä¸€ä¸ªçº¿ç¨‹é”ä½ï¼Œé‚£ä¹ˆä¼šäº§ç”Ÿæ­»é”ã€‚</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">WriteMutexMap.<span class="built_in">unlock</span>();<span class="comment">//è§£é”mutexï¼Œé‡Šæ”¾å…¶æ‰€æœ‰æƒã€‚å¦‚æœæœ‰çº¿ç¨‹å› ä¸ºè°ƒç”¨lock()ä¸èƒ½ä¸Šé”è€Œè¢«é˜»å¡ï¼Œåˆ™è°ƒç”¨æ­¤å‡½æ•°ä¼šå°†mutexçš„ä¸»åŠ¨æƒéšæœºäº¤ç»™å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ï¼›å¦‚æœmutexä¸æ˜¯è¢«æ­¤çº¿ç¨‹ä¸Šé”ï¼Œé‚£ä¹ˆä¼šå¼•å‘æœªå®šä¹‰çš„å¼‚å¸¸ã€‚</span></span><br><span class="line"></span><br><span class="line">WriteMutexMap.<span class="built_in">try_lock</span>();<span class="comment">//å°è¯•å°†mutexä¸Šé”ã€‚å¦‚æœmutexæœªè¢«ä¸Šé”ï¼Œåˆ™å°†å…¶ä¸Šé”å¹¶è¿”å›trueï¼›å¦‚æœmutexå·²è¢«é”åˆ™è¿”å›falseã€‚</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">socketç½‘ç»œç¼–ç¨‹</summary>
    
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://keqiudi.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>å­¦ç”Ÿç®¡ç†ç¨‹åº</title>
    <link href="https://keqiudi.github.io/posts/f28c0c7b.html"/>
    <id>https://keqiudi.github.io/posts/f28c0c7b.html</id>
    <published>2022-12-03T06:21:05.000Z</published>
    <updated>2023-07-18T15:18:59.460Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å­¦ç”Ÿç®¡ç†ç¨‹åºï¼Œè®°å½•äº†å››ä¸ªä¸åŒç‰ˆæœ¬</p><h1>1.ç¬¬ä¸€æ¬¡å­¦ç”Ÿç®¡ç†ç¨‹åº(ç»“æ„ä½“å®ç°):</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS 1<span class="comment">//é˜²æ­¢scanfæŠ¥é”™</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">STUDENTS</span> &#123;<span class="comment">//ä¸»ç»“æ„ä½“</span></span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line"><span class="type">char</span> name[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> sex;</span><br><span class="line"><span class="keyword">union</span> <span class="title class_">stu</span> &#123;<span class="comment">//è”åˆä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">student</span> &#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> year:<span class="number">11</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> month:<span class="number">4</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> day:<span class="number">5</span>;</span><br><span class="line">&#125;birthday;</span><br><span class="line"><span class="type">int</span> date;</span><br><span class="line">&#125;STU;</span><br><span class="line"><span class="type">int</span> score[<span class="number">4</span>];</span><br><span class="line">&#125;STUDENT;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">types</span> &#123;<span class="comment">//æšä¸¾ç±»å‹</span></span><br><span class="line">ç”· = <span class="number">0</span>,</span><br><span class="line">å¥³ =<span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Input</span><span class="params">(STUDENT student[],<span class="type">int</span> n)</span></span>;<span class="comment">//è¾“å…¥å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Search</span><span class="params">(<span class="type">char</span> name[], STUDENT student[], <span class="type">int</span> n)</span></span>;<span class="comment">//æŸ¥æ‰¾å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Average</span><span class="params">(STUDENT student[],<span class="type">int</span> n)</span></span>;<span class="comment">//å¹³å‡æˆç»©å’ŒåŠæ ¼ç‡å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Comparemin</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span></span>;<span class="comment">//æœ€å°å¹´é¾„æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span><span class="params">(<span class="type">char</span> names[], STUDENT student[<span class="number">100</span>], <span class="type">int</span> n)</span></span>;<span class="comment">//åŒ¹é…å­—ç¬¦ä¸²çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">trans1</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span></span>;<span class="comment">//è”åˆä½“ä¸­ä¸¤æˆå‘˜çš„å€¼äº’åŒ–ï¼Œä¸‹åŒ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">trans2</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">STUDENT student[<span class="number">100</span>];</span><br><span class="line"><span class="type">int</span> n, chose,func;</span><br><span class="line"><span class="type">char</span> names[<span class="number">100</span>];</span><br><span class="line">part1:<span class="built_in">printf</span>(<span class="string">&quot;è¯·å…ˆè¾“å…¥ç­çº§å­¦ç”Ÿä¿¡æ¯,è¾“å…¥1è·³è½¬: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;chose);</span><br><span class="line"><span class="built_in">rewind</span>(stdin);</span><br><span class="line"><span class="keyword">if</span> (chose == <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ç­çº§äººæ•°:&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line"><span class="built_in">Input</span>(student, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (chose != <span class="number">1</span>) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¾“å…¥é”™è¯¯!,è¯·é‡æ–°è¾“å…¥\n&quot;</span>);</span><br><span class="line"><span class="keyword">goto</span> part1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·é€‰æ‹©ä½ è¦ä½¿ç”¨çš„åŠŸèƒ½:\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;1.æŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;2.ç»Ÿè®¡æŸç§‘ç›®çš„å¹³å‡æˆç»©å’ŒåŠæ ¼ç‡\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;3.æŸ¥æ‰¾å¹´é¾„æœ€å°çš„å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;func);</span><br><span class="line"><span class="keyword">switch</span> (func)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿå§“å &quot;</span>);</span><br><span class="line"><span class="built_in">rewind</span>(stdin);</span><br><span class="line"><span class="built_in">gets</span>(names);</span><br><span class="line"><span class="built_in">Search</span>(names, student, n);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="built_in">Average</span>(student, n);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="built_in">Comparemin</span>(student, n);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Input</span><span class="params">(STUDENT student[<span class="number">100</span>], <span class="type">int</span> n)</span> </span>&#123;<span class="comment">//è¾“å…¥å‡½æ•°</span></span><br><span class="line"><span class="type">int</span> i,j;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦å·:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;student[i].number);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦ç”Ÿå§“å:&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, student[i].name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦ç”Ÿçš„æ€§åˆ«(ç”·:0å¥³:1):&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;student[i].sex);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦ç”Ÿå‡ºç”Ÿå¹´: æœˆ: æ—¥:\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line"><span class="type">int</span> year, month, day;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;year, &amp;month, &amp;day);</span><br><span class="line">student[i].STU.birthday.year = year;</span><br><span class="line">student[i].STU.birthday.month =month;</span><br><span class="line">student[i].STU.birthday.day = day;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦ç”Ÿçš„è¯­æ–‡ æ•°å­¦ è‹±è¯­ ç†ç»¼æˆç»©:\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;student[i].score[j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Search</span><span class="params">(<span class="type">char</span> names[], STUDENT student[], <span class="type">int</span> n)</span><span class="comment">//æŸ¥æ‰¾å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line">a = <span class="built_in">compare</span>(names, student, n);</span><br><span class="line"><span class="keyword">if</span> (a!=<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ‚¨è¾“å…¥çš„å­¦ç”Ÿä¿¡æ¯å¦‚ä¸‹:\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å§“å: %s\n&quot;</span>, student[a].name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å­¦å·: %d\n&quot;</span>, student[a].number);</span><br><span class="line"><span class="keyword">if</span> (student[a].sex == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: ç”·\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (student[a].sex == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: å¥³\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ: %d%02d%02d\n&quot;</span>, student[a].STU.birthday.year, student[a].STU.birthday.month, student[a].STU.birthday.day);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º\nè¯­æ–‡:%d\n&quot;</span>, student[a].score[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦:%d\n&quot;</span>, student[a].score[<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­:%d\n&quot;</span>, student[a].score[<span class="number">2</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼:%d\n&quot;</span>, student[a].score[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">compare</span>(names, student, n)==<span class="number">-1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ— è¯¥å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">compare</span><span class="params">(<span class="type">char</span> names[] ,STUDENT student[], <span class="type">int</span> n)</span> </span>&#123;<span class="comment">//åå­—åŒ¹é…</span></span><br><span class="line"><span class="type">int</span> i,flag,j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="built_in">strlen</span>(names); j++) &#123;</span><br><span class="line"><span class="keyword">if</span> (names[j] == student[i].name[j]) </span><br><span class="line">flag = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">flag = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (flag == <span class="number">1</span>)</span><br><span class="line"><span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (flag == <span class="number">0</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Average</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span><span class="comment">//åŠæ ¼ç‡å’Œå¹³å‡æˆç»©</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> subject,i;</span><br><span class="line"><span class="type">double</span> avg,pass,sum=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> a=<span class="number">0</span>, b=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä½ æƒ³ç»Ÿè®¡çš„ç§‘ç›®:\n1.è¯­æ–‡\n2.æ•°å­¦\n3.è‹±è¯­\n4.ç†ç»¼\n&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;subject);</span><br><span class="line"><span class="keyword">if</span> (subject == <span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">sum += student[i].score[<span class="number">0</span>];&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n;i++)</span><br><span class="line">&#123;<span class="keyword">if</span> (student[i].score[<span class="number">0</span>] &gt;= <span class="number">60</span>)</span><br><span class="line">a++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (student[i].score[<span class="number">0</span>] &lt; <span class="number">60</span>)</span><br><span class="line">b++;&#125;</span><br><span class="line">avg = sum / n;</span><br><span class="line">pass = (<span class="type">double</span>)a / (a + b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯­æ–‡çš„å¹³å‡æˆç»©ä¸º:%.2lf\nè¯­æ–‡çš„åŠæ ¼ç‡ä¸º%%%.2lf&quot;</span>, avg, pass);&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">2</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">sum += student[i].score[<span class="number">1</span>];&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line"><span class="keyword">if</span> (student[i].score[<span class="number">1</span>] &gt;= <span class="number">60</span>)</span><br><span class="line">a++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (student[i].score[<span class="number">1</span>] &lt; <span class="number">60</span>)</span><br><span class="line">b++;&#125;</span><br><span class="line">avg = sum / n;</span><br><span class="line">pass = (<span class="type">double</span>)a / (a + b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦çš„å¹³å‡æˆç»©ä¸º:%.2lf\næ•°å­¦çš„åŠæ ¼ç‡ä¸º%%%.2lf&quot;</span>, avg, pass);&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">3</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">sum += student[i].score[<span class="number">2</span>];&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line"><span class="keyword">if</span> (student[i].score[<span class="number">2</span>] &gt;= <span class="number">60</span>)</span><br><span class="line">a++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (student[i].score[<span class="number">2</span>] &lt; <span class="number">60</span>)</span><br><span class="line">b++;&#125;</span><br><span class="line">avg = sum / n;</span><br><span class="line">pass = (<span class="type">double</span>)a / (a + b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­çš„å¹³å‡æˆç»©ä¸º:%.2lf\nè‹±è¯­çš„åŠæ ¼ç‡ä¸º%%%.2lf&quot;</span>, avg, pass);&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">4</span>) &#123;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">sum += student[i].score[<span class="number">3</span>];&#125;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line"><span class="keyword">if</span> (student[i].score[<span class="number">3</span>] &gt;= <span class="number">60</span>)</span><br><span class="line">a++;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (student[i].score[<span class="number">3</span>] &lt; <span class="number">60</span>)</span><br><span class="line">b++;&#125;</span><br><span class="line">avg = sum / n;</span><br><span class="line">pass = (<span class="type">double</span>)a / (a + b);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼çš„å¹³å‡æˆç»©ä¸º:%.2lf\nç†ç»¼çš„åŠæ ¼ç‡ä¸º%%%.2lf&quot;</span>, avg, pass);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Comparemin</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">trans1</span>(student, n);</span><br><span class="line"><span class="type">int</span> min=<span class="number">0</span>,i;</span><br><span class="line"><span class="keyword">for</span> (i =<span class="number">0</span>; i &lt; n;i++)<span class="comment">//æ‰¾å‡ºå¹´é¾„æœ€å°çš„å­¦ç”Ÿå¯¹åº”çš„å‡ºç”Ÿæ—¥æœŸ</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (min &lt; student[i].STU.date)</span><br><span class="line">min = student[i].STU.date;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (min == student[i].STU.date)<span class="comment">//å­¦ç”ŸåŒ¹é…</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">trans2</span>(student, n);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å¹´é¾„æœ€å°çš„å­¦ç”Ÿä¿¡æ¯å¦‚ä¸‹:\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å§“å: %s\n&quot;</span>, student[i].name);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å­¦å·: %d\n&quot;</span>, student[i].number);</span><br><span class="line"><span class="keyword">if</span> (student[i].sex == <span class="number">0</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: ç”·\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (student[i].sex == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: å¥³\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ: %d%02d%02d\n&quot;</span>, student[i].STU.birthday.year, student[i].STU.birthday.month, student[i].STU.birthday.day);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º\nè¯­æ–‡:%d\n&quot;</span>, student[i].score[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦:%d\n&quot;</span>, student[i].score[<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­:%d\n&quot;</span>, student[i].score[<span class="number">2</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼:%d\n&quot;</span>, student[i].score[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">trans1</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span><span class="comment">//è”åˆä½“ä¸­ä¸¤æˆå‘˜å€¼çš„è½¬æ¢</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">student[i].STU.date = (student[i].STU.birthday.year)* <span class="number">10000</span> + (student[i].STU.birthday.month) * <span class="number">100</span> + student[i].STU.birthday.day;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">trans2</span><span class="params">(STUDENT student[], <span class="type">int</span> n)</span><span class="comment">//è”åˆä½“ä¸­ä¸¤æˆå‘˜å€¼çš„è½¬æ¢</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i,a;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">a = student[i].STU.date;</span><br><span class="line">student[i].STU.birthday.year = a / <span class="number">10000</span>;</span><br><span class="line">student[i].STU.birthday.month = (a%<span class="number">10000</span>)/<span class="number">100</span>;</span><br><span class="line">student[i].STU.birthday.day = a % <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>2.ç¬¬äºŒæ¬¡å­¦ç”Ÿç®¡ç†ç¨‹åº(é“¾è¡¨å®ç°)</h1><p>main.c</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE* p;</span><br><span class="line">    p = <span class="built_in">fopen</span>(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åŠ è½½æ•°æ®å¤±è´¥,å¼€å§‹å½•å…¥å­¦ç”Ÿæ•°æ®:\n&quot;</span>);</span><br><span class="line">        <span class="built_in">Input</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fclose</span>(p);</span><br><span class="line">        <span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">menu</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>function.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS 1<span class="comment">//é˜²æ­¢scanfæŠ¥é”™</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">STUDENT</span> &#123;</span><span class="comment">//ä¸»ç»“æ„ä½“</span></span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">50</span>];</span><br><span class="line">    <span class="type">int</span> sex;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> <span class="title">stu</span> &#123;</span><span class="comment">//è”åˆä½“</span></span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">birthday</span> &#123;</span></span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> day : <span class="number">5</span>;</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> month : <span class="number">4</span>;</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> year : <span class="number">11</span>;</span><br><span class="line">        &#125;stus;</span><br><span class="line">        <span class="type">int</span> date;</span><br><span class="line">    &#125;STU;</span><br><span class="line">    <span class="type">int</span> score[<span class="number">4</span>];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">STUDENT</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">STUDENT</span>* <span class="title">head</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">STUDENT</span>* <span class="title">student</span> =</span> <span class="literal">NULL</span>, * current = <span class="literal">NULL</span>;<span class="comment">//åˆ›å»ºé“¾è¡¨ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">types</span> &#123;</span></span><br><span class="line">    ç”· = <span class="number">0</span>,</span><br><span class="line">    å¥³ = <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Input</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">char</span> temp[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        current = (<span class="keyword">struct</span> STUDENT*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> STUDENT));</span><br><span class="line">        <span class="keyword">if</span> (current != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (head == <span class="literal">NULL</span>)</span><br><span class="line">                head = current;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                student-&gt;next = current;</span><br><span class="line">            current-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿå§“å: &quot;</span>);</span><br><span class="line">            gets(temp);</span><br><span class="line">            <span class="built_in">strcpy</span>(current-&gt;name, temp);</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;è¯·è¾“å…¥è¯¥å­¦ç”Ÿçš„å­¦å·: &quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;current-&gt;number);</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;è¯·è¾“å…¥è¯¥å­¦ç”Ÿçš„æ€§åˆ«(ç”·:0å¥³:1): &quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;current-&gt;sex);</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿçš„å‡ºç”Ÿæ—¥æœŸå¹´ æœˆ æ—¥: &quot;</span>);</span><br><span class="line">            <span class="type">int</span> year, month, day;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;year, &amp;month, &amp;day);</span><br><span class="line">            current-&gt;STU.stus.year = year;</span><br><span class="line">            current-&gt;STU.stus.month = month;</span><br><span class="line">            current-&gt;STU.stus.day = day;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦ç”Ÿçš„è¯­æ–‡ æ•°å­¦ è‹±è¯­ ç†ç»¼æˆç»©: &quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;current-&gt;score[<span class="number">0</span>], &amp;current-&gt;score[<span class="number">1</span>], &amp;current-&gt;score[<span class="number">2</span>], &amp;current-&gt;score[<span class="number">3</span>]);</span><br><span class="line">            student = current;</span><br><span class="line">            rewind(<span class="built_in">stdin</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ç»§ç»­è¾“å…¥è¯·æŒ‰1,è¾“å…¥å®Œæˆè¯·æŒ‰2:&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;i);</span><br><span class="line">            getchar();</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Find</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;æ‰€æœ‰å­¦ç”Ÿçš„ä¿¡æ¯å¦‚ä¸‹:\n&quot;</span>);</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å­¦ç”Ÿå§“å:%s\n&quot;</span>, current-&gt;name);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å­¦å·:%d\n&quot;</span>, current-&gt;number);</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;sex == <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: ç”·\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;sex == <span class="number">1</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: å¥³\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ:%d%02d%02d\n&quot;</span>, current-&gt;STU.stus.year, current-&gt;STU.stus.month, current-&gt;STU.stus.day);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º\nè¯­æ–‡:%d\n&quot;</span>, current-&gt;score[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦:%d\n&quot;</span>, current-&gt;score[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­:%d\n&quot;</span>, current-&gt;score[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼:%d\n&quot;</span>, current-&gt;score[<span class="number">3</span>]);</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Search</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> names[<span class="number">50</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿçš„å§“å: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, names);</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (match(names, current) == <span class="number">1</span>)<span class="comment">//åŒ¹é…åå­—</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ‚¨è¦æŸ¥æ‰¾çš„å­¦ç”Ÿä¿¡æ¯å¦‚ä¸‹:\n&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;å§“å: %s\n&quot;</span>, current-&gt;name);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;å­¦å·: %d\n&quot;</span>, current-&gt;number);</span><br><span class="line">            <span class="keyword">if</span> (current-&gt;sex == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: ç”·\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;sex == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: å¥³\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ:%4d%02d%02d\n&quot;</span>, current-&gt;STU.stus.year, current-&gt;STU.stus.month, current-&gt;STU.stus.day);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º\nè¯­æ–‡:%d\n&quot;</span>, current-&gt;score[<span class="number">0</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦:%d\n&quot;</span>, current-&gt;score[<span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­:%d\n&quot;</span>, current-&gt;score[<span class="number">2</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼:%d\n&quot;</span>, current-&gt;score[<span class="number">3</span>]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ²¡æœ‰è¯¥å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Average</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> subject, n = <span class="number">0</span>;<span class="comment">//nç”¨äºç»Ÿè®¡ç»“ç‚¹ä¸ªæ•°</span></span><br><span class="line">    <span class="type">double</span> avg = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥ä½ æƒ³ç»Ÿè®¡çš„ç§‘ç›®:\n1.è¯­æ–‡\n2.æ•°å­¦\n3.è‹±è¯­\n4.ç†ç»¼\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;subject);</span><br><span class="line">    <span class="keyword">if</span> (subject == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += current-&gt;score[<span class="number">0</span>];</span><br><span class="line">            current = current-&gt;next;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        avg = sum / n;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è¯­æ–‡çš„å¹³å‡æˆç»©ä¸º:%.2lf&quot;</span>, avg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += current-&gt;score[<span class="number">2</span>];</span><br><span class="line">            current = current-&gt;next;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        avg = sum / n;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦çš„å¹³å‡æˆç»©ä¸º:%.2lf&quot;</span>, avg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += current-&gt;score[<span class="number">2</span>];</span><br><span class="line">            current = current-&gt;next;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        avg = sum / n;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­çš„å¹³å‡æˆç»©ä¸º:%.2lf\n&quot;</span>, avg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += current-&gt;score[<span class="number">3</span>];</span><br><span class="line">            current = current-&gt;next;</span><br><span class="line">            n++;</span><br><span class="line">        &#125;</span><br><span class="line">        avg = sum / n;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼çš„å¹³å‡æˆç»©ä¸º:%.2lf&quot;</span>, avg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">match</span><span class="params">(<span class="type">char</span> names[], <span class="keyword">struct</span> STUDENT* current)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> flag, i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(names); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;name[i] == names[i])</span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;name[i] != names[i])</span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span>  <span class="keyword">if</span> (flag == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">preserve</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    current = head;</span><br><span class="line">    FILE* p1;</span><br><span class="line">    p1 = fopen(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (p1 == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ–‡ä»¶æ‰“å¼€å¤±è´¥&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%s\n&quot;</span>, current-&gt;name);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%d\n&quot;</span>, current-&gt;number);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%d\n&quot;</span>, current-&gt;sex);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%4d%02d%02d\n&quot;</span>, current-&gt;STU.stus.year, current-&gt;STU.stus.month, current-&gt;STU.stus.day);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%d\n&quot;</span>, current-&gt;score[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%d\n&quot;</span>, current-&gt;score[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%d\n&quot;</span>, current-&gt;score[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">fprintf</span>(p1, <span class="string">&quot;%d\n&quot;</span>, current-&gt;score[<span class="number">3</span>]);</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fclose(p1) != <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ–‡ä»¶å…³é—­å¤±è´¥&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ä¿å­˜æ•°æ®æˆåŠŸ,æ–‡ä»¶å…³é—­æˆåŠŸ\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">read</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* p2;</span><br><span class="line">    p2 = fopen(<span class="string">&quot;student&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (p2 == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ‰“å¼€æ–‡ä»¶å¤±è´¥&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!feof(p2))<span class="comment">//è¯»å–åˆ°æ–‡ä»¶ç»“å°¾</span></span><br><span class="line">    &#123;</span><br><span class="line">        current = (<span class="keyword">struct</span> STUDENT*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> STUDENT));</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">NULL</span>)</span><br><span class="line">            head = current;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            student-&gt;next = current;</span><br><span class="line">        current-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%s\n&quot;</span>, current-&gt;name);</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%d\n&quot;</span>, &amp;current-&gt;number);</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%d\n&quot;</span>, &amp;current-&gt;sex);</span><br><span class="line">        <span class="type">int</span> year, month, day;</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%4d%02d%02d\n&quot;</span>, &amp;year, &amp;month, &amp;day);ã€‚</span><br><span class="line">        current-&gt;STU.stus.year = year;</span><br><span class="line">        current-&gt;STU.stus.month = month;</span><br><span class="line">        current-&gt;STU.stus.day = day;<span class="comment">//è®¾ç½®ä½å®½åçš„å¤„ç†</span></span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%d\n&quot;</span>, &amp;current-&gt;score[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%d\n&quot;</span>, &amp;current-&gt;score[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%d\n&quot;</span>, &amp;current-&gt;score[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">fscanf</span>(p2, <span class="string">&quot;%d\n&quot;</span>, &amp;current-&gt;score[<span class="number">3</span>]);</span><br><span class="line">        student = current;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fclose(p2) != <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ–‡ä»¶å…³é—­å¤±è´¥&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å­¦ç”Ÿæ•°æ®åŠ è½½æˆåŠŸ\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">SearchID</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> a, b = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿçš„å­¦å·: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a == current-&gt;number)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">        b++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">NULL</span>)<span class="comment">//åˆ°è¾¾æœ€åä¸€ä¸ªç»“ç‚¹çš„åˆ¤æ–­æ¡ä»¶</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ— è¯¥å­¦ç”Ÿä¿¡æ¯&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è¯¥å­¦ç”Ÿä¿¡æ¯å¦‚ä¸‹:\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å§“å: %s\n&quot;</span>, current-&gt;name);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å­¦å·: %d\n&quot;</span>, current-&gt;number);</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;sex == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: ç”·\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;sex == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;æ€§åˆ«: å¥³\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ:%4d%02d%02d\n&quot;</span>, current-&gt;STU.stus.year, current-&gt;STU.stus.month, current-&gt;STU.stus.day);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º\nè¯­æ–‡:%d\n&quot;</span>, current-&gt;score[<span class="number">0</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;æ•°å­¦:%d\n&quot;</span>, current-&gt;score[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;è‹±è¯­:%d\n&quot;</span>, current-&gt;score[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ç†ç»¼:%d\n&quot;</span>, current-&gt;score[<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">DeleteID</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> a, flag;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥åˆ é™¤å­¦ç”Ÿçš„å­¦å·: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a);</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current-&gt;next != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;next-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (current-&gt;next-&gt;number == a)</span><br><span class="line">            &#123;</span><br><span class="line">                current-&gt;next = current-&gt;next-&gt;next;</span><br><span class="line">                flag = <span class="number">1</span>;<span class="comment">//åˆ é™¤æ”¹é“¾è¡¨ç»“ç‚¹</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span><span class="comment">//åˆ é™¤é“¾è¡¨å°¾ç»“ç‚¹</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (current-&gt;next-&gt;number == a) &#123;</span><br><span class="line">                current-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åˆ é™¤å¤±è´¥,æ‰¾ä¸åˆ°è¯¥å­¦ç”Ÿ&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Deletename</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> names[<span class="number">50</span>];</span><br><span class="line">    <span class="type">int</span> flag;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥åˆ é™¤å­¦ç”Ÿçš„å§“å: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, names);</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current-&gt;next != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;next-&gt;next != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (match(names, current) == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                current-&gt;next = current-&gt;next-&gt;next;<span class="comment">//åˆ é™¤åˆ—è¡¨ç»“ç‚¹</span></span><br><span class="line">                flag = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (match(names, current-&gt;next) == <span class="number">1</span>) &#123;<span class="comment">//å•ç‹¬å¤„ç†åˆ—è¡¨å°¾ç»“ç‚¹</span></span><br><span class="line">                current-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">                flag = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        flag = <span class="number">1</span>;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;åˆ é™¤å¤±è´¥,æ²¡æœ‰è¯¥å­¦ç”Ÿä¿¡æ¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> func;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·é€‰æ‹©ä½ è¦ä½¿ç”¨çš„åŠŸèƒ½:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;1.æŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿ\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;2.å§“åæŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;3.å­¦å·æŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;4.è¾“å…¥å­¦å·åˆ é™¤å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;5.è¾“å…¥å§“ååˆ é™¤å­¦ç”Ÿä¿¡æ¯\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;6.ç»Ÿè®¡æŸç§‘ç›®çš„å¹³å‡æˆç»©\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;7.ä¿å­˜å­¦ç”Ÿæ•°æ®\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;func);</span><br><span class="line">    <span class="keyword">switch</span> (func)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        Find();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        rewind(<span class="built_in">stdin</span>);</span><br><span class="line">        Search();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        SearchID();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        DeleteID();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        Deletename();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        Average();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        preserve();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>3.ç¬¬ä¸‰æ¬¡å­¦ç”Ÿç®¡ç†ç¨‹åº(ç±»+é“¾è¡¨+c++ å®ç°)</h1><p>define.h:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">            <span class="type">int</span> number;</span><br><span class="line">            std::string name;</span><br><span class="line">            <span class="type">int</span> sex;</span><br><span class="line">            <span class="keyword">union</span> <span class="title class_">stu</span> &#123;<span class="comment">//è”åˆä½“</span></span><br><span class="line">                <span class="keyword">struct</span> <span class="title class_">birthday</span> &#123;</span><br><span class="line">                    <span class="type">unsigned</span> <span class="type">int</span> day : <span class="number">5</span>;</span><br><span class="line">                    <span class="type">unsigned</span> <span class="type">int</span> month : <span class="number">4</span>;</span><br><span class="line">                    <span class="type">unsigned</span> <span class="type">int</span> year : <span class="number">12</span>;</span><br><span class="line">                &#125;stus;</span><br><span class="line">                <span class="type">int</span> date;</span><br><span class="line">            &#125;STU;</span><br><span class="line">            <span class="type">int</span> score[<span class="number">4</span>];</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">Student</span>()<span class="comment">//æ„é€ å‡½æ•°åˆå§‹åŒ–å˜é‡</span></span><br><span class="line">        &#123;</span><br><span class="line">            number = <span class="number">0</span>;</span><br><span class="line">            name = <span class="string">&quot;names&quot;</span>;</span><br><span class="line">            sex = <span class="number">0</span>;</span><br><span class="line">            score[<span class="number">0</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">            score[<span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">            score[<span class="number">2</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">            score[<span class="number">3</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        Student* next = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">friend</span> <span class="keyword">class</span> <span class="title class_">Classroom</span>;<span class="comment">//å‹å…ƒç±»(ä½¿å¾—currentèƒ½å¤Ÿè®¿é—®Studentç±»ä¸­çš„ç§æœ‰å˜é‡)</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Classroom</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        Student* head = <span class="literal">nullptr</span>;      <span class="comment">//æŒ‡å‘ä¸‹ä¸€ç»“ç‚¹</span></span><br><span class="line">        Student* latter = <span class="literal">nullptr</span>;</span><br><span class="line">        Student* current = <span class="literal">nullptr</span>;       <span class="comment">//c++ä¸­ç”¨nullpträ»£è¡¨ç©ºæŒ‡é’ˆ,è€ŒNULLå½“ä½œ0ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">public</span>: </span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">Input</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">Find</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">Search</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">SearchID</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">Average</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">DeleteID</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">Deletename</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">preserve</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">menu</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>achieve.cpp:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span><span class="comment">//ç”¨äºå¤„ç†æ–‡ä»¶è¾“å…¥è¾“å‡º</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdlib&gt;</span><span class="comment">//ä¸ºexit()æä¾›åŸå‹</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;define.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Classroom::Input</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       current = <span class="keyword">new</span> Student; </span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">nullptr</span>)</span><br><span class="line">            head = current;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            latter-&gt;next = current;</span><br><span class="line">            current-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿå§“å: &quot;</span>;</span><br><span class="line">            cin &gt;&gt;current-&gt;name;</span><br><span class="line">            cout &lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¯¥å­¦ç”Ÿçš„å­¦å·: &quot;</span>;</span><br><span class="line">            cin &gt;&gt; current-&gt;number;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¯¥å­¦ç”Ÿçš„æ€§åˆ«(ç”·:0å¥³:1): &quot;</span>;</span><br><span class="line">            cin &gt;&gt; current-&gt;sex;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿçš„å‡ºç”Ÿæ—¥æœŸå¹´ æœˆ æ—¥: &quot;</span>;</span><br><span class="line">            <span class="built_in">rewind</span>(stdin);</span><br><span class="line">            <span class="type">int</span> year, month, day;</span><br><span class="line">            cin &gt;&gt; year ;</span><br><span class="line">            cin &gt;&gt; month;</span><br><span class="line">            cin &gt;&gt; day;</span><br><span class="line">            current-&gt;STU.stus.year = year;</span><br><span class="line">            current-&gt;STU.stus.month = month;</span><br><span class="line">            current-&gt;STU.stus.day = day;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥å­¦ç”Ÿçš„è¯­æ–‡ æ•°å­¦ è‹±è¯­ ç†ç»¼æˆç»©: &quot;</span>;</span><br><span class="line">            cin &gt;&gt; current-&gt;score[<span class="number">0</span>] &gt;&gt; current-&gt;score[<span class="number">1</span>] &gt;&gt; current-&gt;score[<span class="number">2</span>] &gt;&gt;current-&gt; score[<span class="number">3</span>];</span><br><span class="line">            latter = current ;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;ç»§ç»­è¾“å…¥è¯·æŒ‰1,è¾“å…¥å®Œæˆè¯·æŒ‰2:&quot;</span>;</span><br><span class="line">            cin &gt;&gt; i;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Classroom::Find</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;æ‰€æœ‰å­¦ç”Ÿçš„ä¿¡æ¯å¦‚ä¸‹:\n&quot;</span>);</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å­¦ç”Ÿå§“å: &quot;</span> &lt;&lt; current-&gt;name &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å­¦å·: &quot;</span> &lt;&lt; current-&gt;number &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: &quot;</span> &lt;&lt; current-&gt;sex &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;sex == <span class="number">0</span>)</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: ç”·&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;sex == <span class="number">1</span>)</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: å¥³&quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ: &quot;</span> &lt;&lt; current-&gt;STU.stus.year &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; current-&gt;STU.stus.month &lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt; current-&gt;STU.stus.day &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º: &quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯­æ–‡: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ•°å­¦: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è‹±è¯­: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;ç†ç»¼: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">3</span>] &lt;&lt; endl;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Classroom::Search</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     string names;</span><br><span class="line">     cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿçš„å§“å: &quot;</span>;</span><br><span class="line">     cin &gt;&gt; names;</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (names==current-&gt;name)<span class="comment">//åŒ¹é…åå­—</span></span><br><span class="line">        &#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;æ‚¨è¦æŸ¥æ‰¾çš„å­¦ç”Ÿä¿¡æ¯å¦‚ä¸‹: &quot;</span>&lt;&lt;endl;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;å§“å: &quot;</span>&lt;&lt;current-&gt;name&lt;&lt;endl;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;å­¦å·: &quot;</span>&lt;&lt; current-&gt;number&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">if</span> (current-&gt;sex == <span class="number">0</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: ç”·&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;sex == <span class="number">1</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: å¥³&quot;</span> &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ: &quot;</span> &lt;&lt; current-&gt;STU.stus.year &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; current-&gt;STU.stus.month &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; current-&gt;STU.stus.day &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º: &quot;</span> &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;è¯­æ–‡: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;æ•°å­¦: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;è‹±è¯­: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;ç†ç»¼: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">3</span>] &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">nullptr</span>)</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ²¡æœ‰è¯¥å­¦ç”Ÿä¿¡æ¯\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Classroom::SearchID</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a, b = <span class="number">0</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥å­¦ç”Ÿçš„å­¦å·: &quot;</span>;</span><br><span class="line">    cin &gt;&gt; a;</span><br><span class="line">    current = head;</span><br><span class="line">    <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a == current-&gt;number)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        current = current-&gt;next;</span><br><span class="line">        b++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (current == <span class="literal">nullptr</span>)<span class="comment">//åˆ°è¾¾æœ€åä¸€ä¸ªç»“ç‚¹çš„åˆ¤æ–­æ¡ä»¶</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ— è¯¥å­¦ç”Ÿä¿¡æ¯&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ‚¨è¦æŸ¥æ‰¾çš„å­¦ç”Ÿä¿¡æ¯å¦‚ä¸‹: &quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å§“å: &quot;</span> &lt;&lt; current-&gt;name &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å­¦å·: &quot;</span> &lt;&lt; current-&gt;number &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">if</span> (current-&gt;sex == <span class="number">0</span>)</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: ç”·&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (current-&gt;sex == <span class="number">1</span>)</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;æ€§åˆ«: å¥³&quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ: &quot;</span> &lt;&lt; current-&gt;STU.stus.year &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; current-&gt;STU.stus.month &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; current-&gt;STU.stus.day &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯¥å­¦ç”Ÿçš„å„ç§‘æˆç»©ä¸º: &quot;</span> &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯­æ–‡: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ•°å­¦: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è‹±è¯­: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;ç†ç»¼: &quot;</span> &lt;&lt; current-&gt;score[<span class="number">3</span>] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">Classroom::Average</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> subject, n = <span class="number">0</span>;<span class="comment">//nç”¨äºç»Ÿè®¡ç»“ç‚¹ä¸ªæ•°</span></span><br><span class="line">        <span class="type">double</span> avg = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">        current = head;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥ä½ æƒ³ç»Ÿè®¡çš„ç§‘ç›®:\n1.è¯­æ–‡\n2.æ•°å­¦\n3.è‹±è¯­\n4.ç†ç»¼\n&quot;</span>;</span><br><span class="line">        cin &gt;&gt; subject;</span><br><span class="line">        <span class="keyword">if</span> (subject == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sum += current-&gt;score[<span class="number">0</span>];</span><br><span class="line">                current = current-&gt;next;</span><br><span class="line">                n++;</span><br><span class="line">            &#125;</span><br><span class="line">            avg = sum / n;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;è¯­æ–‡çš„å¹³å‡æˆç»©ä¸º: &quot;</span>&lt;&lt; avg;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sum += current-&gt;score[<span class="number">2</span>];</span><br><span class="line">                current = current-&gt;next;</span><br><span class="line">                n++;</span><br><span class="line">            &#125;</span><br><span class="line">            avg = sum / n;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;æ•°å­¦çš„å¹³å‡æˆç»©ä¸º: &quot;</span>&lt;&lt; avg;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sum += current-&gt;score[<span class="number">2</span>];</span><br><span class="line">                current = current-&gt;next;</span><br><span class="line">                n++;</span><br><span class="line">            &#125;</span><br><span class="line">            avg = sum / n;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;è‹±è¯­çš„å¹³å‡æˆç»©ä¸º: &quot;</span> &lt;&lt; avg;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (subject == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                sum += current-&gt;score[<span class="number">3</span>];</span><br><span class="line">                current = current-&gt;next;</span><br><span class="line">                n++;</span><br><span class="line">            &#125;</span><br><span class="line">            avg = sum / n;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;ç†ç»¼çš„å¹³å‡æˆç»©ä¸º: &quot;</span> &lt;&lt; avg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">Classroom::DeleteID</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="type">int</span> a, flag;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥åˆ é™¤å­¦ç”Ÿçš„å­¦å·: &quot;</span>;</span><br><span class="line">        cin &gt;&gt; a;</span><br><span class="line">        current = head;</span><br><span class="line">     <span class="keyword">while</span> (current-&gt;next != <span class="literal">nullptr</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="keyword">if</span> (current-&gt;number == a)<span class="comment">//åˆ é™¤åˆ—è¡¨å¤´ç»“ç‚¹</span></span><br><span class="line">         &#123;</span><br><span class="line">             head = current-&gt;next;</span><br><span class="line">             <span class="built_in">delete</span>(current);</span><br><span class="line">             flag = <span class="number">1</span>;</span><br><span class="line">             <span class="keyword">break</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">if</span> (current-&gt;next-&gt;next != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">             <span class="keyword">if</span> (current-&gt;next-&gt;number == a)</span><br><span class="line">             &#123;</span><br><span class="line">                 current-&gt;next = current-&gt;next-&gt;next;</span><br><span class="line">                 <span class="built_in">delete</span>(current-&gt;next);</span><br><span class="line">                 flag = <span class="number">1</span>;<span class="comment">//åˆ é™¤æ”¹é“¾è¡¨ç»“ç‚¹</span></span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span><span class="comment">//åˆ é™¤é“¾è¡¨å°¾ç»“ç‚¹</span></span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">if</span> (current-&gt;next-&gt;number == a) &#123;</span><br><span class="line">                 current-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">                 <span class="built_in">delete</span>(current-&gt;next);</span><br><span class="line">                 flag = <span class="number">1</span>;</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         current = current-&gt;next;</span><br><span class="line">         flag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span> (flag == <span class="number">1</span>)</span><br><span class="line">         cout&lt;&lt;<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>;</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">         cout &lt;&lt;<span class="string">&quot;åˆ é™¤å¤±è´¥,æ‰¾ä¸åˆ°è¯¥å­¦ç”Ÿ&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">Classroom::Deletename</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     string names;</span><br><span class="line">     <span class="type">int</span> flag;</span><br><span class="line">     cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥åˆ é™¤å­¦ç”Ÿçš„å§“å: &quot;</span>;</span><br><span class="line">     cin &gt;&gt; names;</span><br><span class="line">     current = head;</span><br><span class="line">     <span class="keyword">while</span> (current-&gt;next != <span class="literal">nullptr</span>)</span><br><span class="line">     &#123;</span><br><span class="line"> </span><br><span class="line">             <span class="keyword">if</span> (current-&gt;name == names)<span class="comment">//åˆ é™¤åˆ—è¡¨å¤´ç»“ç‚¹</span></span><br><span class="line">             &#123;</span><br><span class="line">                 head = current-&gt;next;</span><br><span class="line">                 <span class="built_in">delete</span>(current);</span><br><span class="line">                 flag = <span class="number">0</span>;</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">          <span class="keyword">if</span> (current-&gt;next-&gt;next != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> (names==current-&gt;next-&gt;name)</span><br><span class="line">             &#123;</span><br><span class="line">                  <span class="built_in">delete</span>(current-&gt;next);</span><br><span class="line">                 current-&gt;next = current-&gt;next-&gt;next;<span class="comment">//åˆ é™¤åˆ—è¡¨ç»“ç‚¹</span></span><br><span class="line">                 flag = <span class="number">0</span>;</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">if</span> (names == current-&gt;next-&gt;name) &#123;<span class="comment">//å•ç‹¬å¤„ç†åˆ—è¡¨å°¾ç»“ç‚¹</span></span><br><span class="line">                 <span class="built_in">delete</span>(current-&gt;next);</span><br><span class="line">                 current-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">                 flag = <span class="number">0</span>;</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         flag = <span class="number">1</span>;</span><br><span class="line">         current = current-&gt;next;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span> (flag == <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>;</span><br><span class="line">     <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;åˆ é™¤å¤±è´¥,æ²¡æœ‰è¯¥å­¦ç”Ÿä¿¡æ¯&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">Classroom::preserve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     current = head;</span><br><span class="line">     ofstream outFile;</span><br><span class="line">     outFile.<span class="built_in">open</span>(<span class="string">&quot;student.txt&quot;</span>);</span><br><span class="line">     <span class="keyword">if</span> (!outFile.<span class="built_in">is_open</span>()) &#123;<span class="comment">//åˆ¤æ–­æ–‡ä»¶æ˜¯å¦æ‰“å¼€æˆåŠŸï¼Œæ‰“å¼€æˆåŠŸè¿”å›true</span></span><br><span class="line">         cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶æ‰“å¼€å¤±è´¥&quot;</span>;</span><br><span class="line">             <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">while</span> (current != <span class="literal">nullptr</span>)</span><br><span class="line">     &#123;</span><br><span class="line">        outFile&lt;&lt;current-&gt;name&lt;&lt;endl;</span><br><span class="line">        outFile&lt;&lt; current-&gt;number &lt;&lt; endl;</span><br><span class="line">        outFile &lt;&lt; current-&gt;sex &lt;&lt; endl;</span><br><span class="line">        outFile &lt;&lt; current-&gt;STU.stus.year &lt;&lt; endl &lt;&lt; current-&gt;STU.stus.month &lt;&lt; endl &lt;&lt; current-&gt;STU.stus.day &lt;&lt; endl;</span><br><span class="line">        outFile &lt;&lt; current-&gt;score[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">        outFile &lt;&lt; current-&gt;score[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">        outFile &lt;&lt; current-&gt;score[<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">        outFile &lt;&lt; current-&gt;score[<span class="number">3</span>] &lt;&lt; endl;</span><br><span class="line">         current = current-&gt;next;</span><br><span class="line">         </span><br><span class="line">     &#125;</span><br><span class="line">     outFile.<span class="built_in">close</span>();</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;ä¿å­˜æˆåŠŸ&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">Classroom::read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     ifstream inFile;</span><br><span class="line">     inFile.<span class="built_in">open</span>(<span class="string">&quot;student.txt&quot;</span>);</span><br><span class="line">     <span class="keyword">if</span> (!inFile.<span class="built_in">is_open</span>())</span><br><span class="line">     &#123;</span><br><span class="line">         cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶æ‰“å¼€å¤±è´¥&quot;</span>;</span><br><span class="line">         <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">while</span> (!inFile.<span class="built_in">eof</span>())<span class="comment">//è¯»å–åˆ°æ–‡ä»¶ç»“å°¾</span></span><br><span class="line">     &#123;</span><br><span class="line">         current = <span class="keyword">new</span> Student;</span><br><span class="line">         <span class="keyword">if</span> (head ==<span class="literal">nullptr</span>)</span><br><span class="line">             head = current;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">             latter-&gt;next = current;</span><br><span class="line">         current-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">         inFile &gt;&gt; current-&gt;name;</span><br><span class="line">         inFile &gt;&gt; current-&gt;number;</span><br><span class="line">         inFile &gt;&gt; current-&gt;sex;</span><br><span class="line">         <span class="type">int</span> year, month, day;</span><br><span class="line">         inFile &gt;&gt; year;</span><br><span class="line">         inFile &gt;&gt; month;</span><br><span class="line">         inFile &gt;&gt; day;</span><br><span class="line">         current-&gt;STU.stus.year = year;</span><br><span class="line">         current-&gt;STU.stus.month = month;</span><br><span class="line">         current-&gt;STU.stus.day = day;<span class="comment">//è®¾ç½®ä½å®½åçš„å¤„ç†</span></span><br><span class="line">         inFile &gt;&gt; current-&gt;score[<span class="number">0</span>];</span><br><span class="line">         inFile &gt;&gt; current-&gt;score[<span class="number">1</span>];</span><br><span class="line">         inFile &gt;&gt; current-&gt;score[<span class="number">2</span>];</span><br><span class="line">         inFile &gt;&gt; current-&gt;score[<span class="number">3</span>];</span><br><span class="line">         latter = current;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line">     inFile.<span class="built_in">close</span>();</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;å­¦ç”Ÿæ•°æ®åŠ è½½æˆåŠŸ\n&quot;</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>main.cpp:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;define.h&quot;</span></span></span><br><span class="line">Classroom a;<span class="comment">//åˆ›å»ºClassroomå¯¹è±¡(å˜é‡)ï¼Œä¾¿äºè°ƒç”¨å‡½æ•°,åŒæ—¶åˆ›å»ºçš„å…¨å±€å˜é‡ï¼Œå…·æœ‰å¤–éƒ¨é“¾æ¥ï¼Œä¾¿äºèœå•è°ƒç”¨;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::ifstream inFile;</span><br><span class="line">    inFile.<span class="built_in">open</span>(<span class="string">&quot;student.txt&quot;</span>, std::ios::in);<span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ‰“å¼€æ–¹å¼ï¼Œios::inä¸ºåªè¯»æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">if</span> (!inFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;å¼€å§‹å½•å…¥æ•°æ®:&quot;</span>;</span><br><span class="line">        a.<span class="built_in">Input</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        inFile.<span class="built_in">close</span>();</span><br><span class="line">        a.<span class="built_in">read</span>();</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;æ•°æ®åŠ è½½æˆåŠŸ&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">    a.<span class="built_in">menu</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>menu.cpp:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;define.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Classroom::menu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> func;</span><br><span class="line">    <span class="keyword">extern</span> Classroom a;<span class="comment">//externå¼•ç”¨å£°æ˜mainæ–‡ä»¶ä¸­çš„a</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********è¯·é€‰æ‹©ä½ è¦ä½¿ç”¨çš„åŠŸèƒ½: **********                  \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********1.æŸ¥çœ‹æ‰€æœ‰å­¦ç”Ÿ       **********                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********2.å§“åæŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯   **********                  \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********3.å­¦å·æŸ¥æ‰¾å­¦ç”Ÿä¿¡æ¯    **********                  \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********4.è¾“å…¥å­¦å·åˆ é™¤å­¦ç”Ÿä¿¡æ¯**********                  \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********5.è¾“å…¥å§“ååˆ é™¤å­¦ç”Ÿä¿¡æ¯**********                  \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********6.ç»Ÿè®¡æŸç§‘ç›®çš„å¹³å‡æˆç»©**********                  \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                 **********7.ä¿å­˜å­¦ç”Ÿæ•°æ®        **********                  \n&quot;</span>);</span><br><span class="line">    std::cin &gt;&gt; func;</span><br><span class="line">    <span class="keyword">switch</span> (func)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        a.<span class="built_in">Find</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">rewind</span>(stdin);</span><br><span class="line">        a.<span class="built_in">Search</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        a.<span class="built_in">SearchID</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        a.<span class="built_in">DeleteID</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        a.<span class="built_in">Deletename</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        a.<span class="built_in">Average</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        a.<span class="built_in">preserve</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1>4.ç¬¬å››ä¸ªç‰ˆæœ¬åœ¨githubä»“åº“</h1><h1>5.Base64ç¼–ç è§£ç </h1><h2 id="bitsetâ€”â€”å®šä¹‰åŠå¸¸ç”¨æ“ä½œ">bitsetâ€”â€”å®šä¹‰åŠå¸¸ç”¨æ“ä½œ</h2><p>bitset å°±ç›¸å½“äºä¸€ä¸ª åªèƒ½å­˜å‚¨äºŒè¿›åˆ¶ï¼Œä¹Ÿå°±æ˜¯ 0 å’Œ 1 çš„ bool æ•°ç»„(å®¹å™¨)<br>ä½†æ˜¯å¯ä»¥ç›´æ¥å½“ä½œä¸€ä¸ªæ•°è¿›è¡Œå·¦ç§»å³ç§»ï¼Œå–æˆ–å–åç­‰äºŒè¿›åˆ¶æ“ä½œã€‚</p><p>å¦‚æœç›´æ¥ç”¨ bool æ•°ç»„å­˜å‚¨äºŒè¿›åˆ¶æ¯ä¸€ä½çš„è¯ï¼Œn ä½å­˜å‚¨å¤æ‚åº¦ä¸º O(n)ï¼Œä½†æ˜¯ç”¨ bitset çš„è¯å¤æ‚åº¦ä¼šå‡å°‘åˆ° O(n/32)ã€‚</p><p><strong>æ‰€ä»¥ä¸€èˆ¬ç”¨äºŒè¿›åˆ¶çŠ¶æ€å‹ç¼©æ—¶å°±ä¼šç”¨ bitsetã€‚</strong></p><p>ä½¿ç”¨æ—¶å¼•å…¥å¤´æ–‡ä»¶#include<bitset></p><h4 id="å®šä¹‰ï¼š">å®šä¹‰ï¼š</h4><p>å¯¹äº <code>bitset</code> çš„å®šä¹‰æœ‰å››ç§æ–¹å¼ï¼š<br>1ã€ç›´æ¥å®šä¹‰ï¼Œæ¯ä¸€ä½åˆå§‹ä¸º0ï¼š<br><code>bitset&lt;N&gt; name;</code> // å®šä¹‰é•¿åº¦ä¸º N çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œå‘½åä¸º nameï¼›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bitset&lt;8&gt; b1;</span><br><span class="line">cout &lt;&lt; b1 &lt;&lt;endl; <span class="comment">// 00000000</span></span><br></pre></td></tr></table></figure><p>2ã€å­˜å‚¨æ•°å­—çš„äºŒè¿›åˆ¶ï¼š<br><code>bitset&lt;N&gt; name(num);</code> // å®šä¹‰é•¿åº¦ä¸º N çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œå‘½åä¸º nameï¼Œå°†æ•°å­— num çš„äºŒè¿›åˆ¶å­˜åˆ°å…¶ä¸­ï¼›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">bitset&lt;8&gt; <span class="title">b2</span><span class="params">(<span class="number">12</span>)</span></span>; <span class="comment">//äºŒè¿›åˆ¶é•¿åº¦8ï¼Œå°†12è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­˜åˆ°å…¶ä¸­ã€‚</span></span><br><span class="line">cout &lt;&lt; b2 &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>3ã€å­˜å‚¨ 01å­—ç¬¦ä¸² å¯¹åº”çš„äºŒè¿›åˆ¶ï¼š<br><code>bitset&lt;N&gt; name(string);</code> // å®šä¹‰é•¿åº¦ä¸º N çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œå‘½åä¸º nameï¼Œå°†01ä¸² string å­˜åˆ°å…¶ä¸­ï¼Œ<strong>é•¿åº¦ä¸å¤Ÿå‰è¡¥ 0ï¼Œé•¿åº¦è¿‡é•¿æˆªæ–­</strong>ï¼›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string s = <span class="string">&quot;10010&quot;</span>;</span><br><span class="line"><span class="function">bitset&lt;8&gt; <span class="title">b3</span><span class="params">(s)</span></span>;</span><br><span class="line">cout &lt;&lt; b3 &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p>4ã€å­˜å‚¨ 01å­—ç¬¦æ•°ç»„ ä¸­çš„äºŒè¿›åˆ¶ï¼š<br><code>bitset&lt;N&gt; name(char[]);</code> // å®šä¹‰é•¿åº¦ä¸º N çš„äºŒè¿›åˆ¶æ•°ç»„ï¼Œå‘½åä¸º nameï¼Œå°† 01å­—ç¬¦æ•°ç»„å­˜åˆ°å…¶ä¸­ï¼Œ<strong>é•¿åº¦ä¸å¤Ÿå‰è¡¥0ï¼Œé•¿åº¦è¿‡é•¿æˆªæ–­</strong>ï¼›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> chs[<span class="number">10</span>] = <span class="string">&quot;10010&quot;</span>;</span><br><span class="line"><span class="function">bitset&lt;8&gt; <span class="title">b4</span><span class="params">(chs)</span></span>;</span><br><span class="line">cout &lt;&lt; b4 &lt;&lt; endl;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong><br>ç›´æ¥è¾“å‡º <strong>bitset</strong> ä¸ºæ­£å¸¸çš„äºŒè¿›åˆ¶ï¼Œä½†æ˜¯éå†æ‰€æœ‰ä½ç½®æ¥è¾“å‡ºçš„è¯å°±æ˜¯é€†åºçš„ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">bitset&lt;8&gt; <span class="title">bs</span><span class="params">(<span class="number">13</span>)</span></span>;</span><br><span class="line">cout &lt;&lt; bs &lt;&lt;endl; <span class="comment">//00001101</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++) cout&lt;&lt;bs[i]; <span class="comment">//10110000</span></span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨æ“ä½œï¼š">å¸¸ç”¨æ“ä½œï¼š</h4><p><strong>åƒæ•°å­—ä¸€æ ·è¿›è¡Œ å–æˆ– æˆ–è€… å·¦ç§»å³ç§»ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b2 |= b3; <span class="comment">//ä¸¤ä¸ªäºŒè¿›åˆ¶æ•°å–æˆ–æ“ä½œï¼› </span></span><br><span class="line">b2 &amp;= b3; <span class="comment">//ä¸¤ä¸ªäºŒè¿›åˆ¶æ•°å–ä¸æ“ä½œï¼› </span></span><br><span class="line">b2 ^= b3; <span class="comment">//å–å¼‚æˆ–ï¼›</span></span><br><span class="line">b2 = ~b2; <span class="comment">//å–å; </span></span><br><span class="line">b2 &lt;&lt;= <span class="number">2</span>; <span class="comment">//å·¦ç§»å³ç§»ï¼›è‡ªå¸¦å‡½æ•°ï¼š</span></span><br></pre></td></tr></table></figure><p><strong>è‡ªå¸¦å‡½æ•°ï¼š</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> cnt_1 = b2.<span class="built_in">count</span>(); <span class="comment">//æŸ¥è¯¢äºŒè¿›åˆ¶æ•°ç»„ä¸­ï¼Œ1çš„ä¸ªæ•°ï¼›</span></span><br><span class="line"><span class="type">int</span> len  = b2.<span class="built_in">size</span>(); <span class="comment">//äºŒè¿›åˆ¶æ•°ç»„çš„é•¿åº¦ï¼Œå°±æ˜¯å®šä¹‰çš„é•¿åº¦ï¼› </span></span><br><span class="line"><span class="type">int</span> test = b2.<span class="built_in">test</span>(<span class="number">7</span>); <span class="comment">//åˆ¤æ–­ç¬¬xä¸ªä½ç½®æ˜¯0è¿˜æ˜¯1ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºç¬¬xä¸ªä½ç½®ï¼Œæ³¨æ„é€†åºï¼›</span></span><br><span class="line"></span><br><span class="line">b2.<span class="built_in">flip</span>(); <span class="comment">//å°†äºŒè¿›åˆ¶æ¯ä¸€ä½å–åï¼›</span></span><br><span class="line">b2.<span class="built_in">flip</span>(<span class="number">3</span>); <span class="comment">//å°†äºŒè¿›åˆ¶ç¬¬xä½å–åï¼›</span></span><br><span class="line">b2.<span class="built_in">set</span>(); <span class="comment">//å°†äºŒè¿›åˆ¶æ¯ä¸€ä½ç½®ä¸º1ï¼› resetç½®ä¸º0ï¼› </span></span><br><span class="line">b2.<span class="built_in">set</span>(<span class="number">3</span>); <span class="comment">//å°†ç¬¬xä¸ªä½ç½®ç½®ä¸º1ï¼›</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨æ“ä½œ:</strong></p><p><strong>string ss = b2.to_string(); //å°†äºŒè¿›åˆ¶æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸².</strong></p><h2 id="ä»£ç å®ç°">ä»£ç å®ç°:</h2><p><strong>main.c</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DATA data,data1;</span><br><span class="line">    <span class="type">int</span> choose;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;é€‰æ‹©ä½ æƒ³ä½¿ç”¨çš„åŠŸèƒ½(è¯·ç¡®ä¿è¿›è¡Œæ“ä½œçš„æ–‡ä»¶è·¯å¾„å­˜åœ¨):&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*****1.   ç¼–ç    *****&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*****2.   è§£ç    *****&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*****3.åˆ›å»ºç¼–ç æ–‡ä»¶*****&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;*****4.åˆ›å»ºè§£ç æ–‡ä»¶*****&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin &gt;&gt; choose;</span><br><span class="line">    <span class="keyword">switch</span>(choose)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">inFile</span>(data);</span><br><span class="line">            <span class="built_in">transform_2_string</span>(data);</span><br><span class="line">            <span class="built_in">encode_number</span>(data);</span><br><span class="line">            <span class="built_in">transform_string_10</span>(data);</span><br><span class="line">            <span class="built_in">output_encode</span>(data);</span><br><span class="line">            <span class="built_in">outFile_encode</span>(data);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">inFile</span>(data1);</span><br><span class="line">            <span class="built_in">decode_2_string</span>(data1);</span><br><span class="line">            <span class="built_in">decode_number</span>(data1);</span><br><span class="line">            <span class="built_in">decode_string_10</span>(data1);</span><br><span class="line">            <span class="built_in">output_decode</span>(data1);</span><br><span class="line">            <span class="built_in">outFile_decode</span>(data1);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">Input_encode</span>(data);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">            <span class="built_in">Input_decode</span>(data1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>main.h</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">// Created by æŸ¯ç§‹è¿ª on 2022/11/29.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> UNTITLED2_MAIN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNTITLED2_MAIN_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DATA</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> aci[<span class="number">64</span>]=&#123;<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;I&#x27;</span>,<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;K&#x27;</span>,<span class="string">&#x27;L&#x27;</span>,<span class="string">&#x27;M&#x27;</span>,<span class="string">&#x27;N&#x27;</span>,<span class="string">&#x27;O&#x27;</span>,<span class="string">&#x27;P&#x27;</span>,<span class="string">&#x27;Q&#x27;</span>,<span class="string">&#x27;R&#x27;</span>,<span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;U&#x27;</span>,<span class="string">&#x27;V&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;Z&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;/&#x27;</span>&#125;;<span class="comment">//æ˜ å°„è¡¨</span></span><br><span class="line">    string input;</span><br><span class="line">    string trans_input;</span><br><span class="line">    string a[<span class="number">100</span>];</span><br><span class="line">    <span class="type">int</span> b[<span class="number">100</span>];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">transform_2_string</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encode_number</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">transform_string_10</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">output_encode</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decode_2_string</span><span class="params">(DATA &amp;data1)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decode_number</span><span class="params">(DATA &amp;data1)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decode_string_10</span><span class="params">(DATA &amp;data1)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">output_decode</span><span class="params">(DATA &amp;data1)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">inFile</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">outFile_decode</span><span class="params">(DATA &amp;data1)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">outFile_encode</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Input_encode</span><span class="params">(DATA &amp;data)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Input_decode</span><span class="params">(DATA &amp;data1)</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">//UNTITLED2_MAIN_H</span></span></span><br></pre></td></tr></table></figure><p><strong>define.c</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by æŸ¯ç§‹è¿ª on 2022/11/29.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;main.h&quot;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> num;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">transform_2_string</span><span class="params">(DATA &amp;data)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;data.input.<span class="built_in">size</span>();i++) &#123;</span><br><span class="line">        bitset&lt;8&gt;<span class="built_in">bs</span>(data.input[i]);<span class="comment">//å°†æ•°æ®è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å‚¨å­˜åœ¨bsä¸­</span></span><br><span class="line">        data.trans_input+=bs.<span class="built_in">to_string</span>();<span class="comment">//å°†bsä¸­çš„æ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encode_number</span><span class="params">(DATA &amp;data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(data.trans_input.<span class="built_in">size</span>()%<span class="number">24</span>==<span class="number">0</span>) &#123;<span class="comment">//æ¯ä¸€ç»„å®Œå…¨å æ»¡çš„æƒ…å†µ</span></span><br><span class="line">        num = data.trans_input.<span class="built_in">size</span>() / <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (; j &lt; data.trans_input.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                data.a[i] += data.trans_input[j];</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((j + <span class="number">1</span>) % <span class="number">6</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                        j++;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;<span class="comment">//ä¸å®Œå…¨å æ»¡çš„æƒ…å†µ</span></span><br><span class="line">        num = (data.trans_input.<span class="built_in">size</span>() / <span class="number">24</span>);</span><br><span class="line">        <span class="keyword">if</span>(num==<span class="number">0</span>)</span><br><span class="line">            num=<span class="number">4</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            num=<span class="number">4</span>*((data.trans_input.<span class="built_in">size</span>()/<span class="number">24</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;num;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(;j&lt;data.trans_input.<span class="built_in">size</span>();j++)</span><br><span class="line">            &#123;</span><br><span class="line">                data.a[i]+=data.trans_input[j];</span><br><span class="line">                <span class="keyword">if</span>(j&gt;=<span class="number">5</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>((j+<span class="number">1</span>)%<span class="number">6</span>==<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        j++;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (data.a[i].<span class="built_in">size</span>() &lt; <span class="number">6</span>) &#123;</span><br><span class="line">            <span class="type">size_t</span> n = data.a[i].<span class="built_in">size</span>();<span class="comment">//size()çš„è¿”å›å€¼ä¸ºsize_t/unsigned intç±»å‹,ç”¨intå‹æ¥æ”¶è¿”å›å€¼ä¼šè­¦å‘Š,è¿”å›å€¼ä¸ºæ­£æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (!data.a[i].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span> - n; k++) &#123;</span><br><span class="line">                    data.a[i].<span class="built_in">push_back</span>(<span class="string">&#x27;0&#x27;</span>);<span class="comment">//ä¸èƒ½ç”¨0,0æ˜¯æ•°å€¼æ— æ³•åŠ åˆ°å­—ç¬¦ä¸²åé¢ï¼Œ0ä¸æ˜¯å­—ç¬¦&#x27;0&#x27;æ‰æ˜¯ï¼Œ&#x27;0&#x27;å¯åŠ åˆ°åé¢</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">0</span>; m &lt; <span class="number">6</span>; m++)</span><br><span class="line">                &#123;</span><br><span class="line">                    data.a[i].<span class="built_in">push_back</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">transform_string_10</span><span class="params">(DATA &amp;data)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(data.a[i]!=<span class="string">&quot;000000&quot;</span>) &#123;</span><br><span class="line">            <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">            <span class="type">double</span> sum=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> ( <span class="type">int</span> j = data.a[i].<span class="built_in">size</span>() - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                sum += (data.a[i][l] - <span class="number">48</span>) * <span class="built_in">pow</span>(<span class="number">2</span>, j);<span class="comment">//</span></span><br><span class="line">                l++;<span class="comment">// å­—ç¬¦æ•°å­—è½¬æ•°å€¼</span></span><br><span class="line">            &#125;</span><br><span class="line">            data.b[i] = (<span class="type">int</span>)sum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            data.b[i]=<span class="number">64</span>;<span class="comment">//å¯¹ç­‰å·çš„å•ç‹¬å¤„ç†</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">output_encode</span><span class="params">(DATA&amp; data)</span> </span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;ç¼–ç åä¸º:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; j &lt; <span class="number">64</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data.b[i] == j) &#123;</span><br><span class="line">                cout &lt;&lt; data.aci[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">64</span>)<span class="comment">//ä¸ä¸Šæ–¹ä»¤å…¶ä¸º64å‘¼åº”</span></span><br><span class="line">            cout&lt;&lt;<span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decode_2_string</span><span class="params">(DATA &amp;data1)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> n=<span class="number">0</span>;n&lt;data1.input.<span class="built_in">size</span>();n++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">0</span>; m &lt; <span class="number">64</span>; m++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (data1.input[n] == data1.aci[m]) &#123;</span><br><span class="line">                    data1.input[n]=(<span class="type">char</span>)m;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;  <span class="comment">//å…ˆå°†éœ€è¦è§£ç çš„å­—ç¬¦å˜ä¸ºbase64ä¸­åŒ¹é…çš„aciç </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; data1.input.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(data1.input[i]!=<span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">        <span class="function">bitset&lt;6&gt; <span class="title">bs</span><span class="params">(data1.input[i])</span></span>;</span><br><span class="line">        data1.trans_input += bs.<span class="built_in">to_string</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decode_number</span><span class="params">(DATA &amp;data1)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (data1.trans_input.<span class="built_in">size</span>() % <span class="number">8</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        num = data1.trans_input.<span class="built_in">size</span>() / <span class="number">8</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        num = (data1.trans_input.<span class="built_in">size</span>() / <span class="number">8</span>) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (; j &lt; data1.trans_input.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">            data1.a[i] += data1.trans_input[j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((j + <span class="number">1</span>) % <span class="number">8</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                    j++;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (data1.a[i].<span class="built_in">size</span>() &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="type">size_t</span> k = <span class="number">8</span> - data1.a[i].<span class="built_in">size</span>();<span class="comment">//è¡¥é½8ä½</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> m = <span class="number">0</span>; m &lt; k; m++)</span><br><span class="line">                data1.a[i].<span class="built_in">push_back</span>(<span class="string">&#x27;0&#x27;</span>);<span class="comment">//æ³¨æ„ä¸è¦å†™æˆ0äº†ï¼Œ0ä¸ºæ•°å€¼ä¸èƒ½æ·»åŠ åˆ°å­—ç¬¦ä¸²åé¢ï¼Œåº”ä¸º&#x27;0&#x27;æ˜¯å­—ç¬¦æ‰èƒ½æ”¾åˆ°å­—ç¬¦ä¸²çš„åé¢</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decode_string_10</span><span class="params">(DATA &amp;data1)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;num;i++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (data1.a[i] != <span class="string">&quot;000000&quot;</span>) &#123;<span class="comment">//ä¸º=æ—¶å°±ä¼šå…¨ä¸º0ï¼Œå½“å…¨ä¸º0æ—¶ä¸ä¼šè½¬æ¢</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">                <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">                <span class="type">double</span> sum = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = data1.a[i].<span class="built_in">size</span>() - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--, l++) &#123;</span><br><span class="line">                    sum += (data1.a[i][l] - <span class="number">48</span>) * <span class="built_in">pow</span>(<span class="number">2</span>, k);<span class="comment">// å­—ç¬¦æ•°å­—è½¬æ•°å€¼</span></span><br><span class="line">                &#125;</span><br><span class="line">                data1.b[i] = (<span class="type">int</span>) sum;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            data1.b[i]=<span class="number">64</span>;<span class="comment">//å¯¹ç­‰å·çš„å¤„ç†é˜²æ­¢å‡ºç°å¥‡æ€ªçš„å­—ç¬¦</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">output_decode</span><span class="params">(DATA &amp;data1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è§£ç åä¸º:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(data1.b[i]!=<span class="number">64</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,data1.b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">inFile</span><span class="params">(DATA &amp;data)</span></span>&#123;</span><br><span class="line">    string encode_txt;</span><br><span class="line">    cout &lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–‡ä»¶è·¯å¾„:&quot;</span>;</span><br><span class="line">    cin &gt;&gt; encode_txt;</span><br><span class="line">    ifstream inFile;</span><br><span class="line">    inFile.<span class="built_in">open</span>(encode_txt,ios::in);<span class="comment">//åªè¯»æ¨¡å¼æ‰“å¼€</span></span><br><span class="line">    <span class="keyword">if</span>(!inFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ‰¾ä¸åˆ°éœ€è¦ç¼–ç çš„æ–‡ä»¶,ç¨‹åºå·²è‡ªåŠ¨ç»“æŸ&quot;</span>;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    inFile &gt;&gt; data.input;</span><br><span class="line">    inFile.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">outFile_decode</span><span class="params">(DATA &amp;data1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string encode_txt;</span><br><span class="line">    cout &lt;&lt;<span class="string">&quot;è¯·è¾“å…¥ä¿å­˜ç»“æœçš„æ–‡ä»¶è·¯å¾„:&quot;</span>;</span><br><span class="line">    cin &gt;&gt; encode_txt;</span><br><span class="line">    ofstream outFile;</span><br><span class="line">    outFile.<span class="built_in">open</span>(encode_txt);</span><br><span class="line">    <span class="keyword">if</span>(!outFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶ä¿å­˜å¤±è´¥&quot;</span>;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;num;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(data1.b[i]!=<span class="number">64</span>)</span><br><span class="line">            outFile &lt;&lt; (<span class="type">char</span>)data1.b[i];</span><br><span class="line">    &#125;</span><br><span class="line">   outFile.<span class="built_in">close</span>();</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶ä¿å­˜æˆåŠŸ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">outFile_encode</span><span class="params">(DATA &amp;data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string encode_txt;</span><br><span class="line">    cout &lt;&lt;<span class="string">&quot;è¯·è¾“å…¥ä¿å­˜ç»“æœçš„æ–‡ä»¶è·¯å¾„:&quot;</span>;</span><br><span class="line">    cin &gt;&gt; encode_txt;</span><br><span class="line">    ofstream outFile;</span><br><span class="line">    outFile.<span class="built_in">open</span>(encode_txt);</span><br><span class="line">    <span class="keyword">if</span>(!outFile.<span class="built_in">is_open</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ–‡ä»¶ä¿å­˜å¤±è´¥&quot;</span>;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="type">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; j &lt; <span class="number">64</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (data.b[i] == j) &#123;</span><br><span class="line">                cout &lt;&lt; data.aci[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">64</span>)<span class="comment">//ä¸ä¸Šæ–¹ä»¤å…¶ä¸º64å‘¼åº”</span></span><br><span class="line">            outFile&lt;&lt;<span class="string">&#x27;=&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Input_encode</span><span class="params">(DATA &amp;data)</span> </span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥ç¼–ç å†…å®¹:&quot;</span>;</span><br><span class="line">    cin.<span class="built_in">get</span>();<span class="comment">//å¸æ”¶å›è½¦;</span></span><br><span class="line">    <span class="built_in">getline</span>(cin,data.input);<span class="comment">//æ­¤å¤„ä¸ç”¨cinï¼Œå¦åˆ™ä¼šé€ æˆæœ‰ç©ºæ ¼çš„æ—¶å€™ï¼Œä¼šè¢«æˆªæ–­,ä¸‹åŒ</span></span><br><span class="line">    <span class="built_in">transform_2_string</span>(data);</span><br><span class="line">    <span class="built_in">encode_number</span>(data);</span><br><span class="line">    <span class="built_in">transform_string_10</span>(data);</span><br><span class="line">    <span class="built_in">output_encode</span>(data);</span><br><span class="line">    <span class="built_in">outFile_encode</span>(data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">Input_decode</span><span class="params">(DATA &amp;data1)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è§£ç å†…å®¹:&quot;</span>;</span><br><span class="line">    cin.<span class="built_in">get</span>();<span class="comment">//å¸æ”¶å›è½¦;</span></span><br><span class="line">    <span class="built_in">getline</span>(cin,data1.input);</span><br><span class="line">    <span class="built_in">decode_2_string</span>(data1);</span><br><span class="line">    <span class="built_in">decode_number</span>(data1);</span><br><span class="line">    <span class="built_in">decode_string_10</span>(data1);</span><br><span class="line">    <span class="built_in">output_decode</span>(data1);</span><br><span class="line">    <span class="built_in">outFile_decode</span>(data1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å››ä¸ªç‰ˆæœ¬çš„å­¦ç”Ÿç®¡ç†ç¨‹åº</summary>
    
    
    
    <category term="C++" scheme="https://keqiudi.github.io/categories/C/"/>
    
    
    <category term="C++" scheme="https://keqiudi.github.io/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Markdownè¯­æ³•ä¸å¤–æŒ‚æ ‡ç­¾å†™æ³•æ±‡æ€»</title>
    <link href="https://keqiudi.github.io/posts/2013454d.html"/>
    <id>https://keqiudi.github.io/posts/2013454d.html</id>
    <published>2022-08-09T10:19:03.000Z</published>
    <updated>2022-10-23T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1>1.Markdownè¯­æ³•è‡ªå¸¦æ ¼å¼</h1><div class="note info flat"><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdownè¯­æ³•å›¾æ–‡å…¨é¢è¯¦è§£(10åˆ†é’Ÿå­¦ä¼š)</a></p></div><div class="note warning flat"><p>æ³¨æ„ï¼šæ­¤é¡µé¢å¶å°”ä¼šå­˜åœ¨CSSå†²çªé—®é¢˜!</p></div><h2 id="1-1-ä»£ç å—">1.1 ä»£ç å—</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCodeç»ˆç«¯</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmderç»ˆç«¯</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCodeç»ˆç«¯</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmderç»ˆç«¯</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-2-å¤šçº§æ ‡é¢˜">1.2 å¤šçº§æ ‡é¢˜</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>è§æœ¬æ–‡ç« æ ‡é¢˜!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-3-æ–‡å­—æ ·å¼">1.3 æ–‡å­—æ ·å¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>ä¸‹åˆ’çº¿æ¼”ç¤º<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">æ–‡å­—<span class="strong">**åŠ ç²—**</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡å­—<span class="emphasis">*æ–œä½“*</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡æœ¬<span class="code">`é«˜äº®`</span>æ¼”ç¤º</span><br><span class="line"></span><br><span class="line">æ–‡æœ¬~~åˆ é™¤~~çº¿æ¼”ç¤º</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5å·å­—<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;é»‘ä½“&quot;</span>&gt;</span></span>é»‘ä½“<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>è“è‰²<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šMistyRosenï¼Œæ­¤å¤„è¾“å…¥ä»»æ„æƒ³è¾“å…¥çš„å†…å®¹<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p><u>ä¸‹åˆ’çº¿æ¼”ç¤º</u></p><p>æ–‡å­—<strong>åŠ ç²—</strong>æ¼”ç¤º</p><p>æ–‡å­—<em>æ–œä½“</em>æ¼”ç¤º</p><p>æ–‡æœ¬<code>é«˜äº®</code>æ¼”ç¤º</p><p>æ–‡æœ¬<s>åˆ é™¤</s>çº¿æ¼”ç¤º</p><p><font size = 5>5å·å­—</font><br><font face="é»‘ä½“">é»‘ä½“</font><br><font color=blue>è“è‰²</font></p><table><tr><td bgcolor=MistyRose>è¿™é‡Œçš„èƒŒæ™¯è‰²æ˜¯ï¼šMistyRosenï¼Œæ­¤å¤„è¾“å…¥ä»»æ„æƒ³è¾“å…¥çš„å†…å®¹</td></tr></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info flat"><p>ä¸Šè¿°è¦ç‚¹å¯å‚è€ƒ:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">ã€Markdownè¯­æ³•ã€‘å­—ä½“é¢œè‰²å¤§å°åŠæ–‡å­—åº•è‰²è®¾ç½®</a></p></div><h2 id="1-4-å¼•ç”¨">1.4 å¼•ç”¨</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; äºŒçº§å¼•ç”¨æ¼”ç¤º</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;å¤–é”®</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;äº‹åŠ¡</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**è¡Œçº§é”**</span>(å¼•ç”¨å†…éƒ¨ä¸€æ ·å¯ä»¥ç”¨æ ¼å¼)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><blockquote><p>Java<br>äºŒçº§å¼•ç”¨æ¼”ç¤º<br>MySQL</p><blockquote><p>å¤–é”®</p><p>äº‹åŠ¡</p><p><strong>è¡Œçº§é”</strong>(å¼•ç”¨å†…éƒ¨ä¸€æ ·å¯ä»¥ç”¨æ ¼å¼)</p></blockquote><p>â€¦</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-5-åˆ†å‰²çº¿">1.5 åˆ†å‰²çº¿</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><hr><hr><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-6-åˆ—è¡¨-è·Ÿç©ºæ ¼éƒ½å¯ä»¥">1.6 åˆ—è¡¨(*,+,-è·Ÿç©ºæ ¼éƒ½å¯ä»¥)</h2><h3 id="1-6-1-æ— åºåˆ—è¡¨">1.6.1 æ— åºåˆ—è¡¨</h3><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><ul><li>Java</li><li>Python</li><li>â€¦</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="1-6-2-æœ‰åºåˆ—è¡¨">1.6.2 æœ‰åºåˆ—è¡¨</h3><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># æ³¨æ„åé¢æœ‰ç©ºæ ¼</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li></li><li></li><li></li><li></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-7-å›¾ç‰‡">1.7 å›¾ç‰‡</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># æœ¬åœ°å›¾ç‰‡</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾ç‰‡&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># åœ¨çº¿å›¾ç‰‡</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>æœ¬åœ°å›¾ç‰‡:<br><img src="/assets/pusheencode.webp" alt="ç¤ºä¾‹å›¾ç‰‡" style="zoom:50%;" /><br>åœ¨çº¿å›¾ç‰‡:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-8-è¡¨æ ¼">1.8 è¡¨æ ¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| é¡¹ç›®æ ‡å· | èµ„é‡‘     | å¤‡æ³¨ |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100ï¼Œ000 | æ—    |</span><br><span class="line">| 2        | 200ï¼Œ000 | æ—    |</span><br><span class="line">| 3        | 300,600  | é‡è¦ |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><table><thead><tr><th>é¡¹ç›®æ ‡å·</th><th>èµ„é‡‘</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>1</td><td>100ï¼Œ000</td><td>æ— </td></tr><tr><td>2</td><td>200ï¼Œ000</td><td>æ— </td></tr><tr><td>3</td><td>300,600</td><td>é‡è¦</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-9-å…¬å¼">1.9 å…¬å¼</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>$$<br>\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt.<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>2.Butterflyå¤–æŒ‚æ ‡ç­¾</h1><div class="note info flat"><p>è¿™éƒ¨åˆ†å‚è€ƒå®‰çŸ¥é±¼:<a href="https://anzhiy.cn/posts/7d58.html">åŸºäºButterflyçš„å¤–æŒ‚æ ‡ç­¾å¼•å…¥</a></p></div><h2 id="2-1-è¡Œå†…æ–‡æœ¬æ ·å¼-text">2.1 è¡Œå†…æ–‡æœ¬æ ·å¼ text</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% emp æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% wavy æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% del æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% kbd æ–‡æœ¬å†…å®¹ %&#125;</span><br><span class="line">&#123;% psw æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> å¸¦ &#123;% u ä¸‹åˆ’çº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">2.</span> å¸¦ &#123;% emp ç€é‡å· %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">3.</span> å¸¦ &#123;% wavy æ³¢æµªçº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">4.</span> å¸¦ &#123;% del åˆ é™¤çº¿ %&#125; çš„æ–‡æœ¬</span><br><span class="line"><span class="bullet">5.</span> é”®ç›˜æ ·å¼çš„æ–‡æœ¬ &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š&#123;% psw è¿™é‡Œæ²¡æœ‰éªŒè¯ç  %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><ol><li>å¸¦ <u>ä¸‹åˆ’çº¿</u> çš„æ–‡æœ¬</li><li>å¸¦ <emp>ç€é‡å·</emp> çš„æ–‡æœ¬</li><li>å¸¦ <wavy>æ³¢æµªçº¿</wavy> çš„æ–‡æœ¬</li><li>å¸¦ <del>åˆ é™¤çº¿</del> çš„æ–‡æœ¬</li><li>é”®ç›˜æ ·å¼çš„æ–‡æœ¬ <kbd>command</kbd> + <kbd>D</kbd></li><li>å¯†ç æ ·å¼çš„æ–‡æœ¬ï¼š<psw>è¿™é‡Œæ²¡æœ‰éªŒè¯ç </psw></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-2-è¡Œå†…æ–‡æœ¬-span">2.2 è¡Œå†…æ–‡æœ¬ span</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span æ ·å¼å‚æ•°(å‚æ•°ä»¥ç©ºæ ¼åˆ’åˆ†), æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å­—ä½“</code>: logo, code</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>å¤§å°</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>å¯¹é½æ–¹å‘</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> å½©è‰²æ–‡å­—</span><br><span class="line">åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% span red, çº¢è‰² %&#125;ã€&#123;% span yellow, é»„è‰² %&#125;ã€&#123;% span green, ç»¿è‰² %&#125;ã€&#123;% span cyan, é’è‰² %&#125;ã€&#123;% span blue, è“è‰² %&#125;ã€&#123;% span gray, ç°è‰² %&#125;ã€‚</span><br><span class="line"><span class="bullet">-</span> è¶…å¤§å·æ–‡å­—</span><br><span class="line">æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><ul><li>å½©è‰²æ–‡å­—<br>åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š<span class='p red'>çº¢è‰²</span>ã€<span class='p yellow'>é»„è‰²</span>ã€<span class='p green'>ç»¿è‰²</span>ã€<span class='p cyan'>é’è‰²</span>ã€<span class='p blue'>è“è‰²</span>ã€<span class='p gray'>ç°è‰²</span>ã€‚</li><li>è¶…å¤§å·æ–‡å­—<br>æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-3-æ®µè½æ–‡æœ¬-p">2.3 æ®µè½æ–‡æœ¬ p</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% p æ ·å¼å‚æ•°(å‚æ•°ä»¥ç©ºæ ¼åˆ’åˆ†), æ–‡æœ¬å†…å®¹ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å­—ä½“</code>: logo, code</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>å¤§å°</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>å¯¹é½æ–¹å‘</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> å½©è‰²æ–‡å­—</span><br><span class="line">åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š&#123;% p red, çº¢è‰² %&#125;ã€&#123;% p yellow, é»„è‰² %&#125;ã€&#123;% p green, ç»¿è‰² %&#125;ã€&#123;% p cyan, é’è‰² %&#125;ã€&#123;% p blue, è“è‰² %&#125;ã€&#123;% p gray, ç°è‰² %&#125;ã€‚</span><br><span class="line"><span class="bullet">-</span> è¶…å¤§å·æ–‡å­—</span><br><span class="line">æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><ul><li>å½©è‰²æ–‡å­—<br>åœ¨ä¸€æ®µè¯ä¸­æ–¹ä¾¿æ’å…¥å„ç§é¢œè‰²çš„æ ‡ç­¾ï¼ŒåŒ…æ‹¬ï¼š<p class='p red'>çº¢è‰²</p>ã€<p class='p yellow'>é»„è‰²</p>ã€<p class='p green'>ç»¿è‰²</p>ã€<p class='p cyan'>é’è‰²</p>ã€<p class='p blue'>è“è‰²</p>ã€<p class='p gray'>ç°è‰²</p>ã€‚</li><li>è¶…å¤§å·æ–‡å­—<br>æ–‡æ¡£ã€Œå¼€å§‹ã€é¡µé¢ä¸­çš„æ ‡é¢˜éƒ¨åˆ†å°±æ˜¯è¶…å¤§å·æ–‡å­—ã€‚</li></ul><p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-4-å¼•ç”¨note">2.4 å¼•ç”¨note</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">é€šç”¨é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">è¯­æ³•æ ¼å¼</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -5">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># è‡ªå¸¦icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># å¤–éƒ¨icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.è‡ªå¸¦icon</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç”¨æ³•</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">ã€å¯é€‰ã€‘æ ‡è¯†ï¼Œä¸åŒçš„æ ‡è¯†æœ‰ä¸åŒçš„é…è‰² ï¼ˆ default / primary / success / info / warning / danger ï¼‰</td></tr><tr><td>no-icon</td><td style="text-align:center">ã€å¯é€‰ã€‘ä¸æ˜¾ç¤º icon</td></tr><tr><td>style</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯ä»¥è¦†ç›–é…ç½®ä¸­çš„ style ï¼ˆsimple/modern/flat/disabledï¼‰</td></tr></tbody></table><p>2.å¤–éƒ¨icon</p><table><thead><tr><th>å‚æ•°</th><th style="text-align:center">ç”¨æ³•</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">ã€å¯é€‰ã€‘æ ‡è¯†ï¼Œä¸åŒçš„æ ‡è¯†æœ‰ä¸åŒçš„é…è‰² ï¼ˆ default / blue / pink / red / purple / orange / green ï¼‰</td></tr><tr><td>no-icon</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯é…ç½®è‡ªå®šä¹‰ icon (åªæ”¯æŒ fontawesome å›¾æ ‡, ä¹Ÿå¯ä»¥é…ç½® no-icon )</td></tr><tr><td>style</td><td style="text-align:center">ã€å¯é€‰ã€‘å¯ä»¥è¦†ç›–é…ç½®ä¸­çš„ style ï¼ˆsimple/modern/flat/disabledï¼‰</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><details class="folding-tag" blue><summary> 1.è‡ªå¸¦icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;é»˜è®¤ æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger æç¤ºå—æ ‡ç­¾&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.å¤–éƒ¨icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>æ ·å¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021å¹´å¿«åˆ°äº†....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;å‰ªåˆ€çŸ³å¤´å¸ƒ&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -5"><details class="folding-tag" blue><summary> 1.è‡ªå¸¦icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><div class="note simple"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default simple"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary simple"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success simple"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info simple"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning simple"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger simple"><p>danger æç¤ºå—æ ‡ç­¾</p></div>2.`modern`æ ·å¼<div class="note modern"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default modern"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary modern"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success modern"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info modern"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning modern"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger modern"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>3.<code>flat</code>æ ·å¼</p><div class="note flat"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default flat"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary flat"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success flat"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info flat"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning flat"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger flat"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>4.<code>disabled</code>æ ·å¼</p><div class="note disabled"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default disabled"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary disabled"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success disabled"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info disabled"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning disabled"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger disabled"><p>danger æç¤ºå—æ ‡ç­¾</p></div><p>5.<code>no-icon</code>æ ·å¼</p><div class="note no-icon flat"><p>é»˜è®¤ æç¤ºå—æ ‡ç­¾</p></div><div class="note default no-icon flat"><p>default æç¤ºå—æ ‡ç­¾</p></div><div class="note primary no-icon flat"><p>primary æç¤ºå—æ ‡ç­¾</p></div><div class="note success no-icon flat"><p>success æç¤ºå—æ ‡ç­¾</p></div><div class="note info no-icon flat"><p>info æç¤ºå—æ ‡ç­¾</p></div><div class="note warning no-icon flat"><p>warning æç¤ºå—æ ‡ç­¾</p></div><div class="note danger no-icon flat"><p>danger æç¤ºå—æ ‡ç­¾</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.å¤–éƒ¨icon </summary>              <div class='content'>              <p>1.<code>simple</code>æ ·å¼</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>2.<code>modern</code>æ ·å¼</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>3.<code>flat</code>æ ·å¼</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>4.<code>disabled</code>æ ·å¼</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div><p>5.<code>no-icon</code>æ ·å¼</p><div class="note no-icon flat"><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note blue no-icon flat"><p>2021å¹´å¿«åˆ°äº†â€¦</p></div><div class="note pink no-icon flat"><p>å°å¿ƒå¼€è½¦ å®‰å…¨è‡³ä¸Š</p></div><div class="note red no-icon flat"><p>è¿™æ˜¯ä¸‰ç‰‡å‘¢ï¼Ÿè¿˜æ˜¯å››ç‰‡ï¼Ÿ</p></div><div class="note orange no-icon flat"><p>ä½ æ˜¯åˆ· Visa è¿˜æ˜¯ UnionPay</p></div><div class="note purple no-icon flat"><p>å‰ªåˆ€çŸ³å¤´å¸ƒ</p></div><div class="note green no-icon flat"><p>å‰ç«¯æœ€è®¨åŒçš„æµè§ˆå™¨</p></div>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-5-ä¸Šæ ‡æ ‡ç­¾-tip">2.5 ä¸Šæ ‡æ ‡ç­¾ tip</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [å‚æ•°ï¼Œå¯é€‰] %&#125;æ–‡æœ¬å†…å®¹&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ ·å¼</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>è‡ªå®šä¹‰å›¾æ ‡</code>: æ”¯æŒfontawesomeã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;è‡ªå®šä¹‰font awesomeå›¾æ ‡&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>è‡ªå®šä¹‰font awesomeå›¾æ ‡</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-6-åŠ¨æ€æ ‡ç­¾-anima">2.6 åŠ¨æ€æ ‡ç­¾ anima</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [å‚æ•°ï¼Œå¯é€‰] %&#125;æ–‡æœ¬å†…å®¹&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><div class="note info flat"><ol><li>å°†æ‰€éœ€çš„CSSç±»æ·»åŠ åˆ°å›¾æ ‡ï¼ˆæˆ–DOMä¸­çš„ä»»ä½•å…ƒç´ ï¼‰ã€‚</li><li>å¯¹äºçˆ¶çº§æ‚¬åœæ ·å¼ï¼Œéœ€è¦ç»™ç›®æ ‡å…ƒç´ æ·»åŠ æŒ‡å®šCSSç±»ï¼ŒåŒæ—¶è¿˜è¦ç»™ç›®æ ‡å…ƒç´ çš„çˆ¶çº§å…ƒç´ æ·»åŠ CSSç±»<code>faa-parent animated-hover</code>ã€‚ï¼ˆè¯¦æƒ…è§ç¤ºä¾‹åŠç¤ºä¾‹æºç ï¼‰<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>å¯ä»¥é€šè¿‡ç»™ç›®æ ‡å…ƒç´ æ·»åŠ CSSç±»<code>faa-fast</code>æˆ–<code>faa-slow</code>æ¥æ§åˆ¶åŠ¨ç”»å¿«æ…¢ã€‚</li></ol></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.On DOM loadï¼ˆå½“é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.è°ƒæ•´åŠ¨ç”»é€Ÿåº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>3.On hoverï¼ˆå½“é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>4.On parent hoverï¼ˆå½“é¼ æ ‡æ‚¬åœåœ¨çˆ¶çº§å…ƒç´ æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.On DOM loadï¼ˆå½“é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.è°ƒæ•´åŠ¨ç”»é€Ÿåº¦<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hoverï¼ˆå½“é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hoverï¼ˆå½“é¼ æ ‡æ‚¬åœåœ¨çˆ¶çº§å…ƒç´ æ—¶æ˜¾ç¤ºåŠ¨ç”»ï¼‰<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-7-å¤é€‰åˆ—è¡¨-checkbox">2.7 å¤é€‰åˆ—è¡¨ checkbox</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ ·å¼</code>: plus, minus, times</li><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>é€‰ä¸­çŠ¶æ€</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox çº¯æ–‡æœ¬æµ‹è¯• %&#125;</span><br><span class="line">&#123;% checkbox checked, æ”¯æŒç®€å•çš„ [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) è¯­æ³• %&#125;</span><br><span class="line">&#123;% checkbox red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;</span><br><span class="line">&#123;% checkbox green checked, ç»¿è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, é»„è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, é’è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox blue checked, è“è‰² + é»˜è®¤é€‰ä¸­ %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, å¢åŠ  %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, å‡å°‘ %&#125;</span><br><span class="line">&#123;% checkbox times red checked, å‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class='checkbox'><input type="checkbox" />            <p>çº¯æ–‡æœ¬æµ‹è¯•</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>æ”¯æŒç®€å•çš„ <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> è¯­æ³•</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>ç»¿è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>é»„è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>é’è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>è“è‰² + é»˜è®¤é€‰ä¸­</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>å¢åŠ </p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>å‡å°‘</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>å‰</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-8-å•é€‰åˆ—è¡¨-radio">2.8 å•é€‰åˆ—è¡¨ radio</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio æ ·å¼å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ–‡æœ¬ï¼ˆæ”¯æŒç®€å•mdï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>é¢œè‰²</code>: red,yellow,green,cyan,blue,gray</li><li><code>é€‰ä¸­çŠ¶æ€</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio çº¯æ–‡æœ¬æµ‹è¯• %&#125;</span><br><span class="line">&#123;% radio checked, æ”¯æŒç®€å•çš„ [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) è¯­æ³• %&#125;</span><br><span class="line">&#123;% radio red, æ”¯æŒè‡ªå®šä¹‰é¢œè‰² %&#125;</span><br><span class="line">&#123;% radio green, ç»¿è‰² %&#125;</span><br><span class="line">&#123;% radio yellow, é»„è‰² %&#125;</span><br><span class="line">&#123;% radio cyan, é’è‰² %&#125;</span><br><span class="line">&#123;% radio blue, è“è‰² %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class='checkbox'><input type="radio" />            <p>çº¯æ–‡æœ¬æµ‹è¯•</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>æ”¯æŒç®€å•çš„ <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> è¯­æ³•</p>            </div><div class='checkbox red'><input type="radio" />            <p>æ”¯æŒè‡ªå®šä¹‰é¢œè‰²</p>            </div><div class='checkbox green'><input type="radio" />            <p>ç»¿è‰²</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>é»„è‰²</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>é’è‰²</p>            </div><div class='checkbox blue'><input type="radio" />            <p>è“è‰²</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-9-æ—¶é—´è½´-timeline">2.9 æ—¶é—´è½´ timeline</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline æ—¶é—´çº¿æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰[,color] %&#125;</span><br><span class="line">&lt;!-- timeline æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ --&gt;</span><br><span class="line">æ­£æ–‡å†…å®¹</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline æ—¶é—´èŠ‚ç‚¹ï¼ˆæ ‡é¢˜ï¼‰ --&gt;</span><br><span class="line">æ­£æ–‡å†…å®¹</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>title</code>:æ ‡é¢˜/æ—¶é—´çº¿</li><li><code>color</code>:<code>timeline</code>é¢œè‰²:default(ç•™ç©º) / blue / pink / red / purple / orange / green</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline æ—¶é—´è½´æ ·å¼,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> å¦‚æœæœ‰ <span class="code">`hexo-lazyload-image`</span> æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® <span class="code">`lazyload.isSPA: true`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> 2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† <span class="code">`use_cdn: true`</span> åˆ™éœ€è¦åˆ é™¤ã€‚</span><br><span class="line"><span class="bullet">3.</span> 2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚</span><br><span class="line"><span class="bullet">4.</span> 2.x ç‰ˆæœ¬çš„ç½®é¡¶ <span class="code">`top: true`</span> æ”¹ä¸ºäº† <span class="code">`pin: true`</span>ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº <span class="code">`layout: page`</span> çš„é¡µé¢ã€‚</span><br><span class="line"><span class="bullet">5.</span> å¦‚æœä½¿ç”¨äº† <span class="code">`hexo-offline`</span> æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> å…¨å±€æœç´¢ <span class="code">`seotitle`</span> å¹¶æ›¿æ¢ä¸º <span class="code">`seo_title`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ<span class="code">`group: group_name`</span> å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ <span class="code">`group_name`</span>ã€‚</span><br><span class="line"><span class="bullet">2.</span> group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ <span class="code">`short_title`</span> å…¶æ¬¡æ˜¯ <span class="code">`title`</span>ã€‚</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>æ—¶é—´è½´æ ·å¼</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>å¦‚æœæœ‰ <code>hexo-lazyload-image</code> æ’ä»¶ï¼Œéœ€è¦åˆ é™¤å¹¶é‡æ–°å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œè®¾ç½® <code>lazyload.isSPA: true</code>ã€‚</li><li>2.x ç‰ˆæœ¬çš„ css å’Œ js ä¸é€‚ç”¨äº 3.x ç‰ˆæœ¬ï¼Œå¦‚æœä½¿ç”¨äº† <code>use_cdn: true</code> åˆ™éœ€è¦åˆ é™¤ã€‚</li><li>2.x ç‰ˆæœ¬çš„ fancybox æ ‡ç­¾åœ¨ 3.x ç‰ˆæœ¬ä¸­è¢«é‡å‘½åä¸º gallery ã€‚</li><li>2.x ç‰ˆæœ¬çš„ç½®é¡¶ <code>top: true</code> æ”¹ä¸ºäº† <code>pin: true</code>ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äº <code>layout: page</code> çš„é¡µé¢ã€‚</li><li>å¦‚æœä½¿ç”¨äº† <code>hexo-offline</code> æ’ä»¶ï¼Œå»ºè®®å¸è½½ï¼Œ3.0 ç‰ˆæœ¬é»˜è®¤å¼€å¯äº† pjax æœåŠ¡ã€‚</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>ä¸éœ€è¦é¢å¤–å¤„ç†ã€‚</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>å…¨å±€æœç´¢ <code>seotitle</code> å¹¶æ›¿æ¢ä¸º <code>seo_title</code>ã€‚</li><li>group ç»„ä»¶çš„ç´¢å¼•è§„åˆ™æœ‰å˜ï¼Œä½¿ç”¨ group ç»„ä»¶çš„æ–‡ç« å†…ï¼Œ<code>group: group_name</code> å¯¹åº”çš„ç»„ä»¶åå¿…é¡»æ˜¯ <code>group_name</code>ã€‚</li><li>group ç»„ä»¶çš„åˆ—è¡¨åä¼˜å…ˆæ˜¾ç¤ºæ–‡ç« çš„ <code>short_title</code> å…¶æ¬¡æ˜¯ <code>title</code>ã€‚</li></ol></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-10-é“¾æ¥å¡ç‰‡-link">2.10 é“¾æ¥å¡ç‰‡ link</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡é“¾æ¥ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link ç³–æœå±‹æ•™ç¨‹è´´, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="tag link"><a class="link-card" title="ç³–æœå±‹æ•™ç¨‹è´´" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">ç³–æœå±‹æ•™ç¨‹è´´</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-11-æŒ‰é’®-btns">2.11 æŒ‰é’® btns</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns æ ·å¼å‚æ•° %&#125;</span><br><span class="line">&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;</span><br><span class="line">&#123;% cell æ ‡é¢˜, é“¾æ¥, å›¾ç‰‡æˆ–è€…å›¾æ ‡ %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>åœ†è§’æ ·å¼ï¼šrounded, circle</li><li>å¢åŠ æ–‡å­—æ ·å¼ï¼šå¯ä»¥åœ¨å®¹å™¨å†…å¢åŠ  <code>&lt;b&gt;</code>æ ‡é¢˜<code>&lt;/b&gt;</code>å’Œ<code>&lt;p&gt;</code>æè¿°æ–‡å­—<code>&lt;/p&gt;</code></li><li>å¸ƒå±€æ–¹å¼ï¼š<br>é»˜è®¤ä¸ºè‡ªåŠ¨å®½åº¦ï¼Œé€‚åˆè§†é‡å†…åªæœ‰ä¸€ä¸¤ä¸ªçš„æƒ…å†µã€‚</li></ol><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>wide</td><td>å®½ä¸€ç‚¹çš„æŒ‰é’®</td></tr><tr><td>fill</td><td>å¡«å……å¸ƒå±€ï¼Œè‡ªåŠ¨é“ºæ»¡è‡³å°‘ä¸€è¡Œï¼Œå¤šäº†ä¼šæ¢è¡Œ</td></tr><tr><td>center</td><td>å±…ä¸­ï¼ŒæŒ‰é’®ä¹‹é—´æ˜¯å›ºå®šé—´è·</td></tr><tr><td>around</td><td>å±…ä¸­åˆ†æ•£</td></tr><tr><td>grid2</td><td>ç­‰å®½æœ€å¤š2åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid3</td><td>ç­‰å®½æœ€å¤š3åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid4</td><td>ç­‰å®½æœ€å¤š4åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr><tr><td>grid5</td><td>ç­‰å®½æœ€å¤š5åˆ—ï¼Œå±å¹•å˜çª„ä¼šé€‚å½“å‡å°‘åˆ—æ•°</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell ä¸‹è½½æºç , /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell æŸ¥çœ‹æ–‡æ¡£, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>3.åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>å¿ƒç‡ç®¡å®¶<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, ä¸“ä¸šç‰ˆ %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>å¿ƒç‡ç®¡å®¶<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, å…è´¹ç‰ˆ %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.å¦‚æœéœ€è¦æ˜¾ç¤ºç±»ä¼¼ã€Œå›¢é˜Ÿæˆå‘˜ã€ä¹‹ç±»çš„ä¸€ç»„å«æœ‰å¤´åƒçš„é“¾æ¥</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.æˆ–è€…å«æœ‰å›¾æ ‡çš„æŒ‰é’®<div class="btns rounded grid5">            <a class="button" href='/' title='ä¸‹è½½æºç '><i class='fas fa-download'></i>ä¸‹è½½æºç </a><a class="button" href='/' title='æŸ¥çœ‹æ–‡æ¡£'><i class='fas fa-book-open'></i>æŸ¥çœ‹æ–‡æ¡£</a>          </div>3.åœ†å½¢å›¾æ ‡ + æ ‡é¢˜ + æè¿° + å›¾ç‰‡ + ç½‘æ ¼5åˆ— + å±…ä¸­<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>å¿ƒç‡ç®¡å®¶</b>  <p class='p red'>ä¸“ä¸šç‰ˆ</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>å¿ƒç‡ç®¡å®¶</b>  <p class='p green'>å…è´¹ç‰ˆ</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-12-githubå¡ç‰‡-ghcard">2.12 githubå¡ç‰‡ ghcard</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ghcard ç”¨æˆ·å, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% ghcard ç”¨æˆ·å/ä»“åº“, å…¶å®ƒå‚æ•°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><p>ä½¿ç”¨<code>,</code>åˆ†å‰²å„ä¸ªå‚æ•°ã€‚å†™æ³•ä¸ºï¼š<code>å‚æ•°å=å‚æ•°å€¼</code><br>ä»¥ä¸‹åªå†™å‡ ä¸ªå¸¸ç”¨å‚æ•°å€¼ã€‚</p><table><thead><tr><th><strong>å‚æ•°å</strong></th><th>å–å€¼</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>éšè—æŒ‡å®šç»Ÿè®¡</td></tr><tr><td>count_private</td><td>true</td><td>å°†ç§äººé¡¹ç›®è´¡çŒ®æ·»åŠ åˆ°æ€»æäº¤è®¡æ•°ä¸­</td></tr><tr><td>show_icons</td><td>true</td><td>æ˜¾ç¤ºå›¾æ ‡</td></tr><tr><td>theme</td><td>æŸ¥é˜…:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>ä¸»é¢˜</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.ç”¨æˆ·ä¿¡æ¯å¡ç‰‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.ä»“åº“ä¿¡æ¯å¡ç‰‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.ç”¨æˆ·ä¿¡æ¯å¡ç‰‡</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table><p>2.ä»“åº“ä¿¡æ¯å¡ç‰‡</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-13-githubå¾½æ ‡-ghbdage">2.13 githubå¾½æ ‡ ghbdage</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>left</code>ï¼šå¾½æ ‡å·¦è¾¹çš„ä¿¡æ¯ï¼Œå¿…é€‰å‚æ•°ã€‚</li><li><code>right</code>: å¾½æ ‡å³è¾¹çš„ä¿¡æ¯ï¼Œå¿…é€‰å‚æ•°ï¼Œ</li><li><code>logo</code>ï¼šå¾½æ ‡å›¾æ ‡ï¼Œå›¾æ ‡åç§°è¯¦è§<a href="https://simpleicons.org/">simpleicons</a>ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>color</code>ï¼šå¾½æ ‡å³è¾¹çš„é¢œè‰²ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>link</code>ï¼šæŒ‡å‘çš„é“¾æ¥ï¼Œå¯é€‰å‚æ•°ã€‚</li><li><code>title</code>ï¼šå¾½æ ‡çš„é¢å¤–ä¿¡æ¯ï¼Œå¯é€‰å‚æ•°ã€‚ä¸»è¦ç”¨äºä¼˜åŒ–SEOï¼Œä½†<code>object</code>æ ‡ç­¾ä¸ä¼šåƒ<code>a</code>æ ‡ç­¾ä¸€æ ·åœ¨é¼ æ ‡æ‚¬åœæ˜¾ç¤º<code>title</code>ä¿¡æ¯ã€‚</li><li><code>option</code>ï¼šè‡ªå®šä¹‰å‚æ•°ï¼Œæ”¯æŒ<a href="https://shields.io/">shields.io</a>çš„å…¨éƒ¨APIå‚æ•°æ”¯æŒï¼Œå…·ä½“å‚æ•°å¯ä»¥å‚çœ‹ä¸Šæ–‡ä¸­çš„æ‹“å±•å†™æ³•ç¤ºä¾‹ã€‚å½¢å¼ä¸º<code>name1=value2&amp;name2=value2</code>ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.åŸºæœ¬å‚æ•°,å®šä¹‰å¾½æ ‡å·¦å³æ–‡å­—å’Œå›¾æ ‡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.ä¿¡æ¯å‚æ•°ï¼Œå®šä¹‰å¾½æ ‡å³ä¾§å†…å®¹èƒŒæ™¯è‰²ï¼ŒæŒ‡å‘é“¾æ¥</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ %&#125;</span><br><span class="line">//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ï¼Œä»ç„¶éœ€è¦å†™ä¸ªé€—å·,ç”¨ä½œåˆ†å‰²</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.æ‹“å±•å‚æ•°ï¼Œæ”¯æŒshieldsçš„APIçš„å…¨éƒ¨å‚æ•°å†…å®¹</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ç»„ï¼Œä»ç„¶éœ€è¦å†™åŒç«–çº¿||ç”¨ä½œåˆ†å‰²</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.åŸºæœ¬å‚æ•°,å®šä¹‰å¾½æ ‡å·¦å³æ–‡å­—å’Œå›¾æ ‡</p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object></p><p>2.ä¿¡æ¯å‚æ•°ï¼Œå®šä¹‰å¾½æ ‡å³ä¾§å†…å®¹èƒŒæ™¯è‰²ï¼ŒæŒ‡å‘é“¾æ¥</p><p><object class="ghbdage" style="margin-inline:5px" title="æœ¬ç«™ä½¿ç”¨JsDelivrä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><br>//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ï¼Œä»ç„¶éœ€è¦å†™ä¸ªé€—å·,ç”¨ä½œåˆ†å‰²<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object></p><p>3.æ‹“å±•å‚æ•°ï¼Œæ”¯æŒshieldsçš„APIçš„å…¨éƒ¨å‚æ•°å†…å®¹</p><p><object class="ghbdage" style="margin-inline:5px" title="æœ¬ç«™é‡‡ç”¨åŒçº¿éƒ¨ç½²ï¼Œé»˜è®¤çº¿è·¯æ‰˜ç®¡äºVercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><br>//å¦‚æœæ˜¯è·¨é¡ºåºçœç•¥å¯é€‰å‚æ•°ç»„ï¼Œä»ç„¶éœ€è¦å†™åŒç«–çº¿||ç”¨ä½œåˆ†å‰²<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-14-ç½‘ç«™å¡ç‰‡-sites">2.14 ç½‘ç«™å¡ç‰‡ sites</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site æ ‡é¢˜, url=é“¾æ¥, screenshot=æˆªå›¾é“¾æ¥, avatar=å¤´åƒé“¾æ¥ï¼ˆå¯é€‰ï¼‰, description=æè¿°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% site æ ‡é¢˜, url=é“¾æ¥, screenshot=æˆªå›¾é“¾æ¥, avatar=å¤´åƒé“¾æ¥ï¼ˆå¯é€‰ï¼‰, description=æè¿°ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=ç®€çº¦é£æ ¼ %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­— %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">ç®€çº¦é£æ ¼</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">è¿™æ˜¯ä¸€æ®µå…³äºè¿™ä¸ªç½‘ç«™çš„æè¿°æ–‡å­—</span></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-15-è¡Œå†…å›¾ç‰‡-inlineimage">2.15 è¡Œå†…å›¾ç‰‡ inlineimage</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineimage å›¾ç‰‡é“¾æ¥, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>é«˜åº¦</code>ï¼šheight=20px</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; ä¸€æ®µè¯ã€‚</span><br><span class="line"></span><br><span class="line">è¿™åˆæ˜¯ &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; ä¸€æ®µè¯ã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>è¿™æ˜¯ <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> ä¸€æ®µè¯ã€‚</p><p>è¿™åˆæ˜¯ <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> ä¸€æ®µè¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-16-å•å¼ å›¾ç‰‡-image">2.16 å•å¼ å›¾ç‰‡ image</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image é“¾æ¥, width=å®½åº¦ï¼ˆå¯é€‰ï¼‰, height=é«˜åº¦ï¼ˆå¯é€‰ï¼‰, alt=æè¿°ï¼ˆå¯é€‰ï¼‰, bg=å ä½é¢œè‰²ï¼ˆå¯é€‰ï¼‰ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>å›¾ç‰‡å®½åº¦é«˜åº¦ï¼šwidth=300px, height=32px</li><li>å›¾ç‰‡æè¿°ï¼šalt=å›¾ç‰‡æè¿°ï¼ˆbutterflyéœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­å¼€å¯å›¾ç‰‡æè¿°ï¼‰</li><li>å ä½èƒŒæ™¯è‰²ï¼šbg=#f2f2f2</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.æ·»åŠ æè¿°ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;</span><br></pre></td></tr></table></figure><p>2.æŒ‡å®šå®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><p>3.æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚ %&#125;</span><br></pre></td></tr></table></figure><p>4.è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.æ·»åŠ æè¿°ï¼š</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚"/></div><span class="image-caption">æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚</span></div>2..æŒ‡å®šå®½åº¦<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.æŒ‡å®šå®½åº¦å¹¶æ·»åŠ æè¿°ï¼š<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚" style="width:400px;"/></div><span class="image-caption">æ¯å¤©ä¸‹è¯¾å›å®¿èˆçš„è·¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ•…äº‹ã€‚</span></div>4.è®¾ç½®å ä½èƒŒæ™¯è‰²ï¼š<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ" style="width:400px;"/></div><span class="image-caption">ä¼˜åŒ–ä¸åŒå®½åº¦æµè§ˆçš„è§‚æ„Ÿ</span></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-17-éŸ³é¢‘-audio">2.17 éŸ³é¢‘ audio</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio éŸ³é¢‘é“¾æ¥ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-18-è§†é¢‘-video">2.18 è§†é¢‘ video</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video è§†é¢‘é“¾æ¥ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>å¯¹é½æ–¹å‘</code>ï¼šleft, center, right</li><li><code>åˆ—æ•°</code>ï¼šé€—å·åé¢ç›´æ¥å†™åˆ—æ•°ï¼Œæ”¯æŒ 1 ï½ 4 åˆ—ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.100%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><p>3.25%å®½åº¦</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.100%å®½åº¦</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%å®½åº¦<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%å®½åº¦<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-19-ç›¸å†Œ-gallery">2.19 ç›¸å†Œ gallery</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery ç›¸å†Œ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown åœ–ç‰‡æ ¼å¼</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ul><li>gallerygroup ç›¸å†Œå›¾åº“</li></ul><table><thead><tr><th>å‚æ•°å</th><th>é‡Šä¹‰</th></tr></thead><tbody><tr><td>name</td><td>å›¾åº“åå­—</td></tr><tr><td>description</td><td>å›¾åº“æè¿°</td></tr><tr><td>link</td><td>é“¾æ¥åˆ°å¯¹åº”ç›¸å†Œçš„åœ°å€</td></tr><tr><td>img-url</td><td>å›¾åº“å°é¢</td></tr></tbody></table><ul><li><p>gallery ç›¸å†Œ</p><p>åŒºåˆ«äºæ—§ç‰ˆçš„Galleryç›¸å†Œ,æ–°çš„Galleryç›¸å†Œä¼šè‡ªåŠ¨æ ¹æ®å›¾ç‰‡é•¿åº¦è¿›è¡Œæ’ç‰ˆï¼Œä¹¦å†™ä¹Ÿæ›´åŠ æ–¹ä¾¿ï¼Œä¸markdownæ ¼å¼ä¸€æ ·ã€‚å¯æ ¹æ®éœ€è¦æ’å…¥åˆ°ç›¸åº”çš„mdã€‚æ— éœ€å†è‡ªå·±é…ç½®é•¿å®½ã€‚<strong>å»ºè®®åœ¨ç²˜è´´æ—¶æ•…æ„ä½¿ç”¨é•¿çŸ­ã€å¤§å°ã€æ¨ªç«–ä¸ä¸€çš„å›¾ç‰‡</strong>ï¼Œä¼šæœ‰æ›´å¥½çš„æ•ˆæœã€‚ï¼ˆå°ºå¯¸å®Œå…¨ç›¸åŒçš„å›¾ç‰‡åªä¼šå¹³é“ºè¾“å‡ºï¼Œæ•ˆæœå¾ˆç³Ÿç³•ï¼‰</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC åœ¨Rikkaã®å…­èŠ±æœåŠ¡å™¨é‡Œç•™ä¸‹çš„è¶³è¿¹ &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam å“¦å’§å“‡gundamå“’ï¼ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar æŸç§æ„ä¹‰ä¸Šä¹Ÿç®—è‡ªæ‹å§ &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery ç›¸å†Œ</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>åœ¨Rikkaã®å…­èŠ±æœåŠ¡å™¨é‡Œç•™ä¸‹çš„è¶³è¿¹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>å“¦å’§å“‡gundamå“’ï¼</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>æŸç§æ„ä¹‰ä¸Šä¹Ÿç®—è‡ªæ‹å§</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure></div>2.gallery ç›¸å†Œ<div class="fj-gallery"><p><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" alt=""><br><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" alt=""></p>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-20-æŠ˜å æ¡†-folding">2.20 æŠ˜å æ¡† folding</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><p>1.gallerygroup ç›¸å†Œå›¾åº“</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding å‚æ•°ï¼ˆå¯é€‰ï¼‰, æ ‡é¢˜ %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><!-- tab å‚æ•°é…ç½® --><ol><li><p><code>é¢œè‰²</code>ï¼šblue, cyan, green, yellow, red</p></li><li><p><code>çŠ¶æ€</code>ï¼šçŠ¶æ€å¡«å†™ open ä»£è¡¨é»˜è®¤æ‰“å¼€ã€‚</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† %&#125;</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, æŸ¥çœ‹ä»£ç æµ‹è¯• %&#125;</span><br><span class="line">å‡è£…è¿™é‡Œæœ‰ä»£ç å—ï¼ˆä»£ç å—æ²¡æ³•åµŒå¥—ä»£ç å—ï¼‰</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, æŸ¥çœ‹åµŒå¥—æµ‹è¯• %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><details class="folding-tag" ><summary> æŸ¥çœ‹å›¾ç‰‡æµ‹è¯• </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg" alt=""></p>              </div>            </details><details class="folding-tag" cyan open><summary> æŸ¥çœ‹é»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡† </summary>              <div class='content'>              <p>è¿™æ˜¯ä¸€ä¸ªé»˜è®¤æ‰“å¼€çš„æŠ˜å æ¡†ã€‚</p>              </div>            </details><details class="folding-tag" green><summary> æŸ¥çœ‹ä»£ç æµ‹è¯• </summary>              <div class='content'>              <p>å‡è£…è¿™é‡Œæœ‰ä»£ç å—ï¼ˆä»£ç å—æ²¡æ³•åµŒå¥—ä»£ç å—ï¼‰</p>              </div>            </details><details class="folding-tag" yellow><summary> æŸ¥çœ‹åˆ—è¡¨æµ‹è¯• </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯• </summary>              <div class='content'>              <details class="folding-tag" blue><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯•2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> æŸ¥çœ‹åµŒå¥—æµ‹è¯•3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-21-åˆ†æ -tab">2.21 åˆ†æ  tab</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">é…ç½®å‚æ•°</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p>Unique name :</p><ul><li><p>é€‰é¡¹å¡å—æ ‡ç­¾çš„å”¯ä¸€åç§°ï¼Œä¸å¸¦é€—å·ã€‚</p></li><li><p>å°†åœ¨#idä¸­ç”¨ä½œæ¯ä¸ªæ ‡ç­¾åŠå…¶ç´¢å¼•å·çš„å‰ç¼€ã€‚</p></li><li><p>å¦‚æœåç§°ä¸­åŒ…å«ç©ºæ ¼ï¼Œåˆ™å¯¹äºç”Ÿæˆ#idï¼Œæ‰€æœ‰ç©ºæ ¼å°†ç”±ç ´æŠ˜å·ä»£æ›¿ã€‚</p></li><li><p>ä»…å½“å‰å¸–å­/é¡µé¢çš„URLå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼</p></li></ul></li><li><p>[index]:</p><ul><li><p>æ´»åŠ¨é€‰é¡¹å¡çš„ç´¢å¼•å·ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šï¼Œå°†é€‰æ‹©ç¬¬ä¸€ä¸ªæ ‡ç­¾ï¼ˆ1ï¼‰ã€‚</p></li><li><p>å¦‚æœindexä¸º-1ï¼Œåˆ™ä¸ä¼šé€‰æ‹©ä»»ä½•é€‰é¡¹å¡ã€‚</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>å½“å‰é€‰é¡¹å¡çš„æ ‡é¢˜ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šæ ‡é¢˜ï¼Œåˆ™å¸¦æœ‰åˆ¶è¡¨ç¬¦ç´¢å¼•åç¼€çš„å”¯ä¸€åç§°å°†ç”¨ä½œåˆ¶è¡¨ç¬¦çš„æ ‡é¢˜ã€‚</p></li><li><p>å¦‚æœæœªæŒ‡å®šæ ‡é¢˜ï¼Œä½†æŒ‡å®šäº†å›¾æ ‡ï¼Œåˆ™æ ‡é¢˜å°†ä¸ºç©ºã€‚</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesomeå›¾æ ‡åç§°ï¼ˆå…¨åï¼Œçœ‹èµ·æ¥åƒâ€œ fas fa-fontâ€ï¼‰</p></li><li><p>å¯ä»¥æŒ‡å®šå¸¦ç©ºæ ¼æˆ–ä¸å¸¦ç©ºæ ¼ï¼›</p></li><li><p>ä¾‹å¦‚â€™Tab caption @iconâ€™ å’Œ â€˜Tab caption@iconâ€™.</p></li><li><p>å¯é€‰å‚æ•°ã€‚</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.Demo 1 - é¢„è®¾é€‰æ‹©ç¬¬ä¸€ä¸ªã€é»˜è®¤ã€‘</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - é¢„è®¾é€‰æ‹©tabs</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - æ²¡æœ‰é¢„è®¾å€¼</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - è‡ªå®šä¹‰Tabå + åªæœ‰icon + iconå’ŒTabå</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab ç¬¬ä¸€ä¸ªTab --&gt;</span><br><span class="line"><span class="strong">**tabåå­—ä¸ºç¬¬ä¸€ä¸ªTab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab ç‚¸å¼¹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**åå­—+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.Demo 1 - é¢„è®¾é€‰æ‹©ç¬¬ä¸€ä¸ªã€é»˜è®¤ã€‘</p><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>2.Demo 2 - é¢„è®¾é€‰æ‹©tabs</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3.Demo 3 - æ²¡æœ‰é¢„è®¾å€¼</p><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test3-1">test3 1</button></li><li class="tab"><button type="button" data-href="#test3-2">test3 2</button></li><li class="tab"><button type="button" data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>4.Demo 4 - è‡ªå®šä¹‰Tabå + åªæœ‰icon + iconå’ŒTabå</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">ç¬¬ä¸€ä¸ªTab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>ç‚¸å¼¹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tabåå­—ä¸ºç¬¬ä¸€ä¸ªTab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>åå­—+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-22-è¯—è¯æ ‡ç­¾-poem">2.22 è¯—è¯æ ‡ç­¾ poem</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><ol><li><code>title</code>ï¼šè¯—è¯æ ‡é¢˜</li><li><code>author</code>ï¼šä½œè€…ï¼Œå¯ä»¥ä¸å†™</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem æ°´è°ƒæ­Œå¤´,è‹è½¼ %&#125;</span><br><span class="line">ä¸™è¾°ä¸­ç§‹ï¼Œæ¬¢é¥®è¾¾æ—¦ï¼Œå¤§é†‰ï¼Œä½œæ­¤ç¯‡ï¼Œå…¼æ€€å­ç”±ã€‚</span><br><span class="line">æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚</span><br><span class="line">ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ï¼Ÿ</span><br><span class="line">æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚</span><br><span class="line">èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ï¼Ÿ</span><br><span class="line"></span><br><span class="line">è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚</span><br><span class="line">ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ï¼Ÿ</span><br><span class="line">äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚</span><br><span class="line">ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><div class='poem'><div class='poem-title'>æ°´è°ƒæ­Œå¤´</div><div class='poem-author'>è‹è½¼</div><p>ä¸™è¾°ä¸­ç§‹ï¼Œæ¬¢é¥®è¾¾æ—¦ï¼Œå¤§é†‰ï¼Œä½œæ­¤ç¯‡ï¼Œå…¼æ€€å­ç”±ã€‚<br>æ˜æœˆå‡ æ—¶æœ‰ï¼ŸæŠŠé…’é—®é’å¤©ã€‚<br>ä¸çŸ¥å¤©ä¸Šå®«é˜™ï¼Œä»Šå¤•æ˜¯ä½•å¹´ï¼Ÿ<br>æˆ‘æ¬²ä¹˜é£å½’å»ï¼Œåˆæç¼æ¥¼ç‰å®‡ï¼Œé«˜å¤„ä¸èƒœå¯’ã€‚<br>èµ·èˆå¼„æ¸…å½±ï¼Œä½•ä¼¼åœ¨äººé—´ï¼Ÿ</p><p>è½¬æœ±é˜ï¼Œä½ç»®æˆ·ï¼Œç…§æ— çœ ã€‚<br>ä¸åº”æœ‰æ¨ï¼Œä½•äº‹é•¿å‘åˆ«æ—¶åœ†ï¼Ÿ<br>äººæœ‰æ‚²æ¬¢ç¦»åˆï¼Œæœˆæœ‰é˜´æ™´åœ†ç¼ºï¼Œæ­¤äº‹å¤éš¾å…¨ã€‚<br>ä½†æ„¿äººé•¿ä¹…ï¼Œåƒé‡Œå…±å©µå¨Ÿã€‚</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-23-é˜¿é‡Œå›¾æ ‡-icon">2.23 é˜¿é‡Œå›¾æ ‡ icon</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>icon-xxxx</code>ï¼šè¡¨ç¤ºå›¾æ ‡<code>font-class</code>,å¯ä»¥åœ¨è‡ªå·±çš„é˜¿é‡ŒçŸ¢é‡å›¾æ ‡åº“é¡¹ç›®çš„<code>font-class</code>å¼•ç”¨æ–¹æ¡ˆå†…æŸ¥è¯¢å¹¶å¤åˆ¶ã€‚</li><li><code>font-size</code>ï¼šè¡¨ç¤ºå›¾æ ‡å¤§å°ï¼Œç›´æ¥å¡«å†™æ•°å­—å³å¯ï¼Œå•ä½ä¸º<code>em</code>ã€‚å›¾æ ‡å¤§å°é»˜è®¤å€¼ä¸º<code>1em</code>ã€‚</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-24-ç‰¹æ•ˆæ ‡ç­¾wow">2.24 ç‰¹æ•ˆæ ‡ç­¾wow</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ¸²æŸ“æ¼”ç¤º</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">å†…å®¹</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>animate</code>: åŠ¨ç”»æ ·å¼ï¼Œæ•ˆæœè¯¦è§<a href="https://animate.style/">animate.csså‚è€ƒæ–‡æ¡£</a></li><li><code>duration</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯<code>ms</code>ä¹Ÿå¯ä»¥æ˜¯<code>s</code>ã€‚ä¾‹å¦‚<code>3s</code>ï¼Œ<code>700ms</code>ã€‚</li><li><code>delay</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯<code>ms</code>ä¹Ÿå¯ä»¥æ˜¯<code>s</code>ã€‚ä¾‹å¦‚<code>3s</code>ï¼Œ<code>700ms</code>ã€‚</li><li><code>offset</code>: é€‰å¡«é¡¹ï¼Œå¼€å§‹åŠ¨ç”»çš„è·ç¦»ï¼ˆç›¸å¯¹æµè§ˆå™¨åº•éƒ¨ï¼‰</li><li><code>iteration</code>: é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»é‡å¤çš„æ¬¡æ•°</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><p>1.flipåŠ¨ç”»æ•ˆæœã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ï¼Œç¦»åº•éƒ¨`100`è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤`10`æ¬¡</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>2.zoomInåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5sï¼Œç¦»åº•éƒ¨100è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤10æ¬¡</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ï¼Œç¦»åº•éƒ¨`100`è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤`10`æ¬¡</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>3.slideInRightåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5s</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­`5s`ï¼Œå»¶æ—¶`5s`ã€‚</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>4.heartBeatåŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶5sï¼Œé‡å¤10æ¬¡ã€‚æ­¤å¤„æ³¨æ„ä¸ç”¨çš„å‚æ•°ä½ç½®è¦ç•™ç©ºï¼Œç”¨é€—å·é—´éš”ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`åŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶`5s`ï¼Œé‡å¤`10`æ¬¡ã€‚</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>1.flipåŠ¨ç”»æ•ˆæœã€‚</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ï¼Œç¦»åº•éƒ¨<code>100</code>è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤<code>10</code>æ¬¡</p></div></div><p>2.zoomInåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5sï¼Œç¦»åº•éƒ¨100è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤10æ¬¡</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ï¼Œç¦»åº•éƒ¨<code>100</code>è·ç¦»æ—¶å¯åŠ¨ï¼Œé‡å¤<code>10</code>æ¬¡</p></div></div><p>3.slideInRightåŠ¨ç”»æ•ˆæœï¼ŒæŒç»­5sï¼Œå»¶æ—¶5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>åŠ¨ç”»æ•ˆæœï¼ŒæŒç»­<code>5s</code>ï¼Œå»¶æ—¶<code>5s</code>ã€‚</p></div></div><p>4.heartBeatåŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶5sï¼Œé‡å¤10æ¬¡ã€‚æ­¤å¤„æ³¨æ„ä¸ç”¨çš„å‚æ•°ä½ç½®è¦ç•™ç©ºï¼Œç”¨é€—å·é—´éš”ã€‚</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>åŠ¨ç”»æ•ˆæœï¼Œå»¶æ—¶<code>5s</code>ï¼Œé‡å¤<code>10</code>æ¬¡ã€‚</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-25-è¿›åº¦æ¡-progress">2.25  è¿›åº¦æ¡ progress</h2><div class="note info flat"><p>è¿›åº¦æ¡æ ‡ç­¾å‚è€ƒ<a href="https://rongbuqiu.com/jdt.html">æ²‚ä½°å­œçŒ«-ç»™HEXOæ–‡ç« æ·»åŠ å½©è‰²è¿›åº¦æ¡</a>ã€‚<br>æºæ ·å¼æå–è‡ª<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>ä¸»é¢˜ã€‚</p></div><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>width</code>: 0åˆ°100çš„é˜¿æ‹‰ä¼¯æ•°å­—</li><li><code>color</code>: é¢œè‰²ï¼Œå–å€¼æœ‰red,yellow,green,cyan,blue,gray</li><li><code>text</code>:è¿›åº¦æ¡ä¸Šçš„æ–‡å­—å†…å®¹</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 30 yellow è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 50 green è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 70 cyan è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 90 blue è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br><span class="line">&#123;% progress 100 gray è¿›åº¦æ¡æ ·å¼é¢„è§ˆ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>è¿›åº¦æ¡æ ·å¼é¢„è§ˆ</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-26-æ³¨é‡Š-notation">2.26 æ³¨é‡Š notation</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p><code>label</code>: æ³¨é‡Šè¯æ±‡</p></li><li><p><code>text</code>: æ‚¬åœæ˜¾ç¤ºçš„æ³¨è§£å†…å®¹</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota æŠŠé¼ æ ‡ç§»åŠ¨åˆ°æˆ‘ä¸Šé¢è¯•è¯• ,å¯ä»¥çœ‹åˆ°æ³¨è§£å†…å®¹å‡ºç°åœ¨é¡¶æ  %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p><span class='nota' data-nota='å¯ä»¥çœ‹åˆ°æ³¨è§£å†…å®¹å‡ºç°åœ¨é¡¶æ '>æŠŠé¼ æ ‡ç§»åŠ¨åˆ°æˆ‘ä¸Šé¢è¯•è¯•</span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-27-æ°”æ³¡æ³¨é‡Š-bubble">2.27 æ°”æ³¡æ³¨é‡Š bubble</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>content</code>: æ³¨é‡Šè¯æ±‡</li><li><code>notation</code>: æ‚¬åœæ˜¾ç¤ºçš„æ³¨è§£å†…å®¹</li><li><code>background-color</code>: å¯é€‰ï¼Œæ°”æ³¡èƒŒæ™¯è‰²ã€‚é»˜è®¤ä¸ºâ€œ#71a4e3â€</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€è¿‘æˆ‘å­¦åˆ°äº†ä¸å°‘æ–°ç©æ„å„¿ï¼ˆè™½ç„¶å¯¹å¾ˆå¤šå¤§ä½¬æ¥è¯´è¿™äº›å·²ç»æ˜¯æ—§æŠ€æœ¯äº†ï¼‰ï¼Œæ¯”å¦‚CSSçš„&#123;% bubble å…„å¼Ÿç›¸é‚»é€‰æ‹©å™¨,&quot;ä¾‹å¦‚ h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;ï¼Œ&#123;% bubble flexå¸ƒå±€,&quot;Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸º&quot;å¼¹æ€§å¸ƒå±€&quot;ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§&quot;,&quot;#ec5830&quot; %&#125;ï¼Œ&#123;% bubble transformå˜æ¢,&quot;transform å±æ€§å‘å…ƒç´ åº”ç”¨ 2D æˆ– 3D è½¬æ¢ã€‚è¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œã€‚&quot;,&quot;#1db675&quot; %&#125;ï¼Œanimationçš„&#123;% bubble è´å¡å°”é€Ÿåº¦æ›²çº¿,&quot;è´å¡å°”æ›²çº¿(BÃ©zier curve)ï¼Œåˆç§°è´å…¹æ›²çº¿æˆ–è´æµåŸƒæ›²çº¿ï¼Œæ˜¯åº”ç”¨äºäºŒç»´å›¾å½¢åº”ç”¨ç¨‹åºçš„æ•°å­¦æ›²çº¿ã€‚ä¸€èˆ¬çš„çŸ¢é‡å›¾å½¢è½¯ä»¶é€šè¿‡å®ƒæ¥ç²¾ç¡®ç”»å‡ºæ›²çº¿ï¼Œè´å…¹æ›²çº¿ç”±çº¿æ®µä¸èŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ˜¯å¯æ‹–åŠ¨çš„æ”¯ç‚¹ï¼Œçº¿æ®µåƒå¯ä¼¸ç¼©çš„çš®ç­‹&quot;,&quot;#de4489&quot; %&#125;å†™æ³•ï¼Œè¿˜æœ‰ä»Šå¤©åˆšçœ‹åˆ°çš„&#123;% bubble clip-path,&quot;clip-pathå±æ€§ä½¿ç”¨è£å‰ªæ–¹å¼åˆ›å»ºå…ƒç´ çš„å¯æ˜¾ç¤ºåŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚&quot;,&quot;#868fd7&quot; %&#125;å±æ€§ã€‚è¿™äº›å¯¹æˆ‘æ¥è¯´å¾ˆæ–°é¢–çš„æ¦‚å¿µç‹ ç‹ çš„å†²å‡»ç€æˆ‘ä»¥å‰ç§¯ç´¯èµ·æ¥çš„è®¾è®¡æ€è·¯ã€‚</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>æœ€è¿‘æˆ‘å­¦åˆ°äº†ä¸å°‘æ–°ç©æ„å„¿ï¼ˆè™½ç„¶å¯¹å¾ˆå¤šå¤§ä½¬æ¥è¯´è¿™äº›å·²ç»æ˜¯æ—§æŠ€æœ¯äº†ï¼‰ï¼Œæ¯”å¦‚CSSçš„<span class="bubble-content">å…„å¼Ÿç›¸é‚»é€‰æ‹©å™¨</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">ä¾‹å¦‚ h1 + p {margin-top:50px;}</span></span>ï¼Œ<span class="bubble-content">flexå¸ƒå±€</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex æ˜¯ Flexible Box çš„ç¼©å†™ï¼Œæ„ä¸ºå¼¹æ€§å¸ƒå±€&quot;ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§&quot;</span></span>ï¼Œ<span class="bubble-content">transformå˜æ¢</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform å±æ€§å‘å…ƒç´ åº”ç”¨ 2D æˆ– 3D è½¬æ¢ã€‚è¯¥å±æ€§å…è®¸æˆ‘ä»¬å¯¹å…ƒç´ è¿›è¡Œæ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–å€¾æ–œã€‚</span></span>ï¼Œanimationçš„<span class="bubble-content">è´å¡å°”é€Ÿåº¦æ›²çº¿</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">è´å¡å°”æ›²çº¿(BÃ©zier curve)ï¼Œåˆç§°è´å…¹æ›²çº¿æˆ–è´æµåŸƒæ›²çº¿ï¼Œæ˜¯åº”ç”¨äºäºŒç»´å›¾å½¢åº”ç”¨ç¨‹åºçš„æ•°å­¦æ›²çº¿ã€‚ä¸€èˆ¬çš„çŸ¢é‡å›¾å½¢è½¯ä»¶é€šè¿‡å®ƒæ¥ç²¾ç¡®ç”»å‡ºæ›²çº¿ï¼Œè´å…¹æ›²çº¿ç”±çº¿æ®µä¸èŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ˜¯å¯æ‹–åŠ¨çš„æ”¯ç‚¹ï¼Œçº¿æ®µåƒå¯ä¼¸ç¼©çš„çš®ç­‹</span></span>å†™æ³•ï¼Œè¿˜æœ‰ä»Šå¤©åˆšçœ‹åˆ°çš„<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-pathå±æ€§ä½¿ç”¨è£å‰ªæ–¹å¼åˆ›å»ºå…ƒç´ çš„å¯æ˜¾ç¤ºåŒºåŸŸã€‚åŒºåŸŸå†…çš„éƒ¨åˆ†æ˜¾ç¤ºï¼ŒåŒºåŸŸå¤–çš„éšè—ã€‚</span></span>å±æ€§ã€‚è¿™äº›å¯¹æˆ‘æ¥è¯´å¾ˆæ–°é¢–çš„æ¦‚å¿µç‹ ç‹ çš„å†²å‡»ç€æˆ‘ä»¥å‰ç§¯ç´¯èµ·æ¥çš„è®¾è®¡æ€è·¯ã€‚</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-28-å¼•ç”¨æ–‡çŒ®-reference">2.28 å¼•ç”¨æ–‡çŒ® reference</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><p>referto å¼•ç”¨ä¸Šæ ‡</p><ul><li><p><code>id</code>: ä¸Šæ ‡åºå·å†…å®¹ï¼Œéœ€ä¸referfromæ ‡ç­¾çš„idå¯¹åº”æ‰èƒ½å®ç°è·³è½¬</p></li><li><p><code>literature</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®åç§°</p></li></ul></li><li><p>referfrom å¼•ç”¨å‡ºå¤„</p><ul><li><p><code>id</code>: åºå·å†…å®¹ï¼Œéœ€ä¸refertoæ ‡ç­¾çš„idå¯¹åº”æ‰èƒ½å®ç° è·³è½¬</p></li><li><p><code>literature</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®åç§°</p></li><li><p><code>url</code>: å¼•ç”¨çš„å‚è€ƒæ–‡çŒ®é“¾æ¥ï¼Œå¯çœç•¥</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Akilarã®ç³–æœå±‹(akilar.top)æ˜¯ä¸€ä¸ªç§äººæ€§è´¨çš„åšå®¢&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹&#x27; %&#125;ï¼Œä»å„ç±»æ•™ç¨‹è‡³ç”Ÿæ´»ç‚¹æ»´ï¼Œæ— è¯ä¸è°ˆã€‚å»ºç¾¤çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé—²èŠçš„åœºæ‰€ã€‚åšå®¢é‡‡ç”¨Hexoæ¡†æ¶&#123;% referto &#x27;[2]&#x27;,&#x27;Hexoä¸­æ–‡æ–‡æ¡£&#x27; %&#125;ï¼ŒButterflyä¸»é¢˜&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">æœ¬é¡¹ç›®å‚è€ƒäº†Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis æ ‡ç­¾æ’ä»¶&#x27; %&#125;çš„æ ‡ç­¾æ ·å¼ã€‚å¼•å…¥<span class="code">`[tag].js`</span>ï¼Œå¹¶é’ˆå¯¹<span class="code">`butterfly`</span>ä¸»é¢˜ä¿®æ”¹äº†ç›¸åº”çš„<span class="code">`[tag].styl`</span>ã€‚åœ¨æ­¤é¸£è°¢<span class="code">`Volantis`</span>ä¸»é¢˜ä¼—å¼€å‘è€…ã€‚</span><br><span class="line">ä¸»è¦å‚è€ƒå†…å®¹åŒ…æ‹¬å„ä¸ªvolantisçš„å†…ç½®æ ‡ç­¾æ’ä»¶æ–‡æ¡£&#123;% referto &#x27;[5]&#x27;,&#x27;Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶&#x27; %&#125;</span><br><span class="line">Butterflyä¸»é¢˜çš„å„ä¸ªè¡ç”Ÿé­”æ”¹&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexoä¸­æ–‡æ–‡æ¡£&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis æ ‡ç­¾æ’ä»¶&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>Akilarã®ç³–æœå±‹(akilar.top)æ˜¯ä¸€ä¸ªç§äººæ€§è´¨çš„åšå®¢<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>ï¼Œä»å„ç±»æ•™ç¨‹è‡³ç”Ÿæ´»ç‚¹æ»´ï¼Œæ— è¯ä¸è°ˆã€‚å»ºç¾¤çš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé—²èŠçš„åœºæ‰€ã€‚åšå®¢é‡‡ç”¨Hexoæ¡†æ¶<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexoä¸­æ–‡æ–‡æ¡£</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>ï¼ŒButterflyä¸»é¢˜<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><p>æœ¬é¡¹ç›®å‚è€ƒäº†Volantis<span class="hidden-anchor" id="referto_[4]"></span><sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis æ ‡ç­¾æ’ä»¶</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span>çš„æ ‡ç­¾æ ·å¼ã€‚å¼•å…¥<code>[tag].js</code>ï¼Œå¹¶é’ˆå¯¹<code>butterfly</code>ä¸»é¢˜ä¿®æ”¹äº†ç›¸åº”çš„<code>[tag].styl</code>ã€‚åœ¨æ­¤é¸£è°¢<code>Volantis</code>ä¸»é¢˜ä¼—å¼€å‘è€…ã€‚<br>ä¸»è¦å‚è€ƒå†…å®¹åŒ…æ‹¬å„ä¸ªvolantisçš„å†…ç½®æ ‡ç­¾æ’ä»¶æ–‡æ¡£<span class="hidden-anchor" id="referto_[5]"></span><sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><br>Butterflyä¸»é¢˜çš„å„ä¸ªè¡ç”Ÿé­”æ”¹<span class="hidden-anchor" id="referto_[6]"></span><sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[7]"></span><sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[8]"></span><sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span><span class="hidden-anchor" id="referto_[9]"></span><sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£</span><span class="reference-title">å‚è€ƒèµ„æ–™</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarã®ç³–æœå±‹ç¾¤èŠç®€ä»‹</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexoä¸­æ–‡æ–‡æ¡£</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly å®‰è£…æ–‡æ¡£(ä¸€) å¿«é€Ÿå¼€å§‹</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis æ ‡ç­¾æ’ä»¶</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantisæ–‡æ¡£:å†…ç½®æ ‡ç­¾æ’ä»¶</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly å®‰è£…æ–‡æ¡£:æ ‡ç­¾å¤–æŒ‚ï¼ˆTag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">å°å¼‹ã®ç”Ÿæ´»é¦†å…¨æ ·å¼é¢„è§ˆ</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">å°åº·çš„butterflyä¸»é¢˜ä½¿ç”¨æ–‡æ¡£</a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-29-PDFå±•ç¤º">2.29 PDFå±•ç¤º</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf æ–‡ä»¶è·¯å¾„ %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li><code>æ–‡ä»¶è·¯å¾„</code>: å¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„æˆ–è€…æ˜¯åœ¨çº¿é“¾æ¥</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.æœ¬åœ°æ–‡ä»¶:åœ¨mdæ–‡ä»¶è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåŒåæ–‡ä»¶å¤¹ï¼Œå…¶å†…æ”¾pdfæ–‡ä»¶åä¸ºxxx.pdfçš„æ–‡ä»¶</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.åœ¨çº¿é“¾æ¥</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/å°ä½œæ–‡è®²ä¹‰.pdf %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><p>2.åœ¨çº¿é“¾æ¥(è¦æ”¾åˆ°æœ€å¤–å±‚æ‰èƒ½èµ·ä½œç”¨)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/å°ä½œæ–‡è®²ä¹‰.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-30-Hexo-tag-map-æ’ä»¶">2.30 Hexo-tag-map æ’ä»¶</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% + æ ‡ç­¾å€¼ + ç»åº¦ + çº¬åº¦ + æ–‡æœ¬ + ç¼©æ”¾ç­‰çº§ + å®½ + é«˜ + é»˜è®¤å›¾å±‚ + %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><table><thead><tr><th style="text-align:center">åœ°å›¾å</th><th style="text-align:center">æ ‡ç­¾å€¼ &lt;å¿…å¡«&gt;</th><th style="text-align:center">å®½ (é»˜è®¤ 100%) / é«˜ (é»˜è®¤ 360px)</th><th style="text-align:center">ç¼©æ”¾ç­‰çº§ (é»˜è®¤ 14)</th><th style="text-align:center">å®½ (é»˜è®¤ 100%) / é«˜ (é»˜è®¤ 360px)</th><th style="text-align:center">é»˜è®¤å›¾å±‚ (é»˜è®¤ 1)</th></tr></thead><tbody><tr><td style="text-align:center">æ··åˆåœ°å›¾</td><td style="text-align:center">map</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 3~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~7</td></tr><tr><td style="text-align:center">è°·æ­Œåœ°å›¾</td><td style="text-align:center">googleMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~20</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~3</td></tr><tr><td style="text-align:center">é«˜å¾·åœ°å›¾</td><td style="text-align:center">gaodeMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 3~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~3</td></tr><tr><td style="text-align:center">ç™¾åº¦åœ°å›¾</td><td style="text-align:center">baiduMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 4~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~2</td></tr><tr><td style="text-align:center">Geoq åœ°å›¾</td><td style="text-align:center">geoqMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~5</td></tr><tr><td style="text-align:center">openstreet åœ°å›¾</td><td style="text-align:center">openstreetMap</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">å–å€¼ 1~18</td><td style="text-align:center">ç™¾åˆ†æ•°æˆ–å…·ä½“å€¼ (100% æˆ– 360px)</td><td style="text-align:center">ä¸æ”¯æŒæ­¤å‚æ•°</td></tr></tbody></table><ol><li>å‚æ•°ä¹‹é—´ï¼Œç”¨è‹±æ–‡é€—å·ç›¸éš”</li><li>å‚æ•°å¿…é¡»æŒ‰ä¸Šè¿°äº‹ä¾‹é¡ºåºè¾“å…¥ï¼Œä¸å¾—ä¸ºç©º</li><li>åŒä¸€ä¸ªé¡µé¢ï¼ŒåŒä¸€ç»„ç»çº¬åº¦å€¼ï¼Œåªèƒ½æ’å…¥ä¸€ä¸ªç›¸åŒæ ‡ç­¾å€¼çš„åœ°å›¾ (è‹¥æœ‰éœ€è¦ï¼Œå¯ä»¥å°†ç¬¬äºŒä¸ªåœ°å›¾ä¸Šï¼Œç»åº¦æˆ–çº¬åº¦æœ«å°¾åˆ é™¤ä¸€ä¸¤ä¸ªæ•°)</li><li>å‚æ•°å–å€¼å¿…é¡»åœ¨ä¸Šè¿°èŒƒå›´å†…</li><li>é»˜è®¤å›¾å±‚ï¼šå³åœ°å›¾å åŠ å±‚çš„å€¼ï¼Œé»˜è®¤å¸¸è§„åœ°å›¾è¿˜æ˜¯å«æ˜Ÿåœ°å›¾ï¼Œå¯æŒ‰åœ°å›¾æ˜¾ç¤ºé¡ºåºå–å€¼</li><li>ç¼©æ”¾ç­‰çº§ï¼Œæ•°å­—è¶Šå¤§ï¼Œåœ°å›¾æ¯”ä¾‹å°ºè¶Šå°ï¼Œæ˜¾ç¤ºçš„è¶Šç²¾ç»†</li><li>é™¤æ ‡ç­¾å€¼å¤–ï¼Œå…¶ä»–å‚æ•°é€‰å¡«ï¼Œä½† æ¯ä¸ªå‚æ•°çš„å·¦è¾¹çš„å‚æ•°å¿…å¡«</li><li>è°·æ­Œåœ°å›¾éœ€è¦å¤–ç½‘æ‰èƒ½åŠ è½½æŸ¥çœ‹</li></ol><p>åæ ‡è·å–ï¼š<a href="https://lbs.amap.com/tools/picker">é«˜å¾·åœ°å›¾åæ ‡æ‹¾å–ç³»ç»Ÿ</a> ã€<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">ç™¾åº¦åœ°å›¾åæ ‡æ‹¾å–ç³»ç»Ÿ</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div></div><script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'é«˜å¾·åœ°å›¾'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"é«˜å¾·åœ°å›¾":normal,"æ™ºå›¾åœ°å›¾":normalm1,"è°·æ­Œåœ°å›¾":normalMap,"é«˜å¾·å«æ˜Ÿåœ°å›¾":imgm,"è°·æ­Œå«æ˜Ÿåœ°å›¾":satelliteMap,"é«˜å¾·å«æ˜Ÿæ ‡æ³¨":image,"è°·æ­Œå«æ˜Ÿæ ‡æ³¨":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"è°·æ­Œåœ°å›¾":normalMap,"è°·æ­Œå«æ˜Ÿå›¾":satelliteMap,"è°·æ­Œå«æ˜Ÿæ ‡æ³¨": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼").openPopup();</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"æ™ºå›¾åœ°å›¾":normalm1,"åˆå¤œè“":normalm2,"ç°è‰²":normalm3,"æš–è‰²":normalm4,"æ°´ç³»":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'æ”¾å¤§',zoomOutTitle:'ç¼©å°'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("è¿™é‡Œæ˜¯è¥¿æ¹–çµéšå¯ºï¼Œæ®è¯´æ±‚å§»ç¼˜å¾ˆçµéªŒå“¦ï¼").openPopup();</script><br><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-31-éšè—å—">2.31 éšè—å—</h2><div class="tabs" id="åˆ†æ "><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#åˆ†æ -1">æ ‡ç­¾è¯­æ³•</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -2">å‚æ•°é…ç½®</button></li><li class="tab"><button type="button" data-href="#åˆ†æ -3">ç¤ºä¾‹æºç </button></li><li class="tab"><button type="button" data-href="#åˆ†æ -4">æ¸²æŸ“æ¼”ç¤º</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†æ -1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -2"><ol><li>contentï¼šè¦éšè—çš„å†…å®¹</li><li>displayï¼šå±•ç¤ºå‰æŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—ï¼ˆå¯é€‰ï¼‰</li><li>bgï¼šæŒ‰é’®çš„èƒŒæ™¯é¢œè‰²ï¼ˆå¯é€‰ï¼‰</li><li>colorï¼šæŒ‰é’®æ˜¾ç¤ºçš„æ–‡å­—çš„é¢œè‰²ï¼ˆå¯é€‰ï¼‰</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock ç‚¹æˆ‘é¢„è§ˆ, blue %&#125;</span><br><span class="line">è¿™é‡Œæœ‰å¼ å›¾ç‰‡ï¼š</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="åˆ†æ -4"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">ç‚¹æˆ‘é¢„è§ˆ    </button><div class="hide-content"><p>è¿™é‡Œæœ‰å¼ å›¾ç‰‡ï¼š<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
    
    
    <summary type="html">ğŸ¥§æœ¬æ–‡æ±‡æ€»Markdownæ ¼å¼ä»¥åŠå¤–æŒ‚æ ‡ç­¾åœ¨ç½‘é¡µç«¯çš„æ¸²æŸ“æ•ˆæœï¼Œå¯ä½œä¸ºæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢</summary>
    
    
    
    <category term="æ¼”ç¤º" scheme="https://keqiudi.github.io/categories/%E6%BC%94%E7%A4%BA/"/>
    
    
    <category term="Markdown" scheme="https://keqiudi.github.io/tags/Markdown/"/>
    
    <category term="å¤–æŒ‚æ ‡ç­¾" scheme="https://keqiudi.github.io/tags/%E5%A4%96%E6%8C%82%E6%A0%87%E7%AD%BE/"/>
    
  </entry>
  
</feed>
